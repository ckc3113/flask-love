"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[506412],{936636:(e,n,t)=>{t.d(n,{zf:()=>d,$Z:()=>c,xf:()=>g,$g:()=>f});var a=t(74583),i=t(346151),r=t(35753),s=t(326326),o=t(584002);const l="updateMessageCache";function d(e,n,t,i,r,s=!1,o){var d,c;try{if((0,a.isEmpty)(i))return void(null==o||o.log(`convId: ${n}, replyChainId: ${t}:: newMessageBatch is empty!`));const{messages:l,cursor:c}=null!==(d=u(e,n,t))&&void 0!==d?d:{};if(!l)return void(null==o||o.warn(`convId: ${n}, replyChainId: ${t}:: cachedMessages is undefined!`));if(c&&parseInt(c,10).toString()===c){const e=i.length;(i=i.filter((({clientMessageId:e,id:n})=>n&&(n===e||n>=c)))).length<e&&(null==o||o.log(`convId: ${n}, replyChainId: ${t}:: filtered out ${e-i.length} updates to messages as they are older than any in the message list.`))}null==o||o.log(`convId: ${n}, replyChainId: ${t}:: newMessageBatch: [${i.map((e=>e.id))}]`);const g=m(e,i,l,r,s,o);g?A(e,n,t,g,o):null==o||o.log(`convId: ${n}, replyChainId: ${t}:: skipped writeCacheQuery. message list not updated!`)}catch(e){null===(c=null==o?void 0:o.errorToTelemetry)||void 0===c||c.call(o,`Failed to updateMessageList for convId: ${n}, replyChainId: ${t}`,"messaging_delete_message",{conversationId:n,operationType:l},!0)}}const c=(e,n,t,i,r,o)=>{var d,c;const u=s.L,g={convId:n,replyChainId:t};try{const s=null===(d=e.readQuery({query:u,variables:g}))||void 0===d?void 0:d.messages;if(!s)return;const{messages:l,cursor:c,__typename:A}=s,m=(0,a.findLast)(l,(e=>e.id===i&&e.from===r));if(l&&m){const r=(0,a.without)(l,m);e.writeQuery({query:u,variables:g,data:{messages:{messages:r,cursor:c,__typename:A}}}),null==o||o.log(`convId: ${n}, replyChainId: ${t}:: deleted from cache. message: ${i}`)}}catch(e){null===(c=null==o?void 0:o.errorToTelemetry)||void 0===c||c.call(o,`Failed to deleteMessage for convId: ${n}, messageToDeleteId: ${i}`,"messaging_delete_message",{conversationId:n,operationType:l},!0)}},u=(e,n,t)=>{var a;const i=e.readQuery({query:s.L,variables:{convId:n,replyChainId:t}});return null!==(a=null==i?void 0:i.messages)&&void 0!==a?a:null},g=(e,n,t)=>{var a,i;return null!==(i=null===(a=u(e,n,t))||void 0===a?void 0:a.messages)&&void 0!==i?i:null},A=(e,n,t,a,i)=>{const r=a.length>0?a[a.length-1].id:null,o={convId:n,replyChainId:t};e.writeQuery({query:s.L,variables:o,data:{messages:{messages:a,cursor:r,__typename:"MessagesResult"}}}),null==i||i.log(`cache.writeQuery message: [${a.map((e=>e.id))}]`)},m=(e,n,t,a,i,r)=>{let s;const o=[];return n.forEach((n=>{let r=!1,l=!1;n.from===a&&t.find((e=>e.id===n.clientMessageId))?(l=!0,r=!0):t.find((e=>e.id===n.id))||(r=!0),i&&h(e,n),r?(s||(s=[...t]),l&&p(s,n),v(s,n)):o.push(n.id)})),o.length>0&&(null==r||r.log(`Skipped message ids [${o.map((e=>e))}]`)),s},v=(e,n)=>{(0,r.M)(e,n,(e=>-new Date(e.originalArrivalTime)))},p=(e,n)=>{const t=e.findIndex((e=>e.clientMessageId===n.clientMessageId));t>=0&&e.splice(t,1)},h=(e,n)=>{e.writeFragment({id:`${(0,i.uG)(n)}`,fragment:o.Ue,fragmentName:"messageFields",data:Object.assign({},n)})},f=(e,n,t,a)=>{var i;if(!t||!a)return null;try{return e.readFragment({id:`Message:${a}`,fragment:o.Ue,fragmentName:"messageFields"})}catch(e){return null===(i=n.errorToTelemetry)||void 0===i||i.call(n,`Failed to readCachedMessage for convId: ${t}, messageId: ${a}`,"messaging_delete_message",{conversationId:t,operationType:l},!0),null}}},338647:(e,n,t)=>{t.d(n,{F:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ComponentsCoreDialogV2UpdateExtendedEntityContainerStateMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"containerState"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ExtendedContainerState"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateExtendedEntityContainerState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"containerState"},value:{kind:"Variable",name:{kind:"Name",value:"containerState"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ExtendedContainerState"}}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]}}]}},147739:(e,n,t)=>{t.d(n,{V:()=>B});var a=t(740597),i=t(250033),r=t(818319),s=t(554694),o=t(390698),l=t(194053),d=t(377509),c=t(50805),u=t(738646),g=t(960722),A=t(228306),m=t(363592),v=t(979176),p=t(338647);const h=(e,n,t,i,r,s)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){if(e){const e=()=>({containerState:i});n.generateEvent({event:v.U3.updateDialogState(e)})}else if(t){r.current=!0;try{yield t.mutate({mutation:p.F,variables:{containerState:i}})}catch(e){s(`${i} mutation failed.`)}r.current=!1}else s("Apollo client does not exist. Unable to issue a mutation.")})),f=(e,n,t,i,r,s,o,l,d,c=!1,u=!1)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){yield h(e,n,t,"Open",l,r),c||u?s.requestAnimationFrame((()=>{o("CriticalInitRender"),i(!0),d()})):(o("CriticalInitRender"),i(!0),d())})),C=(e,n,t,i,r,s,o,l,d)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){w(i,d),yield h(e,n,t,d,l,o),s("UnmountStarted"),r(!1)})),w=(e,n)=>{if(!e.findScenario(u.RG.ExtensionClose)){e.newScenario(u.RG.ExtensionClose).appendEventData({reason:n})}};var y=t(65581),I=t(741034),E=t(477343),x=t(259631),k=t(562472),b=t(947542),R=t(965116),S=t(959394);const M=r.memo((e=>{const n=(0,S.Cq)(),t=n.translate("framework","dialog_error_message_generic"),a=n.translate("framework","dialog_error_cancel"),{errorMessage:r=t}=e;return(0,i.t)(I.c,{children:(0,i.t)(E.a,{children:[(0,i.t)(x.$,{children:r}),(0,i.t)(k.k,{children:(0,i.t)(b.h,{children:(0,i.t)(R.z,{children:a})})})]})})}));var D=t(884836);const F=r.memo((e=>{const{errorMessage:n,children:t}=e,s=(0,a.__rest)(e,["errorMessage","children"]),[o,l]=r.useState(!1),d=r.useCallback((()=>{l(!0)}),[l]);return(0,i.t)(y.Vq,Object.assign({isCoreDialog:!0},s,{children:(0,i.t)(D.M,Object.assign({onError:d},{children:o?(0,i.t)(M,{errorMessage:n}):t}))}))})),B=r.memo((e=>{var{onOpenChange:n,open:t=!0,confirmed:u,cancelled:v}=e,p=(0,a.__rest)(e,["onOpenChange","open","confirmed","cancelled"]);const w=function(e){const{cancelled:n,confirmed:t,onOpen:i,open:u=!0}=e,{error:v}=(0,s.w)("Dialog Container"),p=r.useContext((0,g.K)()).client,w=r.useRef(!1),y=r.useRef(!1),I=r.useRef(!1),E=r.useRef(!0),[x,k]=(0,A.T)({defaultState:!1,state:u,initialState:!1}),{onRenderEvent:b}=(0,o.sV)(),{host:R,scenarioFactory:S}=(0,l.SE)(),M=r.useCallback((e=>{I.current&&k(e)}),[k,I]),{enableHybridExperienceRendererLayout:D}=(0,d.NC)(c.J.Host),{enableRAFInCoreDialog:F}=(0,d.NC)(c.J.Core),B=(0,m.JQ)(),{enableDecoupleCommandingFromResolversExtend:O=!1}=(0,d.NC)(c.J.Core,["enableDecoupleCommandingFromResolversExtend"]),N=r.useCallback((()=>(0,a.__awaiter)(this,void 0,void 0,(function*(){yield h(O,B,p,"Confirmed",w,v),yield C(O,B,p,S,M,b,v,w,"Closed")}))),[p,S,M,b,v,O,B]),T=r.useCallback((()=>(0,a.__awaiter)(this,void 0,void 0,(function*(){yield h(O,B,p,"Cancelled",w,v),C(O,B,p,S,M,b,v,w,"Closed")}))),[p,S,M,b,v,O,B]),Q=r.useCallback((()=>C(O,B,p,S,M,b,v,w,"Closed")),[p,S,M,b,v,O,B]),L=r.useCallback((()=>f(O,B,p,M,v,R,b,y,i,!!D,!!F)),[p,M,v,R,b,i,D,F,O,B]),U=r.useCallback((()=>I.current&&!w.current&&!y.current),[I,w,y]),V=r.useCallback((()=>(0,a.__awaiter)(this,void 0,void 0,(function*(){U()&&(t?N():n&&T())}))),[U,N,T,t,n]);return r.useLayoutEffect((()=>{E.current||t||(x?L():Q())}),[t,x,L,Q]),r.useEffect((()=>{E.current=!1}),[]),r.useLayoutEffect((()=>(I.current=!0,V(),()=>{I.current=!1})),[V,I]),I.current&&V(),x}({open:t,onOpen:r.useCallback((()=>{const e={};null==n||n(e,{event:e,open:!0,type:"triggerClick"})}),[n]),cancelled:v,confirmed:u});return(0,i.t)(F,Object.assign({open:w},p,{onOpenChange:n}))}))},513125:(e,n,t)=>{t.d(n,{ye:()=>a,g6:()=>i,fK:()=>r,Qq:()=>s,$S:()=>o,gW:()=>l,hU:()=>d,G4:()=>c,$y:()=>u,Mw:()=>g,ZO:()=>A,R0:()=>m,fs:()=>v,Od:()=>p,Zd:()=>h,Eh:()=>f});const a="aria-label",i="card",r="itemid",s="data-itemprops",o="itemscope",l=613666==t.j?"animated-emoticon-50-":null,d=100,c=50,u=60,g=20,A=30,m=40,v=16,p="readonly",h="mention",f=/[\u200B]/},659645:(e,n,t)=>{t.d(n,{Fg:()=>i,Rg:()=>r,Tq:()=>d,Pn:()=>c,eD:()=>u});var a=t(263662);const i="Share_Contact_Card",r=`<readonly contenteditable="false" title="ID card" itemid="idcard" itemtype="http://schema.skype.com/Emoji" itemscope=${i} aria-label="ID card"><img data-itemProps=${i} src="https://staticsint.teams.cdn.office.net/evergreen-assets/personal-expressions/v2/assets/emoticons/idcard/default/50_f.png?v=v5&itemscope=share_contact_card" alt="ID card" draggable="false" width="20px" height="20px" style="margin:0px 1px;overflow:hidden;"></readonly>`,s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAABNdJREFUeF7tml1sFFUUx/9ndmnwkxiCgaDGiomfGA3xAY1KgBhFd25n7JbEhER9MzE8ocSg4ieKBuNHYvTFNx9ku7N7Z7QmRCUaX/yI9KGIRqLYNAYIEKVokN2dYwa7Zbed7cxO72w77szj7jnn/s/vnnvnfgyhyx/q8vyRAkgroMsJpEOgywsgnQTTIZAOgS4nkA6BmQognx9a8k+ttoWYV4FwM4DFCSmY4wDvY2jfcgWvO07uWCvdLSugz7Q3MfhtgBYlJOlWMk+4jEecki79DHwBCMPeDMKbCU+8ST4R+stFvTg1p2kAcnm7V6vhZwCZ/xMAAKfcCvVOHQ7TAOim8w6BH21I/jCYtlay2p6hwn2HkwBlQ/7jpQuq7t0g3glgaV0zgZ8pW+KFxhymARCmPQrg8kknwsZyUd+dhMSnaux7wB5gxocNv38nLf3WIAA1AFrdqCdz+qJCYeBUEgEYhrXYpey5NwDjpCzpTZO6XwVwY7LS0hO9VhCmPWM+ygDcn3eWZ6rudhCtBbACwCjA33AVj9m2ODJXFdQRALop7yRQGcAlPokeJ7e2vlw2hucCQuwA8vndF56pLTwUsEo8xFW+ybbFeKchxA5AN50dBH4yRGI7pKVvC2Gn1CR2AMKQX4LojkDVjM9kSV8fZCdMpx/ML4JwTZBt0/+Mn0D0lLRyg42/xw/AtMcALA8Wy2PSEpPri1b2wrQPALg2OJ6vxX5p6Td2GsBXAG4PFBy2Agx7PwjXB8bzM2D8IEv6DR0FEHoOYLwiS3rgXHF2CIBfBnB1WxDmagiseWjvwkV/jg8HjNljlUxm5VzsJWKfA7xeMs3ishqygwDd5tNrozXA+MjSv2+rRxUZdwRAXaswnQcZvFYDehk8RqB9ZUt/Q1EukcJ0FEAkhTE7pQDi2AwZhnUpa9l1LtMKDW42TCcyk8sa/4IKPrdt8XsYHxU2yiugr99Zxy5/OhtxDBa2JezZxAjrqxyAMOy9IKwJK8DXjnhYFsUts4oR0lk9AFP+oeKovNVBy7zfCwjT/hvAeSE7oKVZT+Z0tlAY8I7fmh4x35fCwrRHADSttyPA+E1a+pV+frMCAIxIS18Z614g9Np/JirE78qiaDx6n7SOvBcADgC0TVq5UqwAvFdgjbIjBCyJ0PNnXVyi65xi7seo/u34KZ8EvcYnzgC/aEfIpC3za7IknojkG8EpFgCeDsNwVrvEuwCsDquLwM+VLfFsWHsVdrEBqIszDPsul3AvEV3FzL0TR+Le6vAgEX51mQ5q4JFahYqOk/PeIB19YgfQ0WwiNBYFgHcNdkG9rUoms2wuDjIi5DrN5b9zigWN+45xaekXNxr63Qw1vecJvLVsiVdVCOp0jD5TPs2g5yfb9VmC+12P7yRw8yzNeElD9a1SyTza6SSitGeaQ5fVuLIZRI83+TO2y5J+Dggw/UPJibLxbnp6ojQ+j33+6sn0XFEo3HNixiHg/SkM52EQvz+Pk2lXGhMhH+oTmXpkYTobAfc9FTu/dtUqtj9KGm0qD+b2+MWd8e7fW/a6yGwholUMePt3v9tfxXqVhDsC8DCYvj5zfnbXJx9sONkqaqI/flCBKgWggmKSY6QVkOTeU6E9rQAVFJMcI62AJPeeCu1pBaigmOQYXV8B/wITMWBflDVLfAAAAABJRU5ErkJggg==",o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAABM1JREFUeF7tmltoHGUUx/9ns0nUVotkZ5O2KsYKXiuK+FDFC20RfBKhWhD6oG+CFMWZTWdT7Xjb2e638VYQffFd2+LlsXhB8aUqNg+pVQw2hqDpTFIkbaRJNnNkNAmz2dnd2cnMJGNmHnfPOd///L7zXWcI6/yhdZ4/EgBJBaxzAskQWOcFkEyCyRBIhsA6J5AMgUYFoKp/ShWkZQB3A3wnQF3xKBieBOgUE3/PM5U3Bga2TNTTXbcCcurEPgYfAbApHknXVXmeLXq6fDjzqZuFKwBZNfYT6O2YJ14tn609oth9fHlONQDkg+O9NN/2K4C2/xMABi7y7Fzv8uFQA0BRzXcBPONIfhxEfZizTgiRHY8DFEUxetCeehjMhwH0LGpmxkvlovSqMwc3AKMArl1yIt5bLmQ/ikPiyzXKeeMJYvrQ8fsPQpfuaQZgHkBq0WhDJ1+padmLcQSgqlNdFcw4V4ApoUtVk7pbBbAzWaFLsd4rKKrZMJ/AADzfP7G13eJDDOwEsA3AKIO+66D5ZwuF7nOrVUGRAHihz3gglaJPAFxdmyhPgrBbFLKDqwEhdACaZmycnsFI410ij9A83VEqSReihhA6ADlvFIhJbZ4YFYSe6W9uF6xF6AAU1fwGwP0eZH8hdGl3M7ucauxhptdAuKmZbdX/jF+I+GBJzx5z/h4FgDEAWz2IHRO6tLS/qGevqOYZADd7iOdmclro0u1RA/gWwH0eBHuqAEU1TwO41UM8N5OfhC7dFikA73MAF4WebTpX2EPAAukE3NgShNUaApp29rLpSxsHG45ZwgTmePtqnCVCnwPsXnoub25OW3SMiO916bVREB4TBenHlno0IONIACxqlfPmkynGTgZ6wTzGRKfKuvRWQLn4ChMpAF8KQ3ZKAIRxGJLl8Syl23aBeBsRpb10IjMsJvotVeEvSyXpDy8+QdgEXgG5/MQuZv58JeIIeLSkS5+tJIZX38ABKKr5FYCHvAqoYzcodOmuFcbw5B4GgL+CuCqvd9Gy5s8Cimr+DeByT/gbGI0MZ9JHj5J9/Vb1rPmtsKKaQwCq9ts+YPwudOl6N7+VAeAhoWe3h3oW8L73b4CF8J4oSM6r9yVj32cBwhm2qL9czHwcLgB7CWxvs6tA8tHz/7pYoFsG9MzPfv1b8Qt8ErQbX7gD/LoVIYu2zBDlopTz4+vHJxQAthBZndxBmB8AaIdXYUR4uVSQNK/2QdiFBmBRnKKaDzLzI5RK3QDm3oUr8TQBwxb4LIGGCTR0RefscU3bYq8gkT6hA4g0Gx+N+QFgvwbbsNRWhTevxkWGj1xrXOx7inaG89xxQejSVU5DtzdDy9Z56hN6phSEoKhjyAfMF4nwiqPdmi24GwD7lXLVLE1Er1uzlXfK5R4j6iT8tJfLTV5jpaz9RFCW+R8SuuQEUvuh5ELZjADo8NP4GvaZrnR2XPemtul8wyHw3xJnPEWgD9ZwMi1JYwYTrMc9fSKztLwdMPaC6P0gTn4tqQ3e2ABb+0Sx+4Rb6Ibv/u2bH6TbZCL7MznY53eXt7/BKw4g4jkGDxLo5KXO1MARrWuqXsxYf/wQAKjka/GkAoIoozjHSCogzr0XhPakAoKgGOcYSQXEufeC0J5UQBAU4xzjH4bEWF/lx1UBAAAAAElFTkSuQmCC",l="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAA/pJREFUeF7tml2IVVUUx3//HCSxFBElqaTRwI8yDPEhoxKToCcJxgaCedC3IHoyRdSmD53KKLQg7MX3wsHscdBE8UWLxgfHDxS1GEKjQmaqt1yyL3fk3Dvn3rvvufuce0/37JdzOGettdf677X2XmvvLbq8qcvtpwCg8IAuR6AIgS53gGISLEKgCIEuR6AIgXoOYMYCYBuwBlgNzM+Jw/wJjAI/Ap9L/FFL75oeYMYA8CUwNydG11LzL2CrxLE4glgAzHgbOJhzw6vV75MYrv44DQAzeoGrwIz/GQB/A73V4RAHwFfAmxHjbwE7gBEJ997xzYxHgFeAT6D0PtXelfgwakAcAL8Cj0eI+iW+7XirYxQ043Xgm8ivnyTWNgLgP+CBCNHDEs59ctfMSqtWdAWYkCon9TgPsAqElO96wYy69gQDwIxHgUFgA7AUcKF0DnhL4na73CcTAMx4EfgOmBdjqEtKNkqcbwcIqQNgxkPAzQZZovv/jMRk1iBkAcAQsNPDsCGJXR50QUmyAOA08IKH1ickNjaiM6MP2Assa0Rb9f8KsFviSPR7FgCMQ2kCbNTGpYr8IpbejEvA8kbCavwfk3g6awDOAM97KOzrAWPASg95cSQXJZ7KGgDfOeBjqfFcUQ6Bj4AnmwShbSHwIJSWuHox67KxVe2oJVKfA9wombEISpPPuphRcwnRaxI/NzmiQcgzAWBKUzPeKGeCrqR2k+OoxIEgliQUkikACXVMla0AII1iyIyFwMvloqfHcwjvAteBHyR+8+RpmSy4B5iVDD/eomabJL5vUYYXexoAnATWe/Vem+i8xLMtyvBiTwOAOyG2ylVjo6XjawEz/gVmecFfn6hHwm2/VTQzOjsVNuMCVObbCcD4ReKJOL4WAbggsSrVWsAM39y/Hi6HpIqt9/u0LdQCrorcJXE0bQDcEui8wJ0bJm0rJC4nZW6GL/gk6Dov7wGeakaRCO2nEtsT8jbNlgoAZRCeAz4D3NO3vS/xni9xCLrUAJhSzoyXgFeBJe7sLZIdXgNuAO7pQmZYKq0gmbbUAcjUmgSdJQHAHYPNjvS1qB0bGQlsncZS3qeI1h2TEnOihHEnQ9Xr/A6J/SEUylqGGXuADyL9TkvB4wBwR8rVs/Q+4AuJ37M2Ikl/ZjwGpUse71TxD0oVgEw/+Cy7jTvJmZmk8w7m+QdYLOGuzNxvta7IbAEOd7AxzarmTog3e12RiSxv/cDXISq/ZrUNTO/CdkBiJE5u3XuC5Z2fqWtyrn6PO/0NrG8Qce443m3Vn3XJmsRELanFRckgeOdYSOEBOR68IKoXHhAExhwLKTwgx4MXRPXCA4LAmGMhhQfkePCCqH4P99SCUOXnkMIAAAAASUVORK5CYII=",d=/<img\s+(?=(?:[^>"']|"[^"]*"|'[^']*')*itemscope="Share_Contact_Card")([^>]+)>/g,c=e=>{switch(e){case a.f8.Contrast:return l;case a.f8.Dark:return o;case a.f8.Light:default:return s}},u=e=>e&&e===s||e===o||e===l},853520:(e,n,t)=>{t.d(n,{V:()=>a});const a={MS_PER_SEC:1e3,SEC_PER_MIN:60,MIN_PER_HOUR:60,HOUR_PER_DAY:24,MS_PER_MIN:6e4,MS_PER_HOUR:36e5,MS_PER_DAY:864e5}},834347:(e,n,t)=>{t.d(n,{A4:()=>o,iw:()=>l,cP:()=>d,C4:()=>c,dX:()=>u,bR:()=>p});var a=t(74583),i=t(516909),r=t(181620);if(613666==t.j)var s=t(248965);const o=(e,n,t=!0,i=!1,r=[])=>{let s=(0,a.first)(g(e,n,t));if(void 0!==s&&i&&r){const t=r.find((e=>e.lowerPriorityApp===(null==s?void 0:s.id)));if(t){const a=n.find((e=>e.id===t.higherPriorityApp));a&&A(e,a)&&(s=a)}}return s},l=(e,n)=>!(!n||!(0,a.find)(n,(n=>n===e))),d=e=>{var n,t,a,i,r;return(null===(r=null===(i=null===(a=null===(t=null===(n=null==e?void 0:e.messageExtensions)||void 0===n?void 0:n[0])||void 0===t?void 0:t.messageHandlers)||void 0===a?void 0:a[0])||void 0===i?void 0:i.value)||void 0===r?void 0:r.supportsAnonymousAccess)||!1},c=(e,n,t)=>!(!n||!e)&&(d(e)||l(e.id,t)),u=e=>{var n;const t=(0,a.map)(e.messageExtensions,(e=>({type:i.y8.BotBased,botId:e.botId,commands:(0,a.map)(e.commands,(e=>({id:e.id||"",type:e.type,parameters:(0,a.map)(e.parameters,(e=>({name:e.name})))}))),messageHandlers:(0,a.map)(e.messageHandlers,(e=>{var n,t;return{type:e.type,value:{domains:null===(n=e.value)||void 0===n?void 0:n.domains,supportsAnonymousAccess:null===(t=e.value)||void 0===t?void 0:t.supportsAnonymousAccess}}}))})));return{id:e.id,name:e.name,largeImageUrl:e.largeImageUrl,privacyUrl:e.privacyUrl,termsOfUseUrl:e.termsOfUseUrl,validDomains:e.validDomains,messageExtensions:t,resource:null===(n=e.webApplicationInfo)||void 0===n?void 0:n.resource}},g=(e,n,t)=>(0,a.filter)(n,(n=>{var i,s,o;if(!n.definition)return!1;if(!t&&n.definition.externalId)return!1;if(!t&&n.definition.tenantId)return!1;const l=null===(i=n.definition.messageExtensions)||void 0===i?void 0:i[0],d=(0,a.first)(null==l?void 0:l.messageHandlers);if(d){const{value:n}=d,t=null!==(o=null===(s=null==n?void 0:n.domains)||void 0===s?void 0:s.filter((e=>m(e))))&&void 0!==o?o:[],[i,l]=(0,a.partition)(t,(e=>e.includes("/")));return(0,r.Fd)(e,l)||v(e,i)}return!1})),A=(e,n)=>{var t,i,s,o;const l=null===(i=null===(t=null==n?void 0:n.definition)||void 0===t?void 0:t.messageExtensions)||void 0===i?void 0:i[0],d=(0,a.first)(null==l?void 0:l.messageHandlers);if(d){const{value:n}=d,t=null!==(o=null===(s=null==n?void 0:n.domains)||void 0===s?void 0:s.filter((e=>m(e))))&&void 0!==o?o:[],[i,l]=(0,a.partition)(t,(e=>e.includes("/")));return(0,r.Fd)(e,l)||v(e,i)}return!1},m=e=>{if(!e)return!1;const n=e.split("/")[0].split(".");if(n.length<=1)return!1;const t=n[n.length-1],a=n[n.length-2];return!t.includes("*")&&!a.includes("*")},v=(e,n)=>!!(0,a.some)(n,(n=>{const t=n.replace(new RegExp("[*]","g"),"(.*)"),a=new RegExp(t);return e.match(a)})),p=e=>{switch(e){case i.qi.GroupChat:return s.Mv.group;case i.qi.Personal:return s.Mv.personal;case i.qi.Team:return s.Mv.team;default:return}}},259287:(e,n,t)=>{t.d(n,{K3:()=>r,KT:()=>s,W$:()=>o,mD:()=>l,f_:()=>d});var a=t(74583),i=t(645534);const r=e=>{if(e){if(-1===e.indexOf("."))return e;{const n=/(.+)\.[^.]+$/.exec(e);if(null==n)return e;{const e=n[1];return void 0!==e?e:""}}}return""},s=e=>{const n=/(\s[1-9]\d*)$/g;let t=1,a=r(e);const i=n.exec(a);if(i){const e=a.search(n);t=parseInt(i[1],10)+1,a=a.substring(0,e)}return`${a} ${t}.${l(e)}`},o=e=>{const n=/\ \(([1-9]\d*)\)$/g;let t=1,a=r(e);const i=n.exec(a);if(i){const e=a.search(n);t=parseInt(i[1],10)+1,a=a.substring(0,e)}return`${a} (${t}).${l(e)}`},l=e=>{const n=new RegExp("(?:\\.([^.]+))?$").exec(e);return(0,a.toLower)(n&&n[1]?n[1]:"")},d=(e,n=-1,t=!0)=>{let a=r(e),i=e.substr(a.length);if(a=A(t,g(a)),i=A(t,g(i)),a&&n>-1&&(a=a.substr(0,n)),c(a))return;const s=i?`${a}${i}`:a;return u(s)?void 0:s},c=e=>!e||i.le.odspUnsupportedFilenameList.includes(e.toLowerCase()),u=e=>!e||i.le.odspUnsupportedFilenameWithExtList.includes(e.toLowerCase()),g=e=>e.replace(i.le.odspIllegalWordRegex,"vti"),A=(e,n)=>n.replace(e?i.le.odsp2013IllegalCharsRegex:i.le.odspM365IllegalCharsRegex,"").trim()},727064:(e,n,t)=>{t.d(n,{Cc:()=>l,R2:()=>d,b3:()=>c,tl:()=>g,Hu:()=>A,VI:()=>m,cJ:()=>v,$N:()=>p,gj:()=>h,pw:()=>f,dp:()=>E,bR:()=>x,E:()=>k,Ry:()=>b});var a=t(64217);const i={landscape:400,portrait:200,square:250},r={landscape:225,portrait:355,square:250},s=1.7777778,o=.5625,l=6048e5,d="Video-Clip";var c;!function(e){e.success="success",e.failure="failure",e.pending="pending"}(c||(c={}));const u=new RegExp("^[0-9]+/[1-9][0-9]+$"),g=(e,n)=>`${e}/${n}`,A=e=>{if(e<=0)throw new Error("convertDurationSecToISO8601:Failed, input durationInSec should be greater than 0");const n=(0,a.L)(e).split(":"),t=3===n.length,i={hour:0,minute:1,second:2};t||(i.hour=-1,i.minute=0,i.second=1);const r=t?+n[i.hour]:0,s=+n[i.minute],o=+n[i.second];let l="PT";return r&&(l+=`${r}H`),s&&(l+=`${s}M`),o&&(l+=`${o}S`),l},m=e=>({progress:+e.split("/")[0],total:+e.split("/")[1]}),v=e=>u.test(e),p=(e,n)=>`${e}v1/objects/${n}/views/video`,h=e=>{const n={height:void 0,width:void 0};if(e.width&&e.height)n.width=+e.width,n.height=+e.height;else if(e.style){e.style.split(";").forEach((e=>{const[t,a]=e.split(":"),i=null==t?void 0:t.trim();if("height"===i||"width"===i){const e=a&&parseInt(a.trim(),10);n[i]=e||void 0}}))}return n},f=(e,n)=>e&&n?e<n?C(e,n):e>n?w(e,n):y():I(),C=(e,n)=>{const t=i.portrait,a=r.portrait;return e/n<o?{width:e/n*a,height:a}:{width:t,height:n/e*t}},w=(e,n)=>{const t=i.landscape,a=r.landscape;return e/n<s?{width:e/n*a,height:a}:{width:t,height:n/e*t}},y=()=>({width:i.square,height:r.square}),I=()=>({width:i.landscape,height:r.landscape}),E={volume:1,muted:!1,captionOn:!1},x="tmp.onePlayerSettings",k="OnePlayer-TextTrack-Settings",b='{"showTextTrack":true,"preferredLanguage":"spokenLanguage"}'}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/506412-e03c861c2776828a.js.map