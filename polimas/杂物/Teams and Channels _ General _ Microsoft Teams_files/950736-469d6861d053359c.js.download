"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[950736],{987745:(e,r,t)=>{t.d(r,{Zb:()=>n});t(74583);const n={chat:0,channel:0}},315338:(e,r,t)=>{t.d(r,{oU:()=>p,oD:()=>g,QO:()=>h,Mw:()=>f,ON:()=>y,Rp:()=>T,wM:()=>P,s4:()=>w,Hb:()=>I,DB:()=>S,fb:()=>b,HS:()=>A,MN:()=>O,V3:()=>N,oj:()=>k,cM:()=>Q,tp:()=>U});var n=t(760005),i=t(628063),a=t(711676),o=t(74346),s=t(88204),l=t(81837);const d="default",c="CallableChannelOboCall",u="callParkService",p="delegates",m="call-log",v="sla-call-history",g=";",h=e=>{switch(e){case"default":return s.FT.Default;case"screenSharing":case"ScreenSharing":return s.FT.ScreenSharing;case"emergencyGroupCall":return s.FT.EmergencyGroupCall;default:return s.FT.Unknown}},f=e=>e?Object.assign(Object.assign({},e),{type:e.type||d}):void 0,y=e=>({type:e.type,configId:e.configId,onBehalfOf:e.onBehalfOf&&Object.assign(Object.assign({},e.onBehalfOf),{type:d}),details:e.details&&Object.assign(Object.assign({},e.details),{type:d})}),T={displayName:"Unknown",id:"28:unknown",type:d},C=(e,r,t="value")=>{var n;if(!e)return"";const i=`${t}="`,a=null===(n=e.find((e=>e.indexOf(r)>=0)))||void 0===n?void 0:n.match(new RegExp(`${t}="(.*?)"`,"g"));return a?a[0].substr(i.length,a[0].length-i.length-1):""},P=(e,r,t,i,a)=>{let o,s,l,d,c=(new Date).toISOString();if(a===n.Cs.CallTranscript){const r=((e,r)=>{if(r)try{const e=JSON.parse(unescape(r.replace(/\u200b|\\/g,"")));return{callId:e.callId,userParticipantId:e.originatorParticipantId,transcriptMsg:{scopeId:e.scopeId}}}catch(r){return void e.error("failed to parse transcription content.",r)}})(e,t);if(!r)return;o=r.callId,s=r.userParticipantId,l=r.transcriptMsg}else if(a===n.Cs.CallLogTranscript){const r=((e,r)=>{if(r)try{const e=JSON.parse(unescape(r.replace(/\u200b|\\/g,""))),{CallId:t,UserParticipantId:n,ThreadId:i,MessageId:a}=e;return{callId:t,userParticipantId:n,transcriptMsg:{linkedMessage:{conversationId:i,messageId:a}}}}catch(r){return void e.error("failed to parse transcription content.",r)}})(e,t);if(!r)return;o=r.callId,s=r.userParticipantId,l=r.transcriptMsg}else if(a===n.Cs.CallLogRecording){const r=((e,r)=>{if(r)try{const e=JSON.parse(unescape(r.replace(/\u200b|\\/g,""))),{CallId:t,UserParticipantId:n,ThreadId:i,MessageId:a}=e;return{callId:t,userParticipantId:n,recordingMsg:{linkedMessage:{conversationId:i,messageId:a}}}}catch(r){return void e.error("failed to parse recording message content.",r)}})(e,t);if(!r)return;o=r.callId,s=r.userParticipantId,d=r.recordingMsg}else if(a===n.Cs.CallRecording){const e=((e,r)=>{if(!e)return;const t=e.match(/<.*?>/g),i=C(t,'<Id type="callId"');if("Transcript"===C(t,"<RecordingContent contentTypes=","contentTypes"))return;const a=C(t,'<Id type="OriginatorParticipantId"'),o=C(t,"<RecordingInitiatorId ");return{callId:i,userParticipantId:a,recordingMsg:{conversationId:n.wS,messageId:r||"",initiatorId:o,content:e}}})(t,i);if(!e)return;o=e.callId,s=e.userParticipantId,d=e.recordingMsg}else o=r.callId,s=null==r?void 0:r.userParticipantId,c=r.startTime;return{callId:null!=o?o:"",userParticipantId:s,transcript:l,recordings:d&&[d]||[],startTime:null!=c?c:""}},w=(e,r)=>"-1"===e?r:e,I=({skypeMessage:e,loggerFactory:r})=>{var t;const n=e.conversationid,a=e.messagetype,d=e.content,{callHistoryInput:c,isSlaCallHistory:u}=b(e),p=w(e.id,e.clientmessageid);if(D(c,n))return;const m=r.newLogger("CallHistoryHelper","data-resolvers-calling");try{const n=F(c),{callDirection:v,callState:C,callType:w,callPhoneLineType:I,connectTime:S,endTime:b,eventTranscript:D,isDeleted:E,originatorParticipant:H,participantList:B,sessionType:W,sharedCorrelationId:x,targetParticipant:j,threadId:J,spamProperties:G,callAttributes:z,forwardingInfo:$,transferInfo:V,sharedLineAppearanceParticipantList:X,targetDelegator:K}=n,q=Q(n),Y=P(m,n,d,p,a);if(!Y)return;let Z=f(H);Z||(Z=T,m.warn(`Could not parse valid participant from ${c}`));const ee=(e=>"private"===e?l.Eg.private:null)(I),re=(e=>{switch(e){case"missed":return s.Qv.Missed;case"accepted":return s.Qv.Accepted;case"declined":return s.Qv.Declined;case"acceptedElsewhere":return s.Qv.AcceptedElsewhere;default:return s.Qv.Unknown}})(C),te=(e=>"incoming"===e?s.kw.Incoming:"outgoing"===e?s.kw.Outgoing:s.kw.Unknown)(v),ne=O(B,null==j?void 0:j.type,null==H?void 0:H.type,null===(t=null==z?void 0:z.transferor)||void 0===t?void 0:t.type,null==V?void 0:V.parkType),ie=R(m,n),{validTargetParticipant:ae,forwarderParticipant:oe,forwardedTargetParticipant:se}=_(re,j,$,z,u,!!ie.isSharedLineAppearanceActivated,K),{transferorParticipant:le,transferTargetParticipant:de}=M(z,V,ne),ce=(e=>"twoParty"===e?s.Bd.TwoParty:"multiParty"===e?s.Bd.MultiParty:s.Bd.Unknown)(w),ue=q&&y(q),{isCallQueue:pe}=(0,o.$Z)({callType:ce,applicationContent:ue}),me=te===s.kw.Outgoing,ve=te===s.kw.Incoming,ge=te===s.kw.Incoming&&re===s.Qv.Missed,he=re===s.Qv.Declined,fe=re===s.Qv.AcceptedElsewhere,ye=W===s.FT.EmergencyGroupCall&&(null==B?void 0:B.length)>1,Te=(0,o.r4)({endTime:b,connectTime:S,targetParticipant:j}),Ce=e.originalarrivaltime;return Object.assign(Object.assign(Object.assign(Object.assign({id:`${p}${g}${Y.callId}`,callStartTime:new Date(Y.startTime).getTime(),applicationContent:ue,callDirection:te,originalArrivalTime:Ce,isMissed:ge,isIncoming:ve,isOutgoing:me,isDeclined:he,isAcceptedElsewhere:fe,isEmergencyGroupCall:ye,isCallQueue:pe,callState:re,callType:ce,callPhoneLineType:ee,durationInMs:Te,connectTime:S,endTime:b,isDeleted:E,messageId:p,messageType:(0,i.DE)(r,a,e.properties),originatorParticipant:Z,participantList:B?B.map(f):[],targetParticipant:ae,threadId:J,sessionType:h(W),sharedCorrelationId:null!=x?x:"",spamRiskLevel:G?G.riskLevel:null},Y),{transferorParticipant:le,transferTargetParticipant:de,transferTime:null==V?void 0:V.transferTime,transferStatus:(null==V?void 0:V.transferStatus)&&A(V.transferStatus),forwarderParticipant:oe,forwardedTargetParticipant:se,forwardedTargetType:k(null==$?void 0:$.forwardingDestinationType),forwardingType:N(null==$?void 0:$.forwardingType),isSharedLineAppearanceCallHistory:u}),u?L(m,n):ie),{sharedLineAppearanceParticipantList:X?X.map(f):[],sharedLineAppearanceCallActionList:D?U(D):[]})}catch(e){m.warn(`UnhandledException in message transformation: ${e}`)}},S=({targetParticipant:e,originatorParticipant:r,applicationContent:t},n,i)=>{var a,o;return e&&r&&n?i?null===(a=null==t?void 0:t.onBehalfOf)||void 0===a?void 0:a.id:(null===(o=null==t?void 0:t.details)||void 0===o?void 0:o.id)||null:null},b=e=>{const{properties:r}=e,t={callHistoryInput:void 0,isSlaCallHistory:!1};return r&&(r[v]?(t.callHistoryInput=r[v],t.isSlaCallHistory=!0):r[m]&&(t.callHistoryInput=r[m])),t},_=(e,r,t,n,i,a,o)=>{let l,d,c=r&&f(r);return e===s.Qv.Accepted&&(null==t?void 0:t.acceptedBy)&&(l=i?o&&f(o):c,c=f(t.acceptedBy)),(null==n?void 0:n.forwardedFrom)&&(l=f(n.forwardedFrom)),(e===s.Qv.AcceptedElsewhere||i||a)&&(null==t?void 0:t.acceptedBy)&&(d=f(t.acceptedBy)),(null==n?void 0:n.delegator)&&(l=f(n.delegator)),{validTargetParticipant:c,forwarderParticipant:l,forwardedTargetParticipant:d}},M=(e,r,t)=>{let n,i;return t||((null==e?void 0:e.transferor)&&(n=f(e.transferor)),(null==r?void 0:r.transferor)&&(n=f(r.transferor)),(null==r?void 0:r.transferTarget)&&(i=f(r.transferTarget))),{transferorParticipant:n,transferTargetParticipant:i}},A=e=>{switch(e){case"transferred":return s.hy.Transferred;case"transferAccepted":return s.hy.TransferAccepted;case"transferFailed":return s.hy.TransferFailed;case"transferSucceeded":return s.hy.TransferSucceeded;default:return s.hy.Unknown}},O=(e,r,t,n,i)=>{const a=i&&"none"!==i&&"Unknown"!==i;return a||a&&!!(null==e?void 0:e.find((e=>e.type&&e.type===u)))||r===u||t===u||n===u},N=e=>{switch(e){case"immediate":return s.Io.Immediate;case"simultaneous":return s.Io.Simultaneous;default:return}},k=e=>{switch(e){case"user":return s.Ry.SingleTarget;case"group":return s.Ry.Group;case"delegates":return s.Ry.MyDelegates;case"voicemail":return s.Ry.Voicemail;default:return}},L=(e,r)=>{const{sharedLineAppearanceForwardType:t,originatorDelegator:n,targetDelegator:i}=r;return e.log("[toCallHistoryItem] This is an SLA Call created as part of Shared History"),{forwardingType:N(t),originatorDelegator:n&&f(n),targetDelegator:i&&f(i)}},R=(e,r)=>{var t;const{callAttributes:n,forwardingInfo:i,sharedLineAppearanceActivated:o}=r,s=(null===(t=null==n?void 0:n.onBehalfOf)||void 0===t?void 0:t.id)&&(0,a.lp)(n.onBehalfOf.id);return e.log("[toCallHistoryItem] This is an SLA Call created as part of Personal History"),{isSharedLineAppearanceActivated:!!(o||(null==n?void 0:n.delegator)||s||(null==i?void 0:i.forwardingDestinationType)===p),originatorDelegator:s&&(null==n?void 0:n.onBehalfOf)?f(n.onBehalfOf):void 0,targetDelegator:(null==n?void 0:n.delegator)?f(n.delegator):void 0}},D=(e,r)=>void 0===r?!e:r!==n.wS&&r!==n.tP,F=e=>e?JSON.parse(e):{},Q=e=>{var r,t,n;const{applicationContent:i,callAttributes:a,onBehalfOfContext:o}=e;let s;return s=o&&!i?{type:c,configId:o.id||"",onBehalfOf:{type:(null===(r=null==a?void 0:a.onBehalfOf)||void 0===r?void 0:r.type)||c,id:(null===(t=null==a?void 0:a.onBehalfOf)||void 0===t?void 0:t.id)||"",displayName:(null===(n=null==a?void 0:a.onBehalfOf)||void 0===n?void 0:n.displayName)||""}}:i,s},E=e=>{const r=(e=>{switch(e){case"hold":return s.LW.Hold;case"resume":return s.LW.Resume;case"barge":return s.LW.Barge;default:return}})(e.callAction),t=f(e.actionOriginator);if(!r||!t)return;return{callAction:r,callActionTime:e.actionTime,callActionOriginator:t}},U=e=>{const r=[];return e.forEach((e=>{const t=E(e);t&&r.push(t)})),r}},81837:(e,r,t)=>{t.d(r,{Eg:()=>n});const n={private:"private"}},785014:(e,r,t)=>{t.d(r,{Nd:()=>s,nq:()=>l,NF:()=>d,gS:()=>c});var n=t(516909),i=t(760005),a=t(500396),o=t(876661);const s=e=>{if(e)switch(e){default:case"Success":return"Success";case"SendFailure":return"SendFailure";case"SendFailureCanRetry":return"SendFailureCanRetry";case"EditFailure":return"EditFailure";case"EditFailureCanRetry":return"EditFailureCanRetry";case"DeleteSingleFailure":return"DeleteSingleFailure";case"DeleteSingleFailureCanRetry":return"DeleteSingleFailureCanRetry";case"DeleteAllFailure":return"DeleteAllFailure";case"DeleteAllFailureCanRetry":return"DeleteAllFailureCanRetry"}},l=e=>!(!e||!/^\[[^\]]+\]$/gi.test(e)),d=e=>{if(!e||!(0,o.J6)(e))return null;if((0,o.qo)(e)===a.xu.Standard){return(e=>{if(!e)return null;let r,t;try{t=e[i.Q5.ChannelSettings]&&JSON.parse(e[i.Q5.ChannelSettings])}catch(e){return null}if(!t)return null;switch(null==t?void 0:t.allowReplies){case a.yt.Moderators:r=n.yt.Moderators;break;case a.yt.Everyone:default:r=n.yt.Everyone}return r})(e.threadProperties)}return null},c=e=>{var r;return e?!0===(null===(r=e.memberProperties)||void 0===r?void 0:r.isModerator)||!1:null}},281973:(e,r,t)=>{t.d(r,{Ew:()=>i,aw:()=>a,Hu:()=>o});var n=t(760005);function i(e){return!!e&&(e.messageType&&(r=e.messageType,[n.Cs.AddMember,n.Cs.Call,n.Cs.CallRecording,n.Cs.CallLocalRecording,n.Cs.CallTranscript].indexOf(r)>=0)||function(e){return!!e.deleteTime}(e));var r}function a(e,r){var t;return!!(null===(t=null==e?void 0:e.mentions)||void 0===t?void 0:t.some((e=>e.userId===r)))}const o=(e,r)=>{var t;return(null==e?void 0:e.from)!==r&&!!(null===(t=null==e?void 0:e.mentions)||void 0===t?void 0:t.some((e=>"everyone"===e.mentionType)))}},32552:(e,r,t)=>{t.d(r,{w:()=>l,K:()=>d,su:()=>c});var n=t(38613),i=t(607586),a=t(50805);const o=e=>e&&e.startsWith(i.V.Bot),s=e=>o(e)?e.slice(3):e.slice(e.includes("_")?41:8),l=(e,r)=>{let t=[];return t=o(e)&&!o(r)?[s(r),s(e)]:!o(e)&&o(r)?[s(e),s(r)]:[s(e),s(r)].sort(),`19:${t[0]}_${t[1]}@unq.gbl.spaces`};function d(){const[e,r]=(0,n.MX)(2);return`${e}${r}`.substr(0,19)}function c(e){const{ageGroup:r}=e.get(a.J.AgeConsent);return"MinorWithMsaParentalConsent"===r||"MinorWithoutMsaParentalConsent"===r}},849142:(e,r,t)=>{t.d(r,{w:()=>o});var n=t(905581),i=t(132756),a=t(74583);const o=e=>{const{scheduledMeetingInfo:r}=e,t=s(r);if(t.length)throw(0,n.Tr)(i.w5.DataLayerClient,i.jK.MissingParameter,`validate Meeting schema failed. Missing required prop(s): ${t.join(", ")}`);return e},s=e=>{if(!e)return[];const r="meeting.scheduledMeetingInfo";let t=c(e,["startTime","endTime","eventType"],r);const{eventRecurrenceRange:n,eventRecurrencePattern:i}=e;return t=[...t,...l(n,r),...d(i,r)],t},l=(e,r)=>c(e,["startDate"],`${r}.eventRecurrenceRange`),d=(e,r)=>{let t=[];if(e){const{daily:n,weekly:i,monthly:o,yearly:s,relativeMonthly:l,relativeYearly:d}=e;t=[...c(e,["patternType"],`${r}.eventRecurrencePattern`),...c(n,["interval"],`${r}.eventRecurrencePattern.daily`),...c(i,["interval","daysOfTheWeek"],`${r}.eventRecurrencePattern.weekly`),...c(o,["interval","dayOfMonth"],`${r}.eventRecurrencePattern.monthly`),...c(s,["month","dayOfTheMonth"],`${r}.eventRecurrencePattern.yearly`),...c(l,["interval","dayOfTheWeekIndex","dayOfTheWeek"],`${r}.eventRecurrencePattern.relativeMonthly`),...c(d,["month","dayOfTheWeekIndex","dayOfTheWeek"],`${r}.eventRecurrencePattern.relativeYearly`)],i&&i.daysOfTheWeek&&i.daysOfTheWeek.some((e=>(0,a.isNil)(e)))&&t.push(`${r}.eventRecurrencePattern.weekly.daysOfTheWeek`)}return t},c=(e,r,t)=>{const n=[];return(0,a.isNil)(e)||r.forEach((r=>{(0,a.isNil)(e[r])&&n.push(`${t}.${r}`)})),n}},951296:(e,r,t)=>{t.d(r,{IF:()=>i,wU:()=>o,vA:()=>s,jY:()=>l,gy:()=>d});var n,i,a=t(516909);!function(e){e[e.Standard=0]="Standard",e[e.Important=2]="Important",e[e.Urgent=3]="Urgent"}(n||(n={})),function(e){e.Standard="",e.Important="high",e.Urgent="urgent"}(i||(i={}));const o=e=>d(e)===a.Nt.Important,s=e=>d(e)===a.Nt.Urgent,l=e=>i[e]||i.Standard,d=e=>{switch(e){case i.Important:case n.Important:return a.Nt.Important;case i.Urgent:case n.Urgent:return a.Nt.Urgent;case i.Standard:case n.Standard:default:return a.Nt.Standard}}},592301:(e,r,t)=>{t.d(r,{Q:()=>i});var n=t(529488);const i=e=>{var r;return e&&e.vivaTopicsAnnotations&&null!==(r=(e=>{try{return(e=>{const{ApiVersion:r,EntityAnnotation:t,TraceId:n,ClientRequestId:i}=e,{SectionMatches:a}=t;return{apiVersion:r,entityAnnotation:{sectionMatches:a.map((e=>{const{EntityMatches:r,SectionId:t}=e;return{entityMatches:r.map((e=>{const{Entities:r,HighlightedName:t,Length:n,StartPos:i,OccurrenceIndex:a,TotalOccurrences:o,Relevance:s}=e;return{entities:r.map((e=>{const{DisplayName:r,Id:t,RelevanceScore:n,Source:i,Type:a}=e;return{displayName:r,id:t,relevanceScore:n,source:i,type:a}})),highlightedName:t,length:n,startPos:i,occurrenceIndex:a,totalOccurrences:o,relevance:{annotationScore:s.AnnotationScore}}})),sectionId:t}}))},traceId:n,clientRequestId:i}})((0,n.T)(e))}catch(e){return}})(e.vivaTopicsAnnotations))&&void 0!==r?r:null}},73578:(e,r,t)=>{t.d(r,{bj:()=>l,A3:()=>d,Fh:()=>c,M0:()=>u,jm:()=>m,KD:()=>v,DP:()=>g,xV:()=>h,SI:()=>y,X1:()=>C});var n=t(760005),i=t(876661),a=t(74583),o=t(711676),s=t(919567);function l(e){const[r,t,i]=function(e){const r=3,t=e.split(";");return t&&t.length===r&&t[0]&&!isNaN(Number(t[0]))&&t[1]&&!isNaN(Number(t[1]))&&t[2]&&!(0,a.isNil)(Number(t[2]))?t:n.Mp.split(";")}(e),o=Number(t)||0;return{originalArrivalTime:Number(r)||0,timeStamp:o,clientMessageId:i}}const d=(e,r)=>{const t=(0,i.iX)(Object.assign(Object.assign({},r),{version:0,messages:""})),n=(0,i.J6)(Object.assign(Object.assign({},r),{version:0,messages:""}));return t?e.chat:n?e.channel:void 0};function c(e,r){const t=l(e.properties&&e.properties[n.Ff.ConsumptionHorizon]||n.Mp);if(r){const n=d(r,e)||-1;t.originalArrivalTime=Math.max(t.originalArrivalTime,n)}return t}function u(e,r){let t=l(p(e.properties)||n.Mp);if(r){(d(r,e)||-1)>=t.timeStamp&&(t={originalArrivalTime:0,timeStamp:0,clientMessageId:"0"})}return t}const p=e=>(null==e?void 0:e.userConsumptionHorizon)||(null==e?void 0:e.consumptionHorizonBookmark)||null;function m(e){var r;let t=e.lastMessageTimeUtc;if((0,a.isNil)(t)){const n=null===(r=e.lastMessage)||void 0===r?void 0:r.originalarrivaltime;t=n&&new Date(n).getTime()||0}return t}const v=(e,r)=>{const t=c(e,r),n=u(e,r);return m(e)<=t.originalArrivalTime&&0===n.originalArrivalTime},g=(e,r,t,n=!1)=>{if("newchat"===e.id||(e=>!!e&&-1!==e.indexOf("preview-"))(e.id))return!0;let i=h(e,r,t,n);if(!i&&(e=>!!e&&e.includes("meeting"))(e.id)&&e.lastContentMessageTime){const r=new Date(e.lastContentMessageTime).getTime(),n=c(e,t),a=u(e,t);i=r<=n.originalArrivalTime&&0===a.originalArrivalTime}return i},h=(e,r,t,i=!1)=>{var s,l;let d="";e.lastMessage&&((0,o.gs)(e.lastMessage)?d=f(e.lastMessage)||"":e.lastMessage.from&&(d=(0,a.last)(e.lastMessage.from.split("/"))||""));const c=v(e,t),p=0===u(e,t).originalArrivalTime,m=-1!==d.indexOf(r);return!!i&&m&&!!(null===(l=null===(s=e.lastMessage)||void 0===s?void 0:s.properties)||void 0===l?void 0:l[n.BM.OriginalMessageContext])?c:c||m&&p},f=e=>{let r="";if((0,o.gs)(e)&&e.content){const t=e.content.match(/<initiator>(.*?)<\/initiator>/i);t&&t[1]&&(r=t[1].trim())}return r},y=(e,r)=>{const{clientMessageId:t,originalArrivalTime:n}=u(e,r),i=new Date(n).toISOString();return!!t&&"0"!==t&&T(i)},T=e=>{e=null==e?void 0:e.toString();return 0!==new Date(e&&"0"!==e?e:s.vj).valueOf()},C=(e,r,t)=>{var i,a;const o=y(e,t);let l=!1;if((null===(i=e.lastMessage)||void 0===i?void 0:i.messagetype)===n.Cs.CallRecording){const r=new Date(e.lastContentMessageTime||s.vj),{originalArrivalTime:n}=c(e,t);l=r>new Date(n||s.vj)}else l=!v(e,t);const d=null===(a=e.lastMessage)||void 0===a?void 0:a.from,u=!!(d&&r&&(null==d?void 0:d.indexOf(r))>-1);return o||l&&!u}},592153:(e,r,t)=>{t.d(r,{A1:()=>P,bf:()=>h,BU:()=>f,BT:()=>w,xk:()=>y,oV:()=>C,Fx:()=>m,xV:()=>u,uy:()=>T,Hs:()=>p});var n=t(74583),i=t(987745),a=t(89062);const o=()=>s.instance;class s{constructor(){this._enabled=!1,this._currentAppConsumptionHorizon={current:i.Zb,timestamp:void 0}}static get instance(){return s._instance||(s._instance=new s),s._instance}get isEnabled(){return this._enabled}setEnabled(e,{logger:r}){var t;this._enabled=e,null===(t=r.infoToTelemetry)||void 0===t||t.call(r,"Enabling appConsumptionHorizon singleton","cdl_appch_singleton",void 0,!0)}get currentAppConsumptionHorizon(){return this.isEnabled?this._currentAppConsumptionHorizon.current:i.Zb}get latestAppConsumptionHorizonUpdate(){return this._currentAppConsumptionHorizon}updateAppConsumptionHorizon(e,{logger:r}){var t,i;this.isEnabled?(this._currentAppConsumptionHorizon=(0,n.clone)(e),null===(i=r.infoToTelemetry)||void 0===i||i.call(r,`AppConsumptionHorizon updated to '${(0,a.u4)(e)}'.`,"cdl_appch_singleton",void 0,!0)):null===(t=r.warnToTelemetry)||void 0===t||t.call(r,`Tried updating appConsumptionHorizon while singleton was disabled '${(0,a.u4)(e)}'.`,"cdl_appch_singleton",void 0,!0)}}var l=t(73578),d=t(760005),c=t(876661);const u=e=>(0,l.KD)(e,g()?o().currentAppConsumptionHorizon:void 0),p=(e,r)=>(0,l.xV)(e,r,g()?o().currentAppConsumptionHorizon:void 0),m=e=>function(e){if(!e.properties)return!1;const r=e.properties[d.Ff.LastImportantImTime];return function(e){if(!e)return 0;const r=new Date(e);return r?r.getTime():0}(r)>Number(v(e).originalArrivalTime)}(e),v=e=>(0,n.isEmpty)(e.properties&&e.properties[d.Ff.ConsumptionHorizonBookmark])?h(e):f(e);function g(){return s.instance.isEnabled}const h=e=>(0,l.Fh)(e,g()?o().currentAppConsumptionHorizon:void 0),f=e=>(0,l.M0)(e,g()?o().currentAppConsumptionHorizon:void 0),y=(e,r)=>(0,l.X1)(e,r,g()?o().currentAppConsumptionHorizon:void 0),T=(e,r,t=!1)=>(0,l.DP)(e,r,g()?o().currentAppConsumptionHorizon:void 0,t),C=e=>(0,l.SI)(e,g()?o().currentAppConsumptionHorizon:void 0),P=e=>{let r="";return e&&(r=[e.originalArrivalTime,e.timeStamp,e.clientMessageId].join(";")),r};function w(e,r){var t;if((0,c.iX)(e)&&(0,l.DP)(e,r,void 0))return{updatedConsumptionHorizon:void 0,updatedConsumptionHorizonBookmark:void 0};if((0,c.J6)(e)&&!(0,l.X1)(e,r,void 0))return{updatedConsumptionHorizon:void 0,updatedConsumptionHorizonBookmark:void 0};const n=(0,l.A3)(o().currentAppConsumptionHorizon,e),i=(0,l.M0)(e,void 0),a=(0,l.jm)(e),s=P({originalArrivalTime:a,timeStamp:Date.now().valueOf(),clientMessageId:(null===(t=e.lastMessage)||void 0===t?void 0:t.clientmessageid)||"0"});let u;return n&&(0,l.SI)(e,void 0)&&n>=i.timeStamp&&(u=d.Mp),{updatedConsumptionHorizon:s,updatedConsumptionHorizonBookmark:u}}},303065:(e,r,t)=>{t.d(r,{t:()=>T});var n=t(863553),i=t(760005);const a=/^([^(（]+)[(（]?/;function o(e,r){const t=function(e){var r,t,n;let i="";if(!(null==e?void 0:e.displayName))return i;const o=null!==(r=e.displayName)&&void 0!==r?r:"",s=null!==(t=e.givenName)&&void 0!==t?t:"",l=null!==(n=e.surname)&&void 0!==n?n:"",d=null!==s&&o.startsWith(s),c=null!==l&&o.startsWith(l);if(null!==s&&d&&!c)i=s;else if(c&&!d){const e=a.exec(o);e&&e.length>1&&(i=e[1].trim())}return i=i||o,i||""}(r);return t||(e?e.split(" ")[0]:"")}var s=t(50805),l=t(793377),d=t(711676),c=t(876661),u=t(708975),p=t(628063);const m=(e,r,t)=>{const{enableGroupChatInviteFlow:n}=t.get(s.J.Messaging),i=(0,p.rh)(e);return!!n&&!r&&!i},v=(e,r)=>{const{enableMeetingChatAcceptBlockFlow:t}=r.get(s.J.Calling);return!!t&&(0,u.x)(e)},g=(e,r,t,n,i)=>{var a;if(n)return!1;const o=!!(0,d.eX)(e.id);return((e,r,t)=>{const n=(0,c.Bl)(e);return!(!r||!t||n)})(e.id,t,!!(null===(a=e.usersProps)||void 0===a?void 0:a.hasConsumerUser))||((e,r,t,n,i)=>{var a;const o=[];null===(a=e.members)||void 0===a||a.forEach((e=>{const r=n[e.id];r&&o.push(r)}));const s=(0,p.C)(o,i);return(0,d._K)(e.id,r,t,!!s.length||r,o.map((e=>e.id)))})(e,o,t,r,i)||(s=e.id,(0,c.Bl)(s));var s};var h=t(690250);var f=t(516637);function y(e,r,t,n){var a,o,l,d;const u=(null===(a=e.lastMessage)||void 0===a?void 0:a.content)||"",p=!u&&!!(null===(l=null===(o=e.lastMessage)||void 0===o?void 0:o.properties)||void 0===l?void 0:l.forwardTemplateId);switch(t){case i.Cs.MediaCard:return u||r.stringTranslate("messaging","chats_messagePreview_sent_a_card");case i.Cs.CallLocalRecording:case i.Cs.CallRecording:return function(e,r,t){if(t===i.Cs.CallRecording&&!/<RecordingContent[^>]*contentTypes="Recording/.test(e))return"";if(/<RecordingStatus[^>]*status="Initial"/.test(e))return r.stringTranslate("messaging","chats_messagePreview_call_recording_ongoing");if(/<RecordingStatus[^>]*status="ChunkFinished"/.test(e))return r.stringTranslate("messaging","chats_messagePreview_call_recording_processing");if(/<RecordingStatus[^>]*status="Success"/.test(e))return t===i.Cs.CallRecording?r.stringTranslate("messaging","chats_messagePreview_call_recording"):r.stringTranslate("messaging","chats_messagePreview_call_recording_processing");return""}(u,r,t);case i.Cs.AddMember:return function(e){var r;const t={initiator:"",targets:[]};return(0,f.w)(e,{initiator:e=>{t.initiator=e.trim()},target:e=>{const r=e.trim();r!==t.initiator&&t.targets.push(r)}}),t.initiator&&0===(null===(r=t.targets)||void 0===r?void 0:r.length)}(u)?r.stringTranslate("messaging","chats_messagePreview_user_joined"):r.stringTranslate("messaging","chats_messagePreview_user_added");case i.Cs.CallTranscript:return r.stringTranslate("messaging","chats_messagePreview_call_transcript");case i.Cs.Collaborate:return"";case i.Cs.Embed:if(!u)return r.stringTranslate("messaging","fluid_message_preview");break;case i.Cs.PhonelinkMms:return r.stringTranslate("messaging","chats_messagePreview_phonelink_mms");case i.Cs.Call:if((null===(d=null==n?void 0:n.get(s.J.Messaging))||void 0===d?void 0:d.enableGroupChatAudioDropin)&&(0,c.Xg)(e)&&function(e){const r=-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e);if(!/<partlist/.test(e)||r)return!1;return-1!==e.indexOf("<name>")}(u))return r.stringTranslate("messaging","chats_messagePreview_audio_drop_in_call_started")}return/^<img\b[^>]*>$/.test(u)?r.stringTranslate("messaging","chats_messagePreview_sent_an_image"):function(e){return/^<video[^>]*>[^<>]*<\/video>$/.test(e)}(u)?r.stringTranslate("messaging","chats_messagePreview_sent_an_inline_video"):p?r.stringTranslate("messaging","chats_messagePreview_forwarded_message"):u}const T=e=>{var r,t,a;const{conversation:d,profilesMap:u,coreSettings:f,i18n:T,loggerFactory:C,currentUserMri:P,currentUserTenantId:w,addSenderName:I=!1}=e,S=!!(0,c.YP)(d),b=(0,n.F)(null!==(t=null===(r=null==d?void 0:d.lastMessage)||void 0===r?void 0:r.from)&&void 0!==t?t:""),_=u[b],M=((e,r,t,n,a,o,d)=>{var c;let u;const{environment:p}=t.get(s.J.Metadata),h=p===l.s.life;switch(null===(c=e.properties)||void 0===c?void 0:c.interopconversationstatus){case i.uI.ExtendedDirectoryAcceptPending:u=n.stringTranslate("people","tfl_invite_free_chat_notification_title",{displayName:(null==d?void 0:d.displayName)||n.stringTranslate("peoplePicker","unknown_user")});break;case i.uI.AcceptPending:u=m(e.id,a,t)||g(e,r,a,h,o)||v(e,t)?n.stringTranslate("messaging","tmp_group_chat_invite_flow_chat_list_preview"):n.stringTranslate("people","tfl_invite_free_chat_notification_title",{displayName:(null==d?void 0:d.displayName)||n.stringTranslate("peoplePicker","unknown_user")});break;case i.uI.Blocked:u=n.stringTranslate("people","blocked_sfc_chat_preview_message")}return u})(d,u,f,T,S,w,_);if(M)return M;const A=d.lastMessage;if(!A){return(0,c.xb)(d.id)?T.stringTranslate("messaging","chats_messageDraftPreview_default"):""}if(null===(a=A.properties)||void 0===a?void 0:a.deletetime)return T.stringTranslate("messaging","chats_messagePreview_lastMessage_deleted");const O=(0,p.DE)(C,A.messagetype,A.properties);let N=y(d,T,O,f);if(""===N.trim()&&(N=function(e,r,t){const n=(0,p.jz)(t,e.properties),i=(0,p.le)(t,e.properties);return(null==n?void 0:n.length)?r.stringTranslate("messaging","chats_messagePreview_sent_a_file"):(null==i?void 0:i.some((e=>e.contentType===h.s.Audio)))?r.stringTranslate("messaging","recent_conversations_sent_an_voice_message"):(null==i?void 0:i.some((e=>"bfb101ece45946be988be560a74322f2"===e.cardClientId)))?r.stringTranslate("messaging","recent_conversations_sent_a_location_message"):""}(A,T,C)),!N)return"";if(!I)return N;const k=b===P,L=function(e,r,t,n,a){if(e===i.Cs.Call||e===i.Cs.AddMember||e===i.Cs.CallRecording||e===i.Cs.CallLocalRecording||e===i.Cs.CallTranscript||a&&!n)return{key:"chats_messagePreview_withoutDisplayName"};if(n)return{key:"chats_messagePreview_fromSelf"};const s=o(r,t);return s?{key:"chats_messagePreview_withDisplayName",displayName:s}:{key:"chats_messagePreview_withoutDisplayName"}}(O,A.imdisplayname,_,k,!!S);return N=T.stringTranslate("messaging",L.key,{message:N,displayName:L.displayName}),N}},614658:(e,r,t)=>{t.d(r,{n:()=>n});const n=(e,r,t)=>{const n=e?parseInt(e,10):null,i=r?new Date(r).getTime():0,a=t?parseInt(t,10):null;return!!(a&&a>=i)||!!n&&!(i&&n<i)}},628063:(e,r,t)=>{t.d(r,{le:()=>d,DE:()=>c,jz:()=>v,rh:()=>g,C:()=>h});var n=t(516909),i=t(558632),a=t(905581),o=t(132756),s=t(74583),l=t(760005);const d=(e,r,t)=>{if(!r||!r.cards||"string"!=typeof r.cards&&!t)return null;try{let e=String(r.cards);t&&(e=t);return JSON.parse(e).map((({appIcon:e,appId:r,appName:t,cardClientId:n,content:i,contentType:a,locale:o,userSpecificContent:s})=>Object.assign({appIcon:e,appId:r||"",appName:t,cardClientId:n,content:JSON.stringify(i),contentType:a,locale:o},!!s&&{userSpecificContent:s})))}catch(r){return e.newLogger("Conversation Last Message Processing","services-io-chat").log("UnhandledException in toCards."),null}},c=(e,r,t)=>{if(r===l.Cs.HTML){if(((e,r)=>{const t=d(e,r);if(!t)return!1;const n=(0,s.find)(t,(e=>"application/vnd.microsoft.card.fluid"===e.contentType));return!!n&&!!JSON.parse(n.content).componentUrl})(e,t))return l.Cs.Collaborate;if(((e,r)=>{const t=d(e,r);if(!t)return!1;const n=(0,s.find)(t,(e=>"application/vnd.microsoft.card.fluidEmbedCard"===e.contentType));return!!n&&!!JSON.parse(n.content).componentUrl})(e,t))return l.Cs.Embed}return r};var u;!function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WOPI=1]="WOPI",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(u||(u={}));const p=(e,r)=>{try{const r=JSON.parse(e);if(!r||!r.code)return;const t=(e=>{switch(e){case"BOX":return"BOX";case"DROPBOX":return"DROPBOX";case"EGNYTE":return"EGNYTE";case"GOOGLEDRIVE":return"GOOGLEDRIVE";case"SHAREFILE":return"SHAREFILE";default:throw new Error("Invalid provider code")}})(r.code);return{code:t,type:(e=>{switch(e){case u.Sharepoint:return n.RW.Sharepoint;case u.WOPI:return n.RW.WOPI;case u.Google:return n.RW.Google;case u.OneDrive:return n.RW.OneDrive;case u.Recent:return n.RW.Recent;case u.Aggregate:return n.RW.Aggregate;case u.FileSystem:return n.RW.FileSystem;case u.Search:return n.RW.Search;case u.AllFiles:return n.RW.AllFiles;case u.SharedWithMe:return n.RW.SharedWithMe;default:throw new Error("Not a valid provider type")}})(parseInt(r.type,10))}}catch(e){return void r.newLogger("Conversation Last Message Processing","services-io-chat").log(`Failed to parse provider data: ${e}`)}},m=(e,r)=>{{const t=2,s=["http","https"],{filePreview:l,chicletBreadcrumbs:d,fileInfo:c,anchorFileId:u,progressComplete:m,isUploadError:v,fileChicletState:g,providerData:h}=e,{shareUrl:f,shareId:y,itemId:T}=c,C=l||{},P=null==g?void 0:g.serviceName,{id:w,baseUrl:I,objectUrl:S,type:b,title:_,state:M}=((e,r)=>{var t;const{version:n}=e;let{id:i,baseUrl:s,objectUrl:l,type:d,title:c,state:u}=e;if(n!==r&&(({itemid:i,fileName:c,fileType:d,fileInfo:{fileUrl:l,siteUrl:s}}=e),u=null===(t=e.fileChicletState)||void 0===t?void 0:t.state),"string"!=typeof i)throw(0,a.Tr)("ChatHelpers",o.jK.Undefined,"toFiles",{id:i,version:n,type:d},"File id is missing");return{id:i,baseUrl:s,objectUrl:l,type:d,title:c,state:u}})(e,t),A="active"!==M&&"hidden"!==M,O=p(h,r);return Object.assign({id:w,itemId:T,chicletBreadcrumbs:d,baseUrl:(0,i.Nm)(I,s),objectUrl:(0,i.Nm)(S,s),shareId:y,shareUrl:f,type:b,title:_,fileId:w,isReferencedFile:A,anchorFileId:u,progressComplete:m&&parseInt(m,10)||null,serviceName:P&&n.a4[P],state:M&&n.cj[M],hasUploadFailed:v,providerDataV2:O},C)}},v=(e,r)=>{if(!r||!r.files||"string"!=typeof r.files)return null;try{let t=JSON.parse(r.files);t=t.filter((e=>"deeplink"!==e.type));return(0,s.map)(t,(r=>m(r,e)))}catch(e){return null}},g=e=>!!e&&e.includes(l.IX),h=(e,r)=>e.filter((({tenantId:e,isFederated:t})=>t||r&&e&&e!==r))},708975:(e,r,t)=>{t.d(r,{lF:()=>B,wT:()=>u,io:()=>M,lj:()=>U,oy:()=>H,MQ:()=>R,dk:()=>_,Xc:()=>D,Bu:()=>A,gw:()=>Q,_T:()=>L,R8:()=>w,c_:()=>v,GS:()=>m,_2:()=>y,Iy:()=>P,re:()=>S,mO:()=>b,x:()=>O,X5:()=>N,vJ:()=>I,Ut:()=>p,LQ:()=>T,Jn:()=>C,nN:()=>E,B8:()=>f,$n:()=>k,DA:()=>F});var n=t(50805),i=t(760005),a=t(681145),o=t(74583),s=t(114881),l=t(711676),d=t(919567);var c=t(500396);const u=({isActionToAccept:e,isUserBlocked:r,isInQuarantine:t,quarantineCounter:a,creator:o,currentUserMri:s},l)=>{let d=i.uI.Accepted;if(e){if(r){const e=o===s,{maxInviteFreeQuarantineCounter:r}=l.get(n.J.People),c=a>=(r||0);t&&!e?d=i.uI.AcceptPending:e&&c&&(d=i.uI.Quarantined)}}else d=i.uI.Blocked;return d},p=e=>!!(null==e?void 0:e.startsWith(i.at.PhonelinkSmsPrefix)),m=(e,r)=>v(e.id,r)&&y(e,r),v=(e,r)=>{if(!h(e))return!1;const{overrideThreadTypeForPrivateFeeds:t}=r.get(n.J.Sync);return(!(0,l.dV)(e)||!t)&&!p(e)},g=/^\d+[:]{1}.+/,h=e=>!(0,o.isUndefined)(e)&&e!==i.kK&&e!==i.Ov&&!p(e)&&!e.includes(i.YP)&&!e.includes(i.BQ)&&g.test(e),f=e=>e.startsWith(i.IK)?"MRI conv id":e,y=(e,r)=>!(T(e)&&!function(e){const{msgEnableSfbCloudFromBVD:r}=e.get(n.J.Messaging),{isSfbCloud:t,isSipEnabled:i,isSfbCloudInBVD:a,isSipEnabledInBVD:o}=e.get(n.J.UserResources);return!!(r?o&&a:i&&t)}(r));function T(e){return((0,o.isString)(e)?e:e.id).endsWith(i.GQ)}const C=e=>!!e&&T(e),P=e=>{var r;const t=null===(r=e.memberProperties)||void 0===r?void 0:r[i.e0.RelationshipState];return!!(null==t?void 0:t.edRedemptionRequired)},w=e=>{var r;const t=null===(r=e.memberProperties)||void 0===r?void 0:r[i.e0.RelationshipState];return!!(null==t?void 0:t.blockTime)};const I=e=>{var r;return!!(null===(r=e.memberProperties)||void 0===r?void 0:r[i.e0.IsModerator])},S=e=>e.threadProperties&&!!e.threadProperties[i.Q5.ParentSpaces],b=e=>e.threadProperties&&e.threadProperties[i.Q5.ThreadType]===a.T.Team&&S(e),_=e=>{var r,t;if(e.threadProperties&&(null===(r=e.threadProperties)||void 0===r?void 0:r[i.Q5.ParentSpaces]))try{const r=JSON.parse(null===(t=e.threadProperties)||void 0===t?void 0:t[i.Q5.ParentSpaces]);return r&&r.linkedSpaceInfoItems&&r.linkedSpaceInfoItems[0]&&r.linkedSpaceInfoItems[0].spaceThreadId&&r.linkedSpaceInfoItems[0].spaceThreadId.length>0}catch(e){return!1}return!1},M=e=>{if(e.threadProperties)try{const r=e.threadProperties.meeting,t=r?JSON.parse(r):void 0;return t?t.meetingType:void 0}catch(e){return}},A=(e,r,t)=>{if(r){const{enableStreamChatFeature:e,forceCommentStreamForConversations:i}=r.get(n.J.Calling);if(!e)return!1;if(t&&(null!=i?i:[]).includes(t))return!0}if(e&&void 0!==e.isLiveChatEnabled)return function(e){switch(typeof e){case"boolean":return e;case"number":return 1===e;case"string":const r=e.toLowerCase();return"true"===r||"on"===r||"1"===r}return!1}(e.isLiveChatEnabled)},O=e=>N(e.type),N=e=>!!e&&e.toLowerCase&&e.toLowerCase()===i.i1.Meeting.toLowerCase(),k=e=>{let r;if(O(e)&&e.threadProperties.meeting)try{const t=JSON.parse(e.threadProperties.meeting);t.subject&&(r=t.subject)}catch(e){return r}return r},L=e=>e===i.Cs.Text||e===i.Cs.RichText||e===i.Cs.HTML,R=e=>{var r;return!!(null===(r=e.members)||void 0===r?void 0:r.some((e=>(0,l.Nl)(e.id))))},D=e=>{var r;return e.id===s.VS.CallLogConversationId||e.id===s.VS.SharedCallLogConversationId||(0,l.u5)(null===(r=null==e?void 0:e.threadProperties)||void 0===r?void 0:r.threadType)},F=e=>{if(e===i.Me)return!1;const r=1209600*d.kg*.5;if(!e||isNaN(e))return!0;return e-Date.now()<r},Q=e=>(null==e?void 0:e.threadProperties)&&((null==e?void 0:e.threadProperties[i.Q5.ThreadType])===a.T.Community||(null==e?void 0:e.threadProperties[i.Q5.SpaceType])===i.Q5.SpaceType_Community),E=e=>(null==e?void 0:e.threadProperties)&&(null==e?void 0:e.threadProperties[i.Q5.ThreadType])===a.T.SubCommunity,U=e=>e.threadProperties&&e.threadProperties[i.Q5.SubstrateGroupId]||"",H=e=>{var r,t;const n=null===(t=null===(r=e.threadProperties)||void 0===r?void 0:r[i.Q5.ThreadSubType])||void 0===t?void 0:t.toLowerCase();return n||c.YF.Unknown},B=e=>{const r=e.threadProperties&&e.threadProperties[i.Q5.ThreadType];return W(r)},W=e=>{if(e)return"space"===e||"topic"===e?"Channel":"meeting"===e?"Meeting":"None"}},876661:(e,r,t)=>{t.d(r,{MJ:()=>u,K6:()=>p,Du:()=>m,ut:()=>v,uY:()=>g,pl:()=>h,ky:()=>f,Fz:()=>y,zb:()=>T,s6:()=>C,rt:()=>P,xb:()=>w,eb:()=>I,s0:()=>b,Gp:()=>_,Xm:()=>M,HU:()=>A,Yk:()=>O,yi:()=>N,X3:()=>k,Dq:()=>R,SQ:()=>D,iX:()=>F,S5:()=>Q,nV:()=>E,$V:()=>U,JJ:()=>H,J6:()=>B,sL:()=>W,WN:()=>x,pi:()=>j,Cd:()=>J,hk:()=>G,rj:()=>z,Fv:()=>$,hu:()=>V,TJ:()=>X,dO:()=>K,BL:()=>q,jo:()=>Y,nZ:()=>Z,iE:()=>ee,hP:()=>re,qo:()=>te,CB:()=>ne,au:()=>ie,ZY:()=>ae,T7:()=>oe,Xg:()=>se,YP:()=>le,Zg:()=>de,j8:()=>ue,cW:()=>pe,tq:()=>me,W7:()=>ve,is:()=>ge,dG:()=>Te,Lg:()=>Ce,Su:()=>Pe,rP:()=>we,As:()=>Ie,nL:()=>Se,Bl:()=>be,mB:()=>_e,wB:()=>Me,Eu:()=>Ae,hC:()=>Oe,DZ:()=>Ne,qN:()=>ke,Ud:()=>Le,me:()=>Re,BU:()=>De,Ii:()=>Fe,$c:()=>Qe,tl:()=>Ee,Ts:()=>Ue,wU:()=>He,jM:()=>xe,Il:()=>je,rf:()=>Je,cu:()=>Ge,ln:()=>ze,iK:()=>$e,y5:()=>Ve,Ti:()=>Xe,ok:()=>Ke,zx:()=>qe,xm:()=>Ye});var n=t(114881),i=t(74583),a=t(50805),o=t(711676),s=t(760005),l=t(681145),d=t(500396),c=t(708975);var u;!function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO"}(u||(u={}));const p=e=>{const r=I(e);return(0,c.LQ)(e)?r:r||(0,c.Jn)(e)},m=e=>{var r;return(null===(r=e.threadProperties)||void 0===r?void 0:r[s.Q5.Creator])||null},v=e=>e.threadProperties&&e.threadProperties[s.Q5.CreatedAt]?e.threadProperties[s.Q5.CreatedAt]:null,g=e=>{if(!e)throw new Error("Invalid conversation passed to isDeleted()");if(!e.threadProperties)return!1;const r=e.threadProperties.isDeleted||e.threadProperties[s.Q5.IsDeleted];return!!r&&("boolean"==typeof r?r:"function"==typeof r.toLowerCase&&"true"===r.toLowerCase())},h=e=>{if(!e)throw new Error("Invalid conversation passed to isConversationDeleted()");if(!e.properties)return!1;const r=e.properties.isDeleted||e.properties[s.Ff.isDeleted];return!!r&&("boolean"==typeof r?r:"function"==typeof r.toLowerCase&&"true"===r.toLowerCase())},f=(e,r)=>{if(!e)throw new Error("Invalid conversation passed to shouldConversationDeletedByDeleteChat()");const t=K(e,r);return 0!==t&&(!(0,i.isNil)(e.lastMessageTimeUtc)&&t>=e.lastMessageTimeUtc)},y=e=>{var r;return!(!e.properties||!e.properties[s.Ff.Followed])&&"true"===(null===(r=e.properties[s.Ff.Followed])||void 0===r?void 0:r.toLowerCase())},T=e=>{var r;return!(!e.properties||!e.properties[s.Ff.Collapsed])&&"true"===(null===(r=e.properties[s.Ff.Collapsed])||void 0===r?void 0:r.toLowerCase())},C=e=>-1===e.detailsVersion?-1===e.threadVersion:0===e.threadVersion,P=e=>C(e)||!re(e);function w(e){return e.includes(s.YP)||e.includes(s.BQ)||e===s.kK}const I=e=>{var r;return(0,o.Q5)(e.id,null===(r=null==e?void 0:e.threadProperties)||void 0===r?void 0:r.threadType)&&w(e.id)},S="lwgChannelLie-",b=e=>`${S}${e}`,_=e=>e.startsWith(S),M=e=>B(e)&&e.properties&&!!e.properties.isLie,A=e=>e.threadProperties&&(e.threadProperties[s.Q5.ThreadType]===l.T.Team||e.threadProperties[s.Q5.ThreadType]===l.T.Community)&&!(0,c.re)(e),O=e=>!(e.threadProperties[s.Q5.ParentSpaces]||!e.threadProperties[s.Q5.SubstrateGroupId]||!e.threadProperties[s.Q5.GroupId]||e.threadProperties[s.Q5.ThreadSubType]),N=e=>A(e)&&!O(e),k=e=>{const r=j(e),t=O(e);return r||t?Re(e)||"":oe(e)||""};function L(e){return!!e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===l.T.Team}const R=e=>{var r;if(e.properties){if(e.properties[s.Ff.Favorite])return"true"===(null===(r=e.properties[s.Ff.Favorite])||void 0===r?void 0:r.toLowerCase());if(L(e))return!0}return!1},D=e=>{var r;return!e.properties||!e.properties[s.Ff.GeneralChannelFavorite]||"true"===(null===(r=e.properties[s.Ff.GeneralChannelFavorite])||void 0===r?void 0:r.toLowerCase())},F=(e,r=!1)=>Q(e.type,r),Q=(e,r=!1)=>!(0,i.isNil)(e)&&(e.toLowerCase()===s.i1.Chat.toLowerCase()||e.toLowerCase()===s.i1.PhoneChat.toLowerCase()||e.toLowerCase()===s.i1.Phonelink1on1Chat.toLowerCase()||e.toLowerCase()===s.i1.PhonelinkGroupChat.toLowerCase()||e.toLowerCase()===s.i1.OneOnOne.toLowerCase()||e.toLowerCase()===s.i1.StreamOfNotes.toLowerCase()||!r&&(0,c.X5)(e)),E=e=>e.type===s.i1.RCC,U=e=>{var r;return e.id===n.VS.NotificationConversationId||(0,o.j6)(null===(r=null==e?void 0:e.threadProperties)||void 0===r?void 0:r.threadType)},H=e=>e===n.VS.AnnotationsConversationId,B=e=>e.type===s.i1.Team||e.type===s.i1.Topic,W=e=>te(e)===d.xu.Shared,x=e=>[s.wS,s.tP].includes(e.id),j=e=>(0,c.mO)(e)&&(0,c.dk)(e)&&te(e)===d.xu.Private,J=e=>A(e)&&!!e.memberProperties&&!!e.memberProperties[s.e0.ChannelOnlyMember],G=e=>{if(!(0,c.x)(e))return!1;const r=(0,c.io)(e);return!!r&&r===s.wJ.MeetNow},z=e=>{if(!(0,c.x)(e))return!1;const r=(0,c.io)(e);return!!r&&r===s.wJ.Scheduled},$=(e,r)=>e.from.substring(e.from.indexOf("/")+1)===(-1===r.indexOf(s.rK)?s.rK+r:r),V=(e,r)=>{if(!e.threadProperties)return 0;const{enableRetentionHorizonBasedPruning:t}=r.get(a.J.Sync),n=t||W(e)?e.threadProperties.retentionHorizonV2:0;return n&&isFinite(Number(n))?Number(n):0},X=(e,r)=>{var t,n,i;return null!==(i=null===(n=null===(t=null==e?void 0:e.members)||void 0===t?void 0:t.find((e=>e.id===r)))||void 0===n?void 0:n.shareHistoryTime)&&void 0!==i?i:0},K=(e,r)=>{if(!e.properties)return 0;if(h(e))return e.lastMessageTimeUtc?e.lastMessageTimeUtc+1:864e13;const t=(!r||!!r.get(a.J.Messaging).enableDeleteChat)&&F(e)?e.properties.clearHistoryTime:0;return t&&isFinite(Number(t))?Number(t):0},q=e=>!!e.mruEvictedTime&&e.mruEvictedTime>0,Y=(e,r,t)=>{const n=V(r,t);return!isNaN(Number(e))&&!isNaN(n)&&Number(e)<n},Z=(e,r,t)=>{const n=K(r,t),i=Number(e);return!isNaN(i)&&!isNaN(n)&&i<n},ee=(e,r,t=!1)=>{var n;if((0,o.Q5)(e.id,null===(n=null==e?void 0:e.threadProperties)||void 0===n?void 0:n.threadType)&&!C(e)){if(e.memberProperties&&t)return e.memberProperties[s.e0.ExpirationTime];if(e.members&&r){const t=(0,i.find)(e.members,(e=>e&&e.id===r));return t&&t.memberExpirationTime}return e.memberProperties&&e.memberProperties[s.e0.ExpirationTime]}},re=(e,r)=>{var t;return!(0,o.Q5)(e.id,null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)||!C(e)&&!g(e)&&((0,i.isArray)(e.members)&&r?(0,i.some)(e.members,(e=>e&&e.id===r)):!(e.threadProperties&&B(e)&&!e.threadProperties[s.Q5.LastLeaveAt]&&!e.threadProperties[s.Q5.LastJoinAt])&&!(e.threadProperties&&e.threadProperties[s.Q5.LastLeaveAt]&&(!e.threadProperties[s.Q5.LastJoinAt]||e.threadProperties[s.Q5.LastJoinAt]<e.threadProperties[s.Q5.LastLeaveAt])))};function te(e){if(!e||!B(e))return;const r=e.threadProperties[s.Q5.SpaceTypes],t=r?parseInt(r,10):0,n=!!e.threadProperties[s.Q5.SubstrateGroupId],i=(0,c.oy)(e);return O(e)?d.xu.Standalone:n?i===d.YF.PrivateChannel?d.xu.Private:d.xu.Shared:(t&d.tG.Private)===d.tG.Private?d.xu.Private:d.xu.Standard}const ne=(e,r)=>{var t;if(!!e.threadProperties.isLastMessageFromMe)return!0;const n=null===(t=e.lastMessage)||void 0===t?void 0:t.from;if(!n)return!1;return r===(0,i.last)(n.split("/"))},ie=(e,r)=>(0,i.reduce)(e.members,((e,t)=>{const n=t.id;return n&&n!==r&&e.push(n),e}),[]),ae=(e,r,t)=>{let n;const a=!e.members||!!e.members&&(0,i.some)(e.members,(e=>!e));if(t&&!a){const i=ie(e,r);n=I(e)&&1===i.length?t[i[0]]:t[e.id]}return n},oe=e=>{if(!e)throw new Error("Invalid conversation passed to topicName");if(e.threadProperties){if(F(e)){let r=e.threadProperties.topic;if(r&&-1!==r.indexOf(":")&&(r=void 0),!r&&(0,c.x)(e)){const t=(0,c.$n)(e);t&&(r=t)}return r}if(L(e)&&Te(e)){const r=Re(e);if(r&&r.trim())return r}else{const r=e.threadProperties.topic,t=e.threadProperties[s.Q5.TopicThreadTopic];if(r&&r.trim())return r;if(t&&t.trim())return t}}return""},se=(e,r=!1)=>F(e,!0)&&!le(e,r),le=(e,r=!1)=>{var t;const n=e.members&&e.members.length<=2;return F(e,!0)&&n&&(ge(e)||I(e)||ye(e)||!r&&fe(e)||ce(e))&&!(null===(t=e.members)||void 0===t?void 0:t.some((e=>(0,o.$i)(e.id))))},de=e=>{var r;return le(e)&&(null===(r=e.members)||void 0===r?void 0:r.some((({id:e})=>(0,o.bl)(e))))},ce=e=>e.members&&e.members.length<=2&&he(e)&&(e.type===s.i1.PhoneChat||e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===l.T.PhoneChat),ue=e=>(0,c.Ut)(e),pe=e=>ue(e.id),me=e=>!!e&&((0,o.EG)(e)||(0,o.MR)(e)||(0,o.Jl)(e)||(0,o.yj)(e)),ve=e=>e.type===s.i1.PhonelinkGroupChat,ge=e=>e.type===s.i1.Phonelink1on1Chat,he=e=>(0,i.some)(e.members,(e=>!!e.id&&e.id.startsWith(s.at.Pstn))),fe=e=>F(e,!0)&&e.members&&2===e.members.length&&!(0,i.isNil)(e.threadProperties)&&parseInt(e.threadProperties[s.Q5.CreatedAt],10)<s.Yv,ye=e=>{var r,t;return!!e.id&&e.id.indexOf(s.B3)>-1||"true"===(null===(t=null===(r=e.threadProperties[s.Q5.P2PChatUniqueRosterThread])||void 0===r?void 0:r.toString())||void 0===t?void 0:t.toLowerCase())||Be(e)},Te=e=>e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===l.T.Topic||j(e)||W(e)||(0,c.nN)(e)||M(e),Ce=e=>(0,c.Jn)(e),Pe=e=>be(e&&e.id),we=e=>Ce(e)||(e=>Ie(e))(e)||Pe(e),Ie=e=>{const r=(0,i.isString)(e)?e:e.id;return(0,i.endsWith)(r,s.M9)||(0,i.endsWith)(r,s.IS)||(0,i.startsWith)(r,s.X2)},Se=e=>Ie(e)||He(e),be=e=>!!e&&((0,i.endsWith)(e,s.RS)||(0,i.startsWith)(e,s.QV)),_e=e=>e===s.Z,Me=e=>!(e.id!==s.Z||e.lastMessage||e.threadProperties.retentionHorizonV2&&0!==e.threadProperties.retentionHorizonV2),Ae=e=>{const r=(0,i.endsWith)(e,s.M9)||(0,i.endsWith)(e,s.IS)||(0,i.startsWith)(e,s.X2),t=e.endsWith(s.GQ),n=be(e);return r||t||n},Oe=e=>{const r=ee(e),t=r&&r<Date.now();return re(e)&&!t},Ne=e=>{if(e.threadProperties&&e.threadProperties[s.Q5.Topics]){const r=e.threadProperties[s.Q5.Topics];if("["!==r.substr(0,1))return r.split("|").map((e=>({id:e,name:"Unknown"})));try{return JSON.parse(r)}catch(e){return[]}}return[]},ke=(e,r)=>{var t;const n=Ne(e);for(const e of n)if(e.id===r)return null!==(t=e.isShared)&&void 0!==t&&t;return!1},Le=e=>!!(null==e?void 0:e.some((e=>(0,o.bl)(e)))),Re=e=>{if(e.threadProperties){if(e.threadProperties[s.Q5.XTeamName])return e.threadProperties[s.Q5.XTeamName];if(e.type===s.i1.Team&&e.threadProperties.topic)return e.threadProperties.topic}},De=e=>{const r=Ne(e),t=Re(e);return r.map((r=>{const n={},i=r.name;return n[s.Q5.CreatedAt]=parseInt(r.createdat,10),n[s.Q5.Picture]=r.picture,n[s.Q5.IsDeleted]=r.isdeleted,n[s.Q5.XTeamName]=r.isShared?i:t,n.topic=i,n[s.Q5.TopicThreadTopic]=i,{threadProperties:n,id:r.id,members:[],messages:"",properties:{},version:0,type:s.i1.Topic,threadVersion:0,detailsVersion:-1,oldConsumptionHorizonKeys:[],teamId:e.id,lastMessageTimeUtc:0,isPending:void 0,memberProperties:{},mruEvictedTime:0,rosterVersion:0,rosterSummary:void 0,botMembers:[],lastSeenSkipRosterState:void 0,lastMessage:void 0,localClientId:"",isUserMember:!1,source:e.source}}))},Fe=e=>{if(e.parentId)return e.parentId;if((0,c.re)(e))try{const r=JSON.parse(e.threadProperties[s.Q5.ParentSpaces]),t=r.linkedSpaceInfoItems[0].spaceThreadId;if(!(0,i.isEmpty)(t))return t}catch(e){return}},Qe=e=>{const r=e.threadProperties&&e.threadProperties[s.Q5.SpaceId];return(A(e)?e.id:(0,c.re)(e)?Fe(e):r)||e.teamId},Ee=e=>{var r;const t=e.properties?null===(r=e.properties[s.Ff.Alerts])||void 0===r?void 0:r.trim().toLowerCase():void 0;return"true"!==t&&("false"===t||void 0)},Ue=e=>e.threadProperties&&((0,i.isBoolean)(e.threadProperties[s.Q5.GapDetectionEnabled])?e.threadProperties[s.Q5.GapDetectionEnabled]:"true"===(0,i.lowerCase)(e.threadProperties[s.Q5.GapDetectionEnabled])),He=e=>{const r=xe(e);return r&&!Ie(e)&&le(e)&&(0,i.some)(e.members,(e=>e.tenantId&&e.tenantId!==r))||We(e.id)||We(e.localClientId||"")},Be=e=>{var r,t;return!(0,i.isNil)(e.threadProperties)&&(e.threadProperties[s.Q5.TemplateType]===s.Q5.ImmutableRoster||"true"===(null===(t=null===(r=e.threadProperties[s.Q5.IsStickyThread])||void 0===r?void 0:r.toString())||void 0===t?void 0:t.toLowerCase()))},We=e=>(0,i.startsWith)(e,s.At),xe=e=>e.threadProperties&&e.threadProperties[s.Q5.TenantId],je=e=>{const r=e.threadProperties[s.Q5.ArchivalLevel],t=A(e)&&!!r&&r.toLowerCase()===s.C8.Space.toLowerCase(),n=B(e)&&!!r&&(r.toLowerCase()===s.C8.Topic.toLowerCase()||r.toLowerCase()===s.C8.Space.toLowerCase());return t||n},Je=e=>{if(!e||!e.properties)return!1;const r=e.properties[s.Ff.isPinned];return!!r&&("boolean"==typeof r?r:"string"==typeof r&&"true"===r.toLowerCase())},Ge=e=>{var r;const t=null===(r=e.memberProperties)||void 0===r?void 0:r[s.e0.RelationshipState];return!!(null==t?void 0:t.inQuarantine)},ze=e=>{var r;const t=null===(r=e.memberProperties)||void 0===r?void 0:r[s.e0.RelationshipState];return"number"==typeof(null==t?void 0:t.quarantineCounter)?null==t?void 0:t.quarantineCounter:0},$e=e=>{var r;return!!(null===(r=e.memberProperties)||void 0===r?void 0:r[s.e0.ExplicitlyAdded])},Ve=e=>{var r;return(null===(r=null==e?void 0:e.properties)||void 0===r?void 0:r.suppressLastMessageUpdate)===s.Zt.Sender},Xe=e=>{var r;return le(e)&&!(null===(r=e.usersProps)||void 0===r?void 0:r.hasFederatedUser)&&(0,i.every)(e.members,(e=>{var r;return null===(r=e.id)||void 0===r?void 0:r.startsWith(s.rK)}))||!1},Ke=e=>{var r;return!(!A(e)||parseInt(null===(r=e.threadProperties)||void 0===r?void 0:r[s.Q5.SpaceTypes],10)!==d.tG.TenantWide)},qe=(e,r)=>!!(r&&""!==r&&e.threadProperties&&e.threadProperties[s.Q5.TenantId]&&e.threadProperties[s.Q5.TenantId]!==r),Ye=(e,r)=>!(!A(e)||qe(e,r)||Ke(e)||g(e)||!re(e)||J(e))},309303:(e,r,t)=>{function n(e){const r=e.startsWith("?")||e.startsWith("#");e=r?e.substring(1):e;const t={};return e.split("&").forEach((e=>{const[r,n]=e.split("=");t[r]=decodeURIComponent((n||"").replace(/^.+?(=)/,""))})),t}t.d(r,{d:()=>n})},88204:(e,r,t)=>{t.d(r,{FT:()=>n,Bd:()=>i,Qv:()=>a,kw:()=>o,hy:()=>s,Io:()=>l,Ry:()=>d,Fk:()=>c,LW:()=>u,o8:()=>p,G_:()=>m});const n={Default:"Default",ScreenSharing:"ScreenSharing",EmergencyGroupCall:"EmergencyGroupCall",Unknown:"Unknown"},i={MultiParty:"MultiParty",TwoParty:"TwoParty",Unknown:"Unknown"},a={Accepted:"Accepted",AcceptedElsewhere:"AcceptedElsewhere",Declined:"Declined",Missed:"Missed",Unknown:"Unknown"},o={Outgoing:"Outgoing",Incoming:"Incoming",Unknown:"Unknown"},s={Transferred:"Transferred",TransferAccepted:"TransferAccepted",TransferFailed:"TransferFailed",TransferSucceeded:"TransferSucceeded",Unknown:"Unknown"},l={Immediate:"Immediate",Simultaneous:"Simultaneous",Unanswered:"Unanswered"},d={Voicemail:"Voicemail",SingleTarget:"SingleTarget",MyDelegates:"MyDelegates",DoNothing:"DoNothing",Group:"Group"};var c;!function(e){e.transfer="transfer",e.conference="conference"}(c||(c={}));const u={Hold:"Hold",Resume:"Resume",Barge:"Barge"},p={CallsApp:"CallsApp",CallableChannel:"CallableChannel",QueuesApp:"QueuesApp"};var m;!function(e){e.HuntGroup="HuntGroup",e.CallableChannelOboCall="CallableChannelOboCall"}(m||(m={}))},690250:(e,r,t)=>{var n;t.d(r,{s:()=>n}),function(e){e.Adaptive="application/vnd.microsoft.card.adaptive",e.AnnouncementHeader="application/vnd.microsoft.teams.messaging-announcementBanner",e.Audio="application/vnd.microsoft.card.audio",e.CodeSnippet="application/vnd.microsoft.card.codesnippet",e.FileConsent="application/vnd.microsoft.teams.card.file.consent",e.Hero="application/vnd.microsoft.card.hero",e.Keyboard="application.vnd.microsoft.keyboard",e.List="application/vnd.microsoft.teams.card.list",e.O365connector="application/vnd.microsoft.teams.card.o365connector",e.O365connectorAlias="application/vnd.microsoft.card.o365connector",e.Profile="application/vnd.microsoft.teams.card.profile",e.Receipt="application/vnd.microsoft.card.receipt",e.Signin="application/vnd.microsoft.card.signin",e.Thumbnail="application/vnd.microsoft.card.thumbnail"}(n||(n={}))},516637:(e,r,t)=>{function n(e,r){let t="",n="",i=!1;for(let a=0;a<e.length;a++)if("<"!==e[a])if(i){if(">"===e[a]){i=!1,n="";continue}t+=e[a]}else n+=e[a];else{if("/"===e[a+1]){if(n){const e=r[t];e&&e(n),n=""}do{a++}while(">"!==e[a]);continue}t="",i=!0}}t.d(r,{w:()=>n})},403778:(e,r,t)=>{function n(){return(...e)=>e}t.d(r,{j:()=>n})}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/950736-469d6861d053359c.js.map