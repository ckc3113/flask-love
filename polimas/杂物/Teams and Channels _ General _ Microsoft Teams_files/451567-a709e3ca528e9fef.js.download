"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[451567],{663555:(e,t,n)=>{var r,s,i;n.d(t,{TS:()=>r,Cb:()=>s,H8:()=>i,zt:()=>a,GM:()=>o,rh:()=>l,Tj:()=>d}),function(e){e.addToCall="addToCall",e.addToChat="addToChat",e.addToMeeting="addToMeeting",e.addToMeetingForSharedChannel="addToMeetingForSharedChannel",e.addToSpeedDialOrContacts="addToSpeedDialOrContacts",e.addContacts="addContacts",e.addToTeam="addToTeam",e.atMention="atMention",e.callForwardGroupSelection="callForwardGroupSelection",e.calendarPeoplePicker="calendarPeoplePicker",e.callRouting="callToRouting",e.delegationSelection="delegationSelection",e.meetingSchedule="meetingSchedule",e.newChat="newChat",e.orgChart="orgChart",e.presenceSettings="presenceSettings",e.priorityContactsSelection="priorityContactsSelection",e.searchResults="searchResults",e.searchPeopleFilter="searchPeopleFilter",e.searchSuggestions="searchSuggestions",e.shareToTeams="shareToTeams",e.shareContact="shareContact",e.taggedContactsSelection="taggedContactSelection",e.transfer="transfer",e.escalateMessage="escalateMessage",e.addToSharedChannel="addToSharedChannel",e.allFalse="allFalse",e.allTrue="allTrue",e.meetingRoomCall="meetingRoomCall",e.voicemailTransferTarget="voicemailTransferTarget",e.exceptionHandlingPerson="exceptionHandlingPerson",e.exceptionHandlingVoiceapp="exceptionHandlingVoiceapp",e.custom="custom",e.externalSuggestedContacts="externalSuggestedContacts"}(r||(r={})),function(e){e.AADTenant="AADTenant",e.Bot="Bot",e.CallQandAA="CallQandAA",e.DisabledUser="DisabledUser",e.DL="DL",e.Federated="Federated",e.FederatedConsumer="FederatedConsumer",e.Guest="Guest",e.ModernGroup="ModernGroup",e.PersonalContact="PersonalContact",e.Pstn="Pstn",e.Room="Room",e.UserDefinedGroup="UserDefinedGroup",e.TeamTags="TeamTags",e.PstnNonE164="PstnNonE164",e.LetterMapNumbers="LetterMapNumbers",e.GroupChats="GroupChats",e.Meetings="Meetings",e.Xtap="Xtap",e.TflOffNetworkEmails="TflOffNetworkEmails",e.TflOffNetworkPhones="TflOffNetworkPhones",e.TflConsumer="TflConsumer",e.TflSmsName="TflSmsName",e.ImplicitContacts="ImplicitContacts",e.ImplicitContactsForSMBSuggestions="ImplicitContactsForSMBSuggestions",e.ExtendedDirectoryUsers="ExtendedDirectoryUsers",e.MTOUsers="MTOUsers",e.Tfl2WaySmsUsers="Tfl2WaySmsUsers",e.B2BMembers="B2BMembers"}(s||(s={})),function(e){e.AAD="AAD",e.IndexedDb="IndexedDB",e.MiddleTier="MT",e.Substrate="3S",e.TopNCache="TopNCache",e.Memory="Memory",e.TFLZeroState="TFLZeroState"}(i||(i={}));const a={IDBFedBot:"IDB-FedBot",IDBPeopleGroup:"IDB-PeopleGroup",TeamTag:"TeamTag",Memory:"Memory",MT:"MT"},o={EntityActionTaken:"EntityActionTaken",EntityClicked:"EntityClicked",MouseHover:"MouseHover"},l={OpenContactCard:"OpenContactCard",Remove:"Remove"},d={Vertical:"vertical"}},597293:(e,t,n)=>{n.d(t,{a:()=>b,B:()=>c});var r=n(663555);const s=[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.Bot,r.Cb.DisabledUser,r.Cb.DL,r.Cb.ModernGroup,r.Cb.PersonalContact,r.Cb.UserDefinedGroup,r.Cb.Pstn,r.Cb.CallQandAA,r.Cb.Room,r.Cb.TeamTags,r.Cb.GroupChats,r.Cb.Xtap,r.Cb.TflOffNetworkEmails,r.Cb.TflOffNetworkPhones,r.Cb.TflConsumer,r.Cb.ImplicitContacts],i=[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.Bot,r.Cb.DisabledUser,r.Cb.DL,r.Cb.ModernGroup,r.Cb.UserDefinedGroup,r.Cb.Pstn,r.Cb.CallQandAA,r.Cb.Room,r.Cb.TeamTags,r.Cb.GroupChats,r.Cb.Xtap,r.Cb.TflOffNetworkEmails,r.Cb.TflOffNetworkPhones,r.Cb.TflConsumer,r.Cb.ImplicitContacts],a=[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.Bot,r.Cb.DisabledUser,r.Cb.DL,r.Cb.ModernGroup,r.Cb.UserDefinedGroup,r.Cb.Pstn,r.Cb.CallQandAA,r.Cb.Room,r.Cb.TeamTags,r.Cb.GroupChats,r.Cb.Xtap,r.Cb.TflOffNetworkEmails,r.Cb.TflOffNetworkPhones,r.Cb.TflConsumer,r.Cb.ImplicitContacts],o=[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.Bot,r.Cb.DisabledUser,r.Cb.DL,r.Cb.ModernGroup,r.Cb.UserDefinedGroup,r.Cb.Pstn,r.Cb.CallQandAA,r.Cb.Room,r.Cb.GroupChats,r.Cb.Xtap,r.Cb.Meetings,r.Cb.TflSmsName],l=(r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.Bot,r.Cb.DisabledUser,r.Cb.DL,r.Cb.ModernGroup,r.Cb.PersonalContact,r.Cb.UserDefinedGroup,r.Cb.Pstn,{[r.TS.callForwardGroupSelection]:[r.Cb.AADTenant,r.Cb.B2BMembers,r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.Pstn,r.Cb.CallQandAA],[r.TS.allTrue]:s,[r.TS.meetingRoomCall]:i,[r.TS.searchSuggestions]:o,[r.TS.addToMeetingForSharedChannel]:a,[r.TS.calendarPeoplePicker]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.Federated,r.Cb.DisabledUser,r.Cb.PersonalContact,r.Cb.ModernGroup,r.Cb.DL],[r.TS.searchResults]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.Bot,r.Cb.DisabledUser,r.Cb.ModernGroup,r.Cb.UserDefinedGroup,r.Cb.Pstn,r.Cb.CallQandAA],[r.TS.addToTeam]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.Bot,r.Cb.DisabledUser,r.Cb.Pstn],[r.TS.newChat]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.Bot,r.Cb.DisabledUser,r.Cb.DL,r.Cb.ModernGroup,r.Cb.UserDefinedGroup,r.Cb.TeamTags,r.Cb.Room,r.Cb.TflSmsName,r.Cb.ExtendedDirectoryUsers],[r.TS.transfer]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.DisabledUser,r.Cb.DL,r.Cb.ModernGroup,r.Cb.UserDefinedGroup,r.Cb.Pstn,r.Cb.CallQandAA],[r.TS.addToCall]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Bot,r.Cb.DisabledUser,r.Cb.UserDefinedGroup,r.Cb.Pstn,r.Cb.PersonalContact,r.Cb.CallQandAA,r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.ImplicitContacts,r.Cb.TflConsumer,r.Cb.Xtap],[r.TS.addToChat]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Federated,r.Cb.DisabledUser,r.Cb.TeamTags,r.Cb.Room,r.Cb.ExtendedDirectoryUsers],[r.TS.searchPeopleFilter]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.Bot,r.Cb.DisabledUser,r.Cb.Pstn,r.Cb.TeamTags],[r.TS.callRouting]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Bot,r.Cb.DisabledUser,r.Cb.DL,r.Cb.UserDefinedGroup,r.Cb.Pstn,r.Cb.CallQandAA],[r.TS.delegationSelection]:[r.Cb.AADTenant,r.Cb.B2BMembers],[r.TS.presenceSettings]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.Pstn],[r.TS.addToMeeting]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.Bot,r.Cb.DisabledUser,r.Cb.DL,r.Cb.ModernGroup,r.Cb.UserDefinedGroup,r.Cb.Pstn],[r.TS.meetingSchedule]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Federated,r.Cb.DL,r.Cb.ModernGroup,r.Cb.Pstn],[r.TS.addToSpeedDialOrContacts]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.Bot,r.Cb.DisabledUser,r.Cb.CallQandAA],[r.TS.addContacts]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.Bot,r.Cb.DisabledUser,r.Cb.CallQandAA,r.Cb.Pstn],[r.TS.atMention]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Bot,r.Cb.Pstn],[r.TS.orgChart]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Pstn],[r.TS.shareContact]:[r.Cb.AADTenant],[r.TS.priorityContactsSelection]:[r.Cb.AADTenant,r.Cb.B2BMembers,r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.Pstn],[r.TS.taggedContactsSelection]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.DL],[r.TS.shareToTeams]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.DisabledUser,r.Cb.UserDefinedGroup],[r.TS.escalateMessage]:[r.Cb.AADTenant],[r.TS.voicemailTransferTarget]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.B2BMembers,r.Cb.Bot,r.Cb.DisabledUser,r.Cb.ModernGroup,r.Cb.UserDefinedGroup,r.Cb.Pstn,r.Cb.CallQandAA],[r.TS.addToSharedChannel]:[r.Cb.AADTenant,r.Cb.Xtap],[r.TS.externalSuggestedContacts]:[r.Cb.ImplicitContactsForSMBSuggestions],[r.TS.exceptionHandlingPerson]:[r.Cb.AADTenant],[r.TS.exceptionHandlingVoiceapp]:[r.Cb.CallQandAA],[r.TS.allFalse]:[],[r.TS.custom]:[]});var d=n(74583);const u=(e,t)=>(0,d.flatten)(e.filter((([e,n])=>e===t)).map((([e,t])=>t))),c={[r.H8.Substrate]:[r.Cb.AADTenant,r.Cb.Guest,r.Cb.GroupChats,r.Cb.DL,r.Cb.ModernGroup,r.Cb.Room,r.Cb.ExtendedDirectoryUsers,r.Cb.PersonalContact,r.Cb.MTOUsers,r.Cb.CallQandAA],[r.H8.AAD]:[r.Cb.Guest],[r.H8.IndexedDb]:[r.Cb.Federated,r.Cb.FederatedConsumer,r.Cb.Bot,r.Cb.Pstn],[r.H8.MiddleTier]:[],[r.H8.TopNCache]:[],[r.H8.Memory]:[],[r.H8.TFLZeroState]:[]};class b{constructor(e,t){this.includeFeatures=e,this.name=t,this.includeAADTenant=!1,this.includeGuest=!1,this.includeFederated=!1,this.includeFederatedConsumer=!1,this.includeBot=!1,this.includeDisabledUser=!1,this.includeDL=!1,this.includeModernGroup=!1,this.includePersonalContact=!1,this.includeUserDefinedGroup=!1,this.includePstn=!1,this.includeCallQandAA=!1,this.includeRoom=!1,this.includeTeamTags=!1,this.includeGroupChats=!1,this.includeMeetingChats=!1,this.includeXtap=!1,this.includeOffNetworkEmails=!1,this.includeOffNetworkPhones=!1,this.includeTflConsumer=!1,this.includeTflSmsName=!1,this.includeImplicitContacts=!1,this.includeImplicitContactsForSMBSuggestions=!1,this.includeExtendedDirectoryUsers=!1,this.includeMTOUsers=!1,this.includeTfl2WaySmsUsers=!1,this.includeB2BMembers=!1,this.includeAADTenant=(0,d.includes)(e,r.Cb.AADTenant),this.includeGuest=(0,d.includes)(e,r.Cb.Guest),this.includeFederated=(0,d.includes)(e,r.Cb.Federated),this.includeFederatedConsumer=(0,d.includes)(e,r.Cb.FederatedConsumer),this.includeBot=(0,d.includes)(e,r.Cb.Bot),this.includeDisabledUser=(0,d.includes)(e,r.Cb.DisabledUser),this.includeDL=(0,d.includes)(e,r.Cb.DL),this.includeModernGroup=(0,d.includes)(e,r.Cb.ModernGroup),this.includePersonalContact=(0,d.includes)(e,r.Cb.PersonalContact),this.includeUserDefinedGroup=(0,d.includes)(e,r.Cb.UserDefinedGroup),this.includePstn=(0,d.includes)(e,r.Cb.Pstn),this.includeCallQandAA=(0,d.includes)(e,r.Cb.CallQandAA),this.includeRoom=(0,d.includes)(e,r.Cb.Room),this.includeTeamTags=(0,d.includes)(e,r.Cb.TeamTags),this.includeGroupChats=(0,d.includes)(e,r.Cb.GroupChats),this.includeMeetingChats=(0,d.includes)(e,r.Cb.Meetings),this.includeXtap=(0,d.includes)(e,r.Cb.Xtap),this.includeOffNetworkEmails=(0,d.includes)(e,r.Cb.TflOffNetworkEmails),this.includeOffNetworkPhones=(0,d.includes)(e,r.Cb.TflOffNetworkPhones),this.includeTflConsumer=(0,d.includes)(e,r.Cb.TflConsumer),this.includeTflSmsName=(0,d.includes)(e,r.Cb.TflSmsName),this.includeImplicitContacts=(0,d.includes)(e,r.Cb.ImplicitContacts),this.includeImplicitContactsForSMBSuggestions=(0,d.includes)(e,r.Cb.ImplicitContactsForSMBSuggestions),this.includeExtendedDirectoryUsers=(0,d.includes)(e,r.Cb.ExtendedDirectoryUsers),this.includeMTOUsers=(0,d.includes)(e,r.Cb.MTOUsers),this.includeTfl2WaySmsUsers=(0,d.includes)(e,r.Cb.Tfl2WaySmsUsers),this.includeB2BMembers=(0,d.includes)(e,r.Cb.B2BMembers)}}b.fromName=(e,t=[])=>{if(!(e in l))throw new TypeError("Invalid `name` attribute passed. Please make sure it exists in PEOPLE_FILTER_NAME_CONFIG.");const n=u(t,!0),r=u(t,!1),s=d.without.apply(null,[(0,d.concat)(l[e],n),...r]);return new b(s,e)},b.createFrom=(e,t,n)=>new b(t||e.includeFeatures,n||e.name),b.includesAll=(e,t)=>(0,d.every)(t,(t=>(0,d.includes)(e.includeFeatures,t))),b.includesAny=(e,t)=>(0,d.some)(t,(t=>(0,d.includes)(e.includeFeatures,t)))},900288:(e,t,n)=>{var r,s,i,a;n.d(t,{WH:()=>r,xd:()=>s,$D:()=>i,Uj:()=>a,Zh:()=>o,z_:()=>l,Ei:()=>d,iu:()=>u,UJ:()=>c,Je:()=>b,IE:()=>m}),function(e){e.ConsumerUser="ConsumerUser",e.NotFound="NotFound",e.Success="Success"}(r||(r={})),function(e){e[e.CoreScenario=0]="CoreScenario",e[e.DialToneScenario=1]="DialToneScenario",e[e.BackgroundTask=2]="BackgroundTask"}(s||(s={})),function(e){e.XSmall="HR32x32",e.Small="HR64x64",e.Medium="HR96x96",e.XMedium="HR120x120",e.Large="HR196x196"}(i||(i={})),function(e){e.TfwWithSfc="tfwWithSfc",e.TfwWithTfl="tfwWithTfl",e.TflWithTfw="tflWithTfw",e.TfwWithTfwFederated="tfwWithTfwFederated",e.ExtendedDirectoryTflWithTfw="extendedDirectoryTflWithTfw"}(a||(a={}));const o=["Large","XMedium","Medium","Small","XSmall"];var l;!function(e){e.Mobile="Mobile",e.Business="Business",e.Home="Home",e.Pager="Pager",e.Organization="Organization",e.HomeFax="HomeFax",e.BusinessFax="BusinessFax",e.Other="Other",e.Unknown="Unknown",e.Assistant="Assistant",e.OtherFax="OtherFax",e.Radio="Radio"}(l||(l={}));const d={Private:"Private",Public:"Public"};var u,c,b;!function(e){e.success="success",e.invalid="invalid",e.inTenantUser="intenantuser",e.consumerUser="consumeruser",e.notFound="notfound",e.notAllowed="notallowed",e.failed="failed",e.missingResponse="missingresponse",e.backendrequestfailed="backendrequestfailed"}(u||(u={})),function(e){e.UpdateMSASearchabilityStamping="updateMSASearchabilityStamping",e.UpdateMsaAliasVisibilitySetting="updateMsaAliasVisibilitySetting",e.GetPeopleProfilesByMris="getPeopleProfilesByMris",e.GetFederatedPeopleProfilesByMris="getFederatedPeopleProfilesByMris",e.GetPeopleProfilesByEmails="getPeopleProfilesByEmails",e.GetFederatedPeopleProfilesByEmails="getFederatedPeopleProfilesByEmails",e.GetMeProfile="getMeProfile",e.GetOfficeGroup="getOfficeGroup",e.GetUser="getUser",e.FetchAllUsersByMrisInSharedChannel="people_get_all_users_sharedChannel",e.FetchAllUsersByMrisInSharedChannelBatch="people_get_users_sharedChannel_batch",e.UpdateMsaUserName="update_msa_profile_displayname",e.UpdateProfileAvatar="update_profile_avatar",e.removeSelfProfilePicture="remove_msa_profile_picture",e.UpdateGroupProfileAvatar="update_group_profile_avatar",e.DeleteGroupProfileAvatar="delete-group-profile-avatar",e.GetTflConsumerProfilesByMris="getTflConsumerProfilesByMris",e.GetSkypeConsumerProfilesByMris="getSkypeConsumerProfilesByMris",e.GetTenantPrivacyPolicyStatementUrl="getTenantPrivacyPolicyStatementUrl",e.GetProfilePicturePolicy="getProfilePicturePolicy",e.GetExternalProfilesByAliases="getExternalProfilesByAliases"}(c||(c={})),function(e){e.GET="GET",e.POST="POST",e.PATCH="PATCH",e.PUT="PUT",e.DELETE="DELETE"}(b||(b={}));const m=["displayName","imageUri","selfAvatarLastupdatedTime","profileType","avatarETag"]},982346:(e,t,n)=>{n.d(t,{MD:()=>r,t:()=>s,vf:()=>i,p_:()=>a,cT:()=>o});const r={saveUnknownUser:"unknown_user_profile_generated",unknownUserFromDB:"unknown_user_from_index_db"},s={botType:"BOT"},i={member:"Member",guest:"Guest",anonymousUser:"AnonymousUser",voiceApp:"ADVoiceApp",DistributionList:"Group",Bot:"Bot",person:"Person",federated:"Federated",skypeConsumer:"SkypeConsumer",tflUser:"TFLUser",tflOffNetwork:"TFLOffNetwork",personalContactUser:"PersonalContactUser",tflConsumer:"TflConsumer",pstn:"pstn",extendedDirectoryUser:"EDUser",PendingOrgContact:"PendingOrgContact",OrgContact:"OrgContact",MTOUser:"MTOUser",B2BMember:"B2BMember",ADUser:"ADUser",ACSUser:"ACSUser"},a={MTOUser:64,B2BMember:32},o={showWarningBannerMinimumThreshold:20,type:{team:"team",channel:"channel",person:"person",webhook:"webhook",bot:"BOT",addABot:"addABot",app:"app"},hintElement:"ts-hint"}},451567:(e,t,n)=>{n.d(t,{M:()=>m,T0:()=>C,wo:()=>h,DS:()=>U,Im:()=>P,S4:()=>A,Rb:()=>y,yN:()=>F,$V:()=>N,$l:()=>S,eo:()=>D});var r,s=n(900288),i=n(663555),a=n(50805),o=n(793377),l=n(982346),d=n(74583),u=n(597293),c=n(589585),b=n(405501);const m="unknown_email_address@invalid.teams.ms",C="4:",f="8:tfloffnetwork:",p=`${f}email:`,T=`${f}phone:`,g="50:sms:",h="50:smsunverified:",U="unknown user",P="8:teamsvisitor:",A="8:guest:",y=4,F="28:orgid:",v=["live","sip_profile","myspace","c2c","sms"],N="TflContacts";var S;!function(e){e.NotResolved="NotResolved",e.External="External",e.User="User",e.DistributionList="DistributionList"}(S||(S={}));class D{static isUnknownUser(e){return e.email===m||"unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com"===e.email}static getUnknownUserEmail(){return m}static getRequestCount(e){return e&&e.requestCount||e.$$requestCount||0}static getUserDisplayNameWithPostfix(e,t,n,r,s,i){const{id:l}=e;let{displayName:d}=e;const{enableExternalTagForPSTNUsers:u,enableLabelingUsersByTrustLevel:c,enableMTOLabel:b}=t.get(a.J.People),m=t.get(a.J.Metadata).environment===o.s.life;if(!d)return null;if(e.isRenamed&&(d=this.checkAndAddEditedTag(d,n)),m)this.isAnonymousUser(l)&&(d=this.checkAndAddGuestTag(d,n));else{if(this.isMTOUser(e))return this.getMTOUserDisplayNamePostfixHelper(!!b,!!i,"mtoLabel"in e?e.mtoLabel:null,d,n);this.isAnonymousUser(l)?d=this.getAnonymousTfwUserDisplayNamePostfixHelper(e,d,!!c,r,n):this.isFederatedUser(e)||this.isExtendedDirectoryUser(e)||this.isTFLConsumerUser(e)||this.isSfcUser(e)?d=this.isAnonymousTfwUser(r)?D.checkAndAddUnverifiedTag(d,n):D.checkAndAddExternalTag(d,n):c&&("isAnonymousB2bUser"in e&&e.isAnonymousB2bUser||this.isAcsUserMri(l))?d=this.checkAndAddUnverifiedTag(d,n):this.isGuestUser(e)?d=this.checkAndAddGuestTag(d,n):c&&this.isAnonymousTfwUser(r)&&this.isConsumerUserMri(l)?d=this.checkAndAddUnverifiedTag(d,n):u&&this.isPSTNUser({mri:e.id})&&(d=D.getPSTNUserDisplayNamePostfixHelper(e.id,d,t,!!s,n))}return d}static checkAndAddEditedTag(e,t){const n=this.getDefaultEditedDisplayName(t),r=this.getEditedUserTag(t);let s=e;return e.includes(r)||e===n||(s+=` ${r}`),s}static checkAndAddGuestTag(e,t){const n=this.getDefaultGuestDisplayName(t),r=this.getGuestUserTag(t);let s=e;return e.includes(r)||e===n||(s+=` ${r}`),s}static checkAndAddExternalTag(e,t){const n=this.getDefaultExternalDisplayname(t),r=this.getExternalTag(t);let s=e;return e.includes(r)||e===n||(s+=` ${r}`),s}static checkAndAddUnverifiedTag(e,t){const n=this.getDefaultUnverifiedDisplayname(t),r=this.getUnverifiedTag(t);let s=e;return e.includes(r)||e===n||(s+=` ${r}`),s}static getPSTNUserDisplayNamePostfixHelper(e,t,n,r,s){const{enableLabelingUsersByTrustLevel:i}=n.get(a.J.People),{emergencySmsNumbers:o,hotlineSMSNumbers:l}=n.get(a.J.Messaging);return i?r||this.isEmergencyOrHotlinePhoneNumber(e,o||[],l||[])?D.checkAndAddExternalTag(t,s):D.checkAndAddUnverifiedTag(t,s):D.checkAndAddExternalTag(t,s)}static getAnonymousTfwUserDisplayNamePostfixHelper(e,t,n,r,s){return t="isCcmUser"in e&&e.isCcmUser?this.checkAndAddExternalTag(t,s):n?r!==e.id?this.checkAndAddUnverifiedTag(t,s):t:this.checkAndAddGuestTag(t,s)}static getMTOUserDisplayNamePostfixHelper(e,t,n,r,s){return e&&t&&n?`${r} (${n})`:e?r:D.checkAndAddExternalTag(r,s)}static getDefaultEditedDisplayName(e){return e.stringTranslate("calling","default_edited_displayname",{defaultValue:"Edited"})}static getEditedUserTag(e){return e.stringTranslate("calling","edited_user_postfix",{defaultValue:"(Edited)"})}static getDefaultGuestDisplayName(e){return e.stringTranslate("peoplePicker","default_guest_displayname",{defaultValue:"Guest"})}static getGuestUserTag(e){return e.stringTranslate("peoplePicker","guest_user_postfix",{defaultValue:"(Guest)"})}static getDefaultExternalDisplayname(e){return e.stringTranslate("peoplePicker","default_external_displayname",{defaultValue:"External"})}static getDefaultUnverifiedDisplayname(e){return e.stringTranslate("peoplePicker","default_unverified_displayname",{defaultValue:"Unverified"})}static getExternalTag(e){return e.stringTranslate("peoplePicker","external_user_postfix",{defaultValue:"(External)"})}static getUnverifiedTag(e){return e.stringTranslate("peoplePicker","unverified_user_postfix",{defaultValue:"(Unverified)"})}static applyFeatureFlagSettings(e,t){let n=e.includeFeatures;const r=Boolean(t.get(a.J.Messaging).enableConsumerConversations);switch(e.name){case i.TS.addToMeeting:{const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:s}=t.get(a.J.Federated);s||(n=(0,d.difference)(n,[i.Cb.Federated])),e&&(n=(0,d.difference)(n,[i.Cb.Bot])),n=r?(0,d.difference)(n,[i.Cb.Federated]):(0,d.difference)(n,[i.Cb.TflConsumer]);break}case i.TS.allTrue:{const{enableTflTfwFederation:e,enableTfwTflFederation:s}=t.get(a.J.Host);r?e&&(n=(0,d.difference)(n,[i.Cb.Federated])):s&&(n=(0,d.difference)(n,[i.Cb.TflConsumer]));break}case i.TS.meetingSchedule:const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:s}=t.get(a.J.Federated);s||(n=(0,d.difference)(n,[i.Cb.Federated])),e&&(n=(0,d.difference)(n,[i.Cb.Bot]));break;case i.TS.addToChat:const{enableFederatedUsersInAddToChat:o}=t.get(a.J.Federated),{enableTfwFederationOnTfl:l,enableTfwTflFederation:u}=t.get(a.J.Host);r?l||(n=(0,d.difference)(n,[i.Cb.Federated])):(o||(n=(0,d.difference)(n,[i.Cb.Federated])),u||(n=(0,d.difference)(n,[i.Cb.TflConsumer])));const{enableDLsInAddToChat:c}=t.get(a.J.DistributionLists);c||(n=(0,d.difference)(n,[i.Cb.DL]));break;case i.TS.addToTeam:const{enableFederatedUsersInAddToTeam:b}=t.get(a.J.Federated);b||(n=(0,d.difference)(n,[i.Cb.Federated]));break;case i.TS.addToSpeedDialOrContacts:const{enableFederatedUsersInAddToSpeedDialOrContacts:m}=t.get(a.J.Federated);m||(n=(0,d.difference)(n,[i.Cb.Federated]))}return u.a.createFrom(e,n)}static filterSearchResults(e,t,n){let r=t;return(e=D.applyFeatureFlagSettings(e,n)).includeFederated||(r=r.filter((e=>!(D.isFederatedUser(e)||D.isSfcUser(e)||D.isTFLConsumerUser(e))))),e.includeGuest||(r=r.filter((e=>!D.isGuestUser(e)))),e.includeBot||(r=r.filter((e=>!D.isBot(e)))),e.includeDL||(r=r.filter((e=>!D.isDistributionList(e)))),e.includePstn||(r=r.filter((e=>!D.isPSTNUser(e)))),e.includeAADTenant||(r=r.filter((e=>!D.isInTenantUser(e)))),e.includeCallQandAA||(r=r.filter((e=>!D.isCallQorAAUser(e)))),e.includeTflConsumer||(r=r.filter((e=>!D.isTFLConsumerUser(e)))),e.includeTflSmsName||(r=r.filter((e=>!D.isTFLSmsFriendlyNameUser(e)))),e.includeMTOUsers||(r=r.filter((e=>!D.isMTOUser(e)))),e.includeTfl2WaySmsUsers||(r=r.filter((e=>!D.isTFLSmsVerifiedMri((null==e?void 0:e.mri)||"")))),e.includeB2BMembers||(r=r.filter((e=>!D.isB2BMember(e)))),r}static isMixedChatUser(e,t){const n=!e&&D.isFederatedUser({type:t})||e&&D.isTFLConsumerUser({type:t})||e&&D.isSfcUser({type:t});return Boolean(n)}static isSfCUserPrefix(e){return-1!==v.indexOf(e)}static matchEmailAliasInMeProfile(e,t){return!(0,d.isEmpty)(t)&&(0,d.some)(t,(t=>{var n;return e.toLowerCase()===(null===(n=t.address)||void 0===n?void 0:n.toLowerCase())}))}static matchPhoneAliasInMeProfile(e,t){return!(0,d.isEmpty)(t)&&(0,d.some)(t,(t=>e===t.number))}static generatePstnProfile(e,t,n,r,s,i,o){var u,m;let f;const{enableExternalTagForPSTNUsers:p,enableLabelingUsersByTrustLevel:T}=null!==(u=null==i?void 0:i.get(a.J.People))&&void 0!==u?u:{},{emergencySmsNumbers:g,hotlineSMSNumbers:h,enablePaidSmsChat:U}=null!==(m=null==i?void 0:i.get(a.J.Messaging))&&void 0!==m?m:{},P=e.slice(C.length),A=D.getHotlineNumberMapping(P,i);if(r&&n){const s=(0,b.gx)(P),i=(0,c.un)(s,n,r,!0);f={mri:e,displayName:(0,d.isEmpty)(t)?U&&(null==A?void 0:A.shortCode)||i.display:t,givenName:i.display,description:U&&A?i.display:void 0,surname:"",userPrincipalName:e,accountEnabled:!1,jobTitle:"",type:l.vf.pstn,telephoneNumber:i.display}}else f={mri:e,displayName:U&&(null==A?void 0:A.shortCode)||t,description:U&&(null==A?void 0:A.phoneNumber)||void 0,givenName:t,surname:"",userPrincipalName:e,accountEnabled:!1,jobTitle:"",type:l.vf.pstn,telephoneNumber:(null==A?void 0:A.phoneNumber)||P};return p&&(null==s?void 0:s.stringTranslate)instanceof Function&&(!T||o||this.isEmergencyOrHotlinePhoneNumber(e,g||[],h||[])?f.decoratedDisplayName=D.checkAndAddExternalTag(f.displayName||t,s):f.decoratedDisplayName=D.checkAndAddUnverifiedTag(f.displayName||t,s)),f}static convertStringToBlobFile(e){const t=e.split(",")[1];if((0,d.isEmpty)(t))return;const n=atob(t),r=e.split(",")[0].split(":")[1].split(";")[0],s=new ArrayBuffer(n.length),i=new Uint8Array(s);for(let e=0;e<n.length;e++)i[e]=n.charCodeAt(e);return new Blob([i],{type:r})}static getPhoneNumbers(e){let t=[];return(null==e?void 0:e.telephoneNumber)&&t.push(e.telephoneNumber),(null==e?void 0:e.phones)&&e.phones.length>0&&(t=t.concat(e.phones.map((e=>e.number)))),t}static getExtendedDirectoryPhoneNumber(e){return D.getPhoneNumbers(e)[0]}static isPartialSCContext(e,t){return!!(e&&!t||!e&&t)}static getFederationType(e,t){let n;const r={type:t};return e?D.isTFLUser(r)?n="tflWithTfl":D.isFederatedUser(r)&&(n="tflWithTfw"):D.isSfcUser(r)?n="tfwWithSfc":D.isTFLConsumerUser(r)?n="tfwWithTfl":D.isFederatedUser(r)&&(n="tfwWithTfwFederated"),n}static getTfwExtendedDirectoryMembership(e,t={}){const{mri:n,userType:r}=e,{excludeOffNetwork:s=!0}=t;return!s&&this.isTFLOffNetworkUser(n)?"offNetwork":this.isPEUPUser(r)?"pending":this.isEUPUser(r)?"accepted":void 0}static getTflExtendedDirectoryMembership(e){return!0===e?"pending":!1===e?"accepted":void 0}static determineM365PersonaType(e){if(!e)return S.NotResolved;const{type:t,userType:n}=e;if(!t)return S.NotResolved;switch(t){case"Federated":case"TflConsumer":case"SkypeConsumer":case l.vf.pstn:return S.External;case"person":case"ADUser":return n&&"Guest"===n?S.NotResolved:S.User;case"Group":return S.DistributionList;default:return S.User}}static isValidNameForInitialsAvatarForPstnUser(e,t){return!!(D.isPSTNUser({mri:e})&&D.isValidNameForInitialsAvatar(t))}static isValidNameForInitialsAvatar(e){const t=new RegExp("(^\\p{L})","iu");return!!(!!e&&t.test(e))}static getDescriptionForPstnContact(e,t,n,r,s){var i;let o;const{mri:l,displayName:u}=e,c=l.split(C)[1],{enablePaidSmsChat:b}=null!==(i=s.get(a.J.Messaging))&&void 0!==i?i:{};return b&&D.isPSTNUser({mri:l})&&r&&(D.isTextSameAsPhoneNumber(u,c,t)||(0,d.forEach)(r,(e=>{D.isTextSameAsPhoneNumber(c,e.number,t)&&(o=n.stringTranslate("people",D.getPhoneTypePeopleKey(e.type),{phoneNumber:e.number}))}))),o}static isTextSameAsPhoneNumber(e,t,n){if(!e||!t)return!1;if(e.toLocaleLowerCase()===t.toLocaleLowerCase())return!0;const r=(0,b.gx)(e),s=(0,c.un)(r,"peopleUtilities_isTextSameAsPhoneNumber_Name",n),i=(0,c.un)(t,"peopleUtilities_isTextSameAsPhoneNumber_Phone",n);return(null==s?void 0:s.diallable)===(null==i?void 0:i.diallable)}static getPhoneTypePeopleKey(e){switch(e){case s.z_.Mobile:return`phone_type_${s.z_.Mobile}`;case s.z_.Business:return`phone_type_${s.z_.Business}`;case s.z_.Home:return`phone_type_${s.z_.Home}`;case s.z_.Pager:return`phone_type_${s.z_.Pager}`;case s.z_.Organization:return`phone_type_${s.z_.Organization}`;case s.z_.HomeFax:return`phone_type_${s.z_.HomeFax}`;case s.z_.BusinessFax:return`phone_type_${s.z_.BusinessFax}`;case s.z_.Assistant:return`phone_type_${s.z_.Assistant}`;case s.z_.OtherFax:return`phone_type_${s.z_.OtherFax}`;case s.z_.Radio:return`phone_type_${s.z_.Radio}`;default:return`phone_type_${s.z_.Other}`}}static isEmergencyOrHotlinePhoneNumber(e,t,n){const r=e.slice(C.length);return t.includes(r)||n.includes(r)}static getHotlineNumberMapping(e,t){var n;const r=(null===(n=null==t?void 0:t.get(a.J.People))||void 0===n?void 0:n.hotlineNumbersMapping)||[{shortCode:"988",phoneNumber:"+18002738255"}];for(const t of r)if(e===(null==t?void 0:t.shortCode)||e===(null==t?void 0:t.phoneNumber))return t}}r=D,D.isFederatedUser=e=>{var t;return!!e.isFederated||(null===(t=e.type)||void 0===t?void 0:t.toLowerCase())===l.vf.federated.toLowerCase()},D.isGuestUser=e=>e.type===l.vf.guest||e.userType===l.vf.guest,D.isPersonalContactUser=e=>e.type===l.vf.personalContactUser||e.userType===i.Cb.PersonalContact,D.isTFLUser=e=>e.type===l.vf.tflUser,D.isTFLConsumerUser=e=>e.type===l.vf.tflConsumer,D.isTFLSmsUser=e=>e.id&&D.isTFLSmsMri(e.id),D.isTFLSmsFriendlyNameUser=e=>e.id&&D.isTFLSmsMri(e.id)&&e.friendlyName,D.isInTenantUser=e=>{var t;return!((null===(t=e.type)||void 0===t?void 0:t.toLowerCase())!==l.cT.type.person.toLowerCase()&&e.type!==l.vf.ADUser||D.isGuestUser(e)||e.isFederated)},D.isBot=e=>{var t;return(null===(t=e.type)||void 0===t?void 0:t.toUpperCase())===l.t.botType},D.isDistributionList=e=>e.type===l.vf.DistributionList&&(!e.objectType||e.objectType===l.vf.DistributionList),D.isPSTNUser=e=>e.mri&&0===e.mri.indexOf(C),D.isSfcUser=e=>e.type===l.vf.skypeConsumer,D.isTflOrSkypeConsumerUser=e=>D.isTFLConsumerUser(e)||D.isSfcUser(e),D.isMTOUser=e=>e.profileType===l.p_.MTOUser||e.userType===l.vf.MTOUser,D.isB2BMemberMTOUser=e=>D.isMTOUser(e)&&(e.type===l.vf.ADUser||e.type===l.vf.person),D.isFederatedMTOUser=e=>D.isMTOUser(e)&&D.isFederatedUser(e),D.isB2BMember=e=>e.profileType===l.p_.B2BMember||e.userType===l.vf.B2BMember,D.isB2BGuest=e=>e.userType===l.vf.guest,D.isExtendedDirectoryUser=e=>D.isPEUPUser(e.userType)||D.isEUPUser(e.userType)||e.type===l.vf.extendedDirectoryUser,D.isPEUPUser=e=>e===l.vf.PendingOrgContact,D.isEUPUser=e=>e===l.vf.OrgContact,D.isSfBUser=e=>Boolean(e.mri&&-1!==e.mri.indexOf("sfb:")),D.isCallQorAAUser=e=>e.type===l.vf.voiceApp,D.isAnonymousUser=e=>r.isAnonymousTfwUser(e)||r.isAnonymousTflUser(e),D.isAnonymousTfwUser=e=>null==e?void 0:e.startsWith(P),D.isAnonymousTflUser=e=>null==e?void 0:e.startsWith(A),D.isAnonymousPstn=e=>null==e?void 0:e.startsWith("4:anonymous"),D.isAcsUserMri=e=>null==e?void 0:e.startsWith("8:acs:"),D.isTFLOffNetworkUser=e=>0===(null==e?void 0:e.indexOf(f)),D.isTFLOffNetworkPhoneUser=e=>0===(null==e?void 0:e.indexOf(T)),D.isTFLOffNetworkEmailUser=e=>0===(null==e?void 0:e.indexOf(p)),D.isTFLSmsUnVerifiedMri=e=>0===(null==e?void 0:e.indexOf(h)),D.isTFLSmsVerifiedMri=e=>0===(null==e?void 0:e.indexOf(g)),D.isTFLSmsMri=e=>0===(null==e?void 0:e.indexOf(g))||0===(null==e?void 0:e.indexOf(h)),D.isTFLSmsOrOffNetworkPhoneMri=e=>D.isTFLOffNetworkPhoneUser(e)||D.isTFLSmsMri(e),D.isTflSmsUnverifiedOrOffNetworkPhoneMri=e=>D.isTFLSmsUnVerifiedMri(e)||D.isTFLOffNetworkPhoneUser(e),D.isEnterpriseUserMri=e=>0===(null==e?void 0:e.indexOf("8:orgid:")),D.isConsumerUserMri=e=>{if(!e||!e.startsWith("8:"))return!1;const t=e.split(":");return!!(2===t.length||3===t.length&&r.isSfCUserPrefix(t[1]))},D.isDisplayNameUnknownUser=e=>(null==e?void 0:e.toLowerCase())===U||"unknown"===(null==e?void 0:e.toLowerCase()),D.isConversationItem=e=>{var t;return 0===(null===(t=e.id)||void 0===t?void 0:t.indexOf("19:"))},D.isTag=e=>"Tag"===e.type,D.getPhoneNumberFromMri=e=>e&&D.isTFLSmsUnVerifiedMri(e)?e.slice(h.length):""},607586:(e,t,n)=>{var r;n.d(t,{V:()=>r}),function(e){e.User="8:orgid:",e.Pstn="4:",e.Bot="28:",e.GcchUser="8:gcch:",e.DodUser="8:dod:",e.AcsUser="8:acs:",e.PstnExtension=";ext="}(r||(r={}))},589585:(e,t,n)=>{n.d(t,{un:()=>u,jg:()=>T,xi:()=>g,PN:()=>h,iE:()=>A});var r=n(740597),s=n(74583),i=n(607586),a=n(954938),o=n(50805),l=n(405501),d=n(332507);const u=(e,t,n,r)=>{let s={normalized:e,diallable:e,display:e};const{logger:i,userLocale:a,isDialPlansEnabled:o,allowNonE164Mri:d,phoneNumberUtil:u,phoneNumberFormat:b}=n;if(!u||!b)return i.warn(`[formatPhoneNumber] Invalid config: isPhoneNumberUtilDefined=${!!u}, isPhoneNumberFormatDefined=${!!b}`),s;if(!e)return i.warn(`[formatPhoneNumber] No phone number provided from: ${t}`),s;if(i.log(`[formatPhoneNumber] Received phoneNumber: ${e} from: ${t}`),!r){const t=(0,l.bR)(e),r=c(t,n);if(i.log("[formatPhoneNumber] cleaned_formatting"),o){if(s=U(r,n),i.log(`[formatPhoneNumber] isInternalExtension? ${s.isInternalExtension}`),s.isInternalExtension)return s}else i.log("[formatPhoneNumber] Dialplan not enabled, not applying normalization rules"),s.normalized=r;d||(s.normalized=m(s.normalized,b.E164,n,!0),i.log("[formatPhoneNumber] NonE164 mri are not allowed"))}s=Object.assign(Object.assign({},s),C(s.normalized,n));try{const e=u.getInstance().parseAndKeepRawInput(s.normalized,a);s.display=u.getInstance().formatInOriginalFormat(e,b.INTERNATIONAL),s.isValid=u.getInstance().isPossibleNumber(e)&&u.getInstance().isValidNumber(e)}catch(e){i.error(`[formatPhoneNumber] ${e}`),s.display=s.normalized,s.isValid=!1}return i.log(`[formatPhoneNumber] isValid? ${s.isValid}`),s},c=(e,t)=>{if(!t.phoneNumberUtil)return t.logger.warn(`[convertPhoneNumberToAlpha] Invalid config: isPhoneNumberUtilDefined=${!!t.phoneNumberUtil}`),e;const n=b(e,t),r=e.substring(n.length);return t.phoneNumberUtil.convertAlphaCharactersInNumber(n)+r},b=(e,t)=>{if(!t.phoneNumberUtil)return t.logger.warn(`[getPhoneNumberWithoutExtension] Invalid config: isPhoneNumberUtilDefined=${!!t.phoneNumberUtil}`),e;const n=t.phoneNumberUtil.EXTN_PATTERN_,r=e.search(n);return r>=0?e.substring(0,r):e},m=(e,t,n,r,s)=>{const{userLocale:i,logger:a,phoneNumberUtil:o,phoneNumberFormat:l}=n;if(!o||!l)return a.warn(`[parseAndFormatNumber] Invalid config: isPhoneNumberUtilDefined=${!!o}, isPhoneNumberFormatDefined=${!!l}`),e;const d=t||l.INTERNATIONAL,u=h(e,n,"parseAndFormatNumber");if(!g(u,n,s))return u;try{if(r){const e=o.getInstance().parse(u,i);return o.getInstance().format(e,d)}{const e=o.getInstance().parseAndKeepRawInput(u,i);return o.getInstance().formatInOriginalFormat(e,d)}}catch(e){return a.error("[parseAndFormatNumber] Failed to parse and format a phone number",e),u}},C=(e,t)=>{const{enableFormattingFixForExtension:n}=t;return{diallable:b(e,t),extension:n?p(e,t):f(e,t)}},f=(e,t)=>{const n=h(e,t,"getExtension");return p(n,t)},p=(e,t)=>{const{enablePstnWithExtnFix:n,enableFixForDtmfTone:r,logger:s,userLocale:i,phoneNumberUtil:a}=t;if(!a)return s.warn(`[getExtensionFromNormalizedNumber] Invalid config: isPhoneNumberUtilDefined=${!!a}`),"";if(!n&&!r&&!g(e,t))return s.warn(`[getExtension] Received an invalid phone number: ${e}`),"";try{return a.getInstance().parse(e,i).getExtension()||""}catch(e){return s.error("Failed to parse and format a phone number",e),""}},T=(e,t,n,r)=>{const{logger:s}=t;let a=`${i.V.Pstn}${e}`;return n&&(a+=`${i.V.PstnExtension}${n}`),s.log(`[generateMriForPstn] context: ${r} Generated MRI: ${a} for dialOutNumber: ${e} ${n?`and extension: ${n}`:""}`),a},g=(e,t,n)=>{const{userLocale:r,logger:s,phoneNumberUtil:i}=t;if(!i)return s.warn(`[isStandardFormatNormalized] Invalid config: isPhoneNumberUtilDefined=${!!i}`),!1;if(!e)return!1;try{const s=h(e,t,"isStandardFormatNormalized"),a=i.getInstance().parse(s,r),o=i.getInstance().isPossibleNumber(a);return n?o:o&&i.getInstance().isValidNumber(a)}catch(e){return s.error("[isStandardFormatNormalized] error:",e),!1}},h=(e,t,n)=>{const{isDialPlansEnabled:r,logger:s}=t;s.log(`[normalizePstnNumber] Received phoneNumber: ${e} from: ${n}`);const i=(0,l.bR)(e);return r?U(i,t).normalized:i},U=(e,t)=>{const{normalizationRules:n,logger:r,coreSettings:s,ituCountryPrefix:i}=t,o={normalized:e,diallable:e,display:e};if(!n.length)return o;const l=new a.E(n,i,r,s).normalize(e);return o.normalized=l.phoneNumber,o.diallable=null==l?void 0:l.phoneNumber,o.display=null==l?void 0:l.phoneNumber,o.isInternalExtension=null==l?void 0:l.isInternalExtension,o.isValid=l.isNormalized,o},P=(e,t,n,r,i)=>{let a;if(!(0,s.isEmpty)(e)){const t=null==r?void 0:r.getInstance().getRegionCodeForCountryCode(Number(e));if(t)return a=t.toLowerCase(),n.log(`Setting locale based on dial plan to ${a}`),a}const o=(null==i?void 0:i())||t||"en-US";return o?(a=o.substring(o.indexOf("-")+1).toLowerCase(),n.log(`Setting locale based on teams locale to ${a}`),a):(n.warn("localizationService failed to get locale. Falling back to 'us' locale"),"us")},A=(e,t,s,i)=>(0,r.__awaiter)(void 0,void 0,void 0,(function*(){var a,l,u;const c=e.get(o.J.Calling);let b;try{b=yield((e,t)=>(0,r.__awaiter)(void 0,void 0,void 0,(function*(){var r;let s;try{const r=()=>n.e(29311).then(n.t.bind(n,154953,23));s=yield(0,d.mT)(r,"libphonenumber-bundle",t),e.log("[getLibPhoneNumber] Loaded @microsoft/google-libphonenumber.")}catch(t){return null===(r=e.errorToTelemetry)||void 0===r||r.call(e,`[getLibPhoneNumber] Failed to load @microsoft/google-libphonenumber. Name: ${null==t?void 0:t.name}, Message: ${null==t?void 0:t.message}`,"utilities_normalization_getlibphonenumber",void 0,!0),Promise.reject(`Failed to load @microsoft/google-libphonenumber : ${null==t?void 0:t.message}`)}return s})))(s,i)}catch(e){return s.error(`[getConfig] Failed to load @microsoft/google-libphonenumber. ${e}`),Promise.reject({error:"Failed to load @microsoft/google-libphonenumber",message:e})}return{allowNonE164Mri:!!c.allowNonE164Mri,isDialPlansEnabled:!!c.enableDialPlans,enablePstnWithExtnFix:!!c.enablePstnWithExtnFix,normalizationRules:(null===(a=c.dialPlanPolicy)||void 0===a?void 0:a.normalizationRules)||[],ituCountryPrefix:(null===(l=c.dialPlanPolicy)||void 0===l?void 0:l.ituCountryPrefix)||"",enableFormattingFixForExtension:!!c.enableFormattingFixForExtension,userLocale:P((null===(u=c.dialPlanPolicy)||void 0===u?void 0:u.ituCountryPrefix)||"",t,s,b.PhoneNumberUtil),enableFixForDtmfTone:!!c.enableFixForDtmfTone,logger:s,phoneNumberUtil:b.PhoneNumberUtil,phoneNumberFormat:b.PhoneNumberFormat,coreSettings:e}}))},954938:(e,t,n)=>{n.d(t,{E:()=>i});var r=n(50805),s=n(405501);class i{constructor(e,t,n,r){this.iTUCountryPrefix=t,this.logger=n,this.coreSettings=r,this.invalidRules=[],this.normalizeRules=[],this.setRules(e)}normalize(e){var t,n,a,o,l,d,u;let c=i.removeFormatCharacters(e);c=i.removeGuid(c);const b=null===(t=this.coreSettings)||void 0===t?void 0:t.get(r.J.Calling);if(null===(n=this.logger)||void 0===n||n.log(`[normalize] Feature flag: stopNormalizationOnPlus=${null==b?void 0:b.stopNormalizationOnPlus}`),(null==b?void 0:b.stopNormalizationOnPlus)&&c.startsWith("+"))return null===(a=this.logger)||void 0===a||a.log(`[normalize] ${e} starts with plus. Stopping normalization.`),{phoneNumber:c,isNormalized:!0};let m=1;for(const t of this.normalizeRules){const{pattern:n,translation:r,isInternalExtension:s}=t;if(n.test(c)){const t=c.replace(n,r);return null===(o=this.logger)||void 0===o||o.log(`[normalize] [${e}] was normalized into [${t}] using rule ${m} of ${this.normalizeRules.length}: ruleExpression=[${n}] translation=[${r}] isInternalExtension=[${s}].`),{phoneNumber:t,isInternalExtension:s,isNormalized:!0}}m++}if(null===(l=this.logger)||void 0===l||l.log(`[normalize] No normalization rule matched. [addCountryCodeDuringNormalization=${null==b?void 0:b.addCountryCodeDuringNormalization}].`),(null==b?void 0:b.addCountryCodeDuringNormalization)&&!c.startsWith("+")&&(0,s.TE)(c)){const t=this.iTUCountryPrefix||(null===(d=b.dialPlanPolicy)||void 0===d?void 0:d.ituCountryPrefix),n=t?`+${t}`:"",r=`${n}${c}`;return null===(u=this.logger)||void 0===u||u.log(`[normalize] [${e}] was normalized into [${r}] by adding country code [${n}].`),{phoneNumber:r,isNormalized:!!n}}return{phoneNumber:c}}getInvalidRules(){return this.invalidRules}getITUCountryPrefix(){return this.iTUCountryPrefix}static removeFormatCharacters(e){return e.replace(/[\s\(\)\-_\/]+/g,"")}static removeGuid(e){return e.replace(/_([a-z]+\d+|\d+[a-z]+)[a-z\d]*$/gi,"")}setRules(e){if(e)for(const t of e)try{this.normalizeRules.push({pattern:new RegExp(t.pattern),translation:t.translation,isInternalExtension:t.isInternalExtension})}catch(e){this.invalidRules.push(t.pattern)}}}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/451567-a709e3ca528e9fef.js.map