"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[463258],{459989:(e,t,a)=>{if(a.d(t,{uH:()=>s,lS:()=>r,qi:()=>l,jP:()=>d}),613666==a.j)var n=a(740597);if(613666==a.j)var i=a(516909);if(613666==a.j)var o=a(491465);const s=e=>"com.microsoft.teams.callable-channel"===e||"com.microsoft.teamspace.tab.file.staticviewer.pdf"===e||"44263ed4-f1ac-4e96-93aa-d24dd50459ea"===e||"com.microsoft.teamspace.tab.web"===e,r=(e,t,a)=>{if(a){const{correlationId:n,installationScope:o,tabConfigurationData:s,threadId:r,teamId:l,isEduContext:d,isTmpLaunch:c}=a;switch(o){case i.qi.Team:return t.platform.inContextStorePostInstall({appId:e,teamId:l,correlationId:n,isEduContext:d,isTmpLaunch:c,tabConfigurationData:s,channelId:r,name:"openTabInstanceConfigDialogForChannel",inContextStoreLaunchOptions:a});case i.qi.GroupChat:return t.platform.inContextStorePostInstall({appId:e,correlationId:n,tabConfigurationData:s,isTmpLaunch:c,chatId:r,name:"openTabInstanceConfigDialogForChat",inContextStoreLaunchOptions:a})}}return Promise.resolve()},l=e=>"Student"===e||"Teacher"===e,d=(e,t)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{data:a}=yield e.query({query:o.vh,variables:{convId:t}});return a}))},449127:(e,t,a)=>{a.d(t,{f:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsStageViewUtilsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callByThreadId"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Call"}}}]}}]}},534847:(e,t,a)=>{if(a.d(t,{D:()=>d}),613666==a.j)var n=a(740597);if(613666==a.j)var i=a(516909);if(613666==a.j)var o=a(598726);if(613666==a.j)var s=a(641486);if(613666==a.j)var r=a(738646);if(613666==a.j)var l=a(554404);const d=(e,t,a,s,d,m)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(e.entryPoint===l.mQ.adaptiveCardCollabStage||e.entryPoint===l.mQ.adaptiveCardStageModal)return{appInstalled:!0,appInstallScope:i.qi.Personal};const{appId:n,convId:u,replyChainId:g,channelId:f}=e,v=f||g?void 0:u,h=g?f||u:f,b=h||v||"";let y=i.qi.Personal;try{y=yield c(t,v,h),null==d||d.mark(r.ck.StageViewTargetInstallationScopeConfirmed),null==m||m.mark(r.ck.StageViewTargetInstallationScopeConfirmed);const l={conversation:{id:b,scope:y},shouldFetchPersonalApps:!0},u=(yield(0,o.xJ)(t,s,a,n,!0,`jit-install-for-stage-view-${e.entryPoint}`,l)).find((e=>[i.JM.Installed,i.JM.InstalledAndFavorited,i.JM.InstalledAndPermanent,i.JM.AdminPreInstalled].includes(e.installationState)));if(u)return null==d||d.mark(r.ck.StageViewAppIsPreInstalled),null==m||m.mark(r.ck.StageViewAppIsPreInstalled),{appInstalled:!0,appInstallScope:u.installedScope};{null==d||d.mark(r.ck.StageViewAppIsNotPreInstalled),null==m||m.mark(r.ck.StageViewAppIsNotPreInstalled);const{appInstalled:e,appInstallScope:i}=yield p(n,b,y,t,a,s,d,m);return{appInstalled:e,appInstallScope:i}}}catch(e){return s.log(null==e?void 0:e.message),null==d||d.fail({errors:`JIT Install failed - ${null==e?void 0:e.message}`}),null==m||m.fail({errors:`JIT Install failed - ${null==e?void 0:e.message}`}),{appInstalled:!1,appInstallScope:y}}})),c=(e,t,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(a)return i.qi.Team;if(t){return(yield(0,s.Z)(t,e,"handleJITInstallForStageView"))?i.qi.Personal:i.qi.GroupChat}return i.qi.Personal})),p=(e,t,a,s,l,d,c,p)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=yield(0,o.yx)(s,e);null==c||c.mark(r.ck.StageViewAppDefFetched),null==p||p.mark(r.ck.StageViewAppDefFetched);if((0,o.WW)(i.qi.Personal,n)){const t=yield(0,o.eI)(s,l,r.RG.AppInstallationDialogInstallApp,e,i.qi.Personal,d,!0);return null==c||c.mark(r.ck.StageViewAppInstallationDone),null==p||p.mark(r.ck.StageViewAppInstallationDone),{appInstalled:!!t,appInstallScope:i.qi.Personal}}if(a!==i.qi.Personal&&(0,o.WW)(a,n)){const n=yield(0,o.eI)(s,l,r.RG.AppInstallationDialogInstallApp,e,a,d,!0,t);return null==c||c.mark(r.ck.StageViewAppInstallationDone),null==p||p.mark(r.ck.StageViewAppInstallationDone),{appInstalled:!!n,appInstallScope:a}}throw null==c||c.mark(r.ck.StageViewJITInstallScopeNotSupported),null==p||p.mark(r.ck.StageViewJITInstallScopeNotSupported),Error(`installScope: ${a} is not supported by app: ${e}`)}))},641486:(e,t,a)=>{if(a.d(t,{Z:()=>o}),613666==a.j)var n=a(740597);if(613666==a.j)var i=a(491465);const o=(e,t,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){var n,o;const{data:s}=yield t.query({query:i.vh,variables:{convId:e},context:{callerInfo:a}});return null!==(o=null===(n=s.chat)||void 0===n?void 0:n.isOneOnOneBotChat)&&void 0!==o&&o}))},407904:(e,t,a)=>{if(a.d(t,{M:()=>r}),613666==a.j)var n=a(740597);if(613666==a.j)var i=a(598726);if(613666==a.j)var o=a(738646);if(613666==a.j)var s=a(941636);const r=(e,t,a,r,l)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){try{const{appId:n}=e,d=JSON.parse(e.tabInfo);null==r||r.mark(o.ck.StageViewsAppTabInfoParsed);const c=yield(0,i.yx)(t,n);e.isFullScreenApp=(null==c?void 0:c.isFullScreenApp)||!1,null==r||r.appendEventData({"App.isFullScreenApp":e.isFullScreenApp,"StageView.OpenMode":"popout"}),null==r||r.mark(o.ck.StageViewsAppDefFetched);const p=(0,s.SO)(e,d.tabInfo.contentUrl);return a.platform.launchStageMWWithoutChat({id:p,stageOptions:e,commandSource:l})}catch(e){throw null==r||r.mark(o.ck.StageViewsFailedBeforeCommandTrigger),e}}))},363330:(e,t,a)=>{if(a.d(t,{M:()=>o}),613666==a.j)var n=a(740597);if(613666==a.j)var i=a(941636);const o=(e,t,a,o,s)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{stageViewId:n,linkedEntity:r}=yield(0,i.kf)(e,t,o);return n&&r?a.platform.launchStageMW({id:n,linkedEntity:r,stageOptions:e,commandSource:s}):Promise.reject("Entity commanding not available")}))},753248:(e,t,a)=>{if(a.d(t,{a:()=>o}),613666==a.j)var n=a(50805);if(613666==a.j)var i=a(419925);const o=(e,t,a,o,s)=>{const{enableReactStageModal:r}=t.get(n.J.Extensibility);return r?(null==s||s.appendEventData({"StageView.OpenMode":"modal"}),a.platform.launchReactStageModal(e.appId,e,{visibilityState:i.fe.show,stateTransition:i.su.extend,correlation:{source:o}}).toPromise()):a.platform.launchStage({stageOptions:e,entityCommand:{stateTransition:i.su.extend,visibilityState:i.fe.show,correlation:{source:o}}}).toPromise()}},849538:(e,t,a)=>{if(a.d(t,{A:()=>I}),613666==a.j)var n=a(740597);if(613666==a.j)var i=a(459989);if(613666==a.j)var o=a(248965);if(613666==a.j)var s=a(663945);if(613666==a.j)var r=a(50805);if(613666==a.j)var l=a(955105);if(613666==a.j)var d=a(956255);if(613666==a.j)var c=a(419925);if(613666==a.j)var p=a(738646);if(613666==a.j)var m=a(554404);if(613666==a.j)var u=a(941636);if(613666==a.j)var g=a(534847);if(613666==a.j)var f=a(363330);if(613666==a.j)var v=a(753248);if(613666==a.j)var h=a(407904);if(613666==a.j)var b=a(516909);if(613666==a.j)var y=a(500396);const I=(e,t,a,i,l,d,c,p)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{enableCommandingTelemetryForCollabStageMW:n,enableReactStageModal:m,enableProgrammaticPopoutStageViewOpenAPI:f,enableProgrammaticPopoutStageDeeplink:v}=t.get(r.J.Extensibility);let h,y,I=e;if(!n){const{phase1CollabStageScenario:e,endToEndScenario:t}=(0,u.R3)(i,I.entryPoint);h=e,y=t,I.launchScenarioId=t.id,I.phase1OnlyScenarioDetails={scenarioMarkerName:e.name,scenarioMarkerId:e.id}}if(d)try{I=yield S(d,I,a,h,y)}catch(e){return Promise.reject(`Could not determind if threadId passed is chat/channel: ${e}`)}if(I.openMode=(0,u.qV)(t,I),null==h||h.appendEventData({"App.Id":I.appId,"Thread.Id":I.convId,"PlatformApp.ScenarioCapability":o.Ky.tabs,"App.EntryPoint":I.entryPoint}),null==y||y.appendEventData({"App.Id":I.appId,"Thread.Id":I.convId,"App.EntryPoint":I.entryPoint}),!m&&I.openMode===u.Sm.modal&&c)return null==h||h.cancel({errors:"Opening angular modal hence cancelling react scenarios"}),null==y||y.cancel({errors:"Opening angular modal hence cancelling react scenarios"}),k(I,t,a,c,void 0);const{appInstalled:w,appInstallScope:C}=yield(0,g.D)(I,a,i,l,h,y);return p&&p.recordPanelAction(((e,t,a)=>{const n=a.createDatabag(),i={actionGesture:s.uS.auto,actionOutcome:s.$K.submit,actionScenario:s.Tk.openCollabStageWindow,actionScenarioType:s.Yu.collabStage_Window,moduleName:s.rA.collabStage,moduleType:s.PO.collabStage,panelRegion:s.Ai.main,panelType:s.wh.AdaptiveCardTab,extensibilityData:{id:e,scope:t,scenarioCapability:o.Ky.tabs}};return i.dataBag=n,i})(I.appId,(e=>{let t=o.Mv.personal;switch(e){case b.qi.Team:t=o.Mv.team;case b.qi.GroupChat:t=o.Mv.group}return t})(C),p)),w?(null==h||h.appendEventData({"App.Scope":C}),null==y||y.appendEventData({"App.Scope":C}),k(I,t,a,c,h,!!f,!!v).catch((e=>(null==y||y.fail({errors:"Failed to launch"}),null==h||h.fail({errors:"Failed to launch"}),Promise.reject(e))))):(null==h||h.fail({errors:`App could not be installed- ${C}`}),null==y||y.fail({errors:`App could not be installed- ${C}`}),Promise.reject("App not installed"))})),S=(e,t,a,o,s)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){let n;try{n=yield(0,i.jP)(a,e)}catch(e){return null==o||o.fail({errors:"Could not determind if threadId passed is chat/channel, chatQuery failed"}),null==s||s.fail({errors:"Could not determind if threadId passed is chat/channel: chatQuery failed"}),Promise.reject("error getting chatData: chatQuery failed")}if(n.chat){const{chatSubType:a,memberIds:i}=n.chat;if(null==o||o.mark(p.ck.ChatQuerySuccessful),null==s||s.mark(p.ck.ChatQuerySuccessful),a===y.k2.Channel)return Object.assign(Object.assign({},t),{convId:e,channelId:e,replyChainId:void 0,messageId:void 0});{const a=Object.assign(Object.assign({},t),{convId:e,channelId:void 0,replyChainId:void 0,messageId:void 0});return i&&0!==i.length||t.openMode===u.Sm.modal?a:Object.assign(Object.assign({},a),{openMode:u.Sm.popout})}}return null==o||o.fail({errors:"Could not determind if threadId passed is chat/channel, chatData is empty"}),null==s||s.fail({errors:"Could not determind if threadId passed is chat/channel: chatData is empty"}),Promise.reject("chatData is empty")})),k=(e,t,a,i,o,s,r)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const n=w(e.entryPoint);switch(e.entryPoint){case m.mQ.adaptiveCardCollabStage:return i?(0,f.M)(e,a,i,o,n):Promise.reject("Entity commanding not available");case m.mQ.deepLinkStageView:if(!r)return j(e);switch(e.openMode){case u.Sm.modal:return j(e);case u.Sm.popoutWithChat:return C(e,a,o);case u.Sm.popout:return x(e);default:return j(e)}case m.mQ.stageViewOpenSDKApi:if(!s)return i?(0,v.a)(Object.assign(Object.assign({},e),{openMode:"modal"}),t,i,n,o):Promise.reject("Entity commanding not available");switch(e.openMode){case u.Sm.popout:return i?(0,h.M)(e,a,i,o,n):Promise.reject("Entity commanding not available");case u.Sm.popoutWithChat:return i?(0,f.M)(e,a,i,o,n):Promise.reject("Entity commanding not available");case u.Sm.modal:default:return i?(0,v.a)(e,t,i,n,o):Promise.reject("Entity commanding not available")}case m.mQ.adaptiveCardStageModal:return i?(0,v.a)(e,t,i,n,o):Promise.reject("Entity commanding not available");default:return Promise.reject(`Stage view entry point not supported. Entrypoint: ${e.entryPoint}`)}})),w=e=>{switch(e){case m.mQ.stageViewOpenSDKApi:return l.D.StageViewOpenSDKApi;case m.mQ.deepLinkStageView:return l.D.StageViewDeeplink;default:return l.D.AdaptiveCardInvokeButton}},C=(e,t,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const{stageViewId:n,linkedEntity:i}=yield(0,u.kf)(e,t,a);return n&&i?Promise.resolve({entityCommand:{entity:{id:n,type:d.py.platformStage,action:d.uk.create,linkedEntity:i},command:{stateTransition:c.su.new,visibilityState:c.fe.show,correlation:{source:l.D.StageViewDeeplink,startTimestamp:e.scenarioStartTime}},entityOptions:e},metadata:{allowAnonymous:!1}}):Promise.reject("Entity commanding not available")})),x=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){const t=JSON.parse(e.tabInfo),a=(0,u.SO)(e,t.tabInfo.contentUrl);return a?Promise.resolve({entityCommand:{entity:{id:a,type:d.py.platformstagewithoutchat,action:d.uk.view},command:{stateTransition:c.su.new,visibilityState:c.fe.show,correlation:{source:l.D.StageViewDeeplink,startTimestamp:e.scenarioStartTime}},entityOptions:e},metadata:{allowAnonymous:!1}}):Promise.reject("Entity commanding not available")})),j=e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return Promise.resolve({entityCommand:{entity:{id:e.appId,type:d.py.platformstagemodal,action:d.uk.view},command:{visibilityState:c.fe.show,stateTransition:c.su.extend,correlation:{source:l.D.StageViewDeeplink}},entityOptions:e},metadata:{allowAnonymous:!1}})}))},941636:(e,t,a)=>{if(a.d(t,{Sm:()=>m,fd:()=>u,zt:()=>g,R3:()=>f,SO:()=>h,g:()=>b,kf:()=>y,qV:()=>I}),613666==a.j)var n=a(740597);if(613666==a.j)var i=a(50805);if(613666==a.j)var o=a(956255);if(613666==a.j)var s=a(459989);if(613666==a.j)var r=a(369398);if(613666==a.j)var l=a(281710);if(613666==a.j)var d=a(738646);if(613666==a.j)var c=a(554404);if(613666==a.j)var p=a(449127);var m;!function(e){e.modal="modal",e.popout="popout",e.popoutWithChat="popoutWithChat"}(m||(m={}));const u=(e,t)=>t?`${e};replyChainId=${t}`:e,g=(e,t,a,n)=>{const{licenseType:o}=e.get(i.J.UserResources),{enableStageviewMW:r,enableStageviewMWInChannels:l,enableCollabStageForEDU:d}=e.get(i.J.Extensibility),p=t===c.E4.desktop;return!(!d&&(0,s.qi)(o)||!p)&&(r&&!l?"chats"===a.type&&!n:!!l&&("chats"===a.type||"channels"===a.type))},f=(e,t)=>{var a,n;const i=v(t),o=e.newScenario(i),s=e.newScenario(d.RG.PlatformTabLaunch);return o.clientId=o.id,s.clientId=s.id,null===(a=e.hoistScenarioToCore)||void 0===a||a.call(e,o),null===(n=e.hoistScenarioToCore)||void 0===n||n.call(e,s),{phase1CollabStageScenario:o,endToEndScenario:s}},v=e=>{switch(e){case c.mQ.adaptiveCardStageModal:case c.mQ.deepLinkStageView:case c.mQ.stageViewOpenSDKApi:return d.RG.PlatformTabStageModalLaunch;case c.mQ.adaptiveCardCollabStage:default:return d.RG.PlatformTabCollabStageLaunch}},h=(e,t)=>`${e.appId}-${e.convId}-${t}-${e.reloadToggle}`;function b(e,t,a){var n,i,s,d,c;const p={};try{if((null===(n=e.linkedEntity)||void 0===n?void 0:n.type)===o.py.calls){const{convId:a,messageId:n}=(0,l.U3)(e,o.py.extensions,o.uk.view,t);n&&"0"!==n?(p.channelId=a,p.parentMessageId=n,p.channelMeetingMessageId=n,p.chatId=a):p.chatId=a}else if((null===(i=e.linkedEntity)||void 0===i?void 0:i.type)===o.py.channels){const{channelId:t}=(null===(s=e.linkedEntity)||void 0===s?void 0:s.id)&&JSON.parse(null===(d=e.linkedEntity)||void 0===d?void 0:d.id);p.channelId=t}else switch(e.type){case o.py.channels:const{channelId:n}=e.id&&JSON.parse(e.id);p.channelId=n;break;case o.py.chats:const i=(null!==(c=e.id)&&void 0!==c?c:"").split(";replyChainId=");i.length>1&&(p.replyChainId=i[1],p.channelId=i[0]),p.chatId=i[0];break;case o.py.extensions:const s=(0,r.cq)(e,a,t);p.parentMessageId=null==s?void 0:s.messageId,p.channelMeetingMessageId=null==s?void 0:s.messageId,p.chatId=(null==s?void 0:s.messageId)||null==s?void 0:s.threadId,p.channelId=(null==s?void 0:s.messageId)?null==s?void 0:s.threadId:void 0}}catch(e){t.log("Error while parsing source view entity.",null==e?void 0:e.message)}return p}const y=(e,t,a)=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){try{const{convId:n}=e;null==a||a.appendEventData({"StageView.OpenMode":"popoutWithChat"});const i=JSON.parse(e.tabInfo);null==a||a.mark(d.ck.StageViewsAppTabInfoParsed);const{data:s}=yield t.query({query:p.f,fetchPolicy:"no-cache",variables:{conversationId:n}}),r=h(e,i.tabInfo.contentUrl);null==a||a.mark(d.ck.StageViewsGetCallByThreadIdSuccessful);return{stageViewId:r,linkedEntity:(null==s?void 0:s.callByThreadId)?{id:`${n}-stageview`,type:o.py.platformstageinactivemeeting}:{id:u(n,e.replyChainId),type:o.py.chats}}}catch(e){return null==a||a.mark(d.ck.StageViewsFailedBeforeCommandTrigger),{}}})),I=(e,t)=>{const{sdkHostType:a}=e.get(i.J.Sdk),n="Desktop"===a,{enableProgrammaticPopoutStageViewOpenAPI:o,enableProgrammaticPopoutStageDeeplink:s}=e.get(i.J.Extensibility);return t.entryPoint===c.mQ.adaptiveCardCollabStage?m.popoutWithChat:t.entryPoint===c.mQ.deepLinkStageView?S(t,n,!!s):S(t,n,!!o)},S=(e,t,a)=>{if(!t||!a)return m.modal;const n=e.openMode||m.popoutWithChat;return n===m.popoutWithChat?e.convId||e.channelId?e.channelId&&!e.replyChainId?m.popout:m.popoutWithChat:m.popout:n}},80719:(e,t,a)=>{var n,i,o;a.d(t,{gV:()=>n,XY:()=>i,Jc:()=>o,Ae:()=>s}),function(e){e[e.Card=0]="Card",e[e.MessageExtension=1]="MessageExtension",e[e.PlatformExtensionTab=2]="PlatformExtensionTab",e[e.DeepLink=3]="DeepLink",e[e.ShareToOutlook=4]="ShareToOutlook",e[e.ContentBubble=5]="ContentBubble",e[e.AdaptiveCardTab=6]="AdaptiveCardTab",e[e.BotConfig=7]="BotConfig",e[e.StoreApp=8]="StoreApp",e[e.Workflows=9]="Workflows",e[e.VirtualEvent=10]="VirtualEvent"}(n||(n={})),function(e){e.contentBubble="contentBubble",e.targetedMeetingNotification="targetedMeetingNotification"}(i||(i={})),function(e){e.Small="small",e.Medium="medium",e.Large="large"}(o||(o={}));const s={message:"message",compose:"compose",commandBox:"commandBox",copilot:"copilot"};var r;!function(e){e.normal="normal",e.high="high",e.urgent="urgent"}(r||(r={}));var l;!function(e){e.html="html",e.text="text"}(l||(l={}))},248965:(e,t,a)=>{var n,i,o,s,r,l;a.d(t,{Mv:()=>n,Bd:()=>i,Ky:()=>o,sG:()=>s,Mb:()=>r,$E:()=>l}),function(e){e[e.general=0]="general",e[e.team=1]="team",e[e.personal=2]="personal",e[e.group=4]="group",e[e.meeting=8]="meeting"}(n||(n={})),function(e){e.installed="installed",e.notInstalled="notInstalled",e.preconsented="preconsented"}(i||(i={})),function(e){e[e.na=0]="na",e[e.bots=1]="bots",e[e.tabs=2]="tabs",e[e.messaging=3]="messaging",e[e.connectors=4]="connectors"}(o||(o={})),function(e){e[e.na=0]="na",e[e.card=1]="card",e[e.deepLink=2]="deepLink",e[e.messageExtension=3]="messageExtension",e[e.platformExtensionTab=4]="platformExtensionTab",e[e.contentBubble=5]="contentBubble",e[e.shareToOutlook=6]="shareToOutlook",e[e.adaptiveCardTab=7]="adaptiveCardTab",e[e.botConfig=8]="botConfig",e[e.storeapp=9]="storeapp",e[e.workflows=10]="workflows",e[e.virtualEvent=11]="virtualEvent"}(s||(s={})),function(e){e.bot="bot",e.inputextension="inputextension",e.connectors="connectors"}(r||(r={})),function(e){e.carousel="carousel",e.list="list"}(l||(l={}))},281710:(e,t,a)=>{a.d(t,{Mf:()=>i,f$:()=>o,U3:()=>s,cW:()=>r});var n=a(956255);function i(e,t){return{entity:{type:n.py.chats,action:n.uk.create,id:o(e)},command:t}}function o(e){return JSON.stringify(e&&e.length>0?e.sort():[])}function s(e,t,a,n){let i={};if(!e)return i;if(e.type===t&&e.action===a){const t=e.options;if(t&&"string"==typeof t)try{i=JSON.parse(t)}catch(e){n.warn(`Entity options are in unexpected format. Expected a valid stringified JSON object but instead received: ${t}.`)}}else n.warn(`Entity options are (incorrectly) being asked for type and action that do not pertain to the entity. ${e.type} != ${t} or ${e.action} != ${a}`);return i}const r=e=>`${e.substring(0,32)}00000000${e.substring(40)}`},554404:(e,t,a)=>{a.d(t,{E4:()=>i,$c:()=>o,C9:()=>s,vV:()=>r,xu:()=>l,mQ:()=>d,Np:()=>c});var n,i,o,s,r,l,d,c;!function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(n||(n={})),function(e){e.web="web",e.desktop="desktop",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows"}(i||(i={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.meetingStage="meetingStage"}(o||(o={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(s||(s={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(r||(r={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(l||(l={})),function(e){e.activityFeed="activityFeed",e.card="card",e.connectorConfiguration="connectorConfiguration",e.deepLink="deepLink",e.deepLinkStageView="deepLinkStageView",e.contentBubble="contentBubble",e.messageExtension="messageExtension",e.tab="tab",e.shareToOutlook="shareToOutlook",e.adaptiveCardTab="adaptiveCardTab",e.adaptiveCardCollabStage="adaptiveCardCollabStage",e.adaptiveCardStageModal="adaptiveCardStageModal",e.platformAppView="platformAppView",e.chatTab="chatTab",e.channelTab="channelTab",e.sidePanel="sidePanel",e.privateMeetingSchedulingForm="privateMeetingSchedulingForm",e.channelMeetingSchedulingForm="channelMeetingSchedulingForm",e.personalApp="personalApp",e.botConfig="botConfig",e.storeApp="storeApp",e.stageViewOpenSDKApi="stageViewOpenSDKApi",e.workflows="workflows",e.virtualEvent="virtualEvent",e.botChat="botChat"}(d||(d={})),function(e){e.teamsElectron="TEAMS-ELECTRON",e.teamsWeb="TEAMS-WEB",e.teamsMaglev="TEAMS-MAGLEV"}(c||(c={}))},428957:(e,t,a)=>{a.d(t,{Kz:()=>l,Kp:()=>d,D5:()=>p,eT:()=>m,uO:()=>u,aE:()=>g,eA:()=>f,C$:()=>v,h5:()=>h,vf:()=>b,Mw:()=>y,IM:()=>I});var n=a(132756),i=a(905581);if(613666==a.j)var o=a(516909);var s=a(74583);const r="ParsingMeetingUrl",l=e=>{const t=decodeURIComponent(e),a=new RegExp("context=(.*)$","g").exec(t);if(!a||a.length<2)throw c(`Meeting context is not in valid format ${t}`);const n=JSON.parse(a[1]);if(!n||!n.Tid||!n.Oid)throw c("Meeting url is malformed Tid or Oid is missing");return{tenantId:n.Tid,organizerId:n.Oid}},d=e=>e.context===r&&e.code===n.jK.ErrorParsingQueryParams,c=e=>(0,i.Tr)(r,n.jK.ErrorParsingQueryParams,"",void 0,e),p=e=>{const t="meet",a="meetup-join",n=new URL(e);let i;if(n.pathname.includes(t)||n.pathname.includes(a))i=n;else{if(!n.hash||!n.hash.includes(t)&&!n.hash.includes(a))throw c("Invalid URL - unsupported URL format");i=new URL(n.hash.substring(1),n.origin)}const o=i.searchParams,s=i.pathname.split("/"),r={isLegacyUrl:!1,meetingCloud:i.hostname,meetingUrl:e};if(s[2]===a){const e=o.get("context");if(5!==s.length||!e)throw c("Invalid URL - context param is missing");r.threadId=decodeURIComponent(s[3]),r.messageId=decodeURIComponent(s[4]);const t=JSON.parse(decodeURIComponent(e));if(!t.Tid||!t.Oid)throw c("Invalid URL - context param is invalid. Tid or Oid missing.");r.tenantId=t.Tid,r.organizerId=t.Oid,r.isBroadcastMeeting=t.IsBroadcastMeeting||void 0,r.attendeeRole=t.role||void 0,r.replyChainMessageId=t.MessageId||void 0,r.isLegacyUrl=!0}else{if(s[1]!==t)throw c("Invalid URL - unsupported URL format");r.meetingId=s[2],r.passCode=o.get("p")||void 0}return r},m=(e,t,a,n)=>{const i=p(e),r=(0,s.isEmpty)(a)?"calendar_join_meeting_utils":a;let l;return l=i.isLegacyUrl?{type:"Meeting",joinOptions:{meeting:{showPrejoin:!0,isPSTN:!1,title:t},context:r},coordinates:{legacyMeeting:{meetingCloud:i.meetingCloud,conversationId:i.threadId||"",rootMessageId:i.messageId||"",messageId:i.replyChainMessageId||i.messageId||"",isChannel:"0"!==i.messageId,isAdhoc:!1,tenantId:i.tenantId||"",organizerId:i.organizerId||"",broadcast:i.isBroadcastMeeting?{role:null!=n?n:o.tf.None}:null}}}:{type:"Meeting",joinOptions:{meeting:{showPrejoin:!0,isPSTN:!1,title:t},context:r},coordinates:{meetingData:{meetingUrl:e}}},l},u=e=>{var t,a,n,i;try{return new URL(e).hostname}catch(o){return(null===(i=null===(n=null===(a=null===(t=e.split("/"))||void 0===t?void 0:t[2])||void 0===a?void 0:a.split("@"))||void 0===n?void 0:n.pop())||void 0===i?void 0:i.split(":").shift())||""}},g=e=>{let t=!1;if(e&&e.skypeTeamsDataObj){t=1===e.skypeTeamsDataObj.type}return t};function f(e){return!(!e||!e.skypeTeamsDataObj||(0,s.isEmpty)(e.skypeTeamsDataObj))&&!1===e.skypeTeamsDataObj.private}function v(e){return"Group"===(null==e?void 0:e.mailboxType)}const h=e=>{var t;return!!(null===(t=e.webinarRegistration)||void 0===t?void 0:t.webinarId)},b=e=>{var t;return!!(null===(t=e.virtualEventsData)||void 0===t?void 0:t.eventId)},y=e=>{try{return"meet"===new URL(e).pathname.split("/")[1]}catch(e){return!1}},I=(e,t,a)=>e&&t&&(void 0===a||a)},923975:(e,t,a)=>{a.d(t,{wr:()=>s,ae:()=>r,ZD:()=>d,g0:()=>c,cI:()=>p,pG:()=>m,Qb:()=>u,W5:()=>g,sM:()=>f,E:()=>v});var n=a(658630);if(613666==a.j)var i=a(412183);var o=a(50805);const s=n.cloudDomains,r=n.CrossCloudUtils.isCrossCloudMeetingJoinAttemptBetweenTFLAndTFW,l=n.CrossCloudUtils.isDeepLinkExecutionForCrossCloudMeetingJoinBetweenTFLAndTFWAllowed,d=n.CrossCloudUtils.isLegacyMeetingUrl,c=n.CrossCloudUtils.isTFWDomain,p=n.CrossCloudUtils.isTFLMeetingURL,m=n.CrossCloudUtils.getMeetingLegacyURL,u=(e,t)=>{var a;const n=((null===(a=t.get(o.J.Messaging))||void 0===a?void 0:a.deepLinkDomains)||[])[0],{enableMeetingBetweenTFWAndTFL:i}=t.get(o.J.Calling);return l(n,e,!!i)},g=e=>({coordinates:{meetingData:{instantMeetingOptions:void 0,isAdhoc:!0}},joinOptions:{outgoingVideo:!0,outgoingAudio:!0,context:"WatchParty",meeting:{deeplinkId:e,isWatchParty:!0,showPrejoin:!0}},type:"Meeting"}),f=(e,t,a,n)=>{let o;if((0,i.N6)(e)){const{conversationId:t,messageId:a,rootMessageId:n,isChannel:i,isAdhoc:s,tenantId:r,organizerId:l,meetingCloud:d,registration:c,participantPin:p,broadcast:m}=e;o={legacyMeeting:{conversationId:t,messageId:a,rootMessageId:n,isChannel:i,isAdhoc:s,tenantId:r,organizerId:l,meetingCloud:d,registration:c,broadcast:m,participantPin:p}}}else{const{meetingCode:t,passcode:a,meetingUrl:n}=e.meetingData;o={meetingData:{participantPin:null==e?void 0:e.participantPin,meetingCode:t,passcode:a,meetingUrl:n}}}return{coordinates:o,joinOptions:{outgoingVideo:!1,outgoingAudio:!1,context:"DeepLink",meeting:{deeplinkId:t,showPrejoin:!0,isPSTN:!1,homeCloud:a,correlationId:n}},type:"Meeting"}},v=(e,t,a,n,i)=>({coordinates:{legacyMeeting:{conversationId:a,messageId:n,rootMessageId:"",isChannel:!1,isAdhoc:!1,tenantId:e,organizerId:t,meetingCloud:"",broadcast:null,registration:i?{participantRegistrationId:i,isPublic:!0}:null,instantMeetingOptions:null}},joinOptions:{outgoingVideo:!1,outgoingAudio:!1,context:"Meeting EmbedLink",meeting:{showPrejoin:!0,isPSTN:!1}},type:"Meeting"})},816772:(e,t,a)=>{a.d(t,{X:()=>n,si:()=>o,D:()=>s});const n="other";var i;function o(e){return!!i[e]}function s(){return Object.keys(i).filter((e=>isNaN(Number(e))))}!function(e){e[e["3mf"]=0]="3mf",e[e.cool=1]="cool",e[e.glb=2]="glb",e[e.gltf=3]="gltf",e[e.obj=4]="obj",e[e.stl=5]="stl",e[e.movie=6]="movie",e[e.pages=7]="pages",e[e.pict=8]="pict",e[e.sketch=9]="sketch",e[e.ai=10]="ai",e[e.pdf=11]="pdf",e[e.psb=12]="psb",e[e.psd=13]="psd",e[e["3g2"]=14]="3g2",e[e["3gp"]=15]="3gp",e[e.asf=16]="asf",e[e.bmp=17]="bmp",e[e.hevc=18]="hevc",e[e.m2ts=19]="m2ts",e[e.m4v=20]="m4v",e[e.mov=21]="mov",e[e.mp3=22]="mp3",e[e.mp4=23]="mp4",e[e.mp4v=24]="mp4v",e[e.mts=25]="mts",e[e.ts=26]="ts",e[e.wmv=27]="wmv",e[e.dwg=28]="dwg",e[e.fbx=29]="fbx",e[e.erf=30]="erf",e[e.zip=31]="zip",e[e["7z"]=32]="7z",e[e.z=33]="z",e[e.dcm=34]="dcm",e[e.dcm30=35]="dcm30",e[e.dicm=36]="dicm",e[e.dicom=37]="dicom",e[e.ply=38]="ply",e[e.hcp=39]="hcp",e[e.gif=40]="gif",e[e.heic=41]="heic",e[e.heif=42]="heif",e[e.jpeg=43]="jpeg",e[e.jpg=44]="jpg",e[e.jpe=45]="jpe",e[e.mef=46]="mef",e[e.mrw=47]="mrw",e[e.nef=48]="nef",e[e.nrw=49]="nrw",e[e.orf=50]="orf",e[e.pano=51]="pano",e[e.pef=52]="pef",e[e.png=53]="png",e[e.rw2=54]="rw2",e[e.spm=55]="spm",e[e.tif=56]="tif",e[e.tiff=57]="tiff",e[e.xbm=58]="xbm",e[e.xcf=59]="xcf",e[e.key=60]="key",e[e.csv=61]="csv",e[e.dic=62]="dic",e[e.doc=63]="doc",e[e.docm=64]="docm",e[e.docx=65]="docx",e[e.dot=66]="dot",e[e.dotm=67]="dotm",e[e.dotx=68]="dotx",e[e.pot=69]="pot",e[e.potm=70]="potm",e[e.potx=71]="potx",e[e.pps=72]="pps",e[e.ppsm=73]="ppsm",e[e.ppsx=74]="ppsx",e[e.ppt=75]="ppt",e[e.pptm=76]="pptm",e[e.pptx=77]="pptx",e[e.xd=78]="xd",e[e.xls=79]="xls",e[e.xlsb=80]="xlsb",e[e.xlsm=81]="xlsm",e[e.xlsx=82]="xlsx",e[e.sltx=83]="sltx",e[e.eml=84]="eml",e[e.msg=85]="msg",e[e.vsd=86]="vsd",e[e.vsdx=87]="vsdx",e[e.cur=88]="cur",e[e.ico=89]="ico",e[e.icon=90]="icon",e[e.epub=91]="epub",e[e.odp=92]="odp",e[e.ods=93]="ods",e[e.odt=94]="odt",e[e.arw=95]="arw",e[e.cr2=96]="cr2",e[e.crw=97]="crw",e[e.dng=98]="dng",e[e.rtf=99]="rtf",e[e.abap=100]="abap",e[e.ada=101]="ada",e[e.adp=102]="adp",e[e.ahk=103]="ahk",e[e.as=104]="as",e[e.as3=105]="as3",e[e.asc=106]="asc",e[e.ascx=107]="ascx",e[e.asm=108]="asm",e[e.asp=109]="asp",e[e.awk=110]="awk",e[e.bas=111]="bas",e[e.bash=112]="bash",e[e.bash_login=113]="bash_login",e[e.bash_logout=114]="bash_logout",e[e.bash_profile=115]="bash_profile",e[e.bashrc=116]="bashrc",e[e.bat=117]="bat",e[e.bib=118]="bib",e[e.bsh=119]="bsh",e[e.build=120]="build",e[e.builder=121]="builder",e[e.c=122]="c",e[e.capfile=123]="capfile",e[e.cbk=124]="cbk",e[e.cc=125]="cc",e[e.cfc=126]="cfc",e[e.cfm=127]="cfm",e[e.cfml=128]="cfml",e[e.cl=129]="cl",e[e.clj=130]="clj",e[e.cmake=131]="cmake",e[e.cmd=132]="cmd",e[e.coffee=133]="coffee",e[e.cpp=134]="cpp",e[e.cpt=135]="cpt",e[e.cpy=136]="cpy",e[e.cs=137]="cs",e[e.cshtml=138]="cshtml",e[e.cson=139]="cson",e[e.csproj=140]="csproj",e[e.css=141]="css",e[e.ctp=142]="ctp",e[e.cxx=143]="cxx",e[e.d=144]="d",e[e.ddl=145]="ddl",e[e.dif=146]="dif",e[e.diff=147]="diff",e[e.disco=148]="disco",e[e.dml=149]="dml",e[e.dtd=150]="dtd",e[e.dtml=151]="dtml",e[e.el=152]="el",e[e.emake=153]="emake",e[e.erb=154]="erb",e[e.erl=155]="erl",e[e.f90=156]="f90",e[e.f95=157]="f95",e[e.fluid=158]="fluid",e[e.fs=159]="fs",e[e.fsi=160]="fsi",e[e.fsscript=161]="fsscript",e[e.fsx=162]="fsx",e[e.gemfile=163]="gemfile",e[e.gemspec=164]="gemspec",e[e.gitconfig=165]="gitconfig",e[e.go=166]="go",e[e.groovy=167]="groovy",e[e.gvy=168]="gvy",e[e.h=169]="h",e[e.haml=170]="haml",e[e.handlebars=171]="handlebars",e[e.hbs=172]="hbs",e[e.hrl=173]="hrl",e[e.hs=174]="hs",e[e.htc=175]="htc",e[e.hxx=176]="hxx",e[e.idl=177]="idl",e[e.iim=178]="iim",e[e.inc=179]="inc",e[e.inf=180]="inf",e[e.ini=181]="ini",e[e.inl=182]="inl",e[e.ipp=183]="ipp",e[e.ipynb=184]="ipynb",e[e.irbrc=185]="irbrc",e[e.jade=186]="jade",e[e.jav=187]="jav",e[e.java=188]="java",e[e.jfif=189]="jfif",e[e.js=190]="js",e[e.json=191]="json",e[e.jsp=192]="jsp",e[e.jsx=193]="jsx",e[e.l=194]="l",e[e.less=195]="less",e[e.lhs=196]="lhs",e[e.lisp=197]="lisp",e[e.log=198]="log",e[e.lst=199]="lst",e[e.ltx=200]="ltx",e[e.lua=201]="lua",e[e.m=202]="m",e[e.make=203]="make",e[e.markdn=204]="markdn",e[e.mdown=205]="mdown",e[e.mkdn=206]="mkdn",e[e.ml=207]="ml",e[e.mli=208]="mli",e[e.mll=209]="mll",e[e.mly=210]="mly",e[e.mm=211]="mm",e[e.mud=212]="mud",e[e.nfo=213]="nfo",e[e.opml=214]="opml",e[e.osascript=215]="osascript",e[e.out=216]="out",e[e.p=217]="p",e[e.pas=218]="pas",e[e.patch=219]="patch",e[e.php=220]="php",e[e.php2=221]="php2",e[e.php3=222]="php3",e[e.php4=223]="php4",e[e.php5=224]="php5",e[e.pl=225]="pl",e[e.plist=226]="plist",e[e.pm=227]="pm",e[e.pod=228]="pod",e[e.pp=229]="pp",e[e.profile=230]="profile",e[e.properties=231]="properties",e[e.ps=232]="ps",e[e.ps1=233]="ps1",e[e.pt=234]="pt",e[e.py=235]="py",e[e.pyw=236]="pyw",e[e.r=237]="r",e[e.rake=238]="rake",e[e.rb=239]="rb",e[e.rbx=240]="rbx",e[e.rc=241]="rc",e[e.re=242]="re",e[e.readme=243]="readme",e[e.reg=244]="reg",e[e.rest=245]="rest",e[e.resw=246]="resw",e[e.resx=247]="resx",e[e.rhtml=248]="rhtml",e[e.rjs=249]="rjs",e[e.rprofile=250]="rprofile",e[e.rpy=251]="rpy",e[e.rss=252]="rss",e[e.rst=253]="rst",e[e.rxml=254]="rxml",e[e.s=255]="s",e[e.sass=256]="sass",e[e.scala=257]="scala",e[e.scm=258]="scm",e[e.sconscript=259]="sconscript",e[e.sconstruct=260]="sconstruct",e[e.script=261]="script",e[e.scss=262]="scss",e[e.sgml=263]="sgml",e[e.sh=264]="sh",e[e.shtml=265]="shtml",e[e.sml=266]="sml",e[e.sql=267]="sql",e[e.sty=268]="sty",e[e.tcl=269]="tcl",e[e.tex=270]="tex",e[e.text=271]="text",e[e.textile=272]="textile",e[e.tld=273]="tld",e[e.tli=274]="tli",e[e.tmpl=275]="tmpl",e[e.tpl=276]="tpl",e[e.txt=277]="txt",e[e.vb=278]="vb",e[e.vi=279]="vi",e[e.vim=280]="vim",e[e.wsdl=281]="wsdl",e[e.xaml=282]="xaml",e[e.xhtml=283]="xhtml",e[e.xoml=284]="xoml",e[e.xml=285]="xml",e[e.xsd=286]="xsd",e[e.xsl=287]="xsl",e[e.xslt=288]="xslt",e[e.yaml=289]="yaml",e[e.yaws=290]="yaws",e[e.yml=291]="yml",e[e.zsh=292]="zsh",e[e.htm=293]="htm",e[e.html=294]="html",e[e.markdown=295]="markdown",e[e.md=296]="md",e[e.url=297]="url",e[e.one=298]="one",e[e.note=299]="note",e[e.whiteboard=300]="whiteboard"}(i||(i={}))}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/463258-64cd8a883d954978.js.map