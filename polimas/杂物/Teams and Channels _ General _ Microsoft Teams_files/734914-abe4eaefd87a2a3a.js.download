(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[734914],{307526:(t,e,n)=>{"use strict";n.d(e,{F:()=>i});var r=n(58838);class i{constructor(t,e){this.value=t,this.piiKind=e}static isPIIValue(t){return!!t&&"string"!=typeof t&&void 0!==t.scrub}scrub(){return(0,r.sha256)(JSON.stringify(this.value))}}},467452:(t,e,n)=>{"use strict";n.d(e,{B:()=>i});var r=n(132756);function i(t){if(!t||"object"!=typeof t)return!1;const e=t;return e.code===r.jK.InvalidResponse&&"Discover"===e.context&&"regionGtm"===e.subContext}},595315:(t,e,n)=>{"use strict";var r,i;n.d(e,{V:()=>r}),function(t){t[t.BT_STOP=0]="BT_STOP",t[t.BT_STOP_BASE=1]="BT_STOP_BASE",t[t.BT_BOOL=2]="BT_BOOL",t[t.BT_UINT8=3]="BT_UINT8",t[t.BT_UINT16=4]="BT_UINT16",t[t.BT_UINT32=5]="BT_UINT32",t[t.BT_UINT64=6]="BT_UINT64",t[t.BT_FLOAT=7]="BT_FLOAT",t[t.BT_DOUBLE=8]="BT_DOUBLE",t[t.BT_STRING=9]="BT_STRING",t[t.BT_STRUCT=10]="BT_STRUCT",t[t.BT_LIST=11]="BT_LIST",t[t.BT_SET=12]="BT_SET",t[t.BT_MAP=13]="BT_MAP",t[t.BT_INT8=14]="BT_INT8",t[t.BT_INT16=15]="BT_INT16",t[t.BT_INT32=16]="BT_INT32",t[t.BT_INT64=17]="BT_INT64",t[t.BT_WSTRING=18]="BT_WSTRING",t[t.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"}(r||(r={})),function(t){t[t.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL",t[t.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL",t[t.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL",t[t.JSON_PROTOCOL=21322]="JSON_PROTOCOL",t[t.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL",t[t.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"}(i||(i={}))},447918:(t,e,n)=>{"use strict";n.d(e,{D:()=>r});class r{constructor(){this._buffer=[]}Add(t,e){-1==this._getIndex(t)&&this._buffer.push({Key:t,Value:e})}AddOrReplace(t,e){var n=this._getIndex(t);n>=0?this._buffer[n]={Key:t,Value:e}:this._buffer.push({Key:t,Value:e})}Remove(t){var e=this._getIndex(t);e>=0&&this._buffer.splice(e,1)}Count(){return this._buffer.length}GetBuffer(){return this._buffer}ContainsKey(t){return this._getIndex(t)>=0}Get(t){var e=this._getIndex(t);return e>=0?this._buffer[e].Value:null}_getIndex(t){for(var e=0,n=-1;e<this._buffer.length;++e)if(this._buffer[e].Key==t){n=e;break}return n}}},435098:(t,e,n)=>{"use strict";n.d(e,{ni:()=>s,zM:()=>a,Mr:()=>o,Pp:()=>u,KS:()=>c,rH:()=>l});var r=n(595315),i=n(878097);class s{constructor(t){this.low=0,this.high=0,this.low=parseInt(t),this.low<0&&(this.high=-1)}Equals(t){var e=new s(t);return this.low==e.low&&this.high==e.high}}class a{constructor(t){this.low=0,this.high=0,this.low=parseInt(t)}Equals(t){var e=new a(t);return this.low==e.low&&this.high==e.high}}class o{static ToByte(t){return this.ToUInt8(t)}static ToInt8(t){return 127&t|(128&t)<<24>>24}static ToInt16(t){return 32767&t|(32768&t)<<16>>16}static ToInt32(t){return 2147483647&t|2147483648&t}static ToUInt8(t){return 255&t}static ToUInt16(t){return 65535&t}static ToUInt32(t){return 4294967295&t}}class u{constructor(t){this.Message=t}}class c{static IsDataViewSupport(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView}}class l{constructor(t){this._stream=t}WriteBlob(t){this._stream.Write(t,0,t.length)}WriteBool(t){this._stream.WriteByte(t?1:0)}WriteContainerBegin(t,e){this.WriteUInt8(e),this.WriteUInt32(t)}WriteMapContainerBegin(t,e,n){this.WriteUInt8(e),this.WriteUInt8(n),this.WriteUInt32(t)}WriteContainerEnd(){}WriteDouble(t){var e=i.bh.GetBytes(t);this._stream.Write(e,0,e.length)}WriteFloat(t){var e=i.bv.GetBytes(t);this._stream.Write(e,0,e.length)}WriteFieldBegin(t,e,n){e<=5?this._stream.WriteByte(t|e<<5):e<=255?(this._stream.WriteByte(192|t),this._stream.WriteByte(e)):(this._stream.WriteByte(224|t),this._stream.WriteByte(e),this._stream.WriteByte(e>>8))}WriteFieldEnd(){}WriteFieldOmitted(t,e,n){}WriteInt16(t){t=i.if.EncodeZigzag16(t),this.WriteUInt16(t)}WriteInt32(t){t=i.if.EncodeZigzag32(t),this.WriteUInt32(t)}WriteInt64(t){this.WriteUInt64(i.if.EncodeZigzag64(t))}WriteInt8(t){this._stream.WriteByte(o.ToInt8(t))}WriteString(t){if(""==t)this.WriteUInt32(0);else{var e=i.di.GetBytes(t);this.WriteUInt32(e.length),this._stream.Write(e,0,e.length)}}WriteStructBegin(t,e){}WriteStructEnd(t){this.WriteUInt8(t?r.V.BT_STOP_BASE:r.V.BT_STOP)}WriteUInt16(t){var e=i.Km.GetBytes(o.ToUInt16(t));this._stream.Write(e,0,e.length)}WriteUInt32(t){var e=i.Km.GetBytes(o.ToUInt32(t));this._stream.Write(e,0,e.length)}WriteUInt64(t){var e=i.Ms.GetBytes(t);this._stream.Write(e,0,e.length)}WriteUInt8(t){this._stream.WriteByte(o.ToUInt8(t))}WriteWString(t){this.WriteUInt32(t.length);for(var e=0;e<t.length;++e){var n=t.charCodeAt(e);this._stream.WriteByte(n),this._stream.WriteByte(n>>>8)}}}},100836:(t,e,n)=>{"use strict";n.d(e,{P6:()=>c,A4:()=>s,WV:()=>d,Pm:()=>h,$L:()=>m});var r,i,s,a=n(435098),o=n(595315),u=n(447918);class c{static GetGuid(){var t=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5)};return[t(),t(),"-",t(),"-",t(),"-",t(),"-",t(),t(),t()].join("")}static GetTimeStamp(){var t=(new Date).getTime(),e=new a.ni("0");return e.low=4294967295&t,e.high=Math.floor(t/4294967296),e}static GetTimeStampWithValue(t){var e=new a.ni("0");return e.low=4294967295&t,e.high=Math.floor(t/4294967296),e}}!function(t){t[t.NotSet=0]="NotSet",t[t.Event=1]="Event",t[t.PerformanceCounter=2]="PerformanceCounter",t[t.Anomaly=3]="Anomaly",t[t.Prediction=4]="Prediction",t[t.TraceLog=5]="TraceLog",t[t.EventSourceLog=6]="EventSourceLog",t[t.HttpLog=7]="HttpLog",t[t.PerformanceCounterAzure=8]="PerformanceCounterAzure",t[t.PerformanceCounterGfs=9]="PerformanceCounterGfs"}(r||(r={})),function(t){t[t.NotSet=0]="NotSet",t[t.O365=1]="O365",t[t.SkypeBI=2]="SkypeBI",t[t.SkypeData=3]="SkypeData"}(i||(i={})),function(t){t[t.NotSet=0]="NotSet",t[t.DistinguishedName=1]="DistinguishedName",t[t.GenericData=2]="GenericData",t[t.IPV4Address=3]="IPV4Address",t[t.IPv6Address=4]="IPv6Address",t[t.MailSubject=5]="MailSubject",t[t.PhoneNumber=6]="PhoneNumber",t[t.QueryString=7]="QueryString",t[t.SipAddress=8]="SipAddress",t[t.SmtpAddress=9]="SmtpAddress",t[t.Identity=10]="Identity",t[t.Uri=11]="Uri",t[t.Fqdn=12]="Fqdn",t[t.IPV4AddressLegacy=13]="IPV4AddressLegacy",t[t.FilePath=14]="FilePath"}(s||(s={}));class l{constructor(){this.ScrubType=i.NotSet,this.Kind=s.NotSet,this.RawContent=""}Write(t){this.WriteImpl(t,!1)}WriteImpl(t,e){t.WriteStructBegin(null,e),this.ScrubType!=i.NotSet?(t.WriteFieldBegin(o.V.BT_INT32,1,null),t.WriteInt32(this.ScrubType),t.WriteFieldEnd()):t.WriteFieldOmitted(o.V.BT_INT32,1,null),this.Kind!=s.NotSet?(t.WriteFieldBegin(o.V.BT_INT32,2,null),t.WriteInt32(this.Kind),t.WriteFieldEnd()):t.WriteFieldOmitted(o.V.BT_INT32,2,null),""!=this.RawContent?(t.WriteFieldBegin(o.V.BT_STRING,3,null),t.WriteString(this.RawContent),t.WriteFieldEnd()):t.WriteFieldOmitted(o.V.BT_STRING,3,null),t.WriteStructEnd(e)}Read(t){this.ReadImpl(t,!1)}ReadImpl(t,e){}}class d{constructor(){this.Id=c.GetGuid(),this.Timestamp=c.GetTimeStamp(),this.Type="",this.EventType="",this.Extension=new u.D,this.RecordType=r.NotSet,this.PIIExtensions=new u.D}AddOrReplacePII(t,e,n){var r=new l;r.RawContent=e,r.Kind=n,r.ScrubType=i.O365,this.PIIExtensions.AddOrReplace(t,r)}Write(t){this.WriteImpl(t,!1)}WriteImpl(t,e){if(t.WriteStructBegin(null,e),""!=this.Id?(t.WriteFieldBegin(o.V.BT_STRING,1,null),t.WriteString(this.Id),t.WriteFieldEnd()):t.WriteFieldOmitted(o.V.BT_STRING,1,null),this.Timestamp.Equals("0")?t.WriteFieldOmitted(o.V.BT_INT64,3,null):(t.WriteFieldBegin(o.V.BT_INT64,3,null),t.WriteInt64(this.Timestamp),t.WriteFieldEnd()),""!=this.Type?(t.WriteFieldBegin(o.V.BT_STRING,5,null),t.WriteString(this.Type),t.WriteFieldEnd()):t.WriteFieldOmitted(o.V.BT_STRING,5,null),""!=this.EventType?(t.WriteFieldBegin(o.V.BT_STRING,6,null),t.WriteString(this.EventType),t.WriteFieldEnd()):t.WriteFieldOmitted(o.V.BT_STRING,6,null),this.Extension.Count()){t.WriteFieldBegin(o.V.BT_MAP,13,null),t.WriteMapContainerBegin(this.Extension.Count(),o.V.BT_STRING,o.V.BT_STRING);for(var n=0;n<this.Extension.GetBuffer().length;++n)t.WriteString(this.Extension.GetBuffer()[n].Key),t.WriteString(this.Extension.GetBuffer()[n].Value);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(o.V.BT_MAP,13,null);if(this.RecordType!=r.NotSet?(t.WriteFieldBegin(o.V.BT_INT32,24,null),t.WriteInt32(this.RecordType),t.WriteFieldEnd()):t.WriteFieldOmitted(o.V.BT_INT32,24,null),this.PIIExtensions.Count()){t.WriteFieldBegin(o.V.BT_MAP,30,null),t.WriteMapContainerBegin(this.PIIExtensions.Count(),o.V.BT_STRING,o.V.BT_STRUCT);for(var i=0;i<this.PIIExtensions.GetBuffer().length;++i)t.WriteString(this.PIIExtensions.GetBuffer()[i].Key),this.PIIExtensions.GetBuffer()[i].Value.WriteImpl(t,!1);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(o.V.BT_MAP,30,null);t.WriteStructEnd(e)}Read(t){this.ReadImpl(t,!1)}ReadImpl(t,e){}}class h{constructor(){this.Source="",this.DataPackageId="",this.Timestamp=new a.ni("0"),this.Records=[]}Write(t){this.WriteImpl(t,!1)}WriteImpl(t,e){if(t.WriteStructBegin(null,e),""!=this.Source?(t.WriteFieldBegin(o.V.BT_STRING,2,null),t.WriteString(this.Source),t.WriteFieldEnd()):t.WriteFieldOmitted(o.V.BT_STRING,2,null),""!=this.DataPackageId?(t.WriteFieldBegin(o.V.BT_STRING,5,null),t.WriteString(this.DataPackageId),t.WriteFieldEnd()):t.WriteFieldOmitted(o.V.BT_STRING,5,null),this.Timestamp.Equals("0")?t.WriteFieldOmitted(o.V.BT_INT64,6,null):(t.WriteFieldBegin(o.V.BT_INT64,6,null),t.WriteInt64(this.Timestamp),t.WriteFieldEnd()),this.Records.length){t.WriteFieldBegin(o.V.BT_LIST,8,null),t.WriteContainerBegin(this.Records.length,o.V.BT_STRUCT);for(var n=0;n<this.Records.length;++n)this.Records[n].WriteImpl(t,!1);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(o.V.BT_LIST,8,null);t.WriteStructEnd(e)}Read(t){this.ReadImpl(t,!1)}ReadImpl(t,e){}}class m{constructor(){this.DataPackages=[],this.RequestRetryCount=0}Write(t){this.WriteImpl(t,!1)}WriteImpl(t,e){if(t.WriteStructBegin(null,e),this.DataPackages.length){t.WriteFieldBegin(o.V.BT_LIST,1,null),t.WriteContainerBegin(this.DataPackages.length,o.V.BT_STRUCT);for(var n=0;n<this.DataPackages.length;++n)this.DataPackages[n].WriteImpl(t,!1);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(o.V.BT_LIST,1,null);0!=this.RequestRetryCount?(t.WriteFieldBegin(o.V.BT_INT32,2,null),t.WriteInt32(this.RequestRetryCount),t.WriteFieldEnd()):t.WriteFieldOmitted(o.V.BT_INT32,2,null),t.WriteStructEnd(e)}Read(t){this.ReadImpl(t,!1)}ReadImpl(t,e){}}},681145:(t,e,n)=>{"use strict";var r;n.d(e,{T:()=>r}),function(t){t.Chat="chat",t.Community="community",t.Meeting="meeting",t.OneOnOne="1on1",t.PhoneChat="phonechat",t.Phonelink1on1Chat="phonelink1on1chat",t.PhonelinkGroupChat="phonelinkgroupchat",t.SfbInteropChat="sfbinteropchat",t.Team="space",t.Topic="topic",t.StreamOfNotifications="streamofnotifications",t.StreamOfCalllogs="streamofcalllogs",t.StreamOfSharedCalllogs="streamofsharedcalllogs",t.StreamOfBookmarks="streamofbookmarks",t.StreamOfNotes="streamofnotes",t.StreamOfDrafts="streamofdrafts",t.SubCommunity="subcommunity"}(r||(r={}))},711676:(t,e,n)=>{"use strict";n.d(e,{ab:()=>U,_W:()=>M,WD:()=>w,Q5:()=>L,dV:()=>k,mh:()=>D,W7:()=>G,Q_:()=>V,Nl:()=>x,Cq:()=>J,tj:()=>H,oJ:()=>K,zD:()=>$,lp:()=>q,lr:()=>j,mr:()=>Q,mJ:()=>z,IM:()=>Y,vX:()=>X,m:()=>Z,vC:()=>tt,y:()=>et,Fd:()=>nt,Q2:()=>rt,EG:()=>st,$i:()=>at,xn:()=>ot,_c:()=>ut,o_:()=>ct,P5:()=>lt,tv:()=>ht,uY:()=>mt,zH:()=>Tt,iK:()=>St,PA:()=>ft,Ue:()=>pt,Vq:()=>gt,ml:()=>Wt,bl:()=>yt,W9:()=>It,y2:()=>Bt,s5:()=>vt,$6:()=>Ct,cQ:()=>_t,eF:()=>Pt,Jl:()=>Ot,yj:()=>Nt,MR:()=>bt,vq:()=>Rt,Q:()=>Ft,tL:()=>At,TV:()=>Ut,eZ:()=>Mt,kz:()=>Et,B4:()=>wt,YQ:()=>Lt,mA:()=>kt,Kt:()=>Dt,i4:()=>Gt,y1:()=>xt,pu:()=>Jt,gs:()=>Ht,lh:()=>Kt,eb:()=>$t,n:()=>qt,gu:()=>jt,j6:()=>Qt,u5:()=>zt,fP:()=>Yt,nN:()=>Xt,o7:()=>Zt,e9:()=>te,ug:()=>ee,WA:()=>ne,SL:()=>re,kw:()=>se,eX:()=>ae,_K:()=>oe,Bj:()=>ue,aP:()=>ce});var r=n(114881),i=n(100836),s=n(307526),a=n(74583),o=n(863553),u=n(760005),c=n(681145),l=n(500396),d=n(50805),h=n(919567);const m=400,T=500,S=3,f="unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com",p=u.at.SkypeSpacesUser+u.f0,g=u.at.SkypeSpacesUser+u.pW,W=u.at.SkypeSpacesUser+u.iO,y=u.at.SkypeSpacesUser+u.Md,I=u.at.SkypeSpacesUser+u.Dr,B=u.at.SkypeSpacesUser+u.Mt,v=u.at.SkypeSpacesUser+u.TO,C=u.at.SkypeSpacesUser+u.ng,_=u.at.SkypeSpacesUser+u.pk,P=u.at.SkypeSpacesUser+u.Fp,O=u.at.SkypeSpacesUser+u.P_,N=u.at.SkypeSpacesUser+u.cz,b="tfl:",R=u.at.SkypeSpacesUser+b,F="sfc:",A=u.at.SkypeSpacesUser+F,U="receiverSfB",M="Text";function E(t,e){return!!t&&t.startsWith(e)}function w(t){return t>=m&&t<T}function L(t,e){return E(t,u.at.SkypeSpacesThread)||E(t,u.at.PhonelinkSmsPrefix)||D(t,e)}function k(t){return E(t,u.at.PrivateFeed)}function D(t,e){return k(t)||E(e,u.rf)}function G(t=""){const e=/syncState=([^&]+)/;let n;return t&&e.test(t)&&(n=t.match(e)[1]),n}function V(t){return-1!==u.$H.indexOf(t)}function x(t){if(!t||!t.startsWith(u.IK))return!1;const e=t.split(":");return!!(2===e.length||3===e.length&&V(e[1]))}function J(t){return!!t&&t.startsWith(R)}function H(t){return!!t&&t.startsWith(A)}function K(t){return t&&J(t)?t.replace(b,""):t}function $(t){return t&&H(t)?t.replace(F,""):t}function q(t){return!!t&&(Q(t)||et(t)||x(t)||t.startsWith(R)||z(t)||Y(t)||X(t)||Z(t)||tt(t))}function j(t){return!!t&&t.startsWith(g)}function Q(t){return!!t&&(t.startsWith(p)||t.startsWith(g))}function z(t){return!!t&&(t.startsWith(W)||t.startsWith(y))}function Y(t){return!!t&&(t.startsWith(I)||t.startsWith(B))}function X(t){return!!t&&(t.startsWith(v)||t.startsWith(C))}function Z(t){return!!t&&(t.startsWith(_)||t.startsWith(P))}function tt(t){return!!t&&(t.startsWith(O)||t.startsWith(N))}function et(t){return!!t&&(t.startsWith(u.dT)||t.startsWith(u.dG)||t.startsWith(u.Sj))}function nt(t){return!!t&&(Q(t)||z(t)||Y(t)||X(t)||Z(t)||tt(t))}function rt(t){if((0,a.isString)(t)&&!(0,a.isEmpty)(t)){if(st(t))return it("PSTN",t,i.A4.PhoneNumber);if(x(t)||at(t))return it("SfC",t,i.A4.Identity)}return t}const it=(t,e,n)=>`${t}-${new s.F(e,n).scrub()}`;function st(t){return!!t&&0===t.indexOf(u.at.Pstn)}function at(t){return!!t&&t.startsWith(u.Pc)}function ot(t){return Boolean(t===f||t===u.j2)}function ut(t,e){let n=t;return e&&(n=[t,u.XM,e].join("")),n}function ct(t){return Dt((0,o.F)(t.conversationLink)).conversationId}function lt(t){if(!t||!t.conversationLink)throw TypeError("Chat-Service-Utils: Missing conversationLink");const e=Dt((0,a.last)(t.conversationLink.split("/"))||"");return e.isValid?e.itemId:t.id}function dt(t){const e=Number(t);return!e||e<u.hV}function ht(t){const{properties:e}=t;if(!e)return;const n=e[u.BM.EditTime];return n?Number(n):void 0}function mt(t){const{properties:e}=t;if(!e)return;const n=e[u.BM.DeleteTime];return n?Number(n):void 0}function Tt(t){const{properties:e}=t;if(!e)return;const n=e[u.BM.HardDeleteTime];return n?Number(n):void 0}function St(t,e,n){const r=t;if(e&&(e[u.Q5.ExtensionDefinitionContainer]||e[u.Q5.P2PChatUniqueRosterThread]&&r&&r.length>2)){const{members:e,botMembers:r}=ft(t,n);return{members:e,botMembers:r}}return{members:r,botMembers:[]}}function ft(t,e){if(t&&t.length>2){const n=(0,a.partition)(t,(t=>!yt(t.id)||e&&e.indexOf(t.id)>-1));return{members:n[0],botMembers:n[1]}}return{members:t,botMembers:[]}}const pt=t=>!!t&&t.startsWith(u.eA),gt=t=>!!t&&(t.startsWith(u.dT)||t.startsWith(u.dG)||t.startsWith(u.eA)||t.startsWith(u.q0)||t.startsWith(u.Y3)||t.startsWith(u.aJ)),Wt=(t,e)=>{if(!t)return!1;const n=et(t);if(n)return n;const r=t.startsWith(u.Sj);return!e&&r};function yt(t){return!!t&&(!t.startsWith(u.GE.VoiceAppPrefix)&&(t.startsWith(u.at.BotPrefix)||t.startsWith(u.GE.BotPrefixOld)))}const It=(t,e)=>{if(!e)return!1;const{m365ChatBotIds:n}=t.get(d.J.Messaging);return!(!yt(e)||!(null==n?void 0:n.includes(e)))},Bt=(t,e)=>{if(!e)return!1;const{m365ChatBotIds:n}=t.get(d.J.Messaging);return!!e.some((t=>null==n?void 0:n.includes(t)))},vt=(t,e)=>{const{enableM365ChatBot:n}=t.get(d.J.Messaging);return!n&&Bt(t,e)},Ct=t=>{const{m365ChatBotIds:e}=t.get(d.J.Messaging);if(e)return e.find((t=>"28:914d3be7-0ff0-4da7-ac61-4dab62e6e076"===t))},_t=t=>!!t&&t.startsWith(u.kR),Pt=t=>t&&t.split(":")[3]||"",Ot=t=>t&&t.startsWith(u.EI)||!1,Nt=t=>!!t&&t.startsWith(u.B_),bt=t=>t&&t.startsWith(u.VJ)||!1,Rt=t=>t&&t.split(":")[2]||"",Ft=t=>x(t)&&!t.startsWith(R)?t.replace(u.at.SkypeSpacesUser,u.at.SkypeSpacesUser+b):t,At=t=>x(t)&&!t.startsWith(A)?t.replace(u.at.SkypeSpacesUser,u.at.SkypeSpacesUser+F):t,Ut=(t,e=u.Jq)=>q(t)||yt(t)||st(t)||wt(t,e)||Nt(t)||bt(t),Mt=t=>q(t)&&!gt(t),Et=t=>{const e=Number(t),n=Date.now()+30*h.Zd;return 0!==e&&!isNaN(e)&&e<n},wt=(t,e)=>{if(!t)return!1;const n=u.at.BotPrefix+e;return t.startsWith(n)};function Lt(t){return!!yt(t)&&u.BB.InterceptorBotMris.some((e=>e===t))}function kt(t){return!!t&&t.includes(u.ep)}function Dt(t){if(!t)return{isValid:!1,conversationId:"",itemId:""};const e=t.split(";");if(1===e.length)return{isValid:!1,conversationId:e[0],itemId:""};if(2!==e.length||0!==e[1].indexOf(u.ep)||e[1].indexOf(u.Jh)>-1)return{isValid:!1,conversationId:"",itemId:""};const n=e[1].substr(u.ep.length);return{isValid:!dt(n),conversationId:e[0],itemId:n}}function Gt(t){switch(t){case c.T.Team:case c.T.Community:return u.i1.Team;case c.T.Topic:case c.T.SubCommunity:return u.i1.Topic;case c.T.SfbInteropChat:case c.T.Chat:return u.i1.Chat;case c.T.Meeting:return u.i1.Meeting;case c.T.PhoneChat:return u.i1.PhoneChat;case c.T.Phonelink1on1Chat:return u.i1.Phonelink1on1Chat;case c.T.PhonelinkGroupChat:return u.i1.PhonelinkGroupChat;default:return u.i1.Thread}}function Vt(t){const{properties:e}=t;return e&&e[u.BM.Importance]?e[u.BM.Importance]:u.fA.NORMAL}function xt(t){return Vt(t)===u.fA.HIGH}function Jt(t){return Vt(t)===u.fA.URGENT}function Ht(t){return(0,a.includes)(u.lZ,t.messagetype)}function Kt(t){switch(t){case l.UB.Admin:return u.nL.Admin;case l.UB.Guest:return u.nL.Guest;case l.UB.User:return u.nL.User;case l.UB.Shadow:return u.nL.Shadow;case l.UB.Undefined:default:return u.nL.None}}const $t=(t,e)=>{if(t){const n=t[u.BM.Emotions],r=n&&(0,a.find)(n,{key:"star"}),i=r&&r.users;if(i)return!!(0,a.some)(i,{mri:e})}return!1},qt=({resourceType:t,resource:e})=>{switch(t){case"NewMessage":case"MessageUpdate":return e.conversationid||ct(e);case"ThreadUpdate":case"ConversationUpdate":return e.id;case u.tw.CommentStreamLie:case u.tw.NewLiveMessages:case u.tw.LiveMessageUpdates:return e.conversationId;default:return}},jt=({resourceType:t,resource:e})=>{switch(t){case"NewMessage":case"MessageUpdate":return lt(e);default:return}},Qt=t=>t===c.T.StreamOfNotifications,zt=t=>t===c.T.StreamOfCalllogs||t===c.T.StreamOfSharedCalllogs,Yt=t=>t===c.T.StreamOfDrafts,Xt=t=>t===c.T.StreamOfNotes,Zt=t=>{var e;if(!t)return"";if((0,a.isString)(t)){const e=t;return 0===e.lastIndexOf(u.IK,0)||0===e.lastIndexOf(u.at.BotPrefix,0)||st(e)||Nt(e)||bt(e)?e:u.IK+e}return null!==(e=(0,a.first)(t.mris))&&void 0!==e?e:""},te=t=>(null==t?void 0:t.startsWith(u.PA))||(null==t?void 0:t.startsWith(u.vd))||(null==t?void 0:t.startsWith(u.sR));function ee(t){if(!t)return!1;if(!t.startsWith(u.IK))return!1;return(t.startsWith(p)||t.startsWith(W)||t.startsWith(I)||t.startsWith(_)||t.startsWith(v)||t.startsWith(O))&&t.split(":").length===S}const ne=t=>{const{enableTfwTflFederation:e}=t.get(d.J.Messaging),{enableGuardiansChat:n}=t.get(d.J.Guardians),{licenseType:r}=t.get(d.J.UserResources);return!!(e||n&&ie(r))},re=t=>{const{enablePhonelinkSms:e}=t.get(d.J.PhonelinkSms),{phoneLinkingBlocked:n}=t.get(d.J.HostCapabilities);return!!e&&!n},ie=t=>"Teacher"===t,se=t=>{if(!(null==t?void 0:t.sendAt))return;const e=Number(t.sendAt);return isNaN(e)?new Date(t.sendAt).getTime():e},ae=t=>!!t&&(t.includes(u.oz)||t.endsWith(u.b$.FederatedGatewayChat)||t.endsWith(u.b$.OnPremFederatedGatewayChat)),oe=(t,e,n,r,i)=>{const s=t&&t.includes(u.L$),a=null==i?void 0:i.some((t=>x(t)));return s||!(e||!n||!r||a)},ue=(t,e)=>`${t};messageid=${e}`,ce=(t,e)=>Object.assign(Object.assign({},e?{draftDetails:{sendAt:new Date(e).getTime().toString()},draftType:r.dP.ScheduledDraft}:{draftType:r.dP.RoamedDraft}),{innerThreadId:t})},114881:(t,e,n)=>{"use strict";n.d(e,{dP:()=>r,mU:()=>i,qN:()=>s,iv:()=>a,vO:()=>u,VS:()=>d,f1:()=>h,b:()=>m});var r,i,s,a,o,u,c,l=n(760005);!function(t){t.ScheduledDraft="ScheduledDraft",t.RoamedDraft="RegularDraft"}(r||(r={})),function(t){t.TemplateId="basic_forward_message_template",t.ForwardedContentStart='<blockquote itemtype="http://schema.skype.com/Forward">',t.ForwardedContentEnd="</blockquote>"}(i||(i={})),function(t){t[t.Sync=1]="Sync",t[t.LongPoll=2]="LongPoll",t[t.SfB=3]="SfB",t[t.SyncRelated=4]="SyncRelated",t[t.Local=5]="Local",t[t.CSAReplyChain=6]="CSAReplyChain",t[t.DeltaSync=7]="DeltaSync",t[t.SyncOnDemandFromLongpoll=8]="SyncOnDemandFromLongpoll",t[t.AdHocPropertyUpdate=9]="AdHocPropertyUpdate"}(s||(s={})),function(t){t[t.Sending=0]="Sending",t[t.Delivered=1]="Delivered",t[t.Received=2]="Received",t[t.Error=3]="Error",t[t.Deleted=4]="Deleted"}(a||(a={})),function(t){t[t.Muted=0]="Muted",t[t.Simple=1]="Simple",t[t.Important=2]="Important",t[t.Mentioned=3]="Mentioned"}(o||(o={})),function(t){t[t.StartupSyncClean=1]="StartupSyncClean",t[t.StartupSyncUpdate=2]="StartupSyncUpdate",t[t.ThreadDetailsSync=3]="ThreadDetailsSync",t[t.LongPoll=4]="LongPoll",t[t.ResolverPutConversation=5]="ResolverPutConversation",t[t.LocalUpdate=6]="LocalUpdate",t[t.PutConversationLie=7]="PutConversationLie",t[t.AddUsersToConversation=8]="AddUsersToConversation",t[t.ConversationFetchJob=9]="ConversationFetchJob",t[t.GroupChatsStartupJob=10]="GroupChatsStartupJob",t[t.OneToOneChatFetchJob=11]="OneToOneChatFetchJob",t[t.NonRecentChatsStartupJob=12]="NonRecentChatsStartupJob",t[t.NonRecentChatsStartupRetryJob=13]="NonRecentChatsStartupRetryJob"}(u||(u={}));class d{}d.NotificationConversationId=`${l.at.PrivateFeed}notifications`,d.StarredConversationId=`${l.at.PrivateFeed}starred`,d.CallLogConversationId=`${l.at.PrivateFeed}calllogs`,d.SharedCallLogConversationId=`${l.at.PrivateFeed}sharedcalllogs`,d.AnnotationsConversationId=`${l.at.PrivateFeed}annotations`,function(t){t[t.Message=0]="Message"}(c||(c={}));const h="x-ms-request-priority";var m;!function(t){t[t.RealTimeSync=0]="RealTimeSync",t[t.ForegroundSync=10]="ForegroundSync",t[t.BackgroundSync=20]="BackgroundSync"}(m||(m={}))},500396:(t,e,n)=>{"use strict";n.d(e,{wC:()=>c,N:()=>l,ge:()=>d,cU:()=>h,$C:()=>m,E$:()=>T,dW:()=>S,AL:()=>f,x6:()=>p,F3:()=>g,aO:()=>W,Be:()=>y,$_:()=>I,ex:()=>B,Ky:()=>C,LC:()=>_,D2:()=>P,bn:()=>N,TU:()=>b,aX:()=>R,cL:()=>F,sv:()=>A,Oi:()=>U,C9:()=>M,B5:()=>E,eU:()=>w,tG:()=>k,yt:()=>D,s8:()=>G,jK:()=>V,zW:()=>x,UB:()=>J,XI:()=>H,Wr:()=>K,RQ:()=>$,m1:()=>q,xu:()=>j,Vn:()=>Q,wJ:()=>z,fD:()=>Y,uN:()=>X,mr:()=>Z,eO:()=>tt,iO:()=>et,gB:()=>nt,k2:()=>rt,AO:()=>it,lT:()=>st,A6:()=>at,YF:()=>ot,FG:()=>ut,kN:()=>lt,SR:()=>dt,lR:()=>ht});var r=n(740597),i=n(50805),s=n(467452),a=n(223005),o=n(575644),u=n(558632);const c=1,l=200,d=1,h=2,m=0;var T,S,f;!function(t){t.HighlightOverview1Day="HighlightOverview1Day",t.HighlightOverview7days="HighlightOverview7Days",t.HighlightOverview30Days="HighlightOverview30Days",t.HighlightCatchUp="HighlightCatchUp",t.ActionItems="ActionItems",t.Decision="Decision",t.OpenItems="OpenItems",t.MainTopics="MainTopics",t.SuggestedQuestions="SuggestedQuestions",t.FreeText="Q&A",t.Questions="Questions",t.Summary="Summary"}(T||(T={})),function(t){t[t.UserFilter=0]="UserFilter",t[t.ActionItems=4]="ActionItems",t[t.Decision=5]="Decision",t[t.OpenItems=6]="OpenItems",t[t.MainTopics=7]="MainTopics",t[t.SuggestedQuestions=8]="SuggestedQuestions"}(S||(S={})),function(t){t[t.OneDay=1]="OneDay",t[t.SevenDays=7]="SevenDays",t[t.ThirtyDays=30]="ThirtyDays"}(f||(f={}));const p="api/v1/",g="api/v2/",W="api/v3/",y=12e4,I=12e4,B="https://chatsvcagg.teams.microsoft.com",v="https://chatsvcagg-tfl.teams.microsoft.com/user_impersonation",C="https://teams.microsoft.com/api/csa",_={startupclean:"teams/users/me",startupdelta:"teams/users/me/updates",startupgroupchats:"teams/users/me/groupchats",startupnonrecentchats:"teams/users/me/nonrecentchats",startupcleananonymous:"teams/users/anonymous",startupdeltaanonymous:"teams/users/anonymous/updates"},P="xx",O=12e4,N=100,b=50,R=50,F=50,A=6e5,U=12e4;var M,E,w,L,k,D,G,V,x,J,H,K,$,q,j;!function(t){t[t.Standard=0]="Standard",t[t.Edu=1]="Edu",t[t.Class=2]="Class",t[t.Plc=3]="Plc",t[t.Staff=4]="Staff",t[t.HealthcareCareCoordination=5]="HealthcareCareCoordination",t[t.Community=6]="Community"}(M||(M={})),function(t){t.None="none",t.Owners="owners",t.Members="members",t.OwnersAndMembers="ownersAndMembers"}(E||(E={})),function(t){t[t.None=0]="None",t[t.Private=1]="Private",t[t.Secret=2]="Secret",t[t.Public=3]="Public",t[t.HiddenMembership=4]="HiddenMembership",t[t.Unknown=5]="Unknown",t[t.All=6]="All"}(w||(w={})),function(t){t[t.InProgress=0]="InProgress",t[t.Success=1]="Success",t[t.Error=2]="Error"}(L||(L={})),function(t){t[t.None=0]="None",t[t.Private=1]="Private",t[t.TenantWide=2]="TenantWide",t[t.Shared=4]="Shared",t[t.Standalone=9]="Standalone"}(k||(k={})),function(t){t[t.Everyone=0]="Everyone",t[t.Moderators=1]="Moderators"}(D||(D={})),function(t){t[t.Everyone=0]="Everyone",t[t.Moderators=1]="Moderators"}(G||(G={})),function(t){t[t.NotAllowed=0]="NotAllowed",t[t.Allowed=1]="Allowed"}(V||(V={})),function(t){t[t.NotAllowed=0]="NotAllowed",t[t.Allowed=1]="Allowed"}(x||(x={})),function(t){t[t.Undefined=0]="Undefined",t[t.User=1]="User",t[t.Admin=2]="Admin",t[t.Guest=3]="Guest",t[t.Shadow=4]="Shadow"}(J||(J={})),function(t){t[t.Everyone=0]="Everyone",t[t.Moderators=1]="Moderators",t[t.EveryoneButGuests=2]="EveryoneButGuests"}(H||(H={})),function(t){t[t.Unknown=-1]="Unknown",t[t.Private=1]="Private",t[t.Channel=2]="Channel"}(K||(K={})),function(t){t[t.AnyonePost=0]="AnyonePost",t[t.AnyoneWithWarning=1]="AnyoneWithWarning",t[t.OwnersPost=2]="OwnersPost"}($||($={})),function(t){t[t.Strict=0]="Strict",t[t.Moderate=1]="Moderate",t[t.NoRestriction=2]="NoRestriction"}(q||(q={})),function(t){t[t.Standard=0]="Standard",t[t.Private=1]="Private",t[t.Shared=4]="Shared",t[t.Standalone=9]="Standalone"}(j||(j={}));const Q={Single:0,0:"Single",Occurrence:1,1:"Occurrence",Exception:2,2:"Exception",RecurringMaster:3,3:"RecurringMaster"};var z,Y,X,Z,tt,et,nt;!function(t){t[t.None=0]="None",t[t.Adhoc=1]="Adhoc",t[t.Scheduled=2]="Scheduled",t[t.Recurring=3]="Recurring",t[t.Broadcast=4]="Broadcast",t[t.MeetNow=5]="MeetNow"}(z||(z={})),function(t){t[t.None=0]="None",t[t.Daily=1]="Daily",t[t.Weekly=2]="Weekly",t[t.Monthly=3]="Monthly",t[t.RelativeMonthly=4]="RelativeMonthly",t[t.Yearly=5]="Yearly",t[t.RelativeYearly=6]="RelativeYearly"}(Y||(Y={})),function(t){t[t.First=0]="First",t[t.Second=1]="Second",t[t.Third=2]="Third",t[t.Fourth=3]="Fourth",t[t.Last=4]="Last"}(X||(X={})),function(t){t[t.January=1]="January",t[t.February=2]="February",t[t.March=3]="March",t[t.April=4]="April",t[t.May=5]="May",t[t.June=6]="June",t[t.July=7]="July",t[t.August=8]="August",t[t.September=9]="September",t[t.October=10]="October",t[t.November=11]="November",t[t.December=12]="December"}(Z||(Z={})),function(t){t[t.Sunday=0]="Sunday",t[t.Monday=1]="Monday",t[t.Tuesday=2]="Tuesday",t[t.Wednesday=3]="Wednesday",t[t.Thursday=4]="Thursday",t[t.Friday=5]="Friday",t[t.Saturday=6]="Saturday"}(tt||(tt={})),function(t){t[t.First=0]="First",t[t.Second=1]="Second",t[t.Third=2]="Third",t[t.Fourth=3]="Fourth",t[t.Last=4]="Last"}(et||(et={})),function(t){t[t.None=0]="None",t[t.Sfb=1]="Sfb"}(nt||(nt={}));const rt={Meeting:1,1:"Meeting",None:0,0:"None",Channel:2,2:"Channel"};var it,st,at,ot,ut;!function(t){t[t.Success=0]="Success",t[t.TranslationFailed=1]="TranslationFailed",t[t.MessageNotFound=2]="MessageNotFound",t[t.VersionNotFound=3]="VersionNotFound",t[t.SkipTranslation=4]="SkipTranslation",t[t.ContentIsEmpty=5]="ContentIsEmpty",t[t.LanguageDetectionFailed=6]="LanguageDetectionFailed",t[t.UnsupportedSourceLanguage=7]="UnsupportedSourceLanguage",t[t.UnknownError=10]="UnknownError"}(it||(it={})),function(t){t.Badges="badges",t.Chat="chat",t.ChatMessages="chatmessages",t.ChatMessage="chatmessage",t.Chats="chats",t.ChatsV2="chats_v2",t.ChatsV3="chats_v3",t.ChatsByTitle="chatsByTitle",t.ChatSummarization="chatSummarization",t.ChatSummarizationV2="chatSummarizationV2",t.ChatSmartNavigator="chatSmartNavigator",t.ChatWithUser="chatwithuser",t.ConversationFolders="conversationFolders",t.CrossPost="crosspost",t.GetPost="getPost",t.GetSupportedTranslationLanguages="getSupportedTranslationLanguages",t.PostAuthors="postAuthors",t.ReplyChain="replychain",t.ReplyChains="replychains",t.ReplyChainsV2="replychains_v2",t.RepliesInChain="repliesInChain",t.StartupGroupChats="startupgroupchats",t.StartupNonRecentChats="startupnonrecentchats",t.ScheduleMessage="schedulemessage",t.SystemMessages="systemmessages",t.Teams="teams",t.TranslateMessages="translatemessages",t.Phonelink="phonelink",t.PinnedChannels="pinnedChannels",t.PinnedPost="pins",t.PinPost="pinPost",t.UnpinPost="unpinPost",t.Parents="parents"}(st||(st={})),function(t){t.ContentType="content-type",t.XChatserviceEndpoint="x-csendpoint",t.XClientUiLanguage="x-client-ui-language",t.XRequestPriority="x-ms-request-priority",t.XDbFastFailed="x-ms-db-fast-failed"}(at||(at={})),function(t){t.SharedChannel="sharedchannel",t.PrivateChannel="privatechannel",t.Unknown=""}(ot||(ot={})),function(t){t[t.Embed=4]="Embed"}(ut||(ut={}));const ct=(t,e,n)=>(0,r.__awaiter)(void 0,void 0,void 0,(function*(){const r=t.regionGtm("chatSvcAggAfd");return(0,o.E)(r,e,a.A.BaseUrlTimeout).catch((t=>{var e;const r=(0,s.B)(t),i=(0,o.T)(t),a=n.newLogger("getCSAHostFromGtm","core-cdl-worker-services");null===(e=a.errorToTelemetry)||void 0===e||e.call(a,`Failed to resolve CSA host from Gtm. isMissingFromGtm:${r}, isTimedOut:${i}. message:'${null==t?void 0:t.message}'`,"cdl_sync_csa_host_resolution_failed_from_gtm",void 0,!0)}))}));function lt(t){const{apiConstants:e}=t.get(i.J.CsaService),{resource:n=B,version:r=p,endpoints:s=_}=e||{};return{resource:n,version:r,endpoints:s}}function dt(t){const{phonelinkSmsApiResource:e}=t.get(i.J.CsaService);return{resource:e||v}}function ht(t,e,n){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const{csaHostOverrideUrl:r}=t.get(i.J.Test),s=`${C}/`;if(r)return(0,u.m)(r)||s;const{host:a}=t.get(i.J.CsaService).apiConstants||{},{host:o}=t.get(i.J.CsaService).apiConstantsGCC||{};let c=!!t.get(i.J.CsaService).useHostFromGtmTable;if((null==a?void 0:a.includes("csa-int"))&&(c=!1),c){const r=t.get(i.J.Core).endpointsManagerBaseUrlResolutionTimeoutInMs||O,c=(yield ct(e,r,n))||o||a||s;return(0,u.m)(c)}{const t=o||a||s;return(0,u.m)(t)}}))}},863553:(t,e,n)=>{"use strict";n.d(e,{F:()=>i});var r=n(558632);function i(t){const e=(0,r.y4)(t,(t=>t.pathname),t,"https://example.com");return decodeURIComponent(e.slice(e.lastIndexOf("/")+1))}},575644:(t,e,n)=>{"use strict";n.d(e,{E:()=>o,T:()=>u});var r=n(827748),i=n(132756),s=n(905581);const a=20;function o(t,e,n,i){return Promise.race([t,(0,r._)(e).then((()=>{throw null==i||i.abort(),c(e,n)}))]).catch((t=>{if(t instanceof DOMException&&"AbortError"===t.name&&t.code===a)throw c(e,n);throw t}))}const u=t=>t&&t.context===i.w5.Timed&&t.code===i.jK.TimedOut,c=(t,e)=>(0,s.Tr)(i.w5.Timed,i.jK.TimedOut,i.w5.Timed,{ms:t},e)},30818:()=>{},609508:()=>{}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/734914-abe4eaefd87a2a3a.js.map