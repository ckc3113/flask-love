"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[765923],{419925:(e,t,o)=>{o.d(t,{ab:()=>r,Xt:()=>i,vC:()=>n,fe:()=>s,su:()=>a,oz:()=>c,oq:()=>l,lO:()=>d,PH:()=>u,mR:()=>h});const r="com.microsoft.teams.corelayout",i="com.microsoft.teams.entitymoreinfo",n="com.microsoft.teams.notifications",s={show:"show",showWithoutFocusing:"showWithoutFocusing",hide:"hide",toggle:"toggle"},a={none:"none",flush:"flush",forceFlush:"forceFlush",flow:"flow",forceFlow:"forceFlow",new:"new",extend:"extend"};var c;!function(e){e.organization="organization",e.privacyManageVisibility="privacy_manage_visibility",e.linkedin="linkedin"}(c||(c={}));const l={Cancelled:"Cancelled",Closed:"Closed",Confirmed:"Confirmed",Error:"Error",Open:"Open"},d={minimal:"minimal",focus:"focus",standard:"standard",minimode:"minimode"};var u,h;!function(e){e.main="main"}(u||(u={})),function(e){e.header="header",e.subNav="subNav",e.contextualNotifications="contextualNotifications",e.end="end",e.nav="nav",e.main="main",e.start="start",e.titleBar="titleBar",e.toasts="toasts",e.notifications="notifications",e.monitor="monitor"}(h||(h={}))},125386:(e,t,o)=>{var r;o.d(t,{W:()=>r}),function(e){e.WindowReady="windowReady",e.WindowUnloaded="windowUnloaded",e.WindowAppStart="windowAppStart",e.CoreInitialized="coreInitialized",e.CommandChangeType="commandEvent",e.ExperienceStarted="experienceStarted",e.CoreInitializationFailed="coreInitializationFailed",e.ExtendedEntityContainerState="extendedEntityContainerState",e.MainWindowBlockedState="mainWindowBlockedState"}(r||(r={}))},530014:(e,t,o)=>{o.d(t,{G:()=>i});var r=o(599768);class i extends Error{get extensions(){return this.getExtensions()}constructor({type:e,code:t,message:o,originSlotName:r,originAppId:i,prevError:n,userContextId:s}){var a;super(o),this.type=e,this.code=t,this.originSlotName=r,this.originAppId=i,this.prevError=n,this.userContextId=s;const c=function(e){var t;return null!==(t=null==e?void 0:e.split("\n").slice(1))&&void 0!==t?t:[]}(null!==(a=null==n?void 0:n.stack)&&void 0!==a?a:this.stack);this.stack=[`${t} Error: ${o}`,...c].join("\n"),Object.setPrototypeOf(this,new.target.prototype)}static isFunction(e){return"function"==typeof e}getBoundaryProps(){return{title:`default_${this.type.toLowerCase()}_title`,description:`default_${this.type.toLowerCase()}_description`}}toTelemetryEntry(){var e,t;let o=this.toTelemetryCode(),n=this.prevError;for(;n;)n instanceof i&&i.isFunction(n.toTelemetryEntry)?(o+=n.toTelemetryEntry(),n=void 0):(0,r.a)(n)?(o+=`[IError::${n.code}]`,n=null!==(e=n.innerError)&&void 0!==e?e:null===(t=n.reason)||void 0===t?void 0:t.innerError):(o+=`[Error::${n.message}]`,n=void 0);return o}toJSON(){return{type:this.type,code:this.code,stack:this.stack,userContextId:this.userContextId,prevError:this.prevError}}serialize(){const e=new WeakSet;return JSON.stringify(this,((t,o)=>{if("object"==typeof o&&null!==o){if(e.has(o))return;e.add(o)}return o}))}deserialize(e){this.stack=e.stack}toTelemetryCode(){return`[${this.type}::${this.code}]`}getExtensions(){return{type:this.type,code:this.code,prevError:this.prevError,boundaryProps:this.getBoundaryProps()}}}},5575:(e,t,o)=>{o.d(t,{$:()=>r,G:()=>l});var r,i=o(530014),n=o(762757),s=o(599768);!function(e){e.CDL_WORKER_FAILURE="CDL_WORKER_FAILURE",e.CLEANUP="CLEANUP",e.CORE_SERVICES_MISSING="CORE_SERVICES_MISSING",e.CREATE_USER_CONTEXT_FAILED_GENERIC="CREATE_USER_CONTEXT_FAILED_GENERIC",e.CREATE_WINDOW_WRAPPER="CREATE_WINDOW_WRAPPER",e.DISABLED_BY_ADMIN="DISABLED_BY_ADMIN",e.EXPERIENCE_DISABLED="EXPERIENCE_DISABLED",e.INVALID_INTENT_OVERRIDE="INVALID_INTENT_OVERRIDE",e.LAUNCH_CLOUD_DEEPLINK_ERROR="LAUNCH_CLOUD_DEEPLINK_ERROR",e.LAYOUT_ERROR="LAYOUT_ERROR",e.LAYOUT_ERROR_USER_BLOCKED="LAYOUT_ERROR_USER_BLOCKED",e.LAYOUT_PHASE_STATE_MACHINE_TIMEOUT="LAYOUT_PHASE_STATE_MACHINE_TIMEOUT",e.NETWORK_OFFLINE="NETWORK_OFFLINE",e.NETWORK_OFFLINE_USER_BLOCKED="NETWORK_OFFLINE_USER_BLOCKED",e.RENDERING_CONTEXT_DOES_NOT_EXIST="RENDERING_CONTEXT_DOES_NOT_EXIST",e.UNKNOWN="UNKNOWN",e.TELEMETRY_PRIMARY_USER_SET_FAILURE="TELEMETRY_PRIMARY_USER_SET_FAILURE",e.USER_DOES_NOT_EXIST="USER_DOES_NOT_EXIST",e.USER_NOT_AUTHENTICATED="USER_NOT_AUTHENTICATED",e.USERCONTEXTID_EMPTY="USERCONTEXTID_EMPTY",e.WINDOW_UNDEFINED="WINDOW_UNDEFINED"}(r||(r={}));const a={CDL_WORKER_FAILURE:"Cdl worker did not start up properly.",DISABLED_BY_ADMIN:"Please switch back to classic Teams.",EXPERIENCE_DISABLED:"We can't wait to show you the new Teams, but we're not quite ready for you. We'll let you know when it's time.",LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:"Layout phase state machine has timed out triggering a view tear down.",TELEMETRY_PRIMARY_USER_SET_FAILURE:"This can result from a failure to load the PIE api, a failure to call maglev, or a failure to set primary user in the telemetry web worker"},c={CREATE_USER_CONTEXT_FAILED_GENERIC:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},DISABLED_BY_ADMIN:{title:"default_disabledbyadmin_title",description:"default_disabledbyadmin_description",actions:["SWITCH_TO_CLASSIC","SIGN_OUT"],icon:n.P.NoLongerAllowed},EXPERIENCE_DISABLED:{title:"default_experiencedisabled_title",description:"default_experiencedisabled_description",actions:["SIGN_OUT"],icon:n.P.NoLongerAllowed},LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART"]},NETWORK_OFFLINE:{title:"default_nonetwork_title",description:"error_nonetwork_text"},NETWORK_OFFLINE_USER_BLOCKED:{title:"default_nonetwork_title",description:"error_nonetwork_text",actions:["RESTART"]},CDL_WORKER_FAILURE:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART"]},LAYOUT_ERROR:{title:"default_unknown_title",description:"",actions:[]},LAYOUT_ERROR_USER_BLOCKED:{title:"default_unknown_title",description:"",actions:["RESTART"]},RENDERING_CONTEXT_DOES_NOT_EXIST:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},USER_DOES_NOT_EXIST:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]}};class l extends i.G{constructor(e,t,o,r){var i,n,c,l,d;super({type:"CoreError",code:e,message:null!==(i=a[e])&&void 0!==i?i:(0,s.a)(t)?null!==(c=null===(n=t.innerError)||void 0===n?void 0:n.message)&&void 0!==c?c:null===(d=null===(l=t.reason)||void 0===l?void 0:l.innerError)||void 0===d?void 0:d.message:null==t?void 0:t.message,originSlotName:r,prevError:t,userContextId:o})}getBoundaryProps(){var e;return null!==(e=c[this.code])&&void 0!==e?e:{title:"default_core_title",description:"default_core_description"}}static fromSerialized(e){if("CoreError"!==(null==e?void 0:e.type))return null;const t=new l(e.code,e.prevError,e.userContextId);return t.deserialize(e),t}}},682265:(e,t,o)=>{o.d(t,{Y:()=>i});var r=o(530014);class i extends r.G{constructor(e,t){super({type:"TrustedTypeError",code:e,prevError:t})}}},599768:(e,t,o)=>{function r(e){const t=e;return"string"==typeof(null==t?void 0:t.code)}o.d(t,{a:()=>r})},692374:(e,t,o)=>{o.d(t,{n:()=>Y});var r=o(125386),i=o(609901),n=o(382433),s=o(234207),a=o(905581),c=o(132756);class l{constructor(e,t){this.shellComms=e,this.globalWindow=t,this.defaultRequestTimeoutMs=3e4,this.bufferInTimeout=5e3}postMessage(e,t){const o={eventId:e,payload:t,correlationId:(0,s.v4)()};this.shellComms.postMessage(o)}requestMessage(e,t,o=this.defaultRequestTimeoutMs){let r;const i=(0,s.v4)(),n=((null==t?void 0:t.timeout)||o)+this.bufferInTimeout;return new Promise(((o,s)=>{const l=t=>{this.globalWindow.clearTimeout(r),t&&!t.error?o(t.payload):s((0,a.Tr)(c.w5.ShellService,c.jK.RemoteOperationFailed,"requestMessage",{eventName:e,error:t&&t.error,correlationId:i},"Received an error from IPC"))};r=this.globalWindow.setTimeout((()=>{this.shellComms.remove(e,l),s((0,a.Tr)(c.w5.ShellService,c.jK.TimedOut,"requestMessage",{eventName:e,correlationId:i}))}),n),this.shellComms.once(e,l,i);const d={eventId:e,correlationId:i,payload:t};this.shellComms.postMessage(d)}))}addEventListener(e,t,o){o&&o.once?this.shellComms.once(e,t):this.shellComms.on(e,t)}removeEventListener(e,t){t?this.shellComms.remove(e,t):this.shellComms.removeAll(e)}open(e,t,o){const r={openType:e,openHandler:t,handlerParams:o};this.postMessage("requestShellToOpen",r)}}class d{constructor(e,t,o){var r;this._globalWindow=e,this.shellComms=t,this.envPerformance={getBlinkMemoryInfo:()=>{},getJSHeapStatistics:()=>{},getMallocMemoryUsage:()=>{},getProcessMemoryInfo:()=>{},getWebCacheInfo:()=>{}};const{isInCypressFrame:s,isInIframe:a}=o;let c=i.QP.standAlone;if(this.viewportContext=n.R.primary,a&&!s)c=i.QP.iframe,this.viewportContext=n.R.iFrame;else if(null!==this._globalWindow.opener)try{(null===(r=this._globalWindow.opener.location)||void 0===r?void 0:r.host)===this._globalWindow.location.host&&(c=i.QP.secondary,this.viewportContext=n.R.secondary)}catch(e){c=i.QP.standAlone,this.viewportContext=n.R.primary}this._hostedWindowContext=Object.assign(Object.assign({},o),{panelContext:c,startReason:i.zF.userInitiated,__webpack_public_path__:this._globalWindow.__webpack_public_path__}),this.opener=new l(this.shellComms,this._globalWindow)}getHostedWindowContext(){return this._hostedWindowContext}onAppStart(){}setTimeout(...e){return this._globalWindow.setTimeout(...e)}clearTimeout(...e){return this._globalWindow.clearTimeout(...e)}}var u=o(301835),h=o(130757);var m=o(168731);class p{constructor(e,t){this.getObservableOn=e=>{const t=this.observableCache,o=t.get(e);if(o)return o;const r=new m.xQ;return t.set(e,r),r},this.next=e=>{this.logger.debug("Incoming message received. Filtering through cached observables.");const t=e.metaData.destination.channel,o=this.observableCache.get(t);o&&o.next(e)},this.error=e=>{const t=e.message?e.message:e;this.logger.error(`Internal Message Source emitted an error - {${t}}. Completing then clearing all observables from cache...`),this.completeAndClearCache()},this.complete=()=>{this.logger.debug("Internal Message Source completed. Completing then clearing all observables from cache..."),this.completeAndClearCache()},this.completeAndClearCache=()=>{this.observableCache.forEach((e=>e.complete())),this.observableCache.clear(),this.logger.debug("Cache cleared")},this.logger=t,this.observableCache=new Map,e.subscribe(this)}}const g="multi-window-manager-channel";var v=o(645941),w=o(532666),_=o(74583);const f=/^https:\/\/local\.teams\.(office|live)\.com(:8080)?$/;function E(e,t){return t.some((t=>{if(t.startsWith("regex:")){const o=t.replace("regex:","");return new RegExp(o).test(e)}return t===e}))}function b(e){return f.test(new URL(e).origin)}const C=(e,t,o,r)=>{const i=v.y.create((i=>{e.addEventListener("message",(e=>{const{eventId:n,channel:s}=e.data;e&&n&&s===g&&function(e,t,o){var r,i,n;const s=o.newLogger("PostMessage origin validation","services-io-browser-shell-message-passing-browser"),a=e.origin;return t?!("*"!==t&&!b(a)&&((0,_.isArray)(t)?0===t.length?(null===(r=s.errorToTelemetry)||void 0===r||r.call(s,`PostMessage is disabled for this experience. (case 5) ${a}`,"core_origin_validation_failed",void 0,!0),1):!E(a,t)&&(null===(i=s.errorToTelemetry)||void 0===i||i.call(s,`Event origin is not in allow-list. Event was dropped. (case 4) ${a}`,"core_origin_validation_failed",void 0,!0),1):(null===(n=s.errorToTelemetry)||void 0===n||n.call(s,`Could not match the event origin. Event was dropped. (case 6) ${a}`,"core_origin_validation_failed",void 0,!0),1))):(s.debug("PostMessage is enabled for backwards compatibility. No postMessageConfig is set on this experience. https://aka.ms/tmp-post-message-config (case1 )"),!0)}(e,o.postMessageConfig,r)&&(t.debug("Incoming message from post messages"),i.next(e.data))}))})).pipe((0,w.B)());return i};class S{constructor(e,t,o,r){this.opt=r,this.postMessage=e=>{var t,o;if((0,_.isArray)(this.opt.postMessageConfig)&&0===this.opt.postMessageConfig.length)return void(null===(o=(t=this.logger).errorToTelemetry)||void 0===o||o.call(t,"postMessageConfig is set to empty array. No outgoing post messages are allowed","core_origin_validation_failed",void 0,!0));this.logger.log("Sending targeted message to host browser only");const r=null!==e.payload&&"object"==typeof e.payload?Object.assign({},e.payload):{payload:e.payload};this.windowReference.parent.postMessage({channel:g,payload:Object.assign(Object.assign({},r),{channel:e.channel})},((e,t,o)=>{const r=new URL(e.location.href).origin;let i;if(!t||"*"===t)return"*";if(e.document.referrer)try{i=new URL(e.document.referrer).origin}catch(t){o.error(`Invalid referrer: ${e.document.referrer}`)}return i?i===r||b(i)||E(i,t)?i:(o.error(`Invalid target origin (${i}). Source origin (${r}) was returned as target origin.`),r):(o.log(`Could not determine target origin. Falling back to source origin: ${r}`),r)})(this.windowReference,this.opt.postMessageConfig,this.logger))},this.broadcast=()=>{},this.asObservable=e=>this.shellChannelCache.getObservableOn(e).pipe((0,h.U)((e=>(e=>({channel:e.metaData.destination.channel,payload:e.payload}))(e)))),this.createShellChannelCache=(e,t,o,r)=>{t.debug("Creating Shell Channel cache");const i=C(e,t,o,r);return new p(i,t)},this.logger=o.newLogger("RndrShComm","services-io-browser-shell-message-passing-browser"),this.processId=e,this.windowReference=t,this.shellChannelCache=this.createShellChannelCache(this.windowReference,this.logger,this.opt,o)}}const R="main_process";var I=o(688911);class T{constructor(e,t,o){if(3!==arguments.length||e.trim().length<=0)throw(0,a.Tr)("Invalid constructor arguments",c.jK.InvalidInput,typeof T);this.logger=o,this.messagePassingService=t,this.metaData={streamId:e}}next(e,...t){const o=this.metaData,r=this.messagePassingService,i=t&&t.length>0?t:this.messagePassingService.processId!==R?[R]:["main_renderer"],n={channel:o.streamId,payload:e};this.logger.debug(`Invoking stream on targets: ${JSON.stringify(i)}.`),r.postMessage(n,i)}asObservable(){const e=this.messagePassingService,t=this.metaData.streamId;return e.asObservable(t).pipe((0,h.U)((e=>e.payload)),(0,I.b)((()=>{this.logger.debug("Handling stream event.")})))}}class y{constructor(e,t){if(this.getStream=e=>new T(e,this.messagePassingService,this.loggerFactory.newLogger(`ShStrm${e}`,"services-io-browser-shell-communication-provider")),!e||!t)throw(0,a.Tr)(`sc: ${e}, lf: ${t}`,c.jK.Undefined,typeof y);this.messagePassingService=e,this.loggerFactory=t}}var O=o(555828),k=o(523197),L=o(366758);class A{constructor(e,t){if(this.windowReference=e,this.opt=t,!this.windowReference)throw(0,a.Tr)(c.w5.ShellService,c.jK.Undefined,"constructor");const o={error:()=>{},warn:()=>{},debug:()=>{},info:()=>{},log:()=>{}},r={newLogger:()=>o},i=new S("browserWindow",this.windowReference,r,this.opt);this.shellComms=new y(i,r),this.subscriptionManager=new m.xQ}postMessage(e){this.shellComms.getStream(e.eventId).next(e)}on(e,t,o=""){this.createSubscription(e,t,!1,o)}once(e,t,o=""){this.createSubscription(e,t,!0,o)}remove(e,t){this.subscriptionManager.next({channel:e,listener:t})}removeAll(e){this.subscriptionManager.next({channel:e})}createSubscription(e,t,o,r){const i=this.shellComms.getStream(e).asObservable().pipe(this.filterWrapper((e=>{var t;const o=(null==e?void 0:e.correlationId)||(null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.correlationId);return!e||!o||o===r}))),n=this.registerForUnsubscription(e,t);(o?i.pipe((0,O.q)(1),(0,k.R)(n)):i.pipe((0,k.R)(n))).subscribe((e=>{t({payload:e})}),(e=>{throw(0,a.Tr)(c.w5.ShellService,c.jK.RemoteOperationFailed,"createSubscription",{errorMsg:(0,a.B9)(e)})}))}registerForUnsubscription(e,t){return this.subscriptionManager.pipe(this.filterWrapper((o=>o.channel===e&&(void 0===o.listener||o.listener===t))))}filterWrapper(e){return(0,L.h)(e)}}class W{constructor(e,t){this.globalWindow=e,this.opt=t}configureShell(e){const t=this.globalWindow,o=this.createShellCommService(this.globalWindow,this.opt),r=new d(this.globalWindow,o,e);return{hostedWindowContext:r.getHostedWindowContext(),window:(0,u.So)(t,r,!1)}}createShellCommService(e,t){return new A(e,t)}}class x{constructor(e,t,o,s){this.envPerformance=e,this._globalWindow=t,this.shellComms=o,this._hostedWindowContext=Object.assign(Object.assign({},s),{panelContext:i.QP.secondary,startReason:i.zF.userInitiated,__webpack_public_path__:this._globalWindow.__webpack_public_path__}),this.viewportContext=n.R.iFrame,this.opener=new l(o,this._globalWindow),this._globalWindow.addEventListener("unload",(()=>{this.shellComms.postMessage({eventId:r.W.WindowUnloaded})}))}getHostedWindowContext(){return this._hostedWindowContext}onAppStart(){const e={eventId:r.W.WindowAppStart};this.shellComms.postMessage(e)}setTimeout(...e){return this._globalWindow.setTimeout(...e)}clearTimeout(...e){return this._globalWindow.clearTimeout(...e)}}var D,N=o(656690);!function(e){e.WindowMinimize="child-window-minimize",e.WindowMaximize="child-window-maximize"}(D||(D={}));const M="experience-renderer-channel";class P{constructor(e){this.ipcRenderer=e,this.onceListenerLookup={},this.listenerLookup={},this.ipcRenderer.on(M,((e,t)=>{if(t&&t.eventId){const e=`${t.eventId}${t.correlationId||""}`;this.onceListenerLookup[e]?(this.onceListenerLookup[e].forEach((e=>e(t))),delete this.onceListenerLookup[e]):this.listenerLookup[e]&&this.listenerLookup[e].forEach((e=>{e(t)}))}}))}postMessage(e){switch(e.eventId){case N.rY.ActivityEvent:case N.rY.CreateWebview:case N.rY.GetWindowLaunchSubSteps:case N.rY.SetTouchBar:case N.rY.ClearTouchBar:case N.rY.ActivateOutlook:case N.rY.RequestTabMetrics:case N.rY.HasDevicePermissionsCallback:this.ipcRenderer.send(M,e);break;case r.W.CoreInitialized:case N.rY.WindowInitialized:this.ipcRenderer.send(M,e),this.ipcRenderer.sendToHost(M,e);break;default:this.ipcRenderer.sendToHost(M,e)}}on(e,t,o=""){const r=`${e}${o}`;this.listenerLookup[r]||(this.listenerLookup[r]=[]),this.listenerLookup[r].push(t)}once(e,t,o=""){const r=`${e}${o}`;this.onceListenerLookup[r]||(this.onceListenerLookup[r]=[]),this.onceListenerLookup[r].push(t)}remove(e,t){e&&t&&(this.onceListenerLookup[e]&&(this.onceListenerLookup[e]=this.onceListenerLookup[e].filter((e=>e!==t)),0===this.onceListenerLookup[e].length&&delete this.onceListenerLookup[e]),this.listenerLookup[e]&&(this.listenerLookup[e]=this.listenerLookup[e].filter((e=>e!==t)),0===this.listenerLookup[e].length&&delete this.listenerLookup[e]))}removeAll(e){delete this.onceListenerLookup[e],delete this.listenerLookup[e]}}class F{constructor(e){this.windowHandle=e,this.ipcRenderer=this.windowHandle.desktop.ipcRenderer,this.webViewCommService=new P(this.ipcRenderer),this.browserShellCommService=new A(e,{})}postMessage(e){switch(e.eventId){case N.rY.ActivityEvent:case N.rY.CreateWebview:case N.rY.GetWindowLaunchSubSteps:case N.rY.SetTouchBar:case N.rY.ClearTouchBar:this.ipcRenderer.send(M,e);break;case r.W.CoreInitialized:case N.rY.WindowInitialized:this.ipcRenderer.send(M,e),this.browserShellCommService.postMessage(e);break;default:this.browserShellCommService.postMessage(e)}}on(e,t,o=""){this.webViewCommService.on(e,t,o),this.browserShellCommService.on(e,t,o)}once(e,t,o=""){this.webViewCommService.once(e,t,o),this.browserShellCommService.once(e,t,o)}remove(e,t){this.webViewCommService.remove(e,t),this.browserShellCommService.remove(e,t)}removeAll(e){this.webViewCommService.removeAll(e),this.browserShellCommService.removeAll(e)}}class U{constructor(e){this.globalWindow=e}configureShell(e){const t=this.globalWindow,{isInIframe:o}=e,r=this.extractPerformanceTooling(t),i=o?new F(t):new P(t.desktop.ipcRenderer),n=new x(r,t,i,e);return Object.keys(t.desktop).forEach((e=>{"perf"!==e&&delete t.desktop[e]})),{hostedWindowContext:n.getHostedWindowContext(),window:(0,u.So)(t,n,!1)}}extractPerformanceTooling(e){return e.desktop.perf||{getBlinkMemoryInfo:()=>{},getJSHeapStatistics:()=>{},getMallocMemoryUsage:()=>{},getProcessMemoryInfo:()=>{},getWebCacheInfo:()=>{}}}}var z=o(683470);class ${constructor(e){this.windowEnvironment=e}configure(e){const t={isInCypressFrame:B(this.windowEnvironment),isInIframe:H(this.windowEnvironment)};t.isInIframe&&function(e){var t;if(e.navigator){if("Electron"===z.getParser(null===(t=e.navigator)||void 0===t?void 0:t.userAgent).getBrowserName())return!0}return!1}(this.windowEnvironment)&&function(e){var t;try{const o=e.parent;if(!o||!function(e){return!(!e||!e.electronSafeIpc)}(o))return;e.desktop={perf:null===(t=o.desktop)||void 0===t?void 0:t.perf,ipcRenderer:o.electronSafeIpc},e.createInterprocessStore=o.createInterprocessStore,e.vdiSettings=o.vdiSettings}catch(e){return}}(this.windowEnvironment);return(function(e){return!!(e&&e.desktop&&e.desktop.ipcRenderer)}(this.windowEnvironment)?new U(this.windowEnvironment):new W(this.windowEnvironment,e)).configureShell(t)}}function B(e){try{let t=!!e.Cypress;if(!t){const o=e.top||e.parent;t=!!(null==o?void 0:o.Cypress)}return t}catch(e){return!1}}function H(e){try{return e.self!==e.top}catch(e){return!0}}class Y{constructor(){this._opt={};const e=new $(window);this.config=e.configure(this._opt),this.config.window.opener.postMessage(r.W.WindowReady)}set opt(e){Object.keys(e).forEach((t=>{this._opt[t]=e[t]}))}static getInstance(){return Y.instance||(Y.instance=new Y),Y.instance}get window(){return this.config.window}}},301835:(e,t,o)=>{o.d(t,{YR:()=>S,dP:()=>b,So:()=>E});var r=o(740597),i=o(50805),n=o(446652),s=o(419925),a=o(382433),c=o(5575);function l(e){return e.ResizeObserver?e.ResizeObserver:function(t){const o=new Map;let r,i=!1;function n(){if(i||!o.size)return void(r=void 0);const s=[];o.forEach(((e,t)=>{const r=t.getBoundingClientRect();e.height!==r.height&&(o.set(t,r),s.push({target:t,contentRect:r,borderBoxSize:[{inlineSize:r.width,blockSize:r.height}],contentBoxSize:[{inlineSize:r.width,blockSize:r.height}],devicePixelContentBoxSize:[]}))})),s.length&&t(s),r=e.requestAnimationFrame(n)}return{observe(t){o.has(t)||(o.set(t,t.getBoundingClientRect()),r||(r=e.requestAnimationFrame(n)))},unobserve(e){o.has(e)&&o.delete(e)},disconnect(){o.clear(),r=void 0,i=!0}}}}var d=o(682265),u=o(614665);class h{constructor(e,t){this._document=e,this._chunkConfig=t,this._loadedItems=new Map,this._loadScript=(0,u.m)(((e,t)=>new Promise(((o,r)=>{if(!e)return o();const i=this._document.createElement("script");if(i.onload=()=>o(),i.onerror=r,i.async=!0,i.id=`${t}-script`,i.charset="utf-8",!this._coreSecurityService)throw new d.Y("DEVELOPER_ERROR",new Error("Chunkloader core security service is not defined. This should never happen"));try{const t=this._coreSecurityService.getTrustedTypePolicy("@msteams/services-utilities-common#ChunkLoader").createScriptURL(e,i.baseURI);i.src=t}catch(e){throw e}this._document.body.appendChild(i)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this._loadStyle=(0,u.m)(((e,t)=>new Promise(((o,r)=>{if(!e)return o();const i=this._document.createElement("link");i.onload=()=>o(),i.onerror=r,i.type="text/css",i.rel="stylesheet",i.id=`${t}-style`,i.charset="utf-8",i.href=e,this._document.head.appendChild(i)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this.loadChunk=(e,t=!1)=>(0,r.__awaiter)(this,void 0,void 0,(function*(){if(!this._chunkConfig)throw new Error("Chunk loading is not supported in this window or host.");const o=e.reduce(((e,o)=>{const r=this._chunkConfig&&this._chunkConfig[o];if(!r)return e.push(Promise.reject(new Error(`No chunk information found for ${r}.`))),e;const i=r.endsWith(".css")?this._loadStyle:this._loadScript,n=this._loadedItems.get(r)||i(r,o).catch((e=>{throw t&&this._loadedItems.delete(r),e}));return this._loadedItems.has(r)||this._loadedItems.set(r,n),e.push(n),e}),[]);yield Promise.all(o)}))}configureCoreSecurityService(e){if(this._coreSecurityService)throw new d.Y("DUPLICATE_POLICY_FOUND",new Error("ChunkLoader::coreSecurityService is already defined. Developer should not be calling configureCoreSecurityService multiple times in it's context"));e&&(this._coreSecurityService=e)}}var m=o(38023),p=o(949693),g=o(22085),v=o(688911),w=o(833470);const _=(e,t,o,r)=>{var s;const{coreSettings:a,interprocessStoreService:c,loggerFactory:l,platformService:d}=r||{},u=null==l?void 0:l.newLogger("WindowUtilities","services-io-browser-shell"),h=(null==d?void 0:d.config.clientType)===n.Bh.Desktop;if(a.get(i.J.Core,["enableHostFullscreenSubscription"]).enableHostFullscreenSubscription)return t.pipe((0,g.x)());if(h)return c&&o?c.onWindowFullscreen(o).pipe((0,v.b)((e=>null==u?void 0:u.log(`WindowHook[onFullscreen] update to: ${e}`)))):(null==u||u.error(`WindowHook[onFullscreen] on desktop failed due to interprocessStoreService missing for windowId: ${o}`),new m.X(!1));{const t=e,o=new m.X(f(t));"function"!=typeof t.ResizeObserver&&(null===(s=null==u?void 0:u.errorToTelemetry)||void 0===s||s.call(u,`ResizeObserver "${t.ResizeObserver}" is type: ${typeof t.ResizeObserver}.`,"webclient_framework_foundation_services_io_browser_shell",void 0,!0));const r=new t.ResizeObserver((()=>{t.requestAnimationFrame((()=>{o.next(f(t))}))}));return r.observe(t.document.documentElement),o.pipe((0,w.x)((()=>r.disconnect())),(0,g.x)())}},f=e=>!(!e.matchMedia("(display-mode: fullscreen)").matches&&!e.document.fullscreenElement),E=(e,t,o)=>{var i,n,s,a,d;let u;try{u={DOMRect:e.DOMRect,loader:e.loader,loaderConfig:e.loaderConfig,preCoreUiAdapter:e.preCoreUiAdapter,Cypress:e.Cypress,document:e.document,HTMLVideoElement:e.HTMLVideoElement,Element:e.Element,emitDebugEvent:e.emitDebugEvent,external:e.external,location:e.location,history:e.history,navigator:e.navigator,get caches(){return e.caches},crypto:e.crypto,parent:e.parent,self:e.self,top:e.top,performance:e.performance,msCrypto:e.msCrypto&&e.msCrypto,IntersectionObserver:e.IntersectionObserver,ResizeObserver:l(e),WeakRef:e.WeakRef,chunkLoader:new h(e.document,e.__experienceWindowChunks__),screen:e.screen,viewportContext:t.viewportContext,chrome:e.chrome,open:e.loader&&e.loader.openWindow?e.loader.openWindow.bind(e.loader):e.open.bind(e),getLoadingWindow:(null===(i=e.loader)||void 0===i?void 0:i.getLoadingWindow)&&e.loader.getLoadingWindow.bind(e.loader),fetch:e.fetch&&e.fetch.bind(e),close:e.close.bind(e),alert:e.alert.bind(e),requestAnimationFrame:e.requestAnimationFrame.bind(e),cancelAnimationFrame:e.cancelAnimationFrame.bind(e),requestIdleCallback:e.requestIdleCallback?e.requestIdleCallback.bind(e):e.requestAnimationFrame.bind(e),cancelIdleCallback:e.cancelIdleCallback?e.cancelIdleCallback.bind(e):e.cancelAnimationFrame.bind(e),scheduler:e.scheduler,setInterval:e.setInterval.bind(e),clearInterval:e.clearInterval.bind(e),clearTimeout:e.clearTimeout.bind(e),setTimeout:e.setTimeout.bind(e),addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e),dispatchEvent:e.dispatchEvent.bind(e),focus:e.focus.bind(e),getScreenDetails:()=>e.getScreenDetails?e.getScreenDetails():Promise.resolve(void 0),getSelection:e.getSelection.bind(e),getComputedStyle:e.getComputedStyle.bind(e),onpagehide:null===(n=e.onpagehide)||void 0===n?void 0:n.bind(e),setBounds:e.setBounds,setMinimumSize:e.setMinimumSize,createInterprocessStore:e.createInterprocessStore,Logging:e.Logging,matchMedia:e.matchMedia?e.matchMedia.bind(e):null,proxyPostMessage:(t,o,r)=>{e.proxyPostMessage&&e.proxyPostMessage(t,o,r)},getLocaleInfoAsync:()=>e.getLocaleInfoAsync?e.getLocaleInfoAsync():Promise.resolve(void 0),getUserMedia:t=>{var o,r;return(null===(r=null===(o=e.navigator)||void 0===o?void 0:o.mediaDevices)||void 0===r?void 0:r.getUserMedia)?e.navigator.mediaDevices.getUserMedia(t):Promise.reject(new Error("Not available"))},enumerateDevices:()=>{var e,o;return(null===(o=null===(e=t.navigator)||void 0===e?void 0:e.mediaDevices)||void 0===o?void 0:o.enumerateDevices)?t.navigator.mediaDevices.enumerateDevices():Promise.reject(new Error("Not available"))},handleGlobalWindowError:null===(s=e.handleGlobalWindowError)||void 0===s?void 0:s.bind(e),decodeURIComponent,encodeURIComponent,getDesktopCapturerSources:t=>e.getDesktopCapturerSources?e.getDesktopCapturerSources(t):Promise.reject(new Error("Not available")),get __experienceWindowChunks__(){return e.__experienceWindowChunks__},get __webpack_nonce__(){return e.__webpack_nonce__},get __VERSION__(){return e.__VERSION__},get __webpack_public_path__(){return e.__webpack_public_path__},get devicePixelRatio(){return e.devicePixelRatio},get localStorage(){return e.localStorage},get sessionStorage(){return e.sessionStorage},get indexedDB(){return e.indexedDB},get CKEDITOR(){return e.CKEDITOR},get ITEMS_VIEW_STRINGS(){return e.ITEMS_VIEW_STRINGS},get CodeMirror(){return e.CodeMirror},get MutationObserver(){return e.MutationObserver},get LivePersonaCardStrings(){return e.LivePersonaCardStrings},get LivePersonaCardHoverTargetV2(){return e.LivePersonaCardHoverTargetV2},get LPC(){return e.LPC},get SlimCore(){return e.SlimCore},get authLogger(){return e.Logging},get Microsoft(){return e.Microsoft},get Office(){return e.Office},get Image(){return e.Image},get DOMParser(){return e.DOMParser},videoRenderer:e.videoRenderer,get FrameSinkReader(){return e.FrameSinkReader},get continueExternalAuth(){return e.continueExternalAuth},set continueExternalAuth(t){e.continueExternalAuth=t},get continueMsaAuth(){return e.continueMsaAuth},set continueMsaAuth(t){e.continueMsaAuth=t},get FabricConfig(){return e.FabricConfig},set FabricConfig(t){e.FabricConfig=t},get CKEDITOR_BASEPATH(){return e.CKEDITOR_BASEPATH},get ClipboardItem(){return e.ClipboardItem},get PerformanceObserver(){return e.PerformanceObserver},get opener(){return t.opener},get envPerformance(){return t.envPerformance},getHostedWindowContext:t.getHostedWindowContext.bind(t),onAppStart:t.onAppStart.bind(t),get isHighResolution(){if(e){const t=1.3,o=e.navigator&&e.navigator.userAgent&&e.navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if(void 0!==e.devicePixelRatio&&!o)return e.devicePixelRatio>t;if(e.matchMedia){const t="(-webkit-min-device-pixel-ratio: 1.3),            (min--moz-device-pixel-ratio: 1.3),            (-o-min-device-pixel-ratio: 1.3),            (min-resolution: 120dpi)";return e.matchMedia(t).matches}}return!1},get screenX(){return e.screenX},get screenY(){return e.screenY},get innerWidth(){return e.innerWidth},get innerHeight(){return e.innerHeight},isFocused:()=>e.isFocused?e.isFocused():e.document.hasFocus(),onFullscreen:()=>new m.X(!1),unsubscribeFullscreenEvents:()=>{},exitFullscreen:()=>{},maximize:()=>{},minimize:()=>{},requestFullscreen:()=>{},show:()=>{},windowTitleDblClick:()=>{},clearCache:()=>{var t;return null===(t=e.clearCache)||void 0===t?void 0:t.call(e)},getZoomFactor:()=>e.getZoomFactor?e.getZoomFactor():0,zoomFactors:null!==(a=e.zoomFactors)&&void 0!==a?a:p.E,zoomIn:()=>e.zoomIn?e.zoomIn():void 0,zoomOut:()=>e.zoomOut?e.zoomOut():void 0,zoomReset:()=>e.zoomReset?e.zoomReset():void 0,vdiSettings:e.vdiSettings,setSelectedAudioOutputDevice:t=>e.setSelectedAudioOutputDevice?e.setSelectedAudioOutputDevice(t):Promise.resolve(),destroy:i=>(0,r.__awaiter)(void 0,void 0,void 0,(function*(){var r;return null===(r=u.unsubscribeFullscreenEvents)||void 0===r||r.call(u),o?new Promise(((o,r)=>{const n=t.setTimeout((()=>{try{t.clearTimeout(n);for(const e of Reflect.ownKeys(u)){if("windowLeakInfo"===e)continue;delete u[e];const t=()=>{const t=new Error(`wrapWindow: Accessing window.${e} after destroy`);throw t.message=`${t.message} at\n${t.stack}`,t};Reflect.defineProperty(u,e,{get:t,set:t})}e.document.documentElement.innerText="",o()}catch(e){r(e)}finally{e=void 0,t=void 0}}),i+1)})):void 0}))}}catch(e){throw new c.G(c.$.CREATE_WINDOW_WRAPPER,e)}e.CKEDITOR_BASEPATH=e.CKEDITOR_BASEPATH||`${e.__webpack_public_path__||(null===(d=null==t?void 0:t.getHostedWindowContext())||void 0===d?void 0:d.__webpack_public_path__)||""}ckeditor/4.15.1-msft-11/`||"";const g=new Proxy(u,{deleteProperty:(t,o)=>delete e[o]});return u.__lpcWindowProxy=g,u};function b(e,t,o,r,n){const{coreSecurityService:s,hostCommunicationService:a,windowProvider:c,coreSettings:l,loggerFactory:d}=t,u=e,{enableDisconnectWindowWrapper:p,enableHostFullscreenSubscription:g}=l.get(i.J.Core),v=d.newLogger("WindowUtilities","services-io-browser-shell"),w=E(u,c,null!=p&&p),f=S(r,n),b=new h(u.document,c.__experienceWindowChunks__);let R,I;b.configureCoreSecurityService(s);const T={chunkLoader:b,parent:c,viewportContext:f,FabricConfig:{mergeStyles:{namespace:"cw"}},exitFullscreen:()=>C("exitFullscreen",e,t,o,v),focus:()=>C("focus",e,t,o,v),maximize:()=>C("maximize",e,t,o,v),minimize:()=>C("minimize",e,t,o,v),requestFullscreen:()=>C("requestFullscreen",e,t,o,v),windowTitleDblClick:()=>C("windowTitleDblClick",e,t,o,v),onFullscreen:()=>(R||(R=new m.X(!1),g&&a.loadModule("windowcontrols").then((e=>{var t;v.log(`Subscribing to hostComms fullscreen events for window: ${o}`),I=null===(t=null==e?void 0:e.registerForWindowFullScreenChanged)||void 0===t?void 0:t.call(e,(e=>{e.windowId===o&&(null==R||R.next(e.fullscreen))}))}))),_(e,R,o,t)),unsubscribeFullscreenEvents:()=>null==I?void 0:I()};return Object.assign(w,T)}function C(e,t,o,r,i){const{interprocessStoreService:s,platformService:a}=o;if(i.log(`Performing action ${e}`),a.config.clientType===n.Bh.Desktop){if("focus"===e&&(null==t?void 0:t.document.hidden)&&(e="show"),!s)return void i.error(`WindowAction[${e}] on Desktop failed due to interprocessStoreService missing`);s[e](r).then((()=>{i.log(`WindowAction[${e}] on Desktop succeeded.`)})).catch((t=>{i.error(`WindowAction[${e}] on Desktop failed with: ${t&&t.message} (${t&&t.code})`)}))}else{const o=t;switch(e){case"exitFullscreen":o.document.exitFullscreen().catch((t=>{i.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}));break;case"requestFullscreen":o.document.documentElement.requestFullscreen().catch((t=>{i.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}));break;default:try{o[e]()}catch(t){i.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}}}}function S(e,t){let o;if(e)switch(t){case s.lO.minimal:o=a.R.flyout;break;case s.lO.minimode:o=a.R.minimode;break;default:o=a.R.primary}else o=a.R.secondary;return o}},765923:(e,t,o)=>{o.d(t,{J:()=>i,l:()=>n});var r=o(692374);function i(){return r.n.getInstance().window}function n(e,...t){const o=window.electronSafeIpc;o&&o.send(e,...t)}},614665:(e,t,o)=>{o.d(t,{X:()=>l,m:()=>d});var r=o(740597),i=o(682265),n=o(540929),s=o(905581),a=o(132756),c=o(827748);const l=(e,t)=>(...o)=>(0,r.__awaiter)(void 0,void 0,void 0,(function*(){for(;;)try{return yield e(...o)}catch(e){yield t(e,...o)}})),d=(e,t)=>{const{maxRetries:o,retryWindow:l,backoffTime:d,shouldRetry:u}=t,h=e=>l-(Date.now()-e);return(...t)=>(0,r.__awaiter)(void 0,void 0,void 0,(function*(){const r=Date.now();let l=0,m=h(r);for(;l++<=o&&m>0;)try{return yield Promise.resolve(e.apply(e,t))}catch(e){if(e instanceof i.Y)throw e;const t=yield(0,n.tE)(e);if(u&&!u(t))throw t?(0,s.Tr)(t.context,t.code,t.subContext?t.subContext:"",t.reason,t.message,t.serverResponse):(0,s.Tr)("RetryWithBackoff",a.jK.MaxLimitReached,"elapsed",void 0,`All retries elapsed or retryWindow expired, RetryCount: ${l}, RemainingTime: ${m}`);if(l>=o||h(r)<=0)break;yield(0,c._)(d),m=h(r)}throw(0,s.Tr)("RetryWithBackoff",a.jK.MaxLimitReached,"elapsed",void 0,`All retries elapsed or retryWindow expired, RetryCount: ${l}, RemainingTime: ${m}`)}))}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/765923-f03017351695ee37.js.map