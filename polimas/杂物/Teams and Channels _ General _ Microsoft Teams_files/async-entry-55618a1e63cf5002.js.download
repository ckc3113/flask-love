(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[411075],{717390:(e,n,i)=>{"use strict";i.r(n),i.d(n,{simpleCollabStore:()=>d,isDiscoverSurfaceSelectedAtom:()=>l,atomWithCompare:()=>r,areFiltersEqual:()=>s,leftRailFilterAtom:()=>m,selectedConversationIdAtom:()=>u,selectedTeamIdAtom:()=>y});var t=i(918640),a=i(403329),o=i(74583);const d=(0,t.MT)(),l=(0,t.cn)(!1);d.set(l,!1);const r=(e,n)=>(0,a.w0)(e,((e,i)=>n(e,i)?e:i)),s=(e,n)=>{var i,t;return e===n||!((null===(i=null==e?void 0:e.tags)||void 0===i?void 0:i.length)!==(null===(t=null==n?void 0:n.tags)||void 0===t?void 0:t.length)||(null==e?void 0:e.text)!==(null==n?void 0:n.text)||!(0,o.isEqual)((0,o.sortBy)(null==e?void 0:e.tags),(0,o.sortBy)(null==n?void 0:n.tags)))},m=r({},((e,n)=>s(e,n)));d.set(m,{});const c=(0,t.cn)("");d.set(c,"");const u=(0,t.cn)((e=>e(l)?"":p(e)),((e,n,i)=>{n(l,!1),n(c,i)})),p=e=>{var n;const i=e(c);return i?null===(n=JSON.parse(i))||void 0===n?void 0:n.id:""},y=(0,t.cn)((e=>e(l)?"":(e=>{var n;const i=e(c);return i?null===(n=JSON.parse(i))||void 0===n?void 0:n.teamId:""})(e)),((e,n,i)=>{n(l,!1),n(c,i)}))},653930:(e,n,i)=>{"use strict";i.d(n,{e:()=>t});const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"toggleActivityRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toggleActivityRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"isRead"},value:{kind:"Variable",name:{kind:"Name",value:"isRead"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FeedActivity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isRead"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ActivityReadStatusUpdateError"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"errorFaced"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ActivityReadStatusUpdate"}}}}]}}]}},893855:(e,n,i)=>{"use strict";i.d(n,{_3:()=>t});const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateActivitySettings"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"settingsUpdate"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ActivitySettingsUpdate"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subCategoryPageId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateActivitySettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"settingsUpdate"},value:{kind:"Variable",name:{kind:"Name",value:"settingsUpdate"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ActivitySettingsUpdate"}}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"subCategoryPageId"},value:{kind:"Variable",name:{kind:"Name",value:"subCategoryPageId"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"error"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"settingsList"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"value"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"NotificationSettingsOptions"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"UserActivitySetting"}}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ActivitySettings"}}}}]}}]}},712208:(e,n,i)=>{"use strict";i.d(n,{KL:()=>a,zA:()=>d,h8:()=>l});var t=i(332507);const a=()=>Promise.all([i.e(122297),i.e(140641),i.e(256045),i.e(755684),i.e(296056),i.e(277599),i.e(102207),i.e(307317),i.e(9081),i.e(120197)]).then(i.bind(i,814027)),o=()=>i.e(979630).then(i.t.bind(i,686198,23)),d=()=>(0,t.mT)(a,"search-answer-v2"),l=()=>(0,t.mT)(o,"search-answer-v2-override")},972300:(e,n,i)=>{"use strict";i.d(n,{tY:()=>a,jx:()=>d,lS:()=>l});var t=i(332507);const a=()=>Promise.all([i.e(917388),i.e(892924),i.e(166304),i.e(32181),i.e(198998),i.e(561167),i.e(942475)]).then(i.bind(i,226871)),o=()=>Promise.all([i.e(198998),i.e(223490)]).then(i.t.bind(i,435839,23)),d=()=>(0,t.mT)(a,"search-answer"),l=()=>(0,t.mT)(o,"search-answer-override")},935915:(e,n,i)=>{"use strict";var t,a,o,d;i.d(n,{H$:()=>t,a6:()=>a,P$:()=>o,cd:()=>d}),function(e){e.Outlook="Outlook",e.Google="Google"}(t||(t={})),function(e){e.Connect="Connect",e.Disconnect="Disconnect"}(a||(a={})),function(e){e.Default="Default",e.Connect="Connect",e.Disconnect="Disconnect"}(o||(o={})),function(e){e.Error="Error",e.Syncing="Syncing"}(d||(d={}))},46845:(e,n,i)=>{"use strict";i.d(n,{l:()=>c,S:()=>l});var t=i(242863),a=i(697337);const o="ðŸ“· GIF",d=e=>!!e&&e.split("giphy.com").length>1;function l(e,n){(0,t.addHook)("uponSanitizeElement",s),(0,t.addHook)("uponSanitizeElement",r),n&&(0,t.addHook)("uponSanitizeElement",m);const i=(0,t.sanitize)(e,{ALLOWED_TAGS:[]});return(0,t.removeHooks)("uponSanitizeElement"),i}function r(e){"BR"===e.tagName&&e.replaceWith(" ")}function s(e){"BLOCKQUOTE"===e.tagName&&e.remove()}function m(e){var n;if("IMG"!==e.tagName)return;const i=null!==(n=e.getAttribute("src"))&&void 0!==n?n:"";if(d(i))return void e.replaceWith(o);const t=e.getAttribute("alt");if(!t)return;switch(e.getAttribute("itemtype")){case a.T.emoji:e.replaceWith(t);break;case a.T.customEmoji:e.replaceWith(`(${t})`)}}function c(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')}},289931:(e,n,i)=>{"use strict";i.d(n,{i1:()=>t,t3:()=>l,tT:()=>r,BN:()=>s,vc:()=>m});var t,a=i(377509),o=i(50805),d=i(500396);function l(e){const{allowUserChat:n,messagingPolicy:i}=e;return"boolean"==typeof n||!!i?n?t.Enabled:t.Disabled:t.Unknown}function r(){const e=(0,a.NC)(o.J.Messaging);return e.enableComposeDisabledBasedOnPolicy?l(e):t.Enabled}function s(e){const n=r();return e===d.k2.Meeting||e===d.k2.Channel?t.Enabled:n}function m(e,n){const i=s(e),{enablePinMessageToChat:d}=(0,a.NC)(o.J.Messaging);return n&&!!d&&i!==t.Disabled}!function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.Unknown="Unknown"}(t||(t={}))},317655:(e,n,i)=>{"use strict";i.d(n,{_Z:()=>l,qK:()=>r,F2:()=>s,$i:()=>m,Xk:()=>c,Qp:()=>u,f0:()=>p,d1:()=>y,Ue:()=>k,XH:()=>g});var t=i(956255),a=i(955105);const o="communities-selected-id",d="current-enitity-type",l=[t.py.communities,t.py.communitiesjoinrequest,t.py.communitiesmembers,t.py.communitiesblockmembers],r=()=>localStorage.getItem(o),s=()=>localStorage.getItem("communities-selected-reply-id"),m=()=>localStorage.getItem(d),c=()=>localStorage.removeItem(d),u=e=>(null==e?void 0:e.id)===(null==e?void 0:e.teamId),p=e=>[t.py.communities,t.py.communitiesjoininviteview].some((n=>n===e)),y=(e,n)=>{const i=[a.D.ActivityFeed,a.D.ActivityFeedBellClick];return e&&i.includes(e)||!!n},v=(e,n,i,t,a)=>{if(n.includes(t)&&i.includes(a))return e},k=(e,n,i)=>{const a=v(e,[t.py.communitiesonboarding,t.py.communities],[t.uk.join,t.uk.update],n,i),{inviteLinkUrl:o}=(null==a?void 0:a(n,i))||{};return o},g=(e,n,i)=>{const a=v(e,[t.py.communities],[t.uk.view],n,i),{isPostLink:o,enqueSwitch:d,source:l}=(null==a?void 0:a(n,i))||{};return{isPostLink:o,enqueSwitch:d,source:l}}},250236:(e,n,i)=>{"use strict";i.d(n,{_I:()=>t});const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"publishContactsSyncSettings"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"syncSettings"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ContactsSyncSettingsInput"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"skipMiddleTierUpdate"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"publishContactsSyncSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"syncSettings"},value:{kind:"Variable",name:{kind:"Name",value:"syncSettings"}},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ContactsSyncSettingsInput"}}}}}},{kind:"Argument",name:{kind:"Name",value:"skipMiddleTierUpdate"},value:{kind:"Variable",name:{kind:"Name",value:"skipMiddleTierUpdate"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]}},916553:(e,n,i)=>{"use strict";i.d(n,{H:()=>t});class t{constructor(){this.registerAppPhase=({phase:e,signals:n,timeout:i})=>{const t=this._phasesMap.get(e);this._phasesMap.set(e,Object.assign(Object.assign({},t),{signals:n,timeout:i}))},this._phasesMap=new Map}get appPhases(){return{phases:this._phasesMap}}}},208569:(e,n,i)=>{"use strict";i.d(n,{c:()=>t});const t=e=>n=>n.reduce(((n,i)=>(n[i]=e[i],n)),{})},356088:(e,n,i)=>{"use strict";i.d(n,{FU:()=>t,ZG:()=>o});var t,a=i(419925);!function(e){e.DEFAULT="default",e.HEADER_AT_BOTTOM="header_at_bottom",e.HYER="hyer"}(t||(t={}));class o{constructor({layoutKey:e=t.DEFAULT,layoutMode:n,layoutTemplatesPerLayoutMode:i}){var o;this.getTemplate=({layoutKey:e=t.DEFAULT,layoutMode:n,slots:i,slotsDimensionsOverrides:a={}})=>{const o=this._layoutTemplates[n][this._getKeyFromSlotNameArray(e,i)];return"function"==typeof o?o(a):o},this._getKeyFromSlotNameArray=(e=t.DEFAULT,n)=>[e,...[...n].sort()].join("-"),this._layoutTemplates={[a.lO.focus]:{},[a.lO.minimal]:{},[a.lO.standard]:{},[a.lO.minimode]:{}},null===(o=i[n])||void 0===o||o.forEach((i=>{(i.layoutKey||t.DEFAULT)===e&&this._registerTemplates(Object.assign({layoutMode:n},i))}))}_registerTemplates({layoutKey:e=t.DEFAULT,layoutMode:n,responsiveTemplates:i,slots:a}){const o=this._getKeyFromSlotNameArray(e,a);if(void 0!==this._layoutTemplates[n][o])throw new Error(`You can't have two templates with same slots for same layoutMode, slots: ${o} layoutMode: ${n}`);this._layoutTemplates[n][o]="function"==typeof i?i:()=>i}}},952445:(e,n,i)=>{"use strict";i.d(n,{rx:()=>t});const t=(e,n)=>{((e,n)=>{const i=e.getElementById("splash-screen");i&&(i.setAttribute("aria-hidden","true"),e.body.removeChild(i),n&&(n.style.display="block"))})(e,n),(e=>{const n=e.getElementsByClassName("preload-title-bar-trim")[0];n&&e.body.removeChild(n)})(e)}},44175:(e,n,i)=>{"use strict";i.d(n,{o:()=>N});var t=i(740597),a=i(50805),o=i(332507),d=i(929778),l=i(482707),r=i(250033),s=i(818319),m=i(811537),c=i(827748),u=i(112835);const p=()=>(0,r.t)(u.e,Object.assign({client:{}},{children:(0,r.t)("div",{})}));class y extends s.PureComponent{constructor(){super(...arguments),this.divRef=s.createRef(),this.siblingEl=s.createRef()}componentDidMount(){const{document:e}=this.props.mainWindow,n=e.createElement("div");this.divRef.current&&(this.divRef.current.appendChild(n),n.dispatchEvent(new MouseEvent("mouseout",{bubbles:!0,cancelable:!0,relatedTarget:this.siblingEl.current})))}render(){return(0,r.t)("div",Object.assign({ref:this.divRef},{children:(0,r.t)("div",{ref:this.siblingEl,onMouseEnter:()=>{}})}))}}class v extends s.PureComponent{constructor(){super(...arguments),this.state={mounted:!1}}componentDidMount(){this.setState({mounted:!0})}render(){return(0,r.t)("div",{})}}const k=e=>{(e=>{e.document.body.dispatchEvent(new MouseEvent("click",{bubbles:!0}))})(e)};var g=i(738646);const N=(e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const o=yield h(n);return e.pipe((0,d.j)((({id:e,window:t,context$:a})=>((e,n,i,t,a,o)=>{if(!e)return null;const d=e.document.getElementById("app");if(!d){const e=a.loggerFactory.newLogger("entry","components-core-layout");return e.errorToTelemetry&&e.errorToTelemetry("element with ID 'app' not found on the document.","webclient_framework_foundation_components_render_windows",void 0,!0),null}a.scenarioFactory.startStep(g.RG.ExperienceReady,g.ck.RenderProviders);const r=new l.Z({context$:n,coreServices:a,getExperienceProps:i,reactDiagnosticsService:o,rootElement:d,windowId:t,window:e});return r.activate(),{coreRenderer:r,host:e,windowId:t}})(t,a,i,e,n,o)),(e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){if(!e)return;const{host:i,coreRenderer:o,windowId:d}=e;k(i),o.deactivate();const l=n.windowProvider;yield(e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const n=e.document,i=n.body,t=n.createElement("div");t.setAttribute("id","memory-cleanup");const a=i.appendChild(t);yield(0,c._)(0),m.render((0,r.t)(s.Fragment,{children:[(0,r.t)(p,{}),(0,r.t)(y,{mainWindow:e}),(0,r.t)(v,{})]}),a),m.unmountComponentAtNode(a),i.removeChild(a)})))(l);const{dataCleanupService:u,dataEvictionService:g,coreSettings:N}=n;u.markDataForWindowAsInactive(d);const{enableSingleApolloCoreCache:h}=N.get(a.J.Core);h&&(null==g||g.evict())}))),(({id:e})=>e))).subscribe()})),h=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{enableReactDiagnostics:n,enableReactDiagnosticsConsoleLog:t,enableReactDiagnosticsDisplayNameFix:d}=e.coreSettings.get(a.J.Diagnostics);if(n)try{const{initReactDiagnostics:n,ReactDiagnosticsService:a}=yield(0,o.mT)((()=>Promise.all([i.e(163165),i.e(127919),i.e(582271)]).then(i.bind(i,588746))),"react-diagnostics",e.scenarioFactory),l=new a(!!t,!!d);return n(l),l}catch(n){const i=e.loggerFactory.newLogger("react-diagnostics","components-core-layout");i.errorToTelemetry&&i.errorToTelemetry(`Failed to load react-diagnostic ${n}`,"webclient_framework_foundation_components_render_windows",void 0,!0)}}))},854364:(e,n,i)=>{"use strict";i.d(n,{F:()=>a});var t=i(362932);function a(e,n){return(0,t.getTabsterAttribute)({observed:{names:Array.isArray(e)?e:[e]},uncontrolled:n?{}:void 0})}},3959:(e,n,i)=>{"use strict";var t;i.d(n,{l:()=>t}),function(e){e.OOFSettingsPage="general_settings_oof_settings_page_title"}(t||(t={}))},16076:(e,n,i)=>{"use strict";i.d(n,{CH:()=>k,Oh:()=>y});var t=i(740597),a=i(818319),o=i(132333),d=i(489390),l=i(263e3);const r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsGuardiansApprovalStatusQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"studentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getGuardiansApprovalStatus"},arguments:[{kind:"Argument",name:{kind:"Name",value:"studentId"},value:{kind:"Variable",name:{kind:"Name",value:"studentId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"teamId"},value:{kind:"Variable",name:{kind:"Name",value:"teamId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"approvalId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"approvalStatus"},__type:{kind:"NamedType",name:{kind:"Name",value:"GuardiansApprovalStatus"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"GuardiansApprovalStatusResult"}}}]}}]},s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ComponentsGuardiansCreateApprovalMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"studentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"title"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"relatedContacts"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"RelatedContactPayload"}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createGuardiansApproval"},arguments:[{kind:"Argument",name:{kind:"Name",value:"teamId"},value:{kind:"Variable",name:{kind:"Name",value:"teamId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"studentId"},value:{kind:"Variable",name:{kind:"Name",value:"studentId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"title"},value:{kind:"Variable",name:{kind:"Name",value:"title"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"relatedContacts"},value:{kind:"Variable",name:{kind:"Name",value:"relatedContacts"}},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"RelatedContactPayload"}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"approvalId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"CreateGuardiansApprovalResult"}}}]}}]};var m=i(194053),c=i(738646),u=i(377509),p=i(50805);const y=(e,n)=>{var i,t;const{scenarioFactory:a}=(0,m.SE)(),{enableParentsDataIngestion:d}=(0,u.NC)(p.J.Guardians),l=g(a,!!d,e,n),{data:s,error:c,loading:y}=(0,o.a)(r,{variables:{studentId:e,teamId:n},fetchPolicy:"cache-first",context:{callerInfo:"components-student-contact-card-container"},skip:!e||!n||!d});return N(c,l,!!d,(null===(i=null==s?void 0:s.getGuardiansApprovalStatus)||void 0===i?void 0:i.approvalStatus)||"",y),{guardiansApprovalStatus:null===(t=null==s?void 0:s.getGuardiansApprovalStatus)||void 0===t?void 0:t.approvalStatus,loading:y}},v=(e,n,i)=>a.useCallback(((a,o)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,d;try{a.writeQuery({query:r,variables:{studentId:e,teamId:n},data:{getGuardiansApprovalStatus:{approvalStatus:l.GO.Pending,approvalId:null===(d=null===(t=o.data)||void 0===t?void 0:t.createGuardiansApproval)||void 0===d?void 0:d.approvalId,__typename:"GuardiansApprovalStatusResult"}}})}catch(t){yield((e,n,i)=>e.query({query:r,variables:{studentId:n,teamId:i},fetchPolicy:"network-only",context:{callerInfo:"components-student-contact-card-container"}}))(i,e,n)}}))),[i,e,n]),k=(e,n,i,t)=>{const o=v(n,e,t),[l,{loading:r,error:m}]=(0,d.D)(s,{fetchPolicy:"network-only",context:{callerInfo:"guardians-approval-request-dialog-container"},update:o});return{createGuardiansApproval:a.useCallback((t=>l({variables:{teamId:e,studentId:n,title:i,relatedContacts:t}})),[l,e,n,i]),loading:r,error:m}},g=(e,n,i,t)=>{if(n){const n=e.newScenario(c.RG.GetGuardiansApprovalStatus);return n.appendEventData({studentId:i||"",groupId:t||""}),n}return null},N=(e,n,i,t,a)=>{var o,d,l,r;if(i&&n&&!a)if(e){const{message:i}=e,{code:t,context:a,reason:s}=null!==(r=null===(l=null===(d=null===(o=null==e?void 0:e.graphQLErrors)||void 0===o?void 0:o[0])||void 0===d?void 0:d.extensions)||void 0===l?void 0:l.prevError)&&void 0!==r?r:{},m=`ErrorMessage: ${i}`;n.fail({context:a,reason:s,errorCode:t,errors:m})}else n.stop({approvalStatus:t})}},133698:(e,n,i)=>{"use strict";i.d(n,{NU:()=>l,RQ:()=>r,WN:()=>s});var t=i(818319),a=i(194053),o=i(419925),d=i(955105);const l=e=>{const{memberAndRelatedContacts:n,initialAction:i,initialViewMode:l}=e,{entityCommanding:r}=(0,a.SE)();return t.useCallback((()=>{r.guardians.showGuardiansApprovalRequestDialog({stateTransition:o.su.extend,visibilityState:o.fe.show,correlation:{source:d.D.EducationGuardians}},{memberAndRelatedContacts:n,initialAction:i,initialViewMode:l})}),[i,r.guardians,n,l])},r=()=>{const{entityCommanding:e}=(0,a.SE)();return t.useCallback((()=>{e.guardians.showSendApprovalSuccessDialog({stateTransition:o.su.new,visibilityState:o.fe.show,correlation:{source:d.D.EducationGuardians}})}),[e.guardians])},s=()=>{const{entityCommanding:e}=(0,a.SE)();return t.useCallback((()=>{e.guardians.showSendApprovalErrorDialog({stateTransition:o.su.new,visibilityState:o.fe.show,correlation:{source:d.D.EducationGuardians}})}),[e.guardians])}},651966:(e,n,i)=>{"use strict";i.d(n,{ei:()=>p,Pq:()=>v,PO:()=>k,JW:()=>y,hO:()=>f,D7:()=>h,ox:()=>g,pQ:()=>u,Jj:()=>N});var t=i(956255),a=i(419925),o=i(955105),d=i(554404),l=i(549571),r=i(738646),s=i(369398);const m=["bd9fb5cb-4d02-4cc6-a7f4-52a8a62d30b7","9d17e873-c4c4-424d-869c-67f62a3d3174","77be3f72-7c14-415f-992c-3511dd54a4ae","66aeee93-507d-479a-a3ef-8f494af43945","62554c36-4756-4d4e-b8fb-f4b24875ae0c","2c95977d-f2fb-4df3-ad70-1aece87afe03","98eb9edc-3b11-4950-8780-c6ec73d71571","98eb9edc-3b11-4950-8780-c6ec73d71572","be9c77ca-202c-4f11-9241-b27afd891781","5a22b425-b693-4f86-b668-31baeb3dad6c","b85718a3-6d15-4f59-8fad-b6809c6fc6a9","2c95977d-f2fb-4df3-ad70-1aece87afe00","2c95977d-f2fb-4df3-ad70-1aece87afe01","2c95977d-f2fb-4df3-ad70-1aece87afe02"],c="_djb2_msteams_prefix_",u="tab::",p=2,y=(e,n)=>(null==n?void 0:n.startsWith(c))?n:`${c}${(0,l.E)(`${e}:${null==n?void 0:n.replace(/\+/g," ")}`)}`,v=(e,n,i,l,r,s,m,c,u,p,y)=>{var v,k;return{entity:{type:t.py.extensions,id:JSON.stringify({appId:e,tabEntityId:s,subEntityId:c}),action:t.uk.view},command:{visibilityState:null!==(v=null==m?void 0:m.visibilityState)&&void 0!==v?v:a.fe.show,stateTransition:n?a.su.new:null!==(k=null==m?void 0:m.stateTransition)&&void 0!==k?k:a.su.flush,correlation:{source:null!=r?r:o.D.Unknown,startTimestamp:Date.now()}},entityOptions:{entryPoint:l?d.mQ.activityFeed:d.mQ.personalApp,isMultiWindow:n,subEntityId:c,isAppSelected:u,source:r,originalDeeplink:p||void 0,reloadTrigger:i,isFromActivityFeed:l,skipAppCacheRemoveOnReload:y}}},k=(e,n,i,l,r,s,c)=>{var u,p;return{entity:{type:t.py.extensions,id:JSON.stringify({appId:n,threadId:i||l,tabId:null,tabEntityId:y(n,r)}),action:t.uk.view,linkedEntity:{id:i?JSON.stringify({channelId:i}):l,type:i?t.py.channels:t.py.chats,action:t.uk.view}},command:{visibilityState:null!==(u=null==s?void 0:s.visibilityState)&&void 0!==u?u:a.fe.show,stateTransition:null!==(p=null==s?void 0:s.stateTransition)&&void 0!==p?p:a.su.forceFlush,correlation:{source:o.D.PlatformTabDeepLink,startTimestamp:Date.now()}},entityOptions:{entryPoint:i?d.mQ.channelTab:d.mQ.chatTab,source:o.D.PlatformTabDeepLink,subEntityId:c,originalDeeplink:e,isAppTeamLevelApp:m.includes(n)}}},g={files:"files",photos:"photos",attendancereport:"attendancereport",recordingsandtranscripts:"recordingsandtranscripts",recap:"recap",breakoutrooms:"breakoutrooms",coachReport:"coachReport"},N=(e,n,i,l,s,m,c)=>{var u,p;null===(u=null==c?void 0:c.findScenario(r.RG.PlatformTabDeeplinkHandling))||void 0===u||u.cancel();const y=null==c?void 0:c.newScenario(r.RG.PlatformTabDeeplinkHandling);y&&(null===(p=null==c?void 0:c.hoistScenarioToCore)||void 0===p||p.call(c,y)),null==y||y.appendEventData({"PlatformTabDeeplink.pathname":i.pathname,"PlatformTabDeeplink.search":i.search}),null==y||y.mark("create_deeplink_command");const v="files"===m,k=(e=>{switch(e){case g.files:return t.py.file;case g.photos:return t.py.gallery;case g.attendancereport:return t.py.meetinganalytics;case g.recordingsandtranscripts:return t.py.transcriptcontent;case g.recap:return t.py.meetingrecap;case g.breakoutrooms:return t.py.breakoutrooms;case g.coachReport:return t.py.coachreport;default:return t.py.extensions}})(m),N={entityCommand:{entity:{type:k,action:v?t.uk.list:t.uk.view,id:k===t.py.extensions?JSON.stringify({appId:null,threadId:e||n,tabId:m,tabEntityId:null}):null,linkedEntity:{id:e?JSON.stringify({channelId:e}):n,type:e?t.py.channels:t.py.chats,action:t.uk.view}},command:{visibilityState:a.fe.show,stateTransition:a.su.flow},entityOptions:Object.assign({subEntityId:null==s?void 0:s.subEntityId,entryPoint:e?d.mQ.channelTab:d.mQ.chatTab,source:o.D.PlatformTabDeepLink,deeplinkStartedTime:Date.now(),originalDeeplink:i},k===t.py.coachreport&&{threadId:n})},metadata:{allowAnonymous:!1,tenantId:l}};return null==y||y.mark("return_deeplink_command"),null==y||y.appendEventData({"PlatformTabDeeplink.generatedCommand":N.toString()}),Promise.resolve(N)},h=(e,n,i)=>{var t,a,o,d;const l=null!==(a=null===(t=null==n?void 0:n.baseInfo)||void 0===t?void 0:t.appId)&&void 0!==a?a:"",r=null!==(d=null===(o=null==n?void 0:n.baseInfo)||void 0===o?void 0:o.id)&&void 0!==d?d:"";let m="";return"StaticExtensionTab"!==(null==n?void 0:n.__typename)&&"ExtensionTab"!==(null==n?void 0:n.__typename)||!(null==n?void 0:n.entityId)||(m=null==n?void 0:n.entityId),{appId:l,threadId:e,tabId:r,tabEntityId:m,messageId:(0,s.eA)(i)?i:void 0}},f=(e,n,i,t,a)=>{var o,d,r,m;const c=null!==(d=null===(o=null==n?void 0:n.baseInfo)||void 0===o?void 0:o.appId)&&void 0!==d?d:"",u=null!==(m=null===(r=null==n?void 0:n.baseInfo)||void 0===r?void 0:r.id)&&void 0!==m?m:"";let p="";return"StaticExtensionTab"!==(null==n?void 0:n.__typename)&&"ExtensionTab"!==(null==n?void 0:n.__typename)||!(null==n?void 0:n.entityId)||(p=null==n?void 0:n.entityId),t&&a?JSON.stringify(((e,n,i,t,a)=>{var o,d,r,m,c;const u=("ExtensionTab"===(null==e?void 0:e.__typename)||"StaticExtensionTab"===(null==e?void 0:e.__typename))&&(null==e?void 0:e.entityId)||null,p=u?`_djb2_msteams_prefix_${(0,l.E)(`${t?null===(o=null==e?void 0:e.baseInfo)||void 0===o?void 0:o.externalAppId:null===(d=null==e?void 0:e.baseInfo)||void 0===d?void 0:d.appId}:${null==u?void 0:u.replace(/\+/g," ")}`)}`:null;return i?{appId:u?t?null===(r=null==e?void 0:e.baseInfo)||void 0===r?void 0:r.externalAppId:null===(m=null==e?void 0:e.baseInfo)||void 0===m?void 0:m.appId:null,threadId:n,tabId:u?null:null===(c=null==e?void 0:e.baseInfo)||void 0===c?void 0:c.id,tabEntityId:p,messageId:(0,s.eA)(a)?a:void 0}:{appId:e.baseInfo.appId,threadId:n,tabId:e.baseInfo.id,tabEntityId:u,messageId:(0,s.eA)(a)?a:void 0}})(n,e,t,void 0,i)):JSON.stringify({appId:c,threadId:e,tabId:u,tabEntityId:p,messageId:(0,s.eA)(i)?i:void 0})}},548996:(e,n,i)=>{"use strict";i.d(n,{W8:()=>t,xT:()=>a,fk:()=>o});const t=e=>{const{removeUrl:n,contentUrl:i,websiteUrl:t,entityId:a,baseInfo:o}=e||{};return{removeUrl:n||void 0,contentUrl:i||"",websiteUrl:t||void 0,entityId:a||void 0,suggestedDisplayName:(null==o?void 0:o.displayName)||void 0}},a=(e,n,i)=>{var t,a,o,d;const l=e=>e&&String(e);let r;return r=i?{contentUrl:l(e.contentUrl)||(null==n?void 0:n.contentUrl)||"",websiteUrl:null!==(t=l(e.websiteUrl))&&void 0!==t?t:null==n?void 0:n.websiteUrl}:{contentUrl:l(e.contentUrl)||(null==n?void 0:n.contentUrl)||"",removeUrl:null!==(a=l(e.removeUrl))&&void 0!==a?a:null==n?void 0:n.removeUrl,websiteUrl:null!==(o=l(e.websiteUrl))&&void 0!==o?o:null==n?void 0:n.websiteUrl,entityId:null!==(d=l(e.entityId))&&void 0!==d?d:null==n?void 0:n.entityId,suggestedDisplayName:l(e.suggestedDisplayName)||(null==n?void 0:n.suggestedDisplayName)},r},o=(e,n,i,t,a,o)=>{if(i)return e.log("app is not supported because appId not found in the current thread"),i;const d=null==t?void 0:t.includes(n);if(d)return e.log("app is not supported because appId is found in the disabledTabAppIds blocklist"),d;if(n&&a){const i=a.includes(n);if(o){if(!i)return e.log("app is not supported because appId is not present in the appIdlist whitelist"),!i}else if(i)return e.log("app is not supported because appId is  present in the appIdlist blocklist"),i}return!1}},492963:(e,n,i)=>{"use strict";i.d(n,{P:()=>t});const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ComponentsPrivacySettingsUnlinkExternalAccountMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"accountId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"accountAddress"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"provider"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ExternalAccountProvider"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hardDelete"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"unlinkExternalAccount"},arguments:[{kind:"Argument",name:{kind:"Name",value:"accountId"},value:{kind:"Variable",name:{kind:"Name",value:"accountId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"accountAddress"},value:{kind:"Variable",name:{kind:"Name",value:"accountAddress"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"provider"},value:{kind:"Variable",name:{kind:"Name",value:"provider"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ExternalAccountProvider"}}}},{kind:"Argument",name:{kind:"Name",value:"hardDelete"},value:{kind:"Variable",name:{kind:"Name",value:"hardDelete"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]}},84642:(e,n,i)=>{"use strict";i.d(n,{uJ:()=>t});const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"contactsSyncSettings"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isContactsSyncEnabled"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"contactsSyncSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"isContactsSyncEnabled"},value:{kind:"Variable",name:{kind:"Name",value:"isContactsSyncEnabled"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"source"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ContactsSyncSource"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isSyncAllowed"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"accountId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deltaToken"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"currentSyncStatus"},__type:{kind:"NamedType",name:{kind:"Name",value:"ContactsSyncWorkflowStatus"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ContactsSyncSettings"}}}}}}]}}]}},921728:(e,n,i)=>{"use strict";i.d(n,{i:()=>t});const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"deleteCalendarEventsCache"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxAddress"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteCalendarEventsCache"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mailboxAddress"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxAddress"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]}},401801:(e,n,i)=>{"use strict";i.d(n,{p:()=>t});const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsSimpleCollabEntrySimpleCollabSettingsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"simpleCollabUserSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasUserEnabledAdaptiveRailForDesktop"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hasUserEnabledUnifiedAppForDesktop"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"SimpleCollabUserSettings"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferences"}}},arguments:[]}]}}]}},810425:(e,n,i)=>{"use strict";i.d(n,{z:()=>o});var t=i(740597),a=i(401801);const o=(e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var i;let t=!1;const{enableSimpleCollabApp:o,enableSimpleCollabAppToggle:l}=n;if(o&&l){const{data:n}=yield e.query({query:a.p,fetchPolicy:"network-only"}),l=(null===(i=null==n?void 0:n.userPreferences)||void 0===i?void 0:i.simpleCollabUserSettings)||{};t=d(o,l)}return t})),d=(e,n)=>{let i=!1;const t=!0===n.hasUserEnabledAdaptiveRailForDesktop&&!0===n.hasUserEnabledUnifiedAppForDesktop;return i=e&&t,i}},772167:(e,n,i)=>{"use strict";var t,a;i.d(n,{XW:()=>t,uy:()=>a,Gv:()=>o}),function(e){e.CreateTeam="CreateTeam",e.CreateChannel="CreateChannel",e.JoinTeam="JoinTeam",e.JoinTeamByCode="JoinTeamByCode",e.AddMember="AddMember",e.AddChannel="AddChannel",e.MarkAllChannelsAsRead="MarkAllChannelsAsRead",e.ManageTeamsList="ManageTeamsList",e.ManageTeamsInvites="ManageTeamsInvites",e.CrossTeamAnalytics="CrossTeamAnalytics"}(t||(t={})),function(e){e.None="None",e.PinChannel="PinChannel",e.UnpinChannel="UnpinChannel",e.ShowChannel="ShowChannel",e.HideChannel="HideChannel",e.ShowTeam="ShowTeam",e.HideTeam="HideTeam",e.ExpandTeam="ExpandTeam",e.CollapseTeam="CollapseTeam",e.ReorderTeam="ReorderTeam",e.ReorderPinnedChannels="ReorderPinnedChannels",e.ForceHideTeam="ForceHideTeam"}(a||(a={}));const o={forceSync:!1}},165690:(e,n,i)=>{"use strict";i.d(n,{Hj:()=>d,_u:()=>r,Rb:()=>s,Bw:()=>m,fg:()=>c,tO:()=>u,Xf:()=>y,iG:()=>v,A4:()=>k});var t=i(118418),a=i(466149);const o=[a.Tk.Transferring,a.Tk.TransferFailed,a.Tk.TransferSucceeded],d=e=>o.includes(e),l=[a.Tk.Parking,a.Tk.ParkFailed,a.Tk.ParkSucceeded],r=e=>l.includes(e),s=e=>(e=>e===t.OX.LocalHold)(e)||(e=>e===t.OX.RemoteHold)(e),m=e=>e===t.OX.Disconnected,c=e=>!(!e||e!==t.Fz.Park),u=(e,n)=>e===t.OX.Observing&&n,p=[t.OX.Notified,t.OX.EarlyMedia,t.OX.None],y=e=>!(k(e)||p.includes(e.state))||d(e.extendedCallState)||r(e.extendedCallState),v=[t.OX.Connected,t.OX.Connecting,t.OX.Staging],k=e=>v.includes(e.state)},632262:(e,n,i)=>{"use strict";i.d(n,{l8:()=>w,FC:()=>S});var t=i(250033),a=i(818319),o=i(758980),d=i(168731),l=i(38023),r=i(156803),s=i(377509),m=i(554694),c=i(50805),u=i(373554);const p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"activeCallsChangedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeCallsChangedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"calls"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamsCallId"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"callInitiator"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"replyChainMessageId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"conversationId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"tenantId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"organizerId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"CallInfo"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ActiveCallsChanged"}},arguments:[]}]}}]};var y=i(949556),v=i(523197),k=i(248187),g=i(22085),N=i(508813),h=i(970615),f=i(74583);const[_,S]=(0,o.j)("ActiveCallsContext");function T(e){return null!=e}const b=new Map,C=(e,n,{data:i,error:t})=>{var a,o;if(t)return e.error(`Failed to receive data from activeCallsChangedEvent: ${t}`),n;const d=null===(a=null==i?void 0:i.activeCallsChangedEvent)||void 0===a?void 0:a.id;if(!d)return n;const l=((null===(o=null==i?void 0:i.activeCallsChangedEvent)||void 0===o?void 0:o.calls)||[]).filter(T),r=new Map(n);return 0===l.length?(e.log(`No more calls found in ${d}. Removing from active calls map`),r.delete(d),0===r.size?b:r):(e.log(`Updating key in map for conversation ${d}. Number of active calls: ${l.length}`),new Map(r.set(d,l.reduce(((e,n)=>n.messageId?e.set(n.messageId,n):e),new Map))))},w=({children:e})=>{const n=(0,u.x)(),i=(0,m.w)("ActiveCallsContextContainer"),{enableActiveCallsSubscription:o}=(0,s.NC)(c.J.Channels),S=(()=>{const e=a.useMemo((()=>new d.xQ),[]);return a.useEffect((()=>()=>{e.next(),e.complete()}),[e]),e})(),[T,w]=a.useMemo((()=>{const e=new l.X(b);if(!o)return[e,f.noop];const t=(0,y.G)(n.subscribe({query:p,fetchPolicy:"no-cache"})).pipe((0,v.R)(S),(0,k.R)(((e,n)=>C(i,e,n)),b),(0,g.x)(),(0,N.d)(1),(0,h.K)((e=>(i.error("An exception occurred while subscribing to active calls",e),(0,r.of)(b))))).subscribe(e);return[e,()=>t.unsubscribe()]}),[n,o,i,S]);return a.useEffect((()=>w)),(0,t.t)(_,{source$:T,children:e})}},78860:(e,n,i)=>{"use strict";i.d(n,{vb:()=>d,c6:()=>l});var t=i(250033),a=i(818319);const o=a.createContext(""),d=a.memo((e=>{const{children:n,joinId:i}=e;return(0,t.t)(o.Provider,Object.assign({value:i},{children:n}))})),l=()=>a.useContext(o)},580765:(e,n,i)=>{"use strict";i.d(n,{N:()=>s,F:()=>c});var t=i(250033),a=i(818319),o=i(554694),d=i(132333);const l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsCommunitiesAppSettingsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"communitiesAppConfig"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseImageUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"CommunitiesAppConfig"}},arguments:[]}]}}]},r=a.createContext({baseImageUrl:null}),s=({children:e})=>{var n,i;const a=(0,o.w)("CommunitiesAppSettingsProvider"),{data:s}=(0,d.a)(l),c=(null===(n=null==s?void 0:s.communitiesAppConfig)||void 0===n?void 0:n.baseImageUrl)||"",u={baseImageUrl:c};return c||null===(i=a.errorToTelemetry)||void 0===i||i.call(a,"Communities avatar base image URL not found","communities_avatar_base_url_not_found"),(0,t.t)(r.Provider,Object.assign({value:m(u)},{children:e}))},m=e=>a.useMemo((()=>Object.assign({},e)),[e]),c=()=>a.useContext(r)},928315:(e,n,i)=>{"use strict";i.d(n,{Id:()=>o,yx:()=>l,Cs:()=>r});var t=i(250033),a=i(818319);const o={isCallModeStreaming:()=>!1,isFullScreenButtonDisabled:()=>!1,isInEmbedContext:()=>!1,isTestUser:()=>!1,getCallId:()=>{},getCorrelationId:()=>"",getForceAttendeeStreaming:()=>{},getEnablePlayerControlsForStreamingMode:()=>{},getParticipantId:()=>{},getStreamDetails:()=>{},getStreamingMode:()=>!1,getTelemetryData:()=>{},getThreadId:()=>"",getUiLanguagePreference:()=>{},getCallMode:()=>{},getMeetingRole:()=>{},setFullScreenButton:()=>{},setStreamDetails:()=>{},sendConveneError:()=>{},sendDataLoadError:()=>{},sendHeartbeat:()=>{},sendMetadata:()=>{},sendData:()=>{},sendServerError:()=>{},createBroadcastEndEventListener:()=>{},createCallDataUpdateEventListener:()=>{},createStreamUpdateEventListener:()=>{},createCaptionsToggleEventListener:()=>{},destroyCaptionsToggleEventListener:()=>{},createSubtitleTrackChangeEventListener:()=>{},destroySubtitleTrackChangeEventListener:()=>{},destroyBroadcastEndEventListener:()=>{},destroyCallDataUpdateEventListener:()=>{},destroyStreamUpdateEventListener:()=>{},sendReadyToRecieveBroadcastEndNotification:()=>{},sendReadyToRecieveCallDataUpdateNotification:()=>{},sendReadyToRecieveStreamUpdatesNotification:()=>{},validateEmbedStreamDetailsArray:()=>({isSuccessful:!0})},d=a.createContext(null),l=a.memo((e=>{const{conveneHostMessaging:n,children:i}=e,a={conveneHostMessaging:n||Object.assign({},o)};return(0,t.t)(d.Provider,Object.assign({value:a},{children:i}))}));l.displayName="ConveneHostMessagingContextProvider";const r=()=>a.useContext(d)},482707:(e,n,i)=>{"use strict";i.d(n,{Z:()=>p});var t,a=i(740597),o=i(250033),d=i(811537),l=(i(818319),i(952445)),r=i(905581),s=i(132756),m=i(332507),c=i(738646);null===(t=null===performance||void 0===performance?void 0:performance.mark)||void 0===t||t.call(performance,"resolve-main-imports-end");const u=()=>Promise.all([i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(241602),i.e(133950),i.e(268372),i.e(775758),i.e(315215),i.e(236315),i.e(529375),i.e(425552),i.e(9081),i.e(150486),i.e(405309),i.e(511611),i.e(141550),i.e(716618),i.e(127919),i.e(158563),i.e(802054)]).then(i.bind(i,5587));class p{constructor(e){this._activationOptions=e,this._mounted=!1,this._logger=this._activationOptions.coreServices.loggerFactory.newLogger("CoreReactRenderer","components-core-layout")}activate(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){this.deactivate();try{return this._activateRoot()}catch(e){const n=(0,r.Tr)("Experience",s.jK.Undefined,"activate",e);return this._logger.errorToTelemetry&&this._logger.errorToTelemetry(n.message,"webclient_framework_foundation_components_core_react_renderer",void 0,!0),this._activationOptions.coreServices.errorState.error=n,Promise.reject(n)}}))}deactivate(){this._mounted&&(d.unmountComponentAtNode(this._activationOptions.rootElement),this._mounted=!1)}_activateRoot(){var e;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const{window:n,rootElement:i,coreServices:{altScenarioService:t,scenarioFactory:a}}=this._activationOptions,{RootRenderer:r}=yield(0,m.mT)(u,"core-essentials",a);return null===(e=null==t?void 0:t.altScenario)||void 0===e||e.mark(c.ck.CoreEssentialsChunkLoad),new Promise((e=>{d.render((0,o.t)(r,Object.assign({},this._activationOptions)),i,(()=>{this._mounted=!0,n&&(0,l.rx)(n.document,i),e()}))}))}))}}},851047:(e,n,i)=>{"use strict";i.d(n,{Mx:()=>S});var t=i(740597),a=i(250033),o=i(818319),d=i(373554);const l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"presence"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PresenceSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"presence"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PresenceSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userPresenceData"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Presence"}}}]}},...i(232312).OY.definitions]};var r=i(447970),s=i(959394),m=i(415394),c=i(610434),u=i(197602),p=i(373241),y=i(136209),v=i(156385),k=i(854364),g=i(589418),N=i(1142),h=i(638123);const f=({member:e,ariaLabel:n,isParentsEndSlot:i,isGuardiansApprovalRequestDialog:t})=>{const{vars:o}=(0,m.L)(),d=(0,h.D)(),{onClick:l,onKeyDown:r,onMouseEnter:s,onMouseLeave:f}=(0,v.z)({ariaLabel:n,userId:e.id});return(0,a.t)(N.Im,Object.assign({userId:e.id,ariaLabel:n},{children:(0,a.t)(c.k,Object.assign({vAlign:"center",gap:i?"gap.medium":"gap.small",variables:o("guardians",["isStudentFocus"]),onClick:l,onKeyDown:r,onMouseEnter:s,onMouseLeave:f},i&&(0,k.F)(g.D.StudentContactCard,!0),{children:[(0,a.t)(p.mw,{users:[e],isFocusable:!1,"aria-hidden":!0,profilePictureSize:y.$D.Medium,size:i?"larger":t?"medium":"small",narrateProfilePicture:!1,variables:o("guardians",["isStudentAvatar"]),v9ClassName:d.isStudentAvatar,callerInfo:"student-renderer"}),(0,a.t)(c.k.Item,Object.assign({grow:!0},{children:(0,a.t)(u.x,{size:"medium",weight:"regular",content:e.displayName,"aria-hidden":!0,variables:o("guardians",[{name:"isStudentName",props:{isParentsEndSlot:i}}]),truncated:!0})}))]}))}))},_=(e,n,i)=>{const t=i?e.stringTranslate("livePersonaCard",i):e.stringTranslate("guardians","guardians_status_unknown_label"),a=n.displayName?n.displayName:e.stringTranslate("guardians","guardians_user_unknown_label");return e.stringTranslate("guardians","guardians_student_label",{studentName:a,status:t})},S=e=>{const{member:n,isParentsEndSlot:i,isGuardiansApprovalRequestDialog:l}=e,r=(e=>{const n=(0,s.Cq)(),[i,a]=o.useState(_(n,e)),l=(0,d.x)();return o.useEffect((()=>{let i=!1;return(0,t.__awaiter)(void 0,void 0,void 0,(function*(){try{const{title:t}=yield T(l,e.id,!0);!i&&a(_(n,e,t))}catch(e){}})),()=>{i=!0}}),[e,l,n]),i})(n);return(0,a.t)(f,{member:n,ariaLabel:r,isParentsEndSlot:i,isGuardiansApprovalRequestDialog:l})},T=(e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t;if(!e)throw new Error("Apollo Client is not defined");const a=yield e.query({query:l,variables:{userId:n,source:"ups"},fetchPolicy:i?"cache-first":"network-only"});return(0,r.Tq)(null===(t=null==a?void 0:a.data)||void 0===t?void 0:t.presence)}))},637683:(e,n,i)=>{"use strict";i.d(n,{g$:()=>m,jd:()=>c,pt:()=>p,GZ:()=>y,Dk:()=>v,Mt:()=>k,pI:()=>g});var t=i(516909),a=i(132756),o=i(905581),d=i(551675),l=i(767300),r=i(955105),s=i(772167);const m=(e,n)=>{var i,a;return e.isGeneral?n!==t.S1.OwnersPost||e.memberRole===t.k_.Admin:e.memberRole===t.k_.Admin||e.isModerator||"Everyone"===(null===(i=e.channelSettings)||void 0===i?void 0:i.channelPostPermissions)||"EveryoneButGuests"===(null===(a=e.channelSettings)||void 0===a?void 0:a.channelPostPermissions)&&e.memberRole!==t.k_.Guest&&e.memberRole!==t.k_.Undefined},c=(e,n)=>{const i=decodeURIComponent(e),{channelId:t,replyChainId:d}=u(i,n);if(!("string"==typeof t)||!("string"==typeof d||null==d)){const i=`TeamsAndChannelsHelper::extractChannelMessageCompoundId::${a.jK.InvalidInput}::${e}`;throw null==n||n.error(i),(0,o.Tr)("TeamsAndChannelsHelper",a.jK.InvalidInput,"extractChannelMessageCompoundId",{compoundId:e},i)}return{channelId:t,replyChainId:d}},u=(e,n)=>{try{const{channelId:n,replyChainId:i}=JSON.parse(e);return{channelId:n,replyChainId:i}}catch(i){return null==n||n.warn(`Exception parsing channel navigation args JSON, will assume the passed id is a channel id: ${e}`),{channelId:e}}},p=e=>{if(!e)return{teamId:void 0,channelId:void 0};try{const{teamId:n,channelId:i}=JSON.parse(e);return{teamId:n,channelId:i}}catch(n){return{channelId:e}}},y=(e,n,i,t,a,o,m,c,u,p,y,v,k,g)=>{switch(e){case s.XW.CreateTeam:a&&g?n.teamsAndChannels.createTeamV2():t?n.teamsAndChannels.createTeamOnMainView({source:d.IC.template,canUserCreateTeam:!!g},c):n.teamsAndChannels.createTeam();break;case s.XW.CreateChannel:v&&y&&n.teamsAndChannels.createChannelOnLeftRail({entryPoint:l.a.ChannelListHeaderContextMenu});break;case s.XW.JoinTeamByCode:c===r.D.SchoolTeams?n.school.gridTeamDiscover():n.teamsAndChannels.teamDiscover();break;case s.XW.JoinTeam:o?n.teamsGallery.launchTeamsGallery():n.teamsAndChannels.teamDiscover();break;case s.XW.AddChannel:i&&y?n.teamsAndChannels.createChannel({teamId:i.id,groupId:i.groupId||"",teamType:i.teamType}):i&&n.teamsAndChannels.addChannel(i.id);break;case s.XW.AddMember:i&&(m?n.teamsAndChannels.addMemberToTeamDialog(i.id):n.teamsAndChannels.addMember(i.id));break;case s.XW.MarkAllChannelsAsRead:null==u||u();break;case s.XW.ManageTeamsList:n.teamsAndChannels.manageTeamsList(r.D.ChannelList,k?{entityCommand:k}:void 0,null==p?void 0:p()),null==u||u();break;case s.XW.ManageTeamsInvites:n.teamsAndChannels.manageSharedChannelsPendingInvites(r.D.ChannelList,void 0,null==p?void 0:p()),null==u||u();break;case s.XW.CrossTeamAnalytics:n.teamsAndChannels.crossTeamAnalytics(r.D.ChannelList,void 0,null==p?void 0:p()),null==u||u()}},v=e=>{var n,i;const t=null===(n=e.graphQLErrors)||void 0===n?void 0:n.find((e=>{var n;return"CDLResolver"===(null===(n=e.extensions)||void 0===n?void 0:n.source)})),a=null===(i=null==t?void 0:t.extensions)||void 0===i?void 0:i.prevError;return null==a?void 0:a.extraInfo},k=e=>{if(!e)return{teamId:void 0,channelId:void 0,replyChainId:void 0,renderId:void 0};try{const{teamId:n,channelId:i,replyChainId:t,renderId:a}=JSON.parse(e);return{teamId:n,channelId:i,replyChainId:t,renderId:a}}catch(n){return{channelId:e}}},g=e=>`overflow-${e}`},469025:(e,n,i)=>{"use strict";i.d(n,{UN:()=>y,Te:()=>v});var t=i(250033),a=i(818319),o=i(554694),d=i(363592),l=i(979176),r=i(373554);const s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ComponentsWebFloatingMonitorNavigateToCallScreenMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"navigateToCallScreen"},arguments:[{kind:"Argument",name:{kind:"Name",value:"teamsCallId"},value:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]};var m;!function(e){e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden",e[e.Closed=2]="Closed"}(m||(m={}));const c=[m.Hidden,m.Visible],u=a.createContext({setIntentIdOverride:()=>{},mounted:()=>{},hide:()=>Promise.resolve(),unhide:()=>Promise.resolve(),close:()=>Promise.resolve(),showCallWindow:()=>Promise.resolve()}),p=new Map,y=e=>{const n=(0,d.JQ)(),i=(0,r.x)(),[y,v]=a.useState(e.intentIdOverride),k=a.useCallback((()=>{const e=Array.from(p.values());return 0===e.length?m.Closed:e.includes(m.Visible)?m.Visible:m.Hidden}),[]),g=a.useCallback(((e,n)=>(n in c?p.set(e,n):p.delete(e),k())),[k]),N=a.useCallback((e=>{switch(e){case m.Visible:return n.generateEvent({event:l.U3.unhideMonitor()});case m.Hidden:return n.generateEvent({event:l.U3.hideMonitor()});case m.Closed:return n.generateEvent({event:l.U3.closeMonitor()})}}),[n]),h=a.useCallback((e=>{p.get(e)!==m.Hidden&&g(e,m.Visible)}),[g]),f=a.useCallback(((e,n)=>{const i=k(),t=g(e,n);return i!==t?N(t):Promise.resolve()}),[g,k,N]),_=a.useCallback((e=>f(e,m.Hidden)),[f]),S=a.useCallback((e=>f(e,m.Visible)),[f]),T=a.useCallback((e=>f(e,m.Closed)),[f]),b=(0,o.w)("WebFloatingMonitorContextProvider"),C=a.useCallback((e=>null==i?void 0:i.mutate({mutation:s,variables:{teamsCallId:e}}).then((e=>{var n;(null===(n=e.data)||void 0===n?void 0:n.navigateToCallScreen)||b.error("Failed to navigate to call screen via navigateToCallScreen mutation")})).catch((e=>b.error(`Failed to navigate to call screen via navigateToCallScreen mutation: ${e.message}`)))),[i,b]),w=a.useMemo((()=>({intentIdOverride:y,setIntentIdOverride:v,mounted:h,hide:_,unhide:S,close:T,showCallWindow:C})),[y,h,_,S,T,C]);return(0,t.t)(u.Provider,Object.assign({value:w},{children:e.children}))},v=()=>a.useContext(u)},638123:(e,n,i)=>{"use strict";i.d(n,{D:()=>t});const t=(0,i(379525).s)({isStudentAvatar:{Bf4jedk:"f1ohpo60"},isParentAvatar:{Bf4jedk:"ff9fk16"}},{d:[".f1ohpo60{min-width:2.8rem;}",".ff9fk16{min-width:3.2rem;}"]})},505676:(e,n,i)=>{"use strict";i.d(n,{qo:()=>_,m8:()=>N,F2:()=>g,I1:()=>h,Xf:()=>S,Ae:()=>T,wY:()=>I,Zm:()=>f});var t=i(740597);const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"firstLoginInfoNS"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Web"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"WebNorthStar"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"CoachMarkSavedWeb"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"PromptCards"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"FreemiumFRE"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"ios"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"android"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"wp"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"electron"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"maglev"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"desktopHwa"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"surfaceHub"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"espFirstRunStarted"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"espFirstRunCompleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"unknown"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]},o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferencesForCategory"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"category"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategory"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferencesForCategory"},arguments:[{kind:"Argument",name:{kind:"Name",value:"category"},value:{kind:"Variable",name:{kind:"Name",value:"category"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategory"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformationValue"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"firstLoginInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"firstLoginInfoNS"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformation"}},arguments:[]}]}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategoryValue"}}}}]}},...a.definitions]},d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsEspUserPreferenceMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"category"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategory"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"value"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateUserPreferences"},arguments:[{kind:"Argument",name:{kind:"Name",value:"category"},value:{kind:"Variable",name:{kind:"Name",value:"category"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategory"}}}},{kind:"Argument",name:{kind:"Name",value:"value"},value:{kind:"Variable",name:{kind:"Name",value:"value"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UserPreferences"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"firstLoginInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"firstLoginInfoNS"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformation"}},arguments:[]}]}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesResponse"}}}]}},...a.definitions]};var l=i(516909);const r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"activateEspTarget"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"surfaceId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"targetId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"selector"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"windowId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activateEspTarget"},arguments:[{kind:"Argument",name:{kind:"Name",value:"surfaceId"},value:{kind:"Variable",name:{kind:"Name",value:"surfaceId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"targetId"},value:{kind:"Variable",name:{kind:"Name",value:"targetId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"selector"},value:{kind:"Variable",name:{kind:"Name",value:"selector"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"Argument",name:{kind:"Name",value:"windowId"},value:{kind:"Variable",name:{kind:"Name",value:"windowId"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]}}]},s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsEspCompleteAppReadyTriggerStatusMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"completeAppReadyTriggerStatus"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isAppReadyCompleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppReadyTriggerStatus"}}},arguments:[]}]}}]},m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsEspAppReadyTriggerStatusQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appReadyTriggerStatus"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isAppReadyCompleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppReadyTriggerStatus"}}},arguments:[]}]}}]};var c=i(540929),u=i(905581),p=i(132756),y=i(74583);const v="growth_growthplatform_start_esp_job",k="syntheticNotificationRecommendation",g=(e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var i;try{const{data:n}=yield e.query({query:m,fetchPolicy:"no-cache"});return n.appReadyTriggerStatus}catch(e){return null===(i=n.errorToTelemetry)||void 0===i||i.call(n,"Failed to get trigger status",v),{isAppReadyCompleted:!1}}})),N=(e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var i;try{yield e.mutate({mutation:s,fetchPolicy:"no-cache"})}catch(e){const t=I(e,"Failed to complete app ready trigger status.");return null===(i=n.errorToTelemetry)||void 0===i||i.call(n,t.join(" "),v),Promise.reject()}return Promise.resolve(void 0)})),h=(e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var i,t,a;try{const n=yield e.query({query:o,variables:{category:"firstLoginInformation"}});return"FirstLoginInformationValue"===(null===(i=n.data)||void 0===i?void 0:i.userPreferencesForCategory.__typename)?null===(t=n.data)||void 0===t?void 0:t.userPreferencesForCategory.firstLoginInformation:null}catch(e){return null===(a=n.errorToTelemetry)||void 0===a||a.call(n,"First Login CDL Query failed",v),null}})),f=(e,n,i,a,r)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},a),{[n]:i.toISOString()});if(delete t.__typename,t){let e;for(e in t)null===t[e]&&delete t[e]}yield e.mutate({mutation:d,variables:{category:l.nV.firstLoginInformation,value:JSON.stringify(t)},update:(e,n)=>{var i,t,a,d,l;if("UserPreferences"===(null===(t=null===(i=n.data)||void 0===i?void 0:i.updateUserPreferences)||void 0===t?void 0:t.__typename))try{e.writeQuery({query:o,variables:{category:"firstLoginInformation"},data:{userPreferencesForCategory:{firstLoginInformation:null===(d=null===(a=n.data)||void 0===a?void 0:a.updateUserPreferences)||void 0===d?void 0:d.firstLoginInformation,__typename:"FirstLoginInformationValue"}}})}catch(e){null===(l=r.errorToTelemetry)||void 0===l||l.call(r,"Error while updating cache after updating firstLoginInformation.",v)}}})})),_=(e,n,i="shell",a,o)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{data:t}=yield e.mutate({mutation:r,variables:{surfaceId:n,targetId:i,selector:a,windowId:o},fetchPolicy:"no-cache"});if(!(null==t?void 0:t.activateEspTarget))throw new Error("Failed to activate ESP target component.")})),S=(e,n)=>{var i,t,a;return{surfaceId:e,title:w(null!==(i=n.title)&&void 0!==i?i:n.titleNotification),description:w(null!==(t=n.description)&&void 0!==t?t:n.descriptionNotification),visibility:n.visibility,deeplinkUrl:null!==(a=n.deeplinkUrl)&&void 0!==a?a:n.deeplinkUrlNotification}},T=e=>{var n,i;return{teamsAppId:e.teamsAppId,previewText:w(e.previewText),description:w(e.description),source:e.source,deeplinkUrl:e.deeplinkUrl,templateParameters:C(null!==(n=e.title)&&void 0!==n?n:e.titleTfwNotification),activityType:b(e.activityType,null!==(i=e.title)&&void 0!==i?i:e.titleTfwNotification)}},b=(e,n)=>n?k:null!=e?e:k,C=e=>{if(e)return[{name:"SyntheticNotification",value:w(e)}]},w=e=>{if(e){if(function(e){return void 0!==e.localizedContent}(e))return{localizedText:e.localizedContent};return{notLocalizedText:e.key}}},I=(e,n)=>{const i=[n];if(A(e)){const n=(0,c.E6)(e),t=(0,u.O$)(n,"innerError",void 0);(null==t?void 0:t.code)===p.jK.NotPresent&&i.push((0,u.B9)(t))}return i},A=e=>!!e&&!!(0,y.get)(e,"graphQLErrors")},204961:(e,n,i)=>{"use strict";i.d(n,{$:()=>t});const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"espState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"espState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"espState"}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EspState"}}},arguments:[]}]}},...i(132462).J.definitions]}},528765:(e,n,i)=>{"use strict";i.d(n,{$K:()=>t,Nw:()=>a,CN:()=>o});const t="corelayout",a={closeMonitor:"closeMonitor",collapseHeader:"collapseHeader",expandHeader:"expandHeader",expandTab:"expandTab",updateDialogState:"updateDialogState",hideMonitor:"hideMonitor",maximizeTab:"maximizeTab",openCoreDialog:"openCoreDialog",resetLayoutOverrides:"resetLayoutOverrides",showMonitor:"showMonitor",unhideMonitor:"unhideMonitor"},o={collapseHeader:()=>({actor:t,action:a.collapseHeader}),expandHeader:()=>({actor:t,action:a.expandHeader}),expandTab:e=>({actor:t,action:a.expandTab,data:e}),maximizeTab:()=>({actor:t,action:a.maximizeTab}),closeMonitor:()=>({actor:t,action:a.closeMonitor}),hideMonitor:()=>({actor:t,action:a.hideMonitor}),updateDialogState:e=>({actor:t,action:a.updateDialogState,data:e}),openCoreDialog:e=>({actor:t,action:a.openCoreDialog,data:e}),showMonitor:e=>({actor:t,action:a.showMonitor,data:e}),unhideMonitor:()=>({actor:t,action:a.unhideMonitor}),resetLayoutOverrides:()=>({actor:t,action:a.resetLayoutOverrides})}},56981:(e,n,i)=>{"use strict";var t;i.d(n,{Y:()=>t}),function(e){e.BottomLeft="BottomLeft",e.BottomRight="BottomRight",e.TopLeft="TopLeft",e.TopRight="TopRight"}(t||(t={}))},157930:(e,n,i)=>{"use strict";var t,a;i.d(n,{t:()=>t,H:()=>a}),function(e){e.HighMemoryUsage="HighMemoryUsage",e.CallingStackInitTimeoutOrFailure="CallingStackInitTimeoutOrFailure",e.GroupCallTimeoutOrFailure="GroupCallTimeoutOrFailure"}(t||(t={})),function(e){e.MeetingsAudio="1",e.MeetingsVideoOrScreenSharing="2",e.CallingCallDrops="3",e.MessagingOther="5",e.ActivityFeed="6",e.Crashing="7",e.Files="8",e.SearchSERPSearchResultsPage="9",e.SearchPowerbarAutosuggest="10",e.Other="11",e.MeetingsLiveCaptionsOrTranscript="14",e.TeamsChannelsMembership="15",e.Accessibility="17",e.Calendar="18",e.MeetingsOther="19",e.PlatformApps="20",e.PlatformBotsConnectors="21",e.PlatformTabs="22",e.TeamsChannelsCreateManageSettings="23",e.MessagingSync="25",e.PeopleProfiles="26",e.StatusPresence="27",e.TeamsChannelsPrivateAndSharedChannels="28",e.LocalizationTranslation="29",e.MeetingsAgendaNotes="30",e.MessagingCreateNewOrEdit="31",e.MessagingConversationWithExternalOrSkypeUsers="32",e.Tasks="34",e.Lists="35",e.Approvals="36",e.CallingOther="38",e.Performance="39",e.MessagingChatWindow="40",e.MessagingMissingOrDelayed="41",e.VivaLearning="42",e.MeetingsPowerPointLive="43",e.MeetingsChat="44",e.MeetingsRecording="45",e.MeetingsBreakoutRooms="46",e.MeetingsJoinExperience="47",e.MeetingsGalleryViews="48",e.CallingAudio="49",e.CallingVideoOrScreenSharing="50",e.VirtualAppointments="51",e.MeetingsSpeakerCoach="52",e.NotificationToasts="53",e.WebinarsVirtualEvents="54",e.MessagingVideo="55",e.MeetingsExcelLive="56",e.MeetingsWordLive="57",e.Avatars="58",e.ImmersiveSpace="59",e.MessagingLoopComponents="60",e.Discover="61",e.MeetingsMeetApp="62",e.Communities="63",e.Dashboard="64",e.Photos="65",e.Groups="66",e.InvitingJoiningTeams="67",e.Gaming="68",e.MessagingMessageCompose="70",e.MessagingMessagePaneScrolling="71",e.MessagingReactionsEmojisGIFsStickers="72",e.TeamsChannelsApp="73",e.UpdatesApp="74",e.MeetingsAttendanceReport="75",e.Devices="76",e.VideoFilters="77",e.AuthenticationOrSignIn="78",e.PerformanceMemory="79",e.DesktopAppLaunch="80",e.DesktopAppUpdate="81",e.TaskbarOrSystrayExperiences="82",e.Settings="83",e.AppSwitcherPreview="84",e.MeetingsRecap="86",e.FlyoutAndMinimode="87",e.MultiTenantMultiAccount="88",e.CallingCallNotifications="89",e.TagsChatMentions="90",e.TagsManagement="91",e.MeetingsCopilot="92",e.MessagingSMSIntegration="93",e.PlatformWorkflowsAndConnectors="94"}(a||(a={}))},406002:(e,n,i)=>{"use strict";var t;i.d(n,{M:()=>t}),function(e){e.Default="default",e.MobileSync="mobileSync",e.MobileUnsync="mobileUnsync"}(t||(t={}))},767300:(e,n,i)=>{"use strict";var t;i.d(n,{a:()=>t}),function(e){e.ChannelListHeaderContextMenu="ChannelListHeaderContextMenu",e.TeamContextMenu="TeamContextMenu"}(t||(t={}))},44105:(e,n,i)=>{"use strict";var t,a;i.d(n,{h:()=>t,V:()=>a}),function(e){e.List="List",e.Form="Form"}(t||(t={})),function(e){e.Add="Add",e.Edit="Edit"}(a||(a={}))},725811:(e,n,i)=>{"use strict";var t,a;i.d(n,{X:()=>t,p:()=>a}),function(e){e.TeamsPremium="TeamsPremium"}(t||(t={})),function(e){e.Home="TPCHome",e.Benefits="TPCBenefits",e.StartTrial="TPCStartTrial",e.TryPremium="TPCTryPremium"}(a||(a={}))},885909:(e,n,i)=>{"use strict";var t,a,o;i.d(n,{gP:()=>t,pC:()=>a,uP:()=>o}),function(e){e[e.Call=0]="Call",e[e.High=1]="High",e[e.Normal=2]="Normal",e[e.Low=3]="Low"}(t||(t={})),function(e){e.Calling="Calling",e.MSN="MSN",e.MeetingNudge="MeetingNudge",e.Standard="Standard"}(a||(a={})),function(e){e.Rtl="rtl",e.Auto="auto",e.Ltr="ltr"}(o||(o={}))},574229:(e,n,i)=>{"use strict";i.d(n,{dS:()=>t,Pz:()=>a,s_:()=>o,Tu:()=>d,Hm:()=>l,Bh:()=>r,x8:()=>s});const t="com.microsoft.teams.chat",a="com.microsoft.teams.calling",o="com.microsoft.teams.meetingOptions",d="com.microsoft.teams.files",l="com.microsoft.teams.teamsAndChannels",r="com.microsoft.teams.simpleCollab",s="com.microsoft.teams.teamsGallery"},303244:(e,n,i)=>{"use strict";var t,a,o;i.d(n,{PG:()=>t,x9:()=>a,xL:()=>o}),function(e){e.ComposeMessage="composeMessage",e.PostCompose="postCompose",e.MessageList="messageList",e.Powerbar="powerbar",e.VirtualTreeList="virtualTreeList",e.FeedsFilter="feedsFilter",e.PeoplePicker="peoplePicker",e.SearchBox="searchBox",e.Floodgate="floodgate",e.ChatListSearchFilter="chatListSearchFilter",e.ChannelListSearchFilter="channelListSearchFilter",e.CallingPerf="callingPerf",e.TeamsAndChannelsTable="teamsAndChannelsTable",e.DiscoverSurfaceFeedList="discoverSurfaceFeedList",e.AllChannelSystemMessages="channelInfoPaneAllSystemMessages",e.AllPinnedPosts="channelInfoPaneAllPinnedPosts",e.UnifiedFunPicker="unifiedFunPicker",e.CreateTeamGallery="createTeamGallery",e.AddMember="addMember",e.MeetForWorkList="meetForWorkList",e.MeetForWorkSearchFilter="meetForWorkSearchFilter",e.PeopleAppContactList="peopleAppContactList",e.SimpleCollabLeftRail="simpleCollabLeftRail",e.UserOnboardingToTeam="UserOnboardingToTeam"}(t||(t={})),function(e){e.CallingScreen="callingScreen",e.Chat="chat",e.ChannelL1="channelL1",e.ChannelL2="channelL2",e.ChannelSettings="channelSettings",e.ChatList="chatList",e.Communities="communitites",e.DialPad="dialpad",e.FeedList="feedlist",e.FlyoutChatList="flyoutChatList",e.FlyoutPeopleL2="flyoutPeopleL2",e.GroupChat="groupChat",e.MeetingChat="meetingChat",e.MessageEscalation="messageEscalation",e.NewChat="newChat",e.PeopleSearch="peopleSearch",e.Floodgate="floodgate",e.ChannelList="ChannelList",e.ManageThreadMembers="manageThreadMembers",e.ManageChannelThreadMembers="manageChannelThreadMembers",e.ManagePrivateChannelThreadMembers="managePrivateChannelThreadMembers",e.ManageSharedChannelThreadMembers="manageSharedChannelThreadMembers",e.ManageTeams="manageTeams",e.ChannelInvitationsTab="channelInvitationsTab",e.DiscoverSurface="discoverSurface",e.ThreadMembersSearch="threadMembersSearch",e.SharedChannelPendingInvites="sharedChannelPendingInvites",e.PendingJoinRequests="pendingJoinRequests",e.SelectPeoplePickerExtensibility="selectPeoplePickerExtensibility",e.ChannelsTable="channelsTable",e.SpeedDial="SpeedDial",e.CommunitiesJoinRequests="communitiesJoinRequests",e.PeopleApp="peopleApp",e.CommentStreamChatPane="commentStreamChatPane"}(a||(a={})),function(e){e.HeartbeatMonitor="HeartbeatMonitor",e.CallingPerfMonitor="CallingPerfMonitor"}(o||(o={}))},431447:(e,n,i)=>{"use strict";i.d(n,{_C:()=>d,kO:()=>r});var t=i(955105),a=i(956255),o=i(419925);class d{constructor(e,n){this.commandHandler=e,this.extensionCommanding=n}default(e=this.getDefaultEntityCommand(t.D.Unknown)){return this.commandHandler({entity:{type:a.py.channels,action:a.uk.default},command:e})}channelDeeplinkWithMessageId(e,n,i){return this.commandHandler({entity:{type:a.py.channels,action:a.uk.view,id:e},command:n,entityOptions:i})}channelMessagesById(e,n){var i,t,o,d;const l={channelId:e,replyChainId:null==n?void 0:n.replyChainId};return this.commandHandler({entity:{type:a.py.channels,action:a.uk.view,id:JSON.stringify(l)},command:n.entityCommand,entityOptions:Object.assign(Object.assign({},n.entityOptions),{deepLinkId:n.deepLinkId,pinned:n.pinned,parentTeamId:null!==(i=n.parentTeamId)&&void 0!==i?i:null===(t=n.entityOptions)||void 0===t?void 0:t.parentTeamId,source:null===(o=n.entityCommand.correlation)||void 0===o?void 0:o.source}),scenarioEventData:null===(d=n.extendedOptions)||void 0===d?void 0:d.scenarioEventData})}toggleChannelInfoPane(e,n){const{channelId:i}=l(e),t=JSON.stringify({channelId:i});return this.commandHandler({entity:{type:a.py.channels,action:a.uk.info,id:t},command:n})}toggleChannelInfoPaneExpandedView(e,n,i,t){const{channelId:o,replyChainId:d}=l(e),r=JSON.stringify({channelId:o,replyChainId:d});return this.commandHandler({entity:{type:i,action:a.uk.info,id:r,linkedEntity:{id:e,type:a.py.channels}},command:n,entityOptions:t})}showDefaultNavigationDialog(e,n){return this.extensionCommanding.executeCommand({type:a.py.defaultchannelnavdialog,action:a.uk.view},{entityCommand:n,entityOptions:e})}showJoinTeamDialog(e,n){return this.extensionCommanding.executeCommand({type:a.py.teamjoindialog,action:a.uk.view},{entityCommand:n,entityOptions:e})}launchCrossPostChannelSelectionDialog(e,n){return this.extensionCommanding.executeCommand({type:a.py.crosspostchannelselectiondialog,action:a.uk.view},{entityCommand:this.getDefaultEntityCommand(n,o.su.extend),entityOptions:{selectedChannelIds:e}})}launchCrossPostChannelSelectionDialogV2(e,n,i){return this.extensionCommanding.executeCommand({type:a.py.crosspostchannelselectiondialogV2,action:a.uk.view},{entityCommand:{stateTransition:o.su.extend,visibilityState:o.fe.show,correlation:{source:i}},entityOptions:{selectedChannelIds:e,currentChannelId:n}})}toggleChannelCopilotView(e,n,i){return this.commandHandler({entity:{type:i,action:a.uk.info,id:e,linkedEntity:{id:e,type:a.py.channels}},command:n,entityOptions:{source:t.D.ChannelCopilot}})}openChannelCopilotFromL1View(e,n){var i;return this.commandHandler({entity:{type:a.py.channels,action:a.uk.view,id:e},command:n.entityCommand,entityOptions:Object.assign(Object.assign({},n.entityOptions),{channelCopilotOpen:!0,source:null===(i=n.entityCommand.correlation)||void 0===i?void 0:i.source})})}launchCrossPostDeleteDialog(e,n){return this.extensionCommanding.executeCommand({type:a.py.crosspostdeletedialog,action:a.uk.view},{entityCommand:this.getDefaultEntityCommand(n,o.su.extend),entityOptions:e})}launchSharedChannelsPastePermissionsFluid(e){return this.extensionCommanding.executeCommand({type:a.py.fluid,action:a.uk.info},{entityCommand:e})}getDefaultEntityCommand(e,n=o.su.flush){return{stateTransition:n,visibilityState:o.fe.show,correlation:{source:e}}}}const l=e=>{if(!e)return{teamId:void 0,channelId:void 0,replyChainId:void 0};try{const{teamId:n,channelId:i,replyChainId:t}=JSON.parse(e);return{teamId:n,channelId:i,replyChainId:t}}catch(n){return{channelId:e}}},r=e=>{if(!e)return{replyChainId:void 0};try{const{replyChainId:n}=JSON.parse(e);return{replyChainId:n}}catch(e){return{replyChainId:void 0}}}},283722:(e,n,i)=>{"use strict";i.d(n,{UZ:()=>d,cZ:()=>l,Gg:()=>r});var t=i(132756),a=i(722932),o=i(753279);function d(e,n){return(...i)=>(0,a.P)((()=>e(...i))).pipe((0,o.W)(n,s)).toPromise()}const l=e=>(e=>{switch(e){case t.eT.Disabled:case t.eT.Offline:return!1;default:return!0}})(e),r=e=>()=>l(e.getState()),s=e=>e},510793:(e,n,i)=>{"use strict";i.d(n,{mf:()=>t,Zz:()=>a,hh:()=>o,YM:()=>d});const t={Safari:11.1},a=11,o=11.1,d={chrome:">=60",chromium:">=60",edge:">=12",electron:">=2",firefox:">=52"}},329948:(e,n,i)=>{"use strict";i.d(n,{H$:()=>d,MB:()=>l,Qh:()=>r,L5:()=>s});var t=i(683470),a=i(510793),o=i(765923);function d(e=a.YM){return!!e&&!!m().satisfies(e)}function l(){return!c("ie")}function r(){return!!m().satisfies({safari:`>=${a.mf.Safari}`})}function s(){return c("safari")&&void 0===m().getBrowserVersion()}function m(){return t.getParser((0,o.J)().navigator.userAgent)}function c(e){return m().isBrowser(e,!0)}},279746:(e,n,i)=>{"use strict";i.d(n,{sE:()=>g,lx:()=>N,gi:()=>h,h$:()=>f,Do:()=>_,xB:()=>S});var t=i(718306),a=i(516909),o=i(701543),d=i(291768),l=i(688945),r=i(434831),s=i(702191),m=i(974276),c=i(622519),u=i(547880),p=i(293627),y=i(438655),v=i(38613);const k="cacheDeletedMessages";function g(e,n){const{message:i}=b(e,n.id,n.clientMessageId,void 0,!(null==n?void 0:n.deleteTime)),t=i&&i.message&&i.message.importance===a.Nt.Urgent;return{__typename:"DeletionInfo",showMessageAsDeleted:!!i,canBeUndeleted:!!i&&!t,deleteFailed:!1}}function N(e,n,i,t){var a;try{const{message:a}=b(e,n,i,t);if(a){const{message:i}=a,t=Object.assign(Object.assign({},i),{id:n}),o=`Message:${n}`;return e.writeFragment({id:o,fragmentName:"messageFieldsForDeletedMessages",fragment:d.j4,data:t}),t}}catch(e){null===(a=t.errorToTelemetry)||void 0===a||a.call(t,`Failed to recoverDeletedMessageInCache for messageId: ${n}`,"messaging_delete_message",{"Message.Id":n,operationType:k},!0)}}function h(e,n,i,t,a,o){var g;const{fragment:N,fragmentName:h}=function(e){switch(e){case"Message":default:return{fragment:d.Tf,fragmentName:"deletionInfo"};case"ReplyChainMessage":return{fragment:l.R,fragmentName:"DataClientChatDeletedReplyChainMessageFragment_deletionInfo"};case"MeetingReplyMessage":return{fragment:r.Q,fragmentName:"DataClientChatDeletedMeetingReplyMessageFragment_deletionInfo"};case"StandardPostMessage":return{fragment:s.f,fragmentName:"DataClientChatDeletedStandardPostMessageFragment_deletionInfo"};case"AnnouncementPostMessage":return{fragment:m.I,fragmentName:"DataClientChatDeletedAnnouncementPostMessageFragment_deletionInfo"};case"EmailPostMessage":return{fragment:c.$,fragmentName:"DataClientChatDeletedEmailPostMessageFragment_deletionInfo"};case"MeetingPostMessage":return{fragment:u.J,fragmentName:"DataClientChatDeletedMeetingPostMessageFragment_deletionInfo"};case"ConnectorPostMessage":return{fragment:p.r,fragmentName:"DataClientChatDeletedConnectorPostMessageFragment_deletionInfo"};case"GuardiansPostMessage":return{fragment:y.s,fragmentName:"DataClientChatDeletedGuardiansPostMessageFragment_deletionInfo"}}}(i),f=`${i}:${n}`;try{const a=e.readFragment({id:f,fragment:N,fragmentName:h});a&&e.writeFragment({id:f,fragment:N,data:Object.assign(Object.assign({},a),{id:n,deleteTime:o,deletionInfo:{__typename:"Message"===i?"DeletionInfo":"MessageDeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:t},version:(0,v.MX)()[0].toString()})})}catch(e){null===(g=a.errorToTelemetry)||void 0===g||g.call(a,`Failed to updateCachedMessageForDelete for messageId: ${n}, fragmentName: ${h}, deleteFailed: ${t}`,"messaging_delete_message",{"Message.Id":n,operationType:k},!0)}}function f(e,n,i){var t;let a=[];try{if(a=T(e,i),a.find((e=>e.id===n)))return;const t=`Message:${n}`,l=e.readFragment({id:t,fragment:d.j4,fragmentName:"messageFieldsForDeletedMessages"}),r=Object.assign(Object.assign({},l),{id:`${l.id}_deleted`}),s={id:n,message:r,__typename:"DeletedMessage"};return a=[s,...a],e.writeQuery({query:o.a,data:{deletedMessages:a}}),s}catch(e){null===(t=i.errorToTelemetry)||void 0===t||t.call(i,`Failed to addDeletedMessageToCacheForUndelete for messageId: ${n}`,"messaging_delete_message",{"Message.Id":n,operationType:k},!0)}}function _(e,n,i,t){var a;try{const a=T(e,t),{message:l,isDeletedLieMessage:r}=b(e,n,i,t,!1,a);if(l){const t=a.filter((e=>{var t;return r?(null===(t=e.message)||void 0===t?void 0:t.clientMessageId)!==i:e.id!==n})),s=Object.assign(Object.assign({},l.message),{id:n,deletionInfo:{__typename:"DeletionInfo",showMessageAsDeleted:!1,canBeUndeleted:!1,deleteFailed:!1},version:(0,v.MX)()[0].toString(),__typename:"Message"});e.writeQuery({query:o.a,data:{deletedMessages:t}});const m=`Message:${n}`;return e.writeFragment({id:m,fragment:d.j4,data:s}),s}}catch(e){null===(a=t.errorToTelemetry)||void 0===a||a.call(t,`Failed to removeDeletedMessageFromCacheForUndelete for messageId: ${n}`,"messaging_delete_message",{"Message.Id":n,operationType:k},!0)}}function S(e,n,i,o){var d;const l=t.Ps`
    fragment messageFieldsNeeded on Message {
      deleteTime
      importance
      deletionInfo {
        showMessageAsDeleted
        canBeUndeleted
        deleteFailed
      }
      version
    }
  `,r=`Message:${n}`;try{const n=e.readFragment({id:r,fragment:l});if(n){const t=n.importance===a.Nt.Urgent;e.writeFragment({id:r,fragment:l,data:{deleteTime:i,importance:n.importance,deletionInfo:{__typename:"DeletionInfo",showMessageAsDeleted:!!i,canBeUndeleted:!!i&&!t,deleteFailed:!1},version:(0,v.MX)()[0].toString(),__typename:"Message"}})}}catch(e){null===(d=o.errorToTelemetry)||void 0===d||d.call(o,`Failed to updateCachedMessageForUndelete for messageId: ${n}`,"messaging_delete_message",{"Message.Id":n,operationType:k},!0)}}const T=(e,n)=>{var i;let t;try{t=e.readQuery({query:o.a})}catch(e){null===(i=null==n?void 0:n.errorToTelemetry)||void 0===i||i.call(n,"Failed to queryDeletedMessages","messaging_delete_message",{operationType:k},!0)}return t&&t.deletedMessages||[]},b=(e,n,i,t,a,o)=>{const d={message:null,isDeletedLieMessage:!1};if(!(o=o||T(e,t))||0===o.length)return d;if(!a){const e=o.find((e=>e.id===n));if(e)return{message:e,isDeletedLieMessage:!1}}const l=o.find((e=>e.message&&e.message.clientMessageId===i));return l?{message:l,isDeletedLieMessage:!0}:d}},974276:(e,n,i)=>{"use strict";i.d(n,{I:()=>a});var t=i(352996);const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedAnnouncementPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AnnouncementPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteFailed"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageDeletionInfo"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"version"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]};t.Be.definitions,a.definitions},293627:(e,n,i)=>{"use strict";i.d(n,{r:()=>a});var t=i(613958);const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedConnectorPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConnectorPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteFailed"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageDeletionInfo"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"version"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]};t.zL.definitions,a.definitions},622519:(e,n,i)=>{"use strict";i.d(n,{$:()=>a});var t=i(782529);const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedEmailPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteFailed"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageDeletionInfo"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"version"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]};t.E3.definitions,a.definitions},438655:(e,n,i)=>{"use strict";i.d(n,{s:()=>a});var t=i(176992);const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedGuardiansPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"GuardiansPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteFailed"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageDeletionInfo"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"version"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]};t.N4.definitions,a.definitions},547880:(e,n,i)=>{"use strict";i.d(n,{J:()=>a});var t=i(290287);const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedMeetingPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteFailed"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageDeletionInfo"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"version"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]};t.lU.definitions,a.definitions},434831:(e,n,i)=>{"use strict";i.d(n,{Q:()=>a});var t=i(421775);const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedMeetingReplyMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingReplyMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteFailed"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageDeletionInfo"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"version"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]};t.yM.definitions,a.definitions},688945:(e,n,i)=>{"use strict";i.d(n,{R:()=>a});var t=i(180023);const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedReplyChainMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteFailed"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageDeletionInfo"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"version"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]};t.lB.definitions,a.definitions},702191:(e,n,i)=>{"use strict";i.d(n,{f:()=>a});var t=i(218692);const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataClientChatDeletedStandardPostMessageFragment_deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StandardPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteFailed"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageDeletionInfo"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"version"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]};t.w3.definitions,a.definitions},291768:(e,n,i)=>{"use strict";i.d(n,{Tf:()=>t,j4:()=>a});const t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"deletionInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteFailed"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"DeletionInfo"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"version"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]},a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageFieldsForDeletedMessages"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"contentHash"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"imDisplayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"from"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"importance"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageImportance"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"time"},__type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EmotionUser"}}}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Emotion"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"count"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EmotionSummary"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"escalations"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},__type:{kind:"NamedType",name:{kind:"Name",value:"EscalationModality"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"users"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mri"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"time"},__type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"value"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EscalationUser"}}}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Escalation"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"itemId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"userId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mentionType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Mention"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"status"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageStatus"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"userHasSaved"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"diagnosticInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"diagnosticErrorCode"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"diagnosticMessage"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"DiagnosticInfo"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"clientMessageId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"baseUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"objectUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"type"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"previewUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"previewHeight"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"previewWidth"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"File"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"channelId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"siteUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"objectUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"state"},__type:{kind:"NamedType",name:{kind:"Name",value:"DeepLinkChicletState"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DeepLink"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"editTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"deletionInfo"}}]}},...t.definitions]}},580779:(e,n,i)=>{"use strict";i.d(n,{f:()=>t});const t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonActivitiesConnectionFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ActivitiesConnection"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonActivityFeedFragment"}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FeedActivity"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"cursor"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ActivityEdge"}}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"workerResponseTime"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"workerExitTimestamp"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deletedActivityInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deletedActivityIds"},__type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DeletedActivityInfo"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isActivityTranslated"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"pageInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startCursor"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"endCursor"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hasNextPage"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PageInfo"}}},arguments:[]}]}},...i(682585).qS.definitions]}},682585:(e,n,i)=>{"use strict";i.d(n,{qS:()=>t});const t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonActivityFeedFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FeedActivity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isRead"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"timestamp"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"icon"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"titleParams"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DefaultFeedLocaleParams"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"paramType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LocaleParamsType"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"count"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isTranslated"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ChannelFeedTitleLocaleParams"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"paramType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LocaleParamsType"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mentionName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CommunitiesFeedTitleLocaleParams"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"paramType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LocaleParamsType"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"communityName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"userNickname"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"count"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]}]}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"FeedTitleLocaleParams"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"translatedTitle"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"translatedTimestamp"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"translatedLocation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"ignoreInSearch"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LocationLineElement"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"translatedMessagePreview"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"actorAriaLabel"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"actorDisplayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"location"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"ignoreInSearch"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isTranslated"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LocationLineElement"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"locationParams"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DefaultFeedLocaleParams"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"paramType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LocaleParamsType"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"count"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ChannelFeedLocationLocaleParams"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"paramType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LocaleParamsType"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"channelName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CommunitiesFeedLocationLocaleParams"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"paramType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LocaleParamsType"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"communityName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"FeedLocationLocaleParams"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messagePreview"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messagePreviewTemplateOption"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"workerProcessingCompleteTimeStamp"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"activity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activityId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"activityType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"activitySubtype"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"threadType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sourceMessageId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sourceUserImDisplayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"activityProcessingLatency"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"webhookCorrelationId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamsAppId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"appName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ActivityPayload"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"activityNavigationParams"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"threadId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"replyChainId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"navigationTarget"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"campaignType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deeplinkUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"customParams"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ActivityNavigationParams"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"analytics"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ActivityAnalyticsPayload"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"supportedActions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isDivided"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"ActivityContextAction"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"user"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonActivityFeedFragment_user"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"User"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"version"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isUnknownUser"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"activityCustomProps"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"customIconUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"customAvatarMedia"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"avatarMediaType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AvatarMediaType"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"url"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"square"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hidePersonaCard"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"team"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ActivityTeamAvatarFields"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ActivityCustomAvatar"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ActivityCustomProps"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonActivityFeedFragment_user"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"User"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mri"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"type"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"userType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"avatarUrl"},directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"enableAvatarUrlResolutionInActivityFeeds"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]}],__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"givenName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"surname"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]}.definitions]}},352996:(e,n,i)=>{"use strict";i.d(n,{Be:()=>u});var t=i(370311),a=i(752412),o=i(684743),d=i(786541),l=i(830591),r=i(663193),s=i(4968),m=i(284688),c=i(119270);const u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonAnnouncementPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AnnouncementPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"clientMessageId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"content"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"version"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"editTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"File"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"from"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"imDisplayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"importance"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageImportance"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Mention"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Emotion"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EmotionSummary"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"subject"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isPinned"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"status"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageStatus"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"announcement"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"originalImageUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"croppedImageUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"colorTheme"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"croppedImageHeight"},__type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"croppedImageWidth"},__type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"croppedImageAltText"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isTeamsIllustration"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Announcement"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Card"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ATPSafelinksSharepointData"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Translation"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"DlpContext"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isLastRead"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isCrossPost"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"crossPostId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"},__type:{kind:"NamedType",name:{kind:"Name",value:"ChannelCrossPostStatus"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"postType"},__type:{kind:"NamedType",name:{kind:"Name",value:"PostType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"channelId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"siteUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"objectUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"state"},__type:{kind:"NamedType",name:{kind:"Name",value:"DeepLinkChicletState"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DeepLink"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Mention"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageRenderType"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageRenderType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"replyPermission"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageReplyPermissions"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canUserReply"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Meeting"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"translationStatus"},__type:{kind:"NamedType",name:{kind:"Name",value:"TranslationStatusV2"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteFailed"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageDeletionInfo"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"avatarUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"User"}},arguments:[]}]}},...t.Uw.definitions,...a.w.definitions,...o.p.definitions,...d.S.definitions,...l.v.definitions,...r.w.definitions,...s.x.definitions,...m.I.definitions,...c.M3.definitions]}},398411:(e,n,i)=>{"use strict";i.d(n,{yh:()=>t});const t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonChannelListChannelFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Channel"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"archivalLevel"},__type:{kind:"NamedType",name:{kind:"Name",value:"ChannelArchivalLevel"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"channelType"},__type:{kind:"NamedType",name:{kind:"Name",value:"ChannelType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"explicitlyAdded"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isArchived"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isExternal"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isShown"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isShownByDefault"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isGeneral"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isDeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isLie"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"realThreadId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isCreationFailed"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isPinned"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isNewForUser"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"memberRole"},__type:{kind:"NamedType",name:{kind:"Name",value:"TeamMemberRole"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isUserMember"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hasBookmark"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"unreadMessageCount"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"channelResourceTenantId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"areWorkflowsEnabled"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"defaultFileSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filesRelativePath"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"DefaultFileSettings"}},arguments:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Channel"}},directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"activitiesFromWorker"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activityCount"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hasChannelMention"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hasTeamMention"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]}}]}}]}},921916:(e,n,i)=>{"use strict";i.d(n,{Ke:()=>t});const t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonChannelListTeamFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Team"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelOnlyMember"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"description"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dynamicMembership"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hasNewHiddenChannels"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hiddenChannelsCount"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isArchived"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isCollapsed"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isDeleted"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"tenantId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isExternal"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isFavorite"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isUserMember"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isTenantWide"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isNewForUser"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"lastJoinAt"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"memberRole"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TeamMemberRole"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"pictureETag"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"smtpAddress"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamGuestSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createAndUpdateChannel"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteChannel"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"TeamSettings"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createAndUpdateChannel"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteChannel"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"updateConnectors"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TeamSettings"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamSiteInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TeamSiteInformation"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamType"},__type:{kind:"NamedType",name:{kind:"Name",value:"TeamType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"visibility"},__type:{kind:"NamedType",name:{kind:"Name",value:"TeamAccessType"}},arguments:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Team"}},directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"activitiesFromWorker"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalActivityCount"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hasChannelMention"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hasTeamMention"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]}},{kind:"Field",name:{kind:"Name",value:"shouldShowHideTeamOnChannelShowHide"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]}}]}},782529:(e,n,i)=>{"use strict";i.d(n,{E3:()=>u});var t=i(370311),a=i(752412),o=i(684743),d=i(786541);const l={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"from"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EmailUser"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sender"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"EmailUser"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"to"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"}}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EmailUser"}}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"cc"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EmailUser"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"emailLink"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"totalRecipients"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment_emailUser"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailUser"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"smtp"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]}}]}.definitions]};var r=i(830591),s=i(663193),m=i(4968),c=i(284688);const u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonEmailPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmailPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"clientMessageId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"content"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"version"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"editTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"File"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"from"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"imDisplayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"importance"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageImportance"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Mention"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Emotion"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EmotionSummary"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"subject"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isPinned"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"emailDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonEmailDetailsFragment"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"EmailDetails"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"status"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageStatus"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Card"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ATPSafelinksSharepointData"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Translation"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"DlpContext"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isLastRead"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isCrossPost"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"crossPostId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"},__type:{kind:"NamedType",name:{kind:"Name",value:"ChannelCrossPostStatus"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"postType"},__type:{kind:"NamedType",name:{kind:"Name",value:"PostType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"channelId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"siteUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"objectUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"state"},__type:{kind:"NamedType",name:{kind:"Name",value:"DeepLinkChicletState"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DeepLink"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageRenderType"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageRenderType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"replyPermission"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageReplyPermissions"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canUserReply"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"translationStatus"},__type:{kind:"NamedType",name:{kind:"Name",value:"TranslationStatusV2"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteFailed"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageDeletionInfo"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"avatarUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"User"}},arguments:[]}]}},...t.Uw.definitions,...a.w.definitions,...o.p.definitions,...d.S.definitions,...l.definitions,...r.v.definitions,...s.w.definitions,...m.x.definitions,...c.I.definitions]}},119270:(e,n,i)=>{"use strict";i.d(n,{M3:()=>t});const t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Meeting"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"itemId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"meetingTitle"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"meetingActionType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"tenantId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"organizerId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"location"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"scheduledMeetingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment_scheduledMeetingInfo"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ScheduledMeetingInfo"}},arguments:[]}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment_scheduledMeetingInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ScheduledMeetingInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startTime"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"endTime"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"exchangeId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"iCalUID"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isCancelled"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"eventType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppointmentType"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"eventRecurrenceRange"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ScalarEnumString"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"endDate"},__type:{kind:"NamedType",name:{kind:"Name",value:"ScalarEnumString"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"RecurrenceRange"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"eventRecurrencePattern"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patternType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ScalarEnumString"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"daily"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"interval"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"DailyPattern"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"weekly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"daysOfTheWeek"},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ScalarEnumString"}}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"interval"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"WeeklyPattern"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"monthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfMonth"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"interval"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MonthlyPattern"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"relativeMonthly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ScalarEnumString"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ScalarEnumString"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"interval"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"RelativeMonthlyPattern"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"yearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ScalarEnumString"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dayOfTheMonth"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"YearlyPattern"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"relativeYearly"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"month"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ScalarEnumString"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeekIndex"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ScalarEnumString"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dayOfTheWeek"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ScalarEnumString"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"RelativeYearlyPattern"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"RecurrencePattern"}},arguments:[]}]}}]}.definitions]}},290287:(e,n,i)=>{"use strict";i.d(n,{lU:()=>u});var t=i(752412),a=i(684743),o=i(786541),d=i(370311),l=i(119270),r=i(830591),s=i(663193),m=i(4968),c=i(284688);const u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"clientMessageId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"content"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"version"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"editTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"from"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"imDisplayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"importance"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageImportance"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Mention"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Emotion"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EmotionSummary"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"File"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"subject"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isPinned"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"status"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageStatus"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Meeting"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Card"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ATPSafelinksSharepointData"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Translation"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"DlpContext"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isLastRead"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isCrossPost"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"crossPostId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"},__type:{kind:"NamedType",name:{kind:"Name",value:"ChannelCrossPostStatus"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"postType"},__type:{kind:"NamedType",name:{kind:"Name",value:"PostType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"channelId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"siteUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"objectUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"state"},__type:{kind:"NamedType",name:{kind:"Name",value:"DeepLinkChicletState"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DeepLink"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Mention"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"replyPermission"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageReplyPermissions"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canUserReply"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"translationStatus"},__type:{kind:"NamedType",name:{kind:"Name",value:"TranslationStatusV2"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteFailed"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageDeletionInfo"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"avatarUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"User"}},arguments:[]}]}},...t.w.definitions,...a.p.definitions,...o.S.definitions,...d.Uw.definitions,...l.M3.definitions,...r.v.definitions,...s.w.definitions,...m.x.definitions,...c.I.definitions]}},421775:(e,n,i)=>{"use strict";i.d(n,{yM:()=>u});var t=i(684743),a=i(786541),o=i(752412),d=i(830591),l=i(663193),r=i(370311),s=i(119270),m=i(4968),c=i(284688);const u={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMeetingReplyMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingReplyMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"clientMessageId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"content"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"version"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"editTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"from"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"imDisplayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isImportant"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"importance"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageImportance"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Emotion"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EmotionSummary"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Mention"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Card"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ATPSafelinksSharepointData"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"File"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isPinned"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"status"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageStatus"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageRenderType"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageRenderType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"replyPermission"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageReplyPermissions"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canUserReply"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"meeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMeetingFragment"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Meeting"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Translation"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"DlpContext"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isLastRead"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"attached"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageAttachedType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"channelId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"siteUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"objectUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"state"},__type:{kind:"NamedType",name:{kind:"Name",value:"DeepLinkChicletState"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DeepLink"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Mention"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"translationStatus"},__type:{kind:"NamedType",name:{kind:"Name",value:"TranslationStatusV2"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteFailed"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageDeletionInfo"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"avatarUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"User"}},arguments:[]}]}},...t.p.definitions,...a.S.definitions,...o.w.definitions,...d.v.definitions,...l.w.definitions,...r.Uw.definitions,...s.M3.definitions,...m.x.definitions,...c.I.definitions]}},180023:(e,n,i)=>{"use strict";i.d(n,{lB:()=>c});var t=i(370311),a=i(684743),o=i(786541),d=i(752412),l=i(830591),r=i(663193),s=i(284688),m=i(4968);const c={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonReplyMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReplyChainMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"clientMessageId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"content"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"version"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"editTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}},{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"File"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"from"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"imDisplayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isImportant"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"importance"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageImportance"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Emotion"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EmotionSummary"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Mention"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Card"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ATPSafelinksSharepointData"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"File"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isPinned"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"status"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageStatus"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageRenderType"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageRenderType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isLastRead"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"attached"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageAttachedType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"description"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"previewEnabled"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"thumbnail"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"height"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ImageMeta"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"UrlPreview"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"channelId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"siteUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"objectUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"state"},__type:{kind:"NamedType",name:{kind:"Name",value:"DeepLinkChicletState"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DeepLink"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"DlpContext"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Translation"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Mention"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"replyPermission"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageReplyPermissions"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canUserReply"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageRenderType"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageRenderType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"translationStatus"},__type:{kind:"NamedType",name:{kind:"Name",value:"TranslationStatusV2"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteFailed"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageDeletionInfo"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"avatarUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"User"}},arguments:[]}]}},...t.Uw.definitions,...a.p.definitions,...o.S.definitions,...d.w.definitions,...l.v.definitions,...r.w.definitions,...s.I.definitions,...m.x.definitions]}},218692:(e,n,i)=>{"use strict";i.d(n,{w3:()=>c});var t=i(370311),a=i(752412),o=i(684743),d=i(786541),l=i(830591),r=i(663193),s=i(284688),m=i(4968);const c={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonStandardPostMessageFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StandardPostMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"clientMessageId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"content"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"version"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"editTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isDeletedByAdmin"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"files"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"File"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"from"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"imDisplayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"importance"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageImportance"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Mention"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"emotions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotions"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Emotion"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"emotionsSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"emotionsSummary"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EmotionSummary"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"subject"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isPinned"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"status"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageStatus"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"card"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Card"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"atpSharepointData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAtpSharepointDataFragment"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ATPSafelinksSharepointData"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isLastRead"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isTimestampDividerNeeded"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isCrossPost"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"crossPostId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"crossPostStatus"},__type:{kind:"NamedType",name:{kind:"Name",value:"ChannelCrossPostStatus"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"crossPostFailedChannels"},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"postType"},__type:{kind:"NamedType",name:{kind:"Name",value:"PostType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"urlPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"description"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"previewEnabled"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"thumbnail"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"thumbnailMeta"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"height"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ImageMeta"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"UrlPreview"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deeplinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"channelId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"siteUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"objectUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"serverRelativeUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"state"},__type:{kind:"NamedType",name:{kind:"Name",value:"DeepLinkChicletState"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DeepLink"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dlpContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dlpContext"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"DlpContext"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"translation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"translation"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Translation"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hardDeleteReason"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hardDeleteTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"mentions"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Mention"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageRenderType"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageRenderType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"replyPermission"},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageReplyPermissions"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canUserReply"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"translationStatus"},__type:{kind:"NamedType",name:{kind:"Name",value:"TranslationStatusV2"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"softDeleteReason"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sourceLanguageName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sourceLanguageCode"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deletionInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showMessageAsDeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canBeUndeleted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deleteFailed"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MessageDeletionInfo"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"fromUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"avatarUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"User"}},arguments:[]}]}},...t.Uw.definitions,...a.w.definitions,...o.p.definitions,...d.S.definitions,...l.v.definitions,...r.w.definitions,...s.I.definitions,...m.x.definitions]}},736362:(e,n,i)=>{"use strict";i.d(n,{sk:()=>a,u_:()=>d});const t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"participantStreamFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ParticipantStream"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isAvailable"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isStreaming"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"type"},__type:{kind:"NamedType",name:{kind:"Name",value:"StreamType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"rank"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"negotiationTag"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"participantLegId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"label"},__type:{kind:"NamedType",name:{kind:"Name",value:"StreamLabel"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"endpointId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dynamicVirtualParticipantId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mediaDeviceCapabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMediaDeviceCapabilitiesFragment"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MediaDeviceCapabilities"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sourceId"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]}]}},...i(796066).G.definitions]},a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"endpointDetailsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EndpointDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"originalId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"participantId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"clientEndpointCapabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"clientEndpointCapabilitiesFields"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ClientEndpointCapabilities"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"endpointId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"endpointMetadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"audienceview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"status"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"page"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"type"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"AudienceViewMetadata"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"botData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hiddenParticipant"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hiddenStream"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"canBeMutedAndUnMuted"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"page"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"role"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"type"},__type:{kind:"NamedType",name:{kind:"Name",value:"BotSourceType"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"BotMetaData"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"EndpointMetadata"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mappedTo"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"clientEndpointCapabilitiesFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ClientEndpointCapabilities"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CanSupportBreakOutRoom"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"supportBreakoutRoomsSelfSelect"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]}}]}.definitions]},o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"weathermanModeDetailFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WeathermanModeDetail"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isWeatherpersonPresenter"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"overlayCoords"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]},d={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"participantFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Participant"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isServerMuted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isHandRaised"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"raiseHandsRank"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"raiseHandsOrderedRank"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isSpotlighted"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"spotlightRank"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"state"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isReconciled"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isStreamingAttendee"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"streams"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"participantStreamFields"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ParticipantStream"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"audio"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"participantStreamFields"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ParticipantStream"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isFake"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isVideoLive"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isScreenShareLive"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"meetingRole"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"stateReason"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"contentSharingRole"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"participantId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"tenantId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"visible"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"holographicDevice"},__type:{kind:"NamedType",name:{kind:"Name",value:"HolographicDeviceType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"timeZoneOffset"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"endpoints"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"endpointDetailsFields"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EndpointDetails"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"weathermanModeDetail"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"weathermanModeDetailFields"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"WeathermanModeDetail"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mappedTo"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mappedToMeetingRoom"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deviceType"},__type:{kind:"NamedType",name:{kind:"Name",value:"ClientDeviceType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"interpretationDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isInterpreter"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"group"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"InterpretationGroup"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ParticipantInterpretationDetails"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"joinCorrelationId"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isInSameRoom"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isIdentityMasked"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"nonMaskedId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"nonMaskedDisplayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"maskedIdSeqNumber"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayNameOverride"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hasCloudIntelliFrame"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]}},...t.definitions,...a.definitions,...o.definitions]}},483416:(e,n,i)=>{"use strict";i.d(n,{b:()=>t});const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DataResolversBrowserCallingUpdateCallingStateMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"newState"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CurrentCallingState"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateCallingState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"newState"},value:{kind:"Variable",name:{kind:"Name",value:"newState"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CurrentCallingState"}}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]}}]}},862186:(e,n,i)=>{"use strict";i.d(n,{n:()=>t});const t={activity:"14d6962d-6eeb-4f48-8890-de55454bb136",chat:"86fcd49b-61a2-4701-b771-54728cd291fb",calendar:"ef56c0de-36fc-4ef8-b417-3d82ba9d073c",channel:"2a84919f-59d8-4441-a975-2a8c2643b741",calling:"20c3440d-c67e-4420-9f80-0e50c39693df",files:"5af6a76b-40fc-4ba1-af29-8f49b08e44fd",meet:"957ed0e3-e5ca-4c82-9676-fd037185c4d8",meetForWork:"a63f7012-8cc9-42d5-99c3-e35f526fab17",communities:"3b95919f-59d8-4441-a975-2a8c2643c852",assignments:"66aeee93-507d-479a-a3ef-8f494af43945",store:"ac40aa4a-fef1-4896-aea2-46d1c14dbfd5",simpleCollab:"3b64df9d-7e97-4d9c-ac5c-2e0a5d8e6f40",homepage:"7133fca9-0853-4e7a-bb5d-32d4e5f6020a",queues:"a02e4d17-af86-4ceb-9c97-4c2626eb3587",peopleApp:"7831feaf-c4c4-4669-ba64-ce4ea0b56d31",calendarM365:"5966c135-e05f-4ce0-81e0-e138fe8e9583"}},846889:(e,n,i)=>{"use strict";i.d(n,{B:()=>p,c:()=>y});var t=i(12817),a=i(365056),o=i(541152),d=i(109458),l=i(337210),r=i(139130),s=i(74583),m=i(409330),c=i(935539),u=i(853644);function p(e,n){const i=(0,s.castArray)(e),t=(0,c.yM)(i.map((e=>e.resolvers))),a=(null==n?void 0:n.enableClassBasedErrors)?"function"==typeof t?(...e)=>(0,o.o)(t(...e),"CDLResolver"):(0,o.o)(t,"CDLResolver"):t;return y({schema:(0,m.sJ)({resolvers:a,typeDefs:(0,c.c5)(i.map((e=>e.typeDefs))),directiveResolvers:(0,c.yM)(i.map((e=>e.directiveResolvers))),noExtensionExtraction:!0,updateResolversInPlace:!0,resolverValidationOptions:{requireResolversForResolveType:"ignore"},skipASTValidation:!0}),contextValue:i.reduceRight(((e,n)=>Object.assign(Object.assign({},e),n.contextValue)),{})})}function y(e){return new t.i((n=>{const{query:i,variables:t}=n,{operation:o}=(0,d.S)(i,null),s=n.getContext(),{schema:m,contextValue:c}=null!=e?e:s.incremental,p=Object.assign(Object.assign({},c),s);return"subscription"===o?(0,u.F)((()=>(0,l.L)({schema:m,document:i,contextValue:p,variableValues:t}))):new a.y((e=>{try{Promise.resolve((0,r.ht)({schema:m,document:i,variableValues:t,contextValue:p})).then((n=>{e.closed||(e.next(n),e.complete())}),(n=>{e.closed||e.error(n)}))}catch(n){e.closed||e.error(n)}}))}))}},668096:(e,n,i)=>{"use strict";var t,a,o;i.d(n,{$p:()=>t,fg:()=>a,YQ:()=>o}),function(e){e.InviteJoined="InviteJoined",e.TeamsTasks="TeamsTasks",e.GroupMessage="GroupMessage",e.Message="Message",e.Follow="Follow",e.Reply="Reply",e.PersonalReply="PersonalReply",e.ReplyToReply="ReplyToReply"}(t||(t={})),function(e){e.joinInvite="joinInvite",e.teamsTasks="teamsTasks",e.communityFollow="communityFollow",e.communityReplyToReply="communityReplyToReply",e.communityReply="communityReply"}(a||(a={})),function(e){e.inviteeJoined="inviteeJoined",e.tFLPlanCreated="tFLPlanCreated",e.communityNewMessage="communityNewMessage",e.communityReplyMessage="communityReplyMessage"}(o||(o={}))},219418:(e,n,i)=>{"use strict";var t;i.d(n,{yH:()=>t,zc:()=>a,bJ:()=>o,V6:()=>d}),function(e){e.Chat="chat",e.Channel="channel",e.SyntheticNotification="syntheticNotification",e.Communities="communities",e.GraphItemToast="graphItemToast"}(t||(t={}));var a;!function(e){e.FILE="file",e.IMAGE="image",e.VOICE="voice",e.LOCATION="location",e.TEXT="text",e.VIDEO="video"}(a||(a={}));const o="giphy.com",d="bfb101ece45946be988be560a74322f2"},227085:(e,n,i)=>{"use strict";i.d(n,{St:()=>a});const t={about:"about",markAllAsRead:"markAllAsRead",blockUnblockBotChat:"blockUnblockBotChat",newChat:"newChat",popNewChat:"popNewChat"},a={PlatformEvents:t}},344282:(e,n,i)=>{"use strict";i.d(n,{kn:()=>a,uS:()=>o,U3:()=>r});var t=i(660378);const a="Notifications",o={activateCallToast:"activeCallToast",activateChatToast:"activateChatToast",activateCommunitiesToast:"activateCommunitiesToast",activateRemindersToast:"activateRemindersToast",activateGraphItemToast:"activateGraphItemToast",offsetNotificationsWindow:"offsetNotificationsWindow",resizeWindow:"resizeWindow",sendTelemetry:"sendTelemetry",sendDismissToastTelemetry:"sendDismissToastTelemetry",focusWindow:"focusWindow",settingsstore:"settingsstore",files:"files"},d="localRecordingAssembly",l=(e,n)=>{if(n===d)return o.files;switch(e){case t.dt.activity:return o.activateGraphItemToast;case t.dt.calls:case t.dt.callingdeeplink:return o.activateCallToast;case t.dt.communities:case t.dt.communitiesevents:case t.dt.communitiesjoinrequest:case t.dt.communitiesmembers:return o.activateCommunitiesToast;case t.dt.reminders:return o.activateRemindersToast;case t.dt.settingsstore:return o.settingsstore;case t.dt.chats:default:return o.activateChatToast}},r={activateToast:(e,n)=>({originator:a,type:l(e.type,e.id),data:()=>({targetEntity:e,startTimestamp:n})}),resizeWindow:e=>({originator:a,type:o.resizeWindow,data:()=>({windowFeatures:e})}),focusWindow:()=>({originator:a,type:o.focusWindow}),sendTelemetry:e=>({originator:a,type:o.sendTelemetry,data:()=>e}),offsetNotificationsWindow:e=>({originator:a,type:o.offsetNotificationsWindow,data:()=>e}),sendDismissToastTelemetry:({reason:e,correlationId:n,toastType:i})=>({originator:a,type:o.sendDismissToastTelemetry,data:()=>({reason:e,correlationId:n,toastType:i})})}},936733:(e,n,i)=>{"use strict";i.d(n,{k:()=>t,u:()=>a});const t="EntitySearch",a={openContextualSearch:"openContextualSearch"}},705852:(e,n,i)=>{"use strict";i.d(n,{_H:()=>a,cn:()=>o,xs:()=>d,hY:()=>l});const t="SimpleCollabList",a={switchToChat:"switchToChat",switchToChannel:"switchToChannel",channelNotificationSettings:"channelNotificationSettings",filterLeftRail:"filterLeftRail",filterLeftRailComplete:"filterLeftRailComplete",channelWorkflows:"channelWorkflows",deleteChannel:"deleteChannel",editChannel:"editChannel",getLinkToChannel:"getLinkToChannel",manageChannel:"manageChannel",manageChannelMembers:"manageChannelMembers",manageChannelTags:"manageChannelTags",viewChannelEmail:"viewChannelEmail",channelAddMembers:"channelAddMembers",leaveChannel:"leaveChannel",shareChannelWithUser:"shareChannelWithUser",shareChannelWithTeam:"shareChannelWithTeam",shareChannelWithTeamYouOwn:"shareChannelWithTeamYouOwn",viewDiscover:"viewDiscover",manageTeam:"manageTeam",manageTags:"manageTags",deleteTeam:"deleteTeam",getLinkToTeam:"getLinkToTeam",leaveTeam:"leaveTeam",teamAddMember:"teamAddMember",teamAddChannel:"teamAddChannel",leftRailRenderStart:"leftRailRenderStart",seeMoreRenderComplete:"seeMoreRenderComplete",seeMoreRenderStart:"seeMoreRenderStart",seeMoreRenderFail:"seeMoreRenderFail",leftRailRenderComplete:"leftRailRenderComplete",chatManageApps:"chatManageApps",leaveChat:"leaveChat",viewTeamSeeAllChannels:"viewTeamSeeAllChannels",joinTeam:"joinTeam",createChannel:"createChannel",createTeam:"createTeam",manageTeams:"manageTeams"},o={createConversationFolder:"createConversationFolder",removeConversationFolder:"removeConversationFolder",renameConversationFolder:"renameConversationFolder"},d={createConversationFolderSucceeded:"createConversationFolderSucceeded",createConversationFolderFailed:"createConversationFolderFailed",renameConversationFolderSucceeded:"renameConversationFolderSucceeded",renameConversationFolderFailed:"renameConversationFolderFailed",removeConversationFolderSucceeded:"removeConversationFolderSucceeded",removeConversationFolderFailed:"removeConversationFolderFailed",removeFromFolderSucceeded:"removeFromFolderSucceeded",removeFromFolderFailed:"removeFromFolderFailed",moveConversationToFolderSucceeded:"moveConversationToFolderSucceeded",moveConversationToFolderFailed:"moveConversationToFolderFailed",setConversationFolderExpandedStateSucceeded:"setConversationFolderExpandedStateSucceeded",setConversationFolderExpandedStateFailed:"setConversationFolderExpandedStateFailed",reorderConversationFoldersSucceeded:"reorderConversationFoldersSucceeded",reorderConversationFoldersFailed:"reorderConversationFoldersFailed",reorderConversationFolderItemsSucceeded:"reorderConversationFolderItemsSucceeded",reorderConversationFolderItemsFailed:"reorderConversationFolderItemsFailed",dndItemToConversationFolderSucceeded:"dndItemToConversationFolderSucceeded",dndItemToConversationFolderFailed:"dndItemToConversationFolderFailed"},l={switchToChat:e=>({data:e,originator:t,type:a.switchToChat}),switchToChannel:e=>({data:e,originator:t,type:a.switchToChannel}),channelNotificationSettings:e=>({data:e,originator:t,type:a.channelNotificationSettings}),channelWorkflows:e=>({data:e,originator:t,type:a.channelWorkflows}),deleteChannel:e=>({data:e,originator:t,type:a.deleteChannel}),editChannel:e=>({data:e,originator:t,type:a.editChannel}),getLinkToChannel:e=>({data:e,originator:t,type:a.getLinkToChannel}),filterLeftRail:e=>({data:e,originator:t,type:a.filterLeftRail}),filterLeftRailComplete:()=>({originator:t,type:a.filterLeftRailComplete}),manageChannel:e=>({data:e,originator:t,type:a.manageChannel}),manageChannelMembers:e=>({data:e,originator:t,type:a.manageChannelMembers}),manageChannelTags:e=>({data:e,originator:t,type:a.manageChannelTags}),viewChannelEmail:e=>({data:e,originator:t,type:a.viewChannelEmail}),channelAddMembers:e=>({data:e,originator:t,type:a.channelAddMembers}),leaveChannel:e=>({data:e,originator:t,type:a.leaveChannel}),shareChannelWithUser:e=>({data:e,originator:t,type:a.shareChannelWithUser}),shareChannelWithTeam:e=>({data:e,originator:t,type:a.shareChannelWithTeam}),shareChannelWithTeamYouOwn:e=>({data:e,originator:t,type:a.shareChannelWithTeamYouOwn}),createConversationFolder:e=>({data:e,originator:t,type:o.createConversationFolder}),removeConversationFolder:e=>({data:e,originator:t,type:o.removeConversationFolder}),renameConversationFolder:e=>({data:e,originator:t,type:o.renameConversationFolder}),createConversationFolderSucceeded:e=>({data:e,originator:t,type:d.createConversationFolderSucceeded}),createConversationFolderFailed:e=>({data:e,originator:t,type:d.createConversationFolderFailed}),renameConversationFolderSucceeded:e=>({data:e,originator:t,type:d.renameConversationFolderSucceeded}),renameConversationFolderFailed:e=>({data:e,originator:t,type:d.renameConversationFolderFailed}),removeConversationFolderSucceeded:e=>({data:e,originator:t,type:d.removeConversationFolderSucceeded}),removeConversationFolderFailed:e=>({data:e,originator:t,type:d.removeConversationFolderFailed}),removeFromFolderSucceeded:e=>({data:e,originator:t,type:d.removeFromFolderSucceeded}),removeFromFolderFailed:e=>({data:e,originator:t,type:d.removeFromFolderFailed}),moveConversationToFolderSucceeded:e=>({data:e,originator:t,type:d.moveConversationToFolderSucceeded}),moveConversationToFolderFailed:e=>({data:e,originator:t,type:d.moveConversationToFolderFailed}),setConversationFolderExpandedStateSucceeded:e=>({data:e,originator:t,type:d.setConversationFolderExpandedStateSucceeded}),setConversationFolderExpandedStateFailed:e=>({data:e,originator:t,type:d.setConversationFolderExpandedStateFailed}),reorderConversationFoldersSucceeded:e=>({data:e,originator:t,type:d.reorderConversationFoldersSucceeded}),reorderConversationFoldersFailed:e=>({data:e,originator:t,type:d.reorderConversationFoldersFailed}),reorderConversationFolderItemsSucceeded:e=>({data:e,originator:t,type:d.reorderConversationFolderItemsSucceeded}),reorderConversationFolderItemsFailed:e=>({data:e,originator:t,type:d.reorderConversationFolderItemsFailed}),dndItemToConversationFolderSucceeded:e=>({data:e,originator:t,type:d.dndItemToConversationFolderSucceeded}),dndItemToConversationFolderFailed:e=>({data:e,originator:t,type:d.dndItemToConversationFolderFailed}),manageTeam:e=>({data:e,originator:t,type:a.manageTeam}),manageTags:e=>({data:e,originator:t,type:a.manageTags}),getLinkToTeam:e=>({data:e,originator:t,type:a.getLinkToTeam}),deleteTeam:e=>({data:e,originator:t,type:a.deleteTeam}),leaveTeam:e=>({data:e,originator:t,type:a.leaveTeam}),teamAddMember:e=>({data:e,originator:t,type:a.teamAddMember}),teamAddChannel:e=>({data:e,originator:t,type:a.teamAddChannel}),chatManageApps:e=>({data:e,originator:t,type:a.chatManageApps}),leaveChat:e=>({data:e,originator:t,type:a.leaveChat}),viewDiscover:()=>({originator:t,type:a.viewDiscover}),leftRailRenderStart:()=>({originator:t,type:a.leftRailRenderStart}),leftRailRenderComplete:()=>({originator:t,type:a.leftRailRenderComplete}),seeMoreRenderStart:()=>({originator:t,type:a.seeMoreRenderStart}),seeMoreRenderComplete:()=>({originator:t,type:a.seeMoreRenderComplete}),seeMoreRenderFail:()=>({originator:t,type:a.seeMoreRenderFail}),viewTeamSeeAllChannels:e=>({data:e,originator:t,type:a.viewTeamSeeAllChannels}),joinTeam:e=>({data:e,originator:t,type:a.joinTeam}),createChannel:e=>({data:e,originator:t,type:a.createChannel}),createTeam:e=>({data:e,originator:t,type:a.createTeam}),manageTeams:e=>({data:e,originator:t,type:a.manageTeams})}},8397:(e,n,i)=>{"use strict";i.d(n,{s:()=>t,$:()=>a});const t={SimpleCollabSwitcher:"simple-collab-switcher"},a={SwitchOnSimpleCollab:"SwitchOnSimpleCollab",SwitchOffSimpleCollab:"SwitchOffSimpleCollab"}},840424:(e,n,i)=>{"use strict";var t;i.d(n,{U3:()=>r,Q0:()=>s,m3:()=>m,Is:()=>c,Bz:()=>u}),function(e){e.StoreDevices="StoreDevices",e.StoreCart="StoreCart",e.StoreCartCheckout="StoreCartCheckout"}(t||(t={}));const a="openDeviceDetailsDialog",o="openStoreCartCheckoutDialog",d="openStoreCartDialog",l="closeStoreCartCheckoutDialog",r={openDeviceDetailsDialog:e=>({originator:t.StoreDevices,type:a,data:()=>Object.assign({},e)}),openStoreCartDialog:()=>({originator:t.StoreCart,type:d}),openStoreCartCheckoutDialog:e=>({originator:t.StoreCartCheckout,type:o,data:()=>Object.assign({},e)}),closeStoreCartCheckoutDialog:()=>({originator:t.StoreCartCheckout,type:l})},s=e=>p(e)&&e.type===a,m=e=>p(e)&&e.type===d,c=e=>p(e)&&e.type===o,u=e=>p(e)&&e.type===l,p=e=>Object.keys(t).includes(e.originator)},307153:(e,n,i)=>{"use strict";i.d(n,{kn:()=>t,pd:()=>a,yG:()=>o});const t="UseronboardingToTeam",a={switchToChannel:"switchToChannel",loadUserOnboardingToTeamPage:"loadUserOnboardingToTeamPage",seeAllChannelsLoadMoreRenderStart:"seeAllLoadMoreRenderStart",seeAllChannelsLoadMoreRenderFail:"seeAllChannelsLoadMoreRenderFail",seeAllChannelsLoadMoreRenderComplete:"seeAllChannelsLoadMoreRenderComplete"},o={switchToChannel:e=>({data:e,originator:t,type:a.switchToChannel}),loadUserOnboardingToTeamPage:e=>({data:e,originator:t,type:a.loadUserOnboardingToTeamPage}),seeAllChannelsLoadMoreRenderStart:()=>({originator:t,type:a.seeAllChannelsLoadMoreRenderStart}),seeAllChannelsLoadMoreRenderFail:()=>({originator:t,type:a.seeAllChannelsLoadMoreRenderFail}),seeAllChannelsLoadMoreRenderComplete:()=>({originator:t,type:a.seeAllChannelsLoadMoreRenderComplete})}},557273:(e,n,i)=>{"use strict";i.d(n,{kn:()=>t,uS:()=>a,RB:()=>o,U3:()=>d});const t="VirtualConsumerEvents",a={createVirtualConsumerEvent:"createVirtualConsumerEvent"},o=e=>"object"==typeof e&&!!e&&"communityId"in e,d={createVirtualConsumerEvent:e=>({originator:t,type:a.createVirtualConsumerEvent,data:e})}},383376:(e,n,i)=>{"use strict";i.r(n),i.d(n,{activate:()=>hj,getPlatformConfigurationOverrides:()=>Nj});var t=i(740597);i(887198);var a=i(44175),o=i(208569),d=i(861092),l=i(446652),r=i(793377),s=i(50805),m=i(985937),c=i(738646),u=i(236854);const p=[{importFunc:()=>Promise.all([i.e(932180),i.e(192873),i.e(934882)]).then(i.bind(i,424012)),chunkName:"data-schema"},{importFunc:()=>Promise.all([i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(241602),i.e(133950),i.e(268372),i.e(775758),i.e(315215),i.e(236315),i.e(529375),i.e(425552),i.e(9081),i.e(150486),i.e(405309),i.e(511611),i.e(141550),i.e(716618),i.e(127919),i.e(158563),i.e(802054)]).then(i.bind(i,5587)),chunkName:"core-essentials"},{importFunc:()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(256045),i.e(241602),i.e(371935),i.e(976609),i.e(1053),i.e(755684),i.e(671291),i.e(277599),i.e(191673),i.e(102207),i.e(273122),i.e(729816),i.e(239234),i.e(449237),i.e(744816),i.e(357142),i.e(57224),i.e(347761),i.e(9081),i.e(269296),i.e(757343),i.e(37943),i.e(418218),i.e(100869),i.e(668575),i.e(560947),i.e(259649),i.e(68688),i.e(912597),i.e(127919),i.e(953275),i.e(718194),i.e(481020),i.e(495500),i.e(839180),i.e(418133),i.e(827265),i.e(863698),i.e(779792),i.e(66082),i.e(311119),i.e(41464),i.e(834091),i.e(303523),i.e(305271)]).then(i.bind(i,842614)),chunkName:"shell-app"}];var y=i(356088),v=i(419925),k=i(832666),g=i(243334);const N=(e,n,i)=>{var t;const a=null===(t=n[e])||void 0===t?void 0:t.width;return{0:(null==a?void 0:a.get(k.Rd.IS_GREATER_THAN_0))||i,947:(null==a?void 0:a.get(k.Rd.IS_AT_LEAST_947))||i,1350:(null==a?void 0:a.get(k.Rd.IS_AT_LEAST_1350))||i,1500:(null==a?void 0:a.get(k.Rd.IS_AT_LEAST_1500))||i,1680:(null==a?void 0:a.get(k.Rd.IS_AT_LEAST_1680))||i,2560:(null==a?void 0:a.get(k.Rd.IS_AT_LEAST_2560))||i}},h=g.WL.CONTEXTUAL_NOTIFICATIONS,f=g.WL.END,_=g.WL.HEADER,S=g.WL.MAIN,T=g.WL.MODAL,b=g.WL.NOTIFICATIONS,C=g.WL.TITLE_BAR,w=g.WL.TOASTS,I=g.u5.LINE_LOADER,A="minmax(0, 1fr)",F="minmax(0, 1fr)",D="0",E="3.2rem",M=[{layoutKey:y.FU.HYER,slots:[h,S,T,C,w],responsiveTemplates:e=>{var n;const i=(null===(n=e[C])||void 0===n?void 0:n.height)||E;return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n          "${C}            ${C}"           ${i}\n          "${I}          ${I}"         ${D}\n          "${w}              ${S}"               ${A} /\n          0                       ${F}\n        `}]}},{layoutKey:y.FU.HYER,slots:[h,S,T,w],responsiveTemplates:[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n          "${I}    ${I}"         ${D}\n          "${w}        ${S}"               ${A} /\n           0                ${F}\n        `}]},{layoutKey:y.FU.HYER,slots:[h,S,T,b,w],responsiveTemplates:[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n        "${I}          ${I}"      ${D}\n        "${b}       ${b}"   auto\n        "${w}              ${S}"            ${A} /\n        0                       ${F}\n      `}]},{layoutKey:y.FU.HYER,slots:[h,S,T,b,C,w],responsiveTemplates:e=>{var n;const i=(null===(n=e[C])||void 0===n?void 0:n.height)||E;return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n        "${C}          ${C}"        ${i}\n        "${I}        ${I}"      ${D}\n        "${b}     ${b}"   auto\n        "${w}            ${S}"            ${A} /\n        0                     ${F}\n      `}]}},{layoutKey:y.FU.HYER,slots:[h,_,S,T,b,w],responsiveTemplates:e=>{var n;const i=(null===(n=e[_])||void 0===n?void 0:n.height)||"auto";return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n        "${I}                  ${I}"                 ${D}\n        "${b}               ${b}"              auto\n        "${w}                      ${_}"                     ${i}\n        "${w}                      ${h}"    0\n        "${w}                      ${S}"                       ${A} /\n        0                               ${F}\n      `}]}},{layoutKey:y.FU.HYER,slots:[h,_,S,T,w],responsiveTemplates:e=>{var n;const i=(null===(n=e[_])||void 0===n?void 0:n.height)||"auto";return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n        "${I}                   ${I}"               ${D}\n        "${w}                       ${_}"                   ${i}\n        "${w}                       ${h}"  0\n        "${w}                       ${S}"                     ${A} /\n         0                               ${F}\n      `}]}},{layoutKey:y.FU.HYER,slots:[h,f,S,T,b,C,w],responsiveTemplates:e=>{var n;const i=(null===(n=e[C])||void 0===n?void 0:n.height)||E,t=N(f,e,"32rem"),a=e=>({template:`\n      "${C}         ${C}         ${C}"         ${i}\n      "${I}       ${I}       ${I}"       ${D}\n      "${b}    ${b}    ${b}"    auto\n      "${w}           ${S}             ${f}"              ${A} /\n       0                   ${F}        ${e}\n    `});return[Object.assign({minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0},a(t[0])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_947},a(t[947])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1350},a(t[1350])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1500},a(t[1500])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1680},a(t[1680])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_2560},a(t[2560]))]}},{layoutKey:y.FU.HYER,slots:[h,_,S,T,b,C,w],responsiveTemplates:e=>{var n,i;const t=(null===(n=e[C])||void 0===n?void 0:n.height)||E,a=(null===(i=e[_])||void 0===i?void 0:i.height)||"auto";return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n        "${C}            ${C}"        ${t}\n        "${I}          ${I}"      ${D}\n        "${b}       ${b}"   auto\n        "${w}              ${_}"          ${a}\n        "${w}              ${S}"            ${A} /\n        0                       ${F}\n      `}]}},{layoutKey:y.FU.HYER,slots:[h,f,_,S,T,b,w],responsiveTemplates:e=>{const n=N(f,e,"32rem"),i=e=>({template:`\n        "${I}       ${I}       ${I}"       ${D}\n        "${b}    ${b}    ${b}"    auto\n        "${w}           ${_}           ${_}"           auto\n        "${w}           ${S}             ${f}"              ${A} /\n         0                   ${F}        ${e}\n      `});return[Object.assign({minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0},i(n[0])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_947},i(n[947])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1350},i(n[1350])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1500},i(n[1500])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1680},i(n[1680])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_2560},i(n[2560]))]}},{layoutKey:y.FU.HYER,slots:[h,f,_,S,T,b,C,w],responsiveTemplates:e=>{var n;const i=(null===(n=e[C])||void 0===n?void 0:n.height)||E,t=N(f,e,"32rem"),a=e=>({template:`\n        "${C}        ${C}         ${C}"         ${i}\n        "${I}      ${I}       ${I}"       ${D}\n        "${b}   ${b}    ${b}"    auto\n        "${w}          ${_}           ${_}"           auto\n        "${w}          ${S}             ${f}"              ${A} /\n         0                  ${F}        ${e}\n      `});return[Object.assign({minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0},a(t[0])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_947},a(t[947])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1350},a(t[1350])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1500},a(t[1500])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1680},a(t[1680])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_2560},a(t[2560]))]}}],P=g.WL.CONTEXTUAL_NOTIFICATIONS,R=g.WL.MAIN,O=g.WL.MODAL,$=g.WL.NOTIFICATIONS,L=g.WL.TOASTS,x=g.u5.LINE_LOADER,B="minmax(0, 1fr)",j="minmax(0, 1fr)",U=[{layoutKey:y.FU.HYER,slots:[P,R,O,L],responsiveTemplates:[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n        "${x} ${x}" 0\n        "${L}     ${R}"       ${B} /\n        0              ${j}\n        `}]},{layoutKey:y.FU.HYER,slots:[P,R,O,$,L],responsiveTemplates:[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n        "${x}    ${x}" 0\n        "${L}        ${R}"       ${B} /\n        0                 ${j}\n        `}]},{layoutKey:y.FU.HYER,slots:[R],responsiveTemplates:[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n        "${x}        ${x}" 0\n        "${L}            ${R}"       ${B} /\n        0                     ${j}\n        `}]}],V="6.1rem",W="4.8rem",H="6.8rem",G=g.WL.CONTEXTUAL_NOTIFICATIONS,J=g.WL.END,q=g.WL.HEADER,z=g.WL.MAIN,Q=g.WL.MODAL,Y=g.WL.NAV,K=g.WL.NOTIFICATIONS,X=g.WL.SUBNAV,Z=g.WL.TITLE_BAR,ee=g.WL.START,ne=g.u5.LINE_LOADER,ie=g.WL.TOASTS,te="minmax(0, 1fr)",ae="minmax(0, 1fr)",oe="0",de="0",le=[{layoutKey:y.FU.HYER,slots:[G,z,Q,K,ee,Z,ie,q,Y],responsiveTemplates:e=>{var n,i,t,a,o,d;const l=(null===(n=e[Z])||void 0===n?void 0:n.height)||W,r=(null===(i=e[K])||void 0===i?void 0:i.height)||"auto",s=(null===(a=null===(t=e[Y])||void 0===t?void 0:t.width)||void 0===a?void 0:a.get(k.Rd.IS_GREATER_THAN_0))||H,m=(null===(o=e[q])||void 0===o?void 0:o.height)||V,c=null===(d=e[ee])||void 0===d?void 0:d.width,u=(null==c?void 0:c.get(k.Rd.IS_GREATER_THAN_0))||"0",p=(null==c?void 0:c.get(k.Rd.IS_AT_LEAST_947))||"28rem",y=(null==c?void 0:c.get(k.Rd.IS_AT_LEAST_1350))||"32rem",v=(null==c?void 0:c.get(k.Rd.IS_AT_LEAST_1500))||"36rem";return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n            "${Z}       ${Z}         ${Z}         ${Z}"         ${l}\n            "${ne}     ${ne}       ${ne}       ${ne}"       ${de}\n            "${K}  ${K}    ${K}    ${K}"    ${r}\n            "${ie}         ${Y}              ${q}           ${q}"           ${m}\n            "${ie}         ${Y}              ${ee}            ${z}"             ${te} /\n            0                  ${s}         ${u}      ${ae}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_947,template:`\n            "${Z}       ${Z}         ${Z}         ${Z}"         ${l}\n            "${ne}     ${ne}       ${ne}       ${ne}"       ${de}\n            "${K}  ${K}    ${K}    ${K}"    ${r}\n            "${ie}         ${Y}              ${q}           ${q}"           ${m}\n            "${ie}         ${Y}              ${ee}            ${z}"             ${te} /\n            0                  ${s}         ${p}    ${ae}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_1350,template:`\n            "${Z}       ${Z}         ${Z}         ${Z}"         ${l}\n            "${ne}     ${ne}       ${ne}       ${ne}"       ${de}\n            "${K}  ${K}    ${K}    ${K}"    ${r}\n            "${ie}         ${Y}              ${q}           ${q} "          ${m}\n            "${ie}         ${Y}              ${ee}            ${z}"             ${te} /\n            0                  ${s}         ${y}   ${ae}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_1500,template:`\n            "${Z}       ${Z}         ${Z}         ${Z}"         ${l}\n            "${ne}     ${ne}       ${ne}       ${ne}"       ${de}\n            "${K}  ${K}    ${K}    ${K}"    ${r}\n            "${ie}         ${Y}              ${q}           ${q}"           ${m}\n            "${ie}         ${Y}              ${ee}            ${z}"             ${te} /\n            0                  ${s}         ${v}   ${ae}\n          `}]}},{layoutKey:y.FU.HYER,slots:[G,z,Q,K,ie],responsiveTemplates:e=>{var n;const i=(null===(n=e[K])||void 0===n?void 0:n.height)||"auto";return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n            "${ne}        ${ne}"       ${de}\n            "${K}     ${K}"    ${i}\n            "${ie}            ${z}"             ${te} /\n             0                    ${ae}\n          `}]}},{layoutKey:y.FU.HYER,slots:[G,q,z,Q,K,ie],responsiveTemplates:e=>{var n,i;const t=(null===(n=e[K])||void 0===n?void 0:n.height)||"auto",a=(null===(i=e[q])||void 0===i?void 0:i.height)||V;return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n            "${ne}        ${ne}"       ${de}\n            "${K}     ${K}"    ${t}\n            "${ie}            ${q}"           ${a}\n            "${ie}            ${z}"             ${te} /\n             0                    ${ae}\n          `}]}},{layoutKey:y.FU.HYER,slots:[G,J,q,z,Q,K,ie],responsiveTemplates:e=>{var n,i;const t=(null===(n=e[K])||void 0===n?void 0:n.height)||"auto",a=(null===(i=e[q])||void 0===i?void 0:i.height)||V,o=N(J,e,"32rem"),d=e=>({template:`\n        "${ne}        ${ne}        ${ne}"       ${de}\n        "${K}     ${K}     ${K}"    ${t}\n        "${ie}            ${q}            ${q}"           ${a}\n        "${ie}            ${z}              ${J}"              ${te} /\n         0                    ${ae}         ${e}\n      `});return[Object.assign({minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0},d(o[0])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_947},d(o[947])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1350},d(o[1350])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1500},d(o[1500])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1680},d(o[1680])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_2560},d(o[2560]))]}},{layoutKey:y.FU.HYER,slots:[G,z,Q,K,Z,ie],responsiveTemplates:e=>{var n,i;const t=(null===(n=e[K])||void 0===n?void 0:n.height)||"auto",a=(null===(i=e[Z])||void 0===i?void 0:i.height)||W;return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n            "${Z}          ${Z}"         ${a}\n            "${ne}        ${ne}"       ${de}\n            "${K}     ${K}"    ${t}\n            "${ie}            ${z}"             ${te} /\n             0                    ${ae}\n          `}]}},{layoutKey:y.FU.HYER,slots:[G,z,Q,Y,Z,ie],responsiveTemplates:e=>{var n,i,t;const a=(null===(i=null===(n=e[Y])||void 0===n?void 0:n.width)||void 0===i?void 0:i.get(k.Rd.IS_GREATER_THAN_0))||H,o=(null===(t=e[Z])||void 0===t?void 0:t.height)||W;return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n            "${Z}         ${Z}      ${Z}"          ${o}\n            "${ne}       ${ne}    ${ne}"        ${de}\n            "${ie}           ${Y}           ${z}"              ${te} /\n             0                   ${a}      ${ae}\n          `}]}},{layoutKey:y.FU.HYER,slots:[G,z,Q,Y,K,Z,ie],responsiveTemplates:e=>{var n,i,t,a;const o=(null===(n=e[K])||void 0===n?void 0:n.height)||"auto",d=(null===(t=null===(i=e[Y])||void 0===i?void 0:i.width)||void 0===t?void 0:t.get(k.Rd.IS_GREATER_THAN_0))||H,l=(null===(a=e[Z])||void 0===a?void 0:a.height)||W;return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n            "${Z}       ${Z}         ${Z}"         ${l}\n            "${ne}     ${ne}       ${ne}"       ${de}\n            "${K}  ${K}    ${K}"    ${o}\n            "${ie}         ${Y}              ${z}"             ${te} /\n             0                 ${d}         ${ae}\n          `}]}},{layoutKey:y.FU.HYER,slots:[G,q,z,Q,Y,K,Z,ie],responsiveTemplates:e=>{var n,i,t,a,o;const d=(null===(n=e[q])||void 0===n?void 0:n.height)||V,l=(null===(i=e[K])||void 0===i?void 0:i.height)||"auto",r=(null===(a=null===(t=e[Y])||void 0===t?void 0:t.width)||void 0===a?void 0:a.get(k.Rd.IS_GREATER_THAN_0))||H,s=(null===(o=e[Z])||void 0===o?void 0:o.height)||W;return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n            "${Z}       ${Z}      ${Z}"         ${s}\n            "${ne}     ${ne}    ${ne}"       ${de}\n            "${K}  ${K} ${K}"    ${l}\n            "${ie}         ${Y}           ${q}"           ${d}\n            "${ie}         ${Y}           ${z}"             ${te} /\n             0                 ${r}      ${ae}\n          `}]}},{layoutKey:y.FU.HYER,slots:[G,J,z,Q,Y,K,Z,ie],responsiveTemplates:e=>{var n,i,t,a,o;const d=null===(n=e[J])||void 0===n?void 0:n.width,l=(null===(i=e[K])||void 0===i?void 0:i.height)||"auto",r=(null===(a=null===(t=e[Y])||void 0===t?void 0:t.width)||void 0===a?void 0:a.get(k.Rd.IS_GREATER_THAN_0))||H,s=(null===(o=e[Z])||void 0===o?void 0:o.height)||W,m=(null==d?void 0:d.get(k.Rd.IS_GREATER_THAN_0))||"0",c=(null==d?void 0:d.get(k.Rd.IS_AT_LEAST_947))||"0",u=(null==d?void 0:d.get(k.Rd.IS_AT_LEAST_1350))||"32rem",p=(null==d?void 0:d.get(k.Rd.IS_AT_LEAST_1500))||"32rem",y=(null==d?void 0:d.get(k.Rd.IS_AT_LEAST_1680))||"32rem",v=(null==d?void 0:d.get(k.Rd.IS_AT_LEAST_2560))||"32rem",g=e=>({template:`\n        "${Z}       ${Z}      ${Z}         ${Z}"         ${s}\n        "${ne}     ${ne}    ${ne}       ${ne}"       ${de}\n        "${K}  ${K} ${K}    ${K}"    ${l}\n        "${ie}         ${Y}           ${z}             ${J}"              ${te} /\n         0                 ${r}      ${ae}        ${e}"\n      `});return[Object.assign({minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0},g(m)),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_947},g(c)),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1350},g(u)),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1500},g(p)),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1680},g(y)),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_2560},g(v))]}},{layoutKey:y.FU.HYER,slots:[G,q,z,Q,Y,K,ie],responsiveTemplates:e=>{var n,i,t,a;const o=(null===(n=e[q])||void 0===n?void 0:n.height)||V,d=(null===(i=e[K])||void 0===i?void 0:i.height)||"auto",l=(null===(a=null===(t=e[Y])||void 0===t?void 0:t.width)||void 0===a?void 0:a.get(k.Rd.IS_GREATER_THAN_0))||H;return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n            "${ne}      ${ne}    ${ne}"      ${de}\n            "${K}  ${K} ${K}"    ${d}\n            "${ie}         ${Y}           ${q}"           ${o}\n            "${ie}         ${Y}           ${z}"             ${te} /\n             0                 ${l}      ${ae}\n          `}]}},{layoutKey:y.FU.HYER,slots:[G,J,q,z,Q,Y,K,ie],responsiveTemplates:e=>{var n,i,t,a,o;const d=(null===(n=e[q])||void 0===n?void 0:n.height)||V,l=(null===(i=e[K])||void 0===i?void 0:i.height)||"auto",r=(null===(a=null===(t=e[Y])||void 0===t?void 0:t.width)||void 0===a?void 0:a.get(k.Rd.IS_GREATER_THAN_0))||H,s=null===(o=e[J])||void 0===o?void 0:o.width,m=(null==s?void 0:s.get(k.Rd.IS_GREATER_THAN_0))||"0",c=(null==s?void 0:s.get(k.Rd.IS_AT_LEAST_947))||"0",u=(null==s?void 0:s.get(k.Rd.IS_AT_LEAST_1350))||"32rem",p=(null==s?void 0:s.get(k.Rd.IS_AT_LEAST_1500))||"32rem",y=(null==s?void 0:s.get(k.Rd.IS_AT_LEAST_1680))||"32rem",v=(null==s?void 0:s.get(k.Rd.IS_AT_LEAST_2560))||"32rem",g=e=>({template:`\n      "${ne}     ${ne}    ${ne}       ${ne}"       ${de}\n      "${K}  ${K} ${K}    ${K}"    ${l}\n      "${ie}         ${Y}           ${q}           ${q}"           ${d}\n      "${ie}         ${Y}           ${z}             ${J}"              ${te} /\n       0                 ${r}      ${ae}        ${e}"\n    `});return[Object.assign({minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0},g(m)),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_947},g(c)),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1350},g(u)),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1500},g(p)),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1680},g(y)),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_2560},g(v))]}},{layoutKey:y.FU.HYER,slots:[G,J,q,z,Q,Y,K,Z,ie],responsiveTemplates:e=>{var n,i,t,a,o;const d=(null===(n=e[q])||void 0===n?void 0:n.height)||V,l=(null===(i=e[K])||void 0===i?void 0:i.height)||"auto",r=N(J,e,"32rem"),s=(null===(a=null===(t=e[Y])||void 0===t?void 0:t.width)||void 0===a?void 0:a.get(k.Rd.IS_GREATER_THAN_0))||H,m=(null===(o=e[Z])||void 0===o?void 0:o.height)||W,c=e=>({template:`\n            "${Z}         ${Z}      ${Z}         ${Z}"                 ${m}\n            "${ne}       ${ne}    ${ne}       ${ne}"               ${de}\n            "${K}    ${K} ${K}    ${K}"            ${l}\n            "${ie}           ${Y}           ${q}           ${q}"                   ${d}\n            "${ie}           ${Y}           ${z}             ${J}"                      ${te} /\n             0                   ${s}      ${ae}        ${e}\n          `});return[Object.assign({minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0},c(r[0])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_947},c(r[947])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1350},c(r[1350])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1500},c(r[1500])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_1680},c(r[1680])),Object.assign({minWidthBreakpoint:k.Rd.IS_AT_LEAST_2560},c(r[2560]))]}},{layoutKey:y.FU.HYER,slots:[G,z,Q,Y,K,X,Z,ie],responsiveTemplates:e=>{var n,i,t,a,o;const d=(null===(n=e[K])||void 0===n?void 0:n.height)||"auto",l=(null===(i=e[Z])||void 0===i?void 0:i.height)||W,r=(null===(a=null===(t=e[Y])||void 0===t?void 0:t.width)||void 0===a?void 0:a.get(k.Rd.IS_GREATER_THAN_0))||H,s=null===(o=e[X])||void 0===o?void 0:o.width,m=(null==s?void 0:s.get(k.Rd.IS_GREATER_THAN_0))||"0",c=(null==s?void 0:s.get(k.Rd.IS_AT_LEAST_947))||"28rem",u=(null==s?void 0:s.get(k.Rd.IS_AT_LEAST_1350))||"32rem",p=(null==s?void 0:s.get(k.Rd.IS_AT_LEAST_1500))||"36rem";return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n            "${Z}       ${Z}      ${Z}       ${Z}"         ${l}\n            "${ne}     ${ne}    ${ne}     ${ne}"       ${de}\n            "${K}  ${K} ${K}  ${K}"    ${d}\n            "${ie}         ${Y}           ${X}         ${z}"             ${te} /\n             0                 ${r}      ${m}   ${ae}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_947,template:`\n            "${Z}       ${Z}      ${Z}                ${Z}"         ${l}\n            "${ne}     ${ne}    ${ne}              ${ne}"       ${de}\n            "${K}  ${K} ${K}           ${K}"    ${d}\n            "${ie}         ${Y}           ${X}                  ${z}"             ${te} /\n             0                 ${r}      ${c}          ${ae}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_1350,template:`\n            "${Z}       ${Z}      ${Z}                ${Z}"         ${l}\n            "${ne}     ${ne}    ${ne}              ${ne}"       ${de}\n            "${K}  ${K} ${K}           ${K}"    ${d}\n            "${ie}         ${Y}           ${X}                  ${z}"             ${te} /\n             0                 ${r}      ${u}         ${ae}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_1500,template:`\n            "${Z}      ${Z}      ${Z}                 ${Z}"         ${l}\n            "${ne}    ${ne}    ${ne}               ${ne}"       ${de}\n            "${K} ${K} ${K}            ${K}"    ${d}\n            "${ie}        ${Y}           ${X}                   ${z}"             ${te} /\n             0                ${r}      ${p}          ${ae}\n          `}]}},{layoutKey:y.FU.HYER,slots:[G,q,z,Q,Y,K,X,Z,ie],responsiveTemplates:e=>{var n,i,t,a,o,d;const l=(null===(n=e[q])||void 0===n?void 0:n.height)||V,r=(null===(i=e[K])||void 0===i?void 0:i.height)||"auto",s=(null===(t=e[Z])||void 0===t?void 0:t.height)||W,m=null===(a=e[X])||void 0===a?void 0:a.width,c=(null===(d=null===(o=e[Y])||void 0===o?void 0:o.width)||void 0===d?void 0:d.get(k.Rd.IS_GREATER_THAN_0))||H,u=(null==m?void 0:m.get(k.Rd.IS_GREATER_THAN_0))||"0",p=(null==m?void 0:m.get(k.Rd.IS_AT_LEAST_947))||"28rem",y=(null==m?void 0:m.get(k.Rd.IS_AT_LEAST_1350))||"32rem",v=(null==m?void 0:m.get(k.Rd.IS_AT_LEAST_1500))||"36rem";return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n            "${Z}       ${Z}      ${Z}       ${Z}"                ${s}\n            "${ne}     ${ne}    ${ne}     ${ne}"              ${de}\n            "${K}  ${K} ${K}  ${K}"           ${r}\n            "${ie}         ${Y}           ${X}         ${q}"                  ${l}\n            "${ie}         ${Y}           ${X}         ${G}" ${oe}\n            "${ie}         ${Y}           ${X}         ${z}"                    ${te} /\n             0                 ${c}      ${u}   ${ae}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_947,template:`\n            "${Z}      ${Z}      ${Z}                ${Z}"                  ${s}\n            "${ne}    ${ne}    ${ne}              ${ne}"                ${de}\n            "${K} ${K} ${K}           ${K}"             ${r}\n            "${ie}        ${Y}           ${X}                  ${q}"                    ${l}\n            "${ie}        ${Y}           ${X}                  ${G}"   ${oe}\n            "${ie}        ${Y}           ${X}                  ${z}"                      ${te} /\n             0                ${c}      ${p}          ${ae}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_1350,template:`\n            "${Z}      ${Z}      ${Z}                ${Z}"                  ${s}\n            "${ne}    ${ne}    ${ne}              ${ne}"                ${de}\n            "${K} ${K} ${K}           ${K}"             ${r}\n            "${ie}        ${Y}           ${X}                  ${q}"                    ${l}\n            "${ie}        ${Y}           ${X}                  ${G}"   ${oe}\n            "${ie}        ${Y}           ${X}                  ${z}"                      ${te} /\n             0                ${c}      ${y}         ${ae}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_1500,template:`\n            "${Z}      ${Z}      ${Z}                ${Z}"                  ${s}\n            "${ne}    ${ne}    ${ne}              ${ne}"                ${de}\n            "${K} ${K} ${K}           ${K}"             ${r}\n            "${ie}        ${Y}           ${X}                  ${q}"                    ${l}\n            "${ie}        ${Y}           ${X}                  ${G}"   ${oe}\n            "${ie}        ${Y}           ${X}                  ${z}"                      ${te} /\n             0                ${c}      ${v}         ${ae}\n          `}]}},{layoutKey:y.FU.HYER,slots:[G,q,z,Q,Y,K,X,ie],responsiveTemplates:e=>{var n,i,t,a,o;const d=(null===(n=e[q])||void 0===n?void 0:n.height)||V,l=(null===(i=e[K])||void 0===i?void 0:i.height)||"auto",r=null===(t=e[X])||void 0===t?void 0:t.width,s=(null===(o=null===(a=e[Y])||void 0===a?void 0:a.width)||void 0===o?void 0:o.get(k.Rd.IS_GREATER_THAN_0))||H,m=(null==r?void 0:r.get(k.Rd.IS_GREATER_THAN_0))||"0",c=(null==r?void 0:r.get(k.Rd.IS_AT_LEAST_947))||"28rem",u=(null==r?void 0:r.get(k.Rd.IS_AT_LEAST_1350))||"32rem",p=(null==r?void 0:r.get(k.Rd.IS_AT_LEAST_1500))||"36rem";return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n            "${ne}     ${ne}    ${ne}     ${ne}"              ${de}\n            "${K}  ${K} ${K}  ${K}"           ${l}\n            "${ie}         ${Y}           ${X}         ${q}"                  ${d}\n            "${ie}         ${Y}           ${X}         ${G}" ${oe}\n            "${ie}         ${Y}           ${X}         ${z}"                    ${te} /\n             0                 ${s}      ${m}   ${ae}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_947,template:`\n            "${ne}    ${ne}    ${ne}              ${ne}"                ${de}\n            "${K} ${K} ${K}           ${K}"             ${l}\n            "${ie}        ${Y}           ${X}                  ${q}"                    ${d}\n            "${ie}        ${Y}           ${X}                  ${G}"   ${oe}\n            "${ie}        ${Y}           ${X}                  ${z}"                      ${te} /\n             0                ${s}      ${c}          ${ae}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_1350,template:`\n            "${ne}    ${ne}    ${ne}              ${ne}"                ${de}\n            "${K} ${K} ${K}           ${K}"             ${l}\n            "${ie}        ${Y}           ${X}                  ${q}"                    ${d}\n            "${ie}        ${Y}           ${X}                  ${G}"   ${oe}\n            "${ie}        ${Y}           ${X}                  ${z}"                      ${te} /\n             0                ${s}      ${u}         ${ae}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_1500,template:`\n            "${ne}    ${ne}    ${ne}              ${ne}"                ${de}\n            "${K} ${K} ${K}           ${K}"             ${l}\n            "${ie}        ${Y}           ${X}                  ${q}"                    ${d}\n            "${ie}        ${Y}           ${X}                  ${G}"   ${oe}\n            "${ie}        ${Y}           ${X}                  ${z}"                      ${te} /\n             0                ${s}      ${p}         ${ae}\n          `}]}},{layoutKey:y.FU.HYER,slots:[G,J,z,Q,Y,K,X,Z,ie],responsiveTemplates:e=>{var n,i,t,a,o,d;const l=null===(n=e[J])||void 0===n?void 0:n.width,r=(null===(i=e[K])||void 0===i?void 0:i.height)||"auto",s=(null===(t=e[Z])||void 0===t?void 0:t.height)||W,m=null===(a=e[X])||void 0===a?void 0:a.width,c=(null===(d=null===(o=e[Y])||void 0===o?void 0:o.width)||void 0===d?void 0:d.get(k.Rd.IS_GREATER_THAN_0))||H,u=(null==l?void 0:l.get(k.Rd.IS_GREATER_THAN_0))||"0",p=(null==l?void 0:l.get(k.Rd.IS_AT_LEAST_947))||"0",y=(null==l?void 0:l.get(k.Rd.IS_AT_LEAST_1350))||"32rem",v=(null==l?void 0:l.get(k.Rd.IS_AT_LEAST_1500))||"32rem",g=(null==l?void 0:l.get(k.Rd.IS_AT_LEAST_1680))||"32rem",N=(null==l?void 0:l.get(k.Rd.IS_AT_LEAST_2560))||"32rem",h=(null==m?void 0:m.get(k.Rd.IS_GREATER_THAN_0))||"0",f=(null==m?void 0:m.get(k.Rd.IS_AT_LEAST_947))||"28rem",_=(null==m?void 0:m.get(k.Rd.IS_AT_LEAST_1350))||"32rem",S=(null==m?void 0:m.get(k.Rd.IS_AT_LEAST_1500))||"36rem";return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n            "${Z}      ${Z}      ${Z}      ${Z}         ${Z}"         ${s}\n            "${ne}    ${ne}    ${ne}    ${ne}       ${ne}"       ${de}\n            "${K} ${K} ${K} ${K}    ${K}"    ${r}\n            "${ie}        ${Y}           ${X}        ${z}             ${J}"              ${te} /\n             0                ${c}      ${h}  ${ae}        ${u}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_947,template:`\n            "${Z}      ${Z}      ${Z}                ${Z}         ${Z}"         ${s}\n            "${ne}    ${ne}    ${ne}              ${ne}       ${ne}"       ${de}\n            "${K} ${K} ${K}           ${K}    ${K}"    ${r}\n            "${ie}        ${Y}           ${X}                  ${z}             ${J}"              ${te} /\n             0                ${c}      ${f}          ${ae}        ${p}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_1350,template:`\n            "${Z}      ${Z}      ${Z}                ${Z}         ${Z}"         ${s}\n            "${ne}    ${ne}    ${ne}              ${ne}       ${ne}"       ${de}\n            "${K} ${K} ${K}           ${K}    ${K}"    ${r}\n            "${ie}        ${Y}           ${X}                  ${z}             ${J}"              ${te} /\n             0                ${c}      ${_}         ${ae}        ${y}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_1500,template:`\n            "${Z}      ${Z}      ${Z}                ${Z}         ${Z}"         ${s}\n            "${ne}    ${ne}    ${ne}              ${ne}       ${ne}"       ${de}\n            "${K} ${K} ${K}           ${K}    ${K}"    ${r}\n            "${ie}        ${Y}           ${X}                  ${z}             ${J}"              ${te} /\n             0                ${c}      ${S}         ${ae}        ${v}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_1680,template:`\n            "${Z}      ${Z}      ${Z}                ${Z}         ${Z}"         ${s}\n            "${ne}    ${ne}    ${ne}              ${ne}       ${ne}"       ${de}\n            "${K} ${K} ${K}           ${K}    ${K}"    ${r}\n            "${ie}        ${Y}           ${X}                  ${z}             ${J}"              ${te} /\n             0                ${c}      ${S}         ${ae}        ${g}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_2560,template:`\n            "${Z}      ${Z}      ${Z}                ${Z}         ${Z}"         ${s}\n            "${ne}    ${ne}    ${ne}              ${ne}       ${ne}"       ${de}\n            "${K} ${K} ${K}           ${K}    ${K}"    ${r}\n            "${ie}        ${Y}           ${X}                  ${z}             ${J}"              ${te} /\n             0                ${c}      ${S}         ${ae}        ${N}\n          `}]}},{layoutKey:y.FU.HYER,slots:[G,J,q,z,Q,Y,K,X,ie],responsiveTemplates:e=>{var n,i,t,a,o,d;const l=(null===(n=e[q])||void 0===n?void 0:n.height)||V,r=(null===(i=e[K])||void 0===i?void 0:i.height)||"auto",s=null===(t=e[X])||void 0===t?void 0:t.width,m=(null===(o=null===(a=e[Y])||void 0===a?void 0:a.width)||void 0===o?void 0:o.get(k.Rd.IS_GREATER_THAN_0))||H,c=null===(d=e[J])||void 0===d?void 0:d.width,u=(null==c?void 0:c.get(k.Rd.IS_GREATER_THAN_0))||"0",p=(null==c?void 0:c.get(k.Rd.IS_AT_LEAST_947))||"0",y=(null==c?void 0:c.get(k.Rd.IS_AT_LEAST_1350))||"32rem",v=(null==c?void 0:c.get(k.Rd.IS_AT_LEAST_1500))||"32rem",g=(null==c?void 0:c.get(k.Rd.IS_AT_LEAST_1680))||"32rem",N=(null==c?void 0:c.get(k.Rd.IS_AT_LEAST_2560))||"32rem",h=(null==s?void 0:s.get(k.Rd.IS_GREATER_THAN_0))||"0",f=(null==s?void 0:s.get(k.Rd.IS_AT_LEAST_947))||"28rem",_=(null==s?void 0:s.get(k.Rd.IS_AT_LEAST_1350))||"32rem",S=(null==s?void 0:s.get(k.Rd.IS_AT_LEAST_1500))||"36rem";return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n            "${ne}    ${ne}    ${ne}    ${ne}       ${ne}"       ${de}\n            "${K} ${K} ${K} ${K}    ${K}"    ${r}\n            "${q}        ${q}        ${q}        ${q}           ${q}"           ${l}\n            "${ie}        ${Y}           ${X}        ${z}             ${J}"              ${te} /\n             0                ${m}      ${h}  ${ae}        ${u}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_947,template:`\n          "${ne}      ${ne}    ${ne}              ${ne}       ${ne}"       ${de}\n          "${K}   ${K} ${K}           ${K}    ${K}"    ${r}\n          "${q}          ${q}        ${q}                  ${q}           ${q}"           ${l}\n          "${ie}          ${Y}           ${X}                  ${z}             ${J}"              ${te} /\n           0                  ${m}      ${f}          ${ae}        ${p}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_1350,template:`\n          "${ne}    ${ne}    ${ne}              ${ne}       ${ne}"       ${de}\n          "${K} ${K} ${K}           ${K}    ${K}"    ${r}\n          "${q}        ${q}        ${q}                  ${q}           ${q}"           ${l}\n          "${ie}        ${Y}           ${X}                  ${z}             ${J}"              ${te} /\n           0                ${m}      ${_}         ${ae}        ${y}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_1500,template:`\n          "${ne}    ${ne}    ${ne}              ${ne}       ${ne}"       ${de}\n          "${K} ${K} ${K}           ${K}    ${K}"    ${r}\n          "${q}        ${q}        ${q}                  ${q}           ${q}"           ${l}\n          "${ie}        ${Y}           ${X}                  ${z}             ${J}"              ${te} /\n           0                ${m}      ${S}         ${ae}        ${v}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_1680,template:`\n          "${ne}    ${ne}    ${ne}              ${ne}       ${ne}"       ${de}\n          "${K} ${K} ${K}           ${K}    ${K}"    ${r}\n          "${q}        ${q}        ${q}                  ${q}           ${q}"           ${l}\n          "${ie}        ${Y}           ${X}                  ${z}             ${J}"              ${te} /\n           0                ${m}      ${S}         ${ae}        ${g}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_2560,template:`\n          "${ne}    ${ne}    ${ne}              ${ne}       ${ne}"       ${de}\n          "${K} ${K} ${K}           ${K}    ${K}"    ${r}\n          "${q}        ${q}        ${q}                  ${q}           ${q}"           ${l}\n          "${ie}        ${Y}           ${X}                  ${z}             ${J}"              ${te} /\n           0                ${m}      ${S}         ${ae}        ${N}\n          `}]}},{layoutKey:y.FU.HYER,slots:[G,J,q,z,Q,Y,K,X,Z,ie],responsiveTemplates:e=>{var n,i,t,a,o,d,l;const r=null===(n=e[J])||void 0===n?void 0:n.width,s=(null===(i=e[q])||void 0===i?void 0:i.height)||V,m=(null===(t=e[K])||void 0===t?void 0:t.height)||"auto",c=(null===(a=e[Z])||void 0===a?void 0:a.height)||W,u=null===(o=e[X])||void 0===o?void 0:o.width,p=(null===(l=null===(d=e[Y])||void 0===d?void 0:d.width)||void 0===l?void 0:l.get(k.Rd.IS_GREATER_THAN_0))||H,y=(null==u?void 0:u.get(k.Rd.IS_GREATER_THAN_0))||"0",v=(null==u?void 0:u.get(k.Rd.IS_AT_LEAST_947))||"28rem",g=(null==u?void 0:u.get(k.Rd.IS_AT_LEAST_1350))||"32rem",N=(null==u?void 0:u.get(k.Rd.IS_AT_LEAST_1500))||"36rem",h=(null==r?void 0:r.get(k.Rd.IS_GREATER_THAN_0))||"0",f=(null==r?void 0:r.get(k.Rd.IS_AT_LEAST_947))||"0",_=(null==r?void 0:r.get(k.Rd.IS_AT_LEAST_1350))||"32rem",S=(null==r?void 0:r.get(k.Rd.IS_AT_LEAST_1500))||"32rem",T=(null==r?void 0:r.get(k.Rd.IS_AT_LEAST_1680))||"32rem",b=(null==r?void 0:r.get(k.Rd.IS_AT_LEAST_2560))||"32rem";return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n            "${Z}         ${Z}      ${Z}         ${Z}         ${Z}"         ${c}\n            "${ne}       ${ne}    ${ne}       ${ne}       ${ne}"       ${de}\n            "${K}    ${K} ${K}    ${K}    ${K}"    ${m}\n            "${ie}           ${Y}           ${X}           ${q}           ${q}"           ${s}\n            "${ie}           ${Y}           ${X}           ${z}             ${J}"              ${te} /\n             0                   ${p}      ${y}     ${ae}        ${h}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_947,template:`\n            "${Z}      ${Z}      ${Z}                ${Z}         ${Z}"         ${c}\n            "${ne}    ${ne}    ${ne}              ${ne}       ${ne}"       ${de}\n            "${K} ${K} ${K}           ${K}    ${K}"    ${m}\n            "${ie}        ${Y}           ${X}                  ${q}           ${q}"           ${s}\n            "${ie}        ${Y}           ${X}                  ${z}             ${J}"              ${te} /\n             0                ${p}      ${v}          ${ae}        ${f}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_1350,template:`\n            "${Z}      ${Z}      ${Z}                ${Z}         ${Z}"         ${c}\n            "${ne}    ${ne}    ${ne}              ${ne}       ${ne}"       ${de}\n            "${K} ${K} ${K}           ${K}    ${K}"    ${m}\n            "${ie}        ${Y}           ${X}                  ${q}           ${q}"           ${s}\n            "${ie}        ${Y}           ${X}                  ${z}             ${J}"              ${te} /\n             0                ${p}      ${g}         ${ae}        ${_}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_1500,template:`\n            "${Z}      ${Z}      ${Z}               ${Z}         ${Z}"         ${c}\n            "${ne}    ${ne}    ${ne}             ${ne}       ${ne}"       ${de}\n            "${K} ${K} ${K}          ${K}    ${K}"    ${m}\n            "${ie}        ${Y}           ${X}                 ${q}           ${q}"           ${s}\n            "${ie}        ${Y}           ${X}                 ${z}             ${J}"              ${te} /\n             0                ${p}      ${N}        ${ae}        ${S}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_1680,template:`\n            "${Z}      ${Z}      ${Z}               ${Z}         ${Z}"         ${c}\n            "${ne}    ${ne}    ${ne}             ${ne}       ${ne}"       ${de}\n            "${K} ${K} ${K}          ${K}    ${K}"    ${m}\n            "${ie}        ${Y}           ${X}                 ${q}           ${q}"           ${s}\n            "${ie}        ${Y}           ${X}                 ${z}             ${J}"              ${te} /\n             0                ${p}      ${N}        ${ae}        ${T}\n          `},{minWidthBreakpoint:k.Rd.IS_AT_LEAST_2560,template:`\n            "${Z}      ${Z}      ${Z}               ${Z}         ${Z}"         ${c}\n            "${ne}    ${ne}    ${ne}             ${ne}       ${ne}"       ${de}\n            "${K} ${K} ${K}          ${K}    ${K}"    ${m}\n            "${ie}        ${Y}           ${X}                 ${q}           ${q}"           ${s}\n            "${ie}        ${Y}           ${X}                 ${z}             ${J}"              ${te} /\n             0                ${p}      ${N}        ${ae}        ${b}\n          `}]}}],re=g.WL.CONTEXTUAL_NOTIFICATIONS,se=g.WL.MAIN,me=g.WL.MODAL,ce=g.WL.NOTIFICATIONS,ue=g.WL.TOASTS,pe=g.WL.TITLE_BAR,ye=g.u5.LINE_LOADER,ve="minmax(0, 1fr)",ke="minmax(0, 1fr)",ge="3.2rem",Ne=[{layoutKey:y.FU.HYER,slots:[re,se,me,pe,ue],responsiveTemplates:e=>{var n;const i=(null===(n=e[pe])||void 0===n?void 0:n.height)||ge;return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n          "${pe}        ${pe}"    ${i}   \n          "${ye}      ${ye}"  0       \n          "${ue}          ${se}"        ${ve} /\n           0                  ${ke}\n          `}]}},{layoutKey:y.FU.HYER,slots:[re,se,me,ce,pe,ue],responsiveTemplates:e=>{var n;const i=(null===(n=e[pe])||void 0===n?void 0:n.height)||ge;return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n          "${pe}        ${pe}"   ${i}          \n          "${ye}      ${ye}" 0\n          "${ue}          ${se}"       ${ve} /\n           0                  ${ke}\n          `}]}},{layoutKey:y.FU.HYER,slots:[se,pe],responsiveTemplates:e=>{var n;const i=(null===(n=e[pe])||void 0===n?void 0:n.height)||ge;return[{minWidthBreakpoint:k.Rd.IS_GREATER_THAN_0,template:`\n          "${pe}        ${pe}"        ${i}\n          "${ye}      ${ye}"      0\n          "${ue}          ${se}"            ${ve} /\n           0                  ${ke}    \n          `}]}}];function he({layoutKey:e,layoutMode:n}){const i={[v.lO.focus]:M,[v.lO.minimal]:U,[v.lO.standard]:le,[v.lO.minimode]:Ne};return new y.ZG({layoutKey:e,layoutMode:n,layoutTemplatesPerLayoutMode:i})}var fe=i(848085),_e=i(382433),Se=i(706827),Te=i(515719),be=i(650411),Ce=i(671491);const we=({environment:e,theme:n,cspNonce:i,publicPathScript:t,containerVer:a,viewportContext:o})=>{const{favicons:d}=fe.L;return Se({htmlWebpackPlugin:{options:{containerVer:a,publicPathScript:t,cspNonce:i,theme:n,viewportContext:o,partials:{favicons:d(),themeStyles:Te(),titleBar:o===_e.R.flyout?void 0:be({environment:e}),titleBarStyles:o===_e.R.flyout?void 0:Ce()}},files:{}}})};var Ie=i(250033),Ae=i(818319),Fe=i(127097),De=i(956255),Ee=i(916553),Me=i(40882);const Pe=({action:e,appRenderMode:n,coreSettings:i})=>{const t=new Ee.H,{criticalPhaseTimeout:a,postCriticalPhaseTimeout:o,enableRenderingOrder:d}=i.get(s.J.Activity),l=[];switch(n){case Fe.S.Rail:d?(l.push(Me.G.FEED_LIST_ITEMS_RENDERED),l.push(Me.G.FEED_ITEM_NAVIGATION)):l.push(Me.G.VIRTUAL_LIST_RENDER_BUFFER_FILLED);case Fe.S.Main:e===De.uk.empty&&l.push(Me.G.NO_FEED_GRAPHICS_RENDERED)}return t.registerAppPhase({phase:g.nh.CRITICAL,signals:l,timeout:a||6e4}),t.registerAppPhase({phase:g.nh.POST_CRITICAL,signals:[],timeout:o||12e4}),t.appPhases},Re="activity",Oe="viewActivityApp",$e=()=>({actor:Re,action:Oe}),Le={id:"com.microsoft.teams.activity",name:"Activity",getLocalizedName:e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("activity"),e.stringTranslate("activity","activity_app_name")})),actors:[Re],supportedEntities:[De.py.activity,De.py.notificationsettingsdefault,De.py.activityinapptoastundo],supportedRenderModes:[Fe.S.Main,Fe.S.Rail,Fe.S.Modal],getDefaultCommand:()=>({type:De.py.activity,action:De.uk.default}),windowFeatures:{minWidth:602,width:602,minHeight:500,height:500,offset:20},shouldDeferNavigationToMainSlotApp:!0};var xe=i(917556);const Be=e=>{if(je(e))return Ue(e)?{subNavEntity:Ve(e),headerEntity:We(e),startEntity:He(e),mainEntity:Ge(e),endEntity:Je(e)}:null},je=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.standard].includes(e),o=[De.uk.list,De.uk.default,De.uk.empty].includes(i),d=[De.py.activity].includes(t);return!!(a&&d&&o)},Ue=()=>!0,Ve=({entity:e})=>e,We=({entity:e,contextEntity:n})=>Qe(e,n),He=()=>null,Ge=({entity:e,contextEntity:n})=>{const{action:i=null}=Object.assign({},e);return i&&i===De.uk.empty?Object.assign(Object.assign({},e),{action:i}):Qe(e,n)},Je=()=>null,qe=({enableLeftRailStylesV2:e,hasBackdropEffect:n,shouldDisableLeftRailDefaultBackgroundMica:i,enableMercuryDesign:t})=>({isBackgroundTransparent:!i&&!!t&&!!n,isSlotBackgroundSemiTransparent:!!n&&!!e,isColorSchemeDefaultBackground3:!1,isColorSchemeDefaultBackground2:!!i||!n}),ze=({areEmptySlotsTransparent:e,hasBackdropEffect:n,coreSettings:i})=>{var t,a;const{enableLeftRailStylesV2:o,leftRailDefaultBackgroundMicaDisabled:d}=null!==(t=null==i?void 0:i.get(s.J.Core))&&void 0!==t?t:{},{enableMercuryDesign:l}=(null==i?void 0:i.get(s.J.MercuryDesign))||{},{deviceInfo:r}=null!==(a=null==i?void 0:i.get(s.J.Platform))&&void 0!==a?a:{},m=r&&(0,xe.Y)(r),c=d||m;return{subNavEntity:{[Fe.S.Rail]:Object.assign({areSlotShadowsDisabled:e},qe({enableLeftRailStylesV2:o,hasBackdropEffect:n,shouldDisableLeftRailDefaultBackgroundMica:c,enableMercuryDesign:l}))}}},Qe=(e,n)=>n&&(e=>e&&e.type===De.py.activity&&e.action===De.uk.default)(e)?Object.assign(Object.assign({},n),{linkedEntity:null}):null,Ye=e=>c.RG.ActivitySwitch,Ke=e=>e.command.stateTransition===v.su.flow?c.RG.ActivitySwitch:void 0,Xe={shouldAddEntitiesToWindowHistory:e=>{var n;return(null===(n=e.mainEntity)||void 0===n?void 0:n.type)!==De.py.activity},shouldRestoreClientToEntities:e=>{var n;return(null===(n=e.subNavEntity)||void 0===n?void 0:n.type)!==De.py.activity}};var Ze=i(727523);const en="entitymoreinfo",nn="requestPersonMoreInfo",tn="requestPersonMoreOrgInfo",an="requestTopicMoreInfo",on=e=>({actor:en,action:nn,data:e}),dn=e=>({actor:en,action:tn,data:e}),ln=e=>({actor:en,action:an,data:e}),rn={onEventReceived:({eventInput:e})=>{var n,i;if(e.event.type===Ze.uS.requestPersonMoreInfo){const t=null===(i=(n=e.event).data)||void 0===i?void 0:i.call(n);return Promise.resolve({command:on(t)})}return Promise.resolve(void 0)}};var sn=i(955105),mn=i(781015),cn=i(303419),un=i(810602),pn=i(575644),yn=i(905581),vn=i(653266),kn=i(469980),gn=i(132756);const Nn=e=>({visibilityState:v.fe.show,stateTransition:e,correlation:{source:sn.D.AppBar}}),hn=e=>({id:e,action:De.uk.default,type:De.py.activity}),fn=e=>({entity:hn(e),command:Nn(v.su.flush)}),_n="ActivityEarlyFirstPageFetch",Sn=(e,n,i)=>{var t,a;const o=null===(t=null==e?void 0:e.edges[0])||void 0===t?void 0:t.node;if(!o)return i.log("Top feed unavailable, cannot intercept command"),null;const{activityNavigationParams:d}=o;let l=!1,r=null;const s=null===(a=n.executionContext.viewEntities.mainEntity)||void 0===a?void 0:a.type;if(d.navigationTarget===vn.m$.chat)l=s===De.py.chats,r=(({messageId:e,threadId:n},i,t)=>{var a,o,d;if(!n)throw(0,yn.Tr)(_n,gn.jK.MissingParameter,"getInterceptedChatCommand");const l=null===(d=null===(o=null===(a=i.client)||void 0===a?void 0:a.ctx)||void 0===o?void 0:o.entityCommanding)||void 0===d?void 0:d.chat;if(!l)throw t.error("Did not find activityCommanding"),(0,yn.Tr)(_n,gn.jK.NotPresent,"getInterceptedChatCommand");const r=l.getChatByIdCommand(n,{entityOptions:{focusOnLoad:kn.t.DoNotMove,messageId:e}});if(!r)return t.error("Chat commanding did not return a command"),null;const{entity:s,entityOptions:m}=r;return{entity:Object.assign(Object.assign({},s),{linkedEntity:hn(mn.F4.noNavOnSameMainEntity)}),command:Nn(v.su.forceFlush),entityOptions:m}})(d,n,i),i.log(`Top feed mainEntity: chat, previousMainEntity: ${s}`);return null===r?null:l?r:fn(mn.F4.navOnDifferentMainEntity)},Tn=({commandInput:e,requestContext:n})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:i}}=e,t=n.loggerFactory.newLogger("ActivityApp onCommandReceived","apps-activity");if(e.command.actor===Re){if(i===Oe){const e={entity:{id:mn.F4.navWithoutEarlyFetch,type:De.py.activity,action:De.uk.default},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,correlation:{source:sn.D.AppBar}}},i=yield bn(n,t);return null!=i?i:e}t.error(`Command action '${i}' is not supported at ActivityApp.`)}else t.error(`Command for actor '${e.command.actor}' cannot be handled by ActivityApp.`)})),bn=(e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const i=e.scenarioFactory.findScenario(c.RG.ActivitySwitch);if(i&&!e.executionContext.isHandlingAppActiveApp&&e.coreSettings.get(s.J.Activity).enableEarlyFirstPageFetch){if(!Cn(e,n))return null;i.mark(c.ck.CDLEarlyFetchStart);const t=yield wn(e,i,n);if(i.mark(c.ck.CDLEarlyFetchEnd),t){const e=An(t);return cn.c.appendFeedDataBag(n,i,{earlyFetchNavType:e}),n.log(`Early fetch succesful load type: ${e}`),t}}return null})),Cn=(e,n)=>{var i;const t=null===(i=e.executionContext.viewEntities.mainEntity)||void 0===i?void 0:i.type,a=t===De.py.chats;return a||n.log(`Early fetch for entity ${t} not supported`),a},wn=(e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t;try{const{earlyFirstPageFetchWaitTimeout:a,paginationFirstLoad:o,enableAvatarUrlResolutionInActivityFeeds:d}=e.coreSettings.get(s.J.Activity),l=Date.now(),{data:{activities:r}}=yield(0,pn.E)(e.client.query({query:un.I,variables:{first:null!=o?o:mn.ch,isFirstPage:!0,filters:{feedTypes:[]},enableAvatarUrlResolutionInActivityFeeds:!!d},fetchPolicy:"network-only"}),null!=a?a:mn.LI),m=Date.now()-l;return cn.c.appendFeedDataBag(i,n,{earlyFetchWorkerResponseTime:m}),r?null!==(t=In(r,e,n,i))&&void 0!==t?t:fn(mn.F4.navOnEarlyFetch):(i.warn("Did not find activities in CDL response"),null)}catch(e){const t=(0,yn.qZ)(e);return cn.c.appendFeedDataBag(i,n,{earlyFetchErrorCode:t}),i.error(`Early first page fetch failed with code ${t}`),null}})),In=(e,n,i,t)=>{try{return Sn(e,n,t)}catch(e){const n=(0,yn.qZ)(e);return cn.c.appendFeedDataBag(t,i,{earlyFetchErrorCode:n}),t.error(`Early fetch command interception failed with code ${n}`),null}},An=e=>{var n,i,t;return null!==(t=null!==(i=null===(n=e.entity.linkedEntity)||void 0===n?void 0:n.id)&&void 0!==i?i:e.entity.id)&&void 0!==t?t:"unknown"};var Fn=i(653930);const Dn=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n;const{entityCommand:{entity:{type:i,action:t},command:{visibilityState:a}},requestContext:{loggerFactory:o,coreSettings:d}}=e,{enableActivityAppCommandResultHook:l}=d.get(s.J.Activity);if(!l)return;const r=o.newLogger("ActivityApp[onCommandResult]","apps-activity");if(i!==De.py.activity&&t===De.uk.view&&(r.log(`Windowing command with visibilityState: ${a}`),a===v.fe.show)){const i=null===(n=e.entityCommand.metadata)||void 0===n?void 0:n.deepLink;if(i){const n=new URL(i),t=new URLSearchParams(n.search).get("activityId")||"",a=e.requestContext.client;return En(r,a,t)}r.warn("Deeplink Url not present")}})),En=(e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t;e.log(`Marking activity activityId=${i} as read`);try{if(!i)return void e.warn(`Could not mark activity as read: activityId: ${i}`);yield n.mutate({mutation:Fn.e,variables:{id:i,isRead:!0}})}catch(n){null===(t=e.errorToTelemetry)||void 0===t||t.call(e,`mark activity as read failed: activityId ${i} failed`,"feeds_mark_as_read_failed",void 0,!0)}}));var Mn,Pn=i(332507);!function(e){e.ActivityApp="activity-app",e.ActivityFeedDialogs="activity-feed-dialogs",e.ActivityMainPane="activity-main-pane"}(Mn||(Mn={}));const Rn=()=>Promise.all([i.e(917388),i.e(122297),i.e(140641),i.e(892924),i.e(256045),i.e(779478),i.e(296056),i.e(901010),i.e(762706),i.e(9081),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(269296),i.e(26466),i.e(127919),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(403936),i.e(450605),i.e(329712),i.e(839180),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(249903),i.e(579320)]).then(i.bind(i,247442)),On=()=>Promise.all([i.e(576443),i.e(261148)]).then(i.bind(i,734340)),$n=()=>null,Ln=(e,n,i,a)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){switch(n("ChunkLoadStarted",{chunkName:e}),e){case Mn.ActivityApp:const{ActivityViewsRenderer:t}=yield(0,Pn.mT)(Rn,e,i);return n("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(t,{coreSettings:a});case Mn.ActivityFeedDialogs:const{ActivityDialogViewsRenderer:o}=yield(0,Pn.mT)(On,e,i);return n("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(o,{});case Mn.ActivityMainPane:const{ActivityMainPane:d}=yield(0,Pn.mT)(Rn,e,i);return n("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(d,{});default:return(0,Ie.t)($n,{})}}));var xn=i(481786),Bn=i(885293),jn=i(147739),Un=i(741034),Vn=i(477343),Wn=i(259631),Hn=i(952977),Gn=i(562472),Jn=i(494094),qn=i(903912),zn=i(379525);const Qn=(0,zn.s)({dialogSurface:{B2u0y6b:"fvgz9i8",Bqenvij:"fu2thx1",z8tnut:"f1jfh9s1",z189sj:["f15kemlc","fdgang7"],Byoj8tv:"fl2zwns",uwmqm3:["fdgang7","f15kemlc"]},dialogTitle:{a9b677:"f4cn2hj",B6of3ja:"f1xdg43u"},dialogSubTitle:{a9b677:"fl6va0v",B6of3ja:"f7w72kx"},dialogContent:{mc9l5x:"f22iagw",Beiy3e4:"f1vx9l62",B6of3ja:"f2zxqi"},dialogContentRow:{mc9l5x:"f22iagw",Beiy3e4:"f1063pyq",B6of3ja:"f1xdg43u",Bt984gj:"f122n59",Brf1p80:"f1869bpl"},dropdown:{a9b677:"f1hp80ii"},dropdownLabel:{a9b677:"f19i1hda"},dialogActions:{a9b677:"fly5x3f",B6of3ja:"f109tmk6"},dialogActionsRow:{mc9l5x:"f22iagw",Beiy3e4:"f1063pyq",Bt984gj:"f122n59",a9b677:"fly5x3f"},dialogActionButtons:{a9b677:"f1kyr2gn",Frg6f3:["ff9s3yw","f1phki43"]},dialogActionLink:{a9b677:"f1fay27e"},dialogActionButtonGroup:{mc9l5x:"f22iagw",Beiy3e4:"f1063pyq",Frg6f3:["fcgxt0o","f1ujusj6"]}},{d:[".fvgz9i8{max-width:600px;}",".fu2thx1{height:386px;}",".f1jfh9s1{padding-top:28px;}",".f15kemlc{padding-right:24px;}",".fdgang7{padding-left:24px;}",".fl2zwns{padding-bottom:24px;}",".f4cn2hj{width:321px;}",".f1xdg43u{margin-top:12px;}",".fl6va0v{width:415px;}",".f7w72kx{margin-top:20px;}",".f22iagw{display:flex;}",".f1vx9l62{flex-direction:column;}",".f2zxqi{margin-top:8px;}",".f1063pyq{flex-direction:row;}",".f122n59{align-items:center;}",".f1869bpl{justify-content:space-between;}",".f1hp80ii{width:280px;}",".f19i1hda{width:230px;}",".fly5x3f{width:100%;}",".f109tmk6{margin-top:34px;}",".f1kyr2gn{width:96px;}",".ff9s3yw{margin-left:8px;}",".f1phki43{margin-right:8px;}",".f1fay27e{width:158px;}",".fcgxt0o{margin-left:auto;}",".f1ujusj6{margin-right:auto;}"]}),Yn=()=>{const[e,n]=Ae.useState(!0),i=Qn(),t=Ae.useCallback(((e,i)=>{n(i.open)}),[]);return(0,Ie.t)(jn.V,Object.assign({open:e,onOpenChange:t},{children:(0,Ie.t)(Un.c,Object.assign({className:i.dialogSurface},{children:(0,Ie.t)(Vn.a,{children:[(0,Ie.t)(Wn.$,{children:(0,Ie.t)(Jn.O,Object.assign({animation:"pulse"},{children:[(0,Ie.t)(qn.j,{size:20,className:i.dialogTitle,"data-testid":"shape"}),(0,Ie.t)(qn.j,{size:12,className:i.dialogSubTitle,"data-testid":"shape"})]}))}),(0,Ie.t)(Hn.c,Object.assign({className:i.dialogContent},{children:(0,Ie.t)(Jn.O,Object.assign({animation:"pulse"},{children:[...Array(4)].map(((e,n)=>(0,Ie.t)("div",Object.assign({className:i.dialogContentRow},{children:[(0,Ie.t)(qn.j,{size:12,className:i.dropdownLabel,"data-testid":"shape"}),(0,Ie.t)(qn.j,{size:32,className:i.dropdown,"data-testid":"shape"})]}),n)))}))})),(0,Ie.t)(Gn.k,Object.assign({fluid:!0,className:i.dialogActions},{children:(0,Ie.t)(Jn.O,Object.assign({animation:"pulse",className:i.dialogActionsRow},{children:[(0,Ie.t)(qn.j,{size:12,className:i.dialogActionLink,"data-testid":"shape"}),(0,Ie.t)("div",Object.assign({className:i.dialogActionButtonGroup},{children:[...Array(2)].map(((e,n)=>(0,Ie.t)(qn.j,{size:32,className:i.dialogActionButtons,"data-testid":"shape"},n)))}))]}))}))]})}))}))},Kn=()=>Promise.all([i.e(371935),i.e(149179),i.e(466470)]).then(i.bind(i,625370)),Xn=e=>(0,Ie.t)(Bn.S,Object.assign({loggerName:"LazyNotificationSettingsRecommendationDialogEntityView"},{children:(0,Ie.t)(xn.o,{factory:Kn,props:e,fallback:(0,Ie.t)(Yn,{})})}));Xn.displayName="LazyNotificationSettingsRecommendationDialogEntityView";var Zn=i(893855),ei=i(663945),ni=i(36593);const ii=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:n}=e,{entity:{type:i,action:t}}=n;if(i!==De.py.activityinapptoastundo||t!==De.uk.mutate)return n;yield ti(e)})),ti=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:n,requestContext:i}=e,{userBiService:t,loggerFactory:a}=i,o=n.entityOptions,d=a.newLogger("ActivityOnBeforeCommandHandled","apps-activity");switch(oi(t,o),o.supportedAction){case mn.HX.turnOffLikesAndReactions:case mn.HX.turnOffAllTeamAndChannelMentions:yield ai(o,i,ni.NN.Notifications,d);break;case mn.HX.muteApp:yield ai(o,i,ni.NN.GraphApps,d)}})),ai=(e,n,i,a)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{scenarioFactory:t}=n,o=e.previousSettings;if(o&&o.length){const d=t.newScenario(c.RG.ActivityContextualSettingsUpdate);try{yield n.client.mutate({mutation:Zn._3,variables:{settingsUpdate:{updatedSettings:o},appId:i,subCategoryPageId:e.appId}}),d.stop({supportedActions:`${e.supportedAction}-undo`},"success")}catch(n){const i=`ActivityOnBeforeCommandHandled: Couldn't update activity settings for supportedAction: ${e.supportedAction}, appId: ${e.appId}`;a.error(i),d.fail({supportedActions:`${e.supportedAction}-undo`,reason:i})}}else a.warn(`ActivityOnBeforeCommandHandled: noop, previousSettings is empty for supportedAction: ${e.supportedAction}, appId: ${e.appId}`)})),oi=(e,n)=>{var i;const t=null===(i=e.createDatabag)||void 0===i?void 0:i.call(e);if(t){const{supportedAction:e,activityType:i,activitySubtype:a}=n;t.type=i,t.subType=a,t.supportedAction=e}e.recordPanelAction({actionGesture:ei.uS.click,actionOutcome:ei.$K.undo,actionScenario:ei.Tk.activityInAppToastUndo,actionScenarioType:ei.Yu.inAppToast,panelType:ei.wh.inAppToast,dataBag:t}),null==t||t.dispose()},di=()=>Le.windowFeatures||{};function li(){const e=()=>null;return{eventHandlers:rn,getAppPhases:Pe,getAppViewEntities:Be,getAppViewEntitiesProps:ze,getAppWindowFeatures:di,getCommandScenarioName:Ye,getCommandScenarioNameFromSource:Ke,getPlatformAppIdForEntity:e=>e.type===De.py.activity?"14d6962d-6eeb-4f48-8890-de55454bb136":void 0,manifest:Le,onBeforeAddToNavigation:Xe,onBeforeCommandHandled:ii,onCommandReceived:Tn,onCommandResult:Dn,render:({appRenderMode:n,coreSettings:i,onRenderEvent:a,scenarioFactory:o,entity:d})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){switch(n){case Fe.S.Main:return Ln(Mn.ActivityMainPane,a,o,i);case Fe.S.Rail:return Ln(Mn.ActivityApp,a,o,i);case Fe.S.Modal:return d.type===De.py.notificationsettingsdefault?(0,Ie.t)(Xn,{}):Ln(Mn.ActivityFeedDialogs,a,o,i);default:return(0,Ie.t)(e,{})}}))}}var ri=i(386351);const si=e=>{if(mi(e))return ci(e)?{subNavEntity:ui(e),headerEntity:pi(e),startEntity:yi(e),mainEntity:vi(e),endEntity:ki(e)}:null},mi=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.annotation].includes(t),d=[De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},ci=()=>!0,ui=()=>null,pi=()=>null,yi=()=>null,vi=({entity:e})=>e,ki=()=>null,gi=()=>({mainEntity:{[Fe.S.Main]:{forceDisableTitleBar:!0,isBackgroundTransparent:!0,isThemePinnedToDarkOrHighContrast:!0,isSlotBackgroundTransparent:!0,UNSAFE_enablePptProvider:!0,disableNotificationsBanners:!0}}}),Ni={id:"com.microsoft.teams.annotation",name:"AnnotationApp",supportedEntities:[De.py.annotation],supportedRenderModes:[Fe.S.Main],windowFeatures:{additionalFeatures:{alwaysOnTop:"true",excludeWindowFromScreenSharing:"true",contentprotection:"true",transparent:"true",hideWindowControl:"true",resizable:"false",movable:"false"},top:0,left:0,height:360,width:640,minHeight:360,minWidth:640}},hi=()=>i.e(188357).then(i.bind(i,75936)),fi=({windowOptions:e})=>e&&Ni.windowFeatures?{additionalFeatures:Ni.windowFeatures.additionalFeatures,top:e.top,left:e.left>0?e.left:e.left/2,width:Ni.windowFeatures.width,height:Ni.windowFeatures.height,minWidth:Ni.windowFeatures.minWidth,minHeight:Ni.windowFeatures.minHeight,fullscreen:!0}:Object.assign(Object.assign({},Ni.windowFeatures),{fullscreen:!0});function _i(){const e=()=>null;return{getAppViewEntities:si,getAppViewEntitiesProps:gi,getAppWindowFeatures:fi,manifest:Ni,render:({appRenderMode:n,scenarioFactory:i})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main){const{Annotation:e}=yield(0,Pn.mT)(hi,"annotation-app",i);return(0,Ie.t)(ri.f,Object.assign({namespace:"calling",loaderRenderer:null},{children:(0,Ie.t)(e,{})}))}return(0,Ie.t)(e,{})}))}}var Si=i(308794);const Ti={id:"com.microsoft.teams.breakout-rooms",name:"BreakoutRoomsApp",supportedEntities:[De.py.breakoutrooms,De.py.breakoutroomsassignment,De.py.breakoutroomsassignmenttype,De.py.breakoutroomscreaterooms,De.py.breakoutroomsdeleteroom,De.py.breakoutroomsdeleterooms,De.py.breakoutroomseditroom,De.py.breakoutroomssettings],supportedRenderModes:[Fe.S.Main,Fe.S.HorizontalBar,Fe.S.Rail],getDefaultCommand:()=>({type:De.py.breakoutrooms,action:De.uk.view}),windowFeatures:{minWidth:602,width:602,minHeight:500,height:500,offset:20}},bi=e=>{if(Ci(e))return wi(e)?{subNavEntity:Ii(e),headerEntity:Ai(e),startEntity:Fi(e),mainEntity:Di(e),endEntity:Ei(e)}:null},Ci=({entity:e,layoutMode:n})=>{const{action:i=null,type:t}=Object.assign({},e),a=[v.lO.standard,v.lO.focus].includes(n),o=[De.uk.view,null].includes(i),d=[De.py.breakoutrooms].includes(t);return!!(i&&a&&d&&o)},wi=()=>!0,Ii=({entity:e,layoutMode:n})=>[v.lO.standard].includes(n)?e:null,Ai=({entity:e,layoutMode:n})=>[v.lO.standard].includes(n)?e:null,Fi=()=>null,Di=({layoutMode:e,entity:n})=>[v.lO.standard,v.lO.focus].includes(e)?n:null,Ei=()=>null,Mi=({areEmptySlotsTransparent:e})=>({mainEntity:{[Fe.S.Main]:{isBackgroundTransparent:!0}},subNavEntity:{[Fe.S.Rail]:{isBackgroundTransparent:e}},headerEntity:{[Fe.S.HorizontalBar]:{isBackgroundTransparent:e}}}),Pi=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(256045),i.e(241602),i.e(133950),i.e(268372),i.e(775758),i.e(236315),i.e(529375),i.e(69286),i.e(845512),i.e(347761),i.e(9081),i.e(215133),i.e(196348),i.e(511611),i.e(931123),i.e(297312),i.e(442766),i.e(799490),i.e(136615),i.e(384037)]).then(i.bind(i,258613)),Ri="breakout-rooms-northstar-app",Oi=()=>Ti.windowFeatures||{};function $i(){const e=()=>null;return{manifest:Ti,render:({appRenderMode:n,onRenderEvent:i,scenarioFactory:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main){i("ChunkLoadStarted",{chunkName:Ri});const{BreakoutRoomsAppEntry:e}=yield(0,Pn.mT)(Pi,Ri,a);return i("ChunkLoadSucceeded",{chunkName:Ri}),(0,Ie.t)(ri.f,Object.assign({namespaces:["breakoutRooms"],loaderRenderer:null},{children:(0,Ie.t)(e,{})}))}return(0,Ie.t)(e,{})})),getAppViewEntities:bi,getAppViewEntitiesProps:Mi,getAppWindowFeatures:Oi,onRegister:e=>{e.registerTask(new Si.K)}}}var Li=i(928315),xi=i(755083),Bi=i(765923);const ji=e=>({entityCommand:{entity:{type:"unsupporteddeeplinkdialog",action:"view"},command:{layoutMode:"standard",stateTransition:"extend",visibilityState:"show"},entityOptions:{originalDeeplink:e}},metadata:{allowAnonymous:!1,userContextId:void 0}});var Ui,Vi=i(428957),Wi=i(74583);!function(e){e.EmptyDeeplinkUrl="empty-deeplink-url-received",e.EmptyContext="empty-context-received",e.InvalidIsBroadcastMeetingType="invalid-isBroadcastMeeting-type",e.InvalidRoleType="invalid-role-type"}(Ui||(Ui={}));const Hi=[{filter:e=>{if(!e.pathname.includes("/l/meetup-join"))return!1;const n=new URLSearchParams(e.search).get("context");if(!n)return!1;try{const{IsBroadcastMeeting:e}=JSON.parse(n);return e}catch(e){return!1}},execute:({deeplinkUrl:{pathname:e,search:n},context:{coreSettings:i,__doNotUse_globalDataClient:a,loggerFactory:o}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t;const{allowBroadcastAttendeeMeetingJoinsInT2:d,allowBroadcastAttendeeMeetingJoinsInT2Web:r,conveneTemplateUrl:m,allowBroadcastPresenterJoinsInT2:c}=i.get(s.J.Broadcast);if(!e)return Promise.reject({message:Ui.EmptyDeeplinkUrl});const u=null==o?void 0:o.newLogger("BroadcastOnBeforeDeeplinkParsed","apps-broadcast"),p=decodeURIComponent(e).split(/[/?&]/),y=p.indexOf("meetup-join")+1,k=p[y],g=p[y+1],N=new URLSearchParams(n);let h=!1;try{h=JSON.parse(N.get("anon")||"false")}catch(e){}N.set("anon","true");const f=N.get("deeplinkId"),_=N.get("context");if(!_)return Promise.reject({message:Ui.EmptyContext});const{Tid:S,Oid:T,IsBroadcastMeeting:b,role:C}=JSON.parse(_);if(!(0,Wi.isBoolean)(b))return Promise.reject({message:Ui.InvalidIsBroadcastMeetingType});if(!("a"===C||void 0===C))return Promise.reject({message:Ui.InvalidRoleType});const w="a"===C,I=`${e}?${N.toString()}`;let A;const F=((e,n)=>{if("null"!==e)return e;const i=n.get("fqdn");return i?`https://${i}`:void 0})(origin,N);F&&(A=`${F}/_#${e}?${N.toString()}`);const D={joinType:"Legacy",conversationId:k,messageId:g,rootMessageId:g,isChannel:"0"!==g,isAdhoc:!1,tenantId:S,organizerId:T,meetingCloud:N.get("fqdn")||(0,Vi.uO)(origin)};return((e,n,i,t,a,o,d,r,s,m,c,u,p,y)=>{var k;const{tenantId:g,organizerId:N,conversationId:h,rootMessageId:f}=o,_=`${g}__${N}__${h}__${f}`;if(i&&!d)return(null==a?void 0:a.config.clientType)===l.Bh.Web?(null===(k=m.infoToTelemetry)||void 0===k||k.call(m,`[handleBroadcastMeetingRedirect] launch launchUnsupportedDeeplink from deeplink: ${t}`,"cmd_meetings_virtual_events_broadcast_trigger_unsupported_deeplink_dialog_success"),Promise.resolve(ji(t))):Promise.resolve({entityCommand:{entity:{type:"callingdeeplink",action:"join",id:`${h}/${f}`},command:{visibilityState:v.fe.show,stateTransition:v.su.new,layoutMode:v.lO.focus},entityOptions:{deeplinkUrl:t,coordinates:o,directMeetingLink:p,deepLinkId:u,roleHint:r,isBroadcastMeeting:s}},metadata:{allowAnonymous:!!y,tenantId:g}});if(d){if(n)return Promise.resolve({entityCommand:{entity:{id:_,type:"broadcasts",action:"view"},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,layoutMode:v.lO.standard},entityOptions:{threadId:h,messageId:f,tenantId:g,organizerId:N}},metadata:{allowAnonymous:!0,tenantId:g}});if(e){const e=`${g}__${N}__${h}__${f}`;if(a&&a.config.clientType===l.Bh.Maglev)return Promise.resolve({entityCommand:{entity:{id:e,type:"broadcasts",action:"view"},command:{visibilityState:v.fe.show,stateTransition:v.su.new,layoutMode:v.lO.focus},entityOptions:{threadId:h,messageId:f,tenantId:g,organizerId:N}},metadata:{allowAnonymous:!0,tenantId:g}});if(c&&a&&a.config.clientType===l.Bh.Web){const n=(0,Bi.J)(),i=(0,xi.Dk)(e,c,!0);return n.open(i,"_blank"),Promise.resolve(void 0)}}}return Promise.resolve(ji(t))})(d||!1,r||!1,c||!1,I,null===(t=null==a?void 0:a.ctx)||void 0===t?void 0:t.platformService,D,w,C,b,u,m||void 0,f,A,!!h)}))}],Gi=e=>{if(Ji(e))return qi(e)?{subNavEntity:zi(e),headerEntity:Qi(e),startEntity:Yi(e),mainEntity:Ki(e),endEntity:Xi(e)}:null},Ji=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.broadcasts,De.py.eventsbroadcastqna].includes(t),d=[De.uk.create,De.uk.default,De.uk.list,De.uk.view,De.uk.info],l=i&&d.includes(i);return!!(a&&o&&l)},qi=()=>!0,zi=()=>null,Qi=({entity:e})=>e,Yi=()=>null,Ki=({entity:e})=>e,Xi=({contextEntity:e})=>{const{action:n,type:i}=e||{};return e&&(i===De.py.broadcasts&&n===De.uk.info||i===De.py.eventsbroadcastqna)?e:null},Zi={id:"com.microsoft.teams.broadcast",name:"Broadcast",supportedEntities:[De.py.broadcasts,De.py.broadcastfeedback,De.py.eventsbroadcastqna],supportedRenderModes:[Fe.S.HorizontalBar,Fe.S.Main,Fe.S.Rail],windowFeatures:{minWidth:800,width:800,minHeight:670,height:600}};var et=i(234207),nt=i(78860);const it=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(65477),i.e(241602),i.e(133950),i.e(268372),i.e(775758),i.e(236315),i.e(529375),i.e(599271),i.e(347761),i.e(9081),i.e(409201),i.e(745659),i.e(511611),i.e(15931),i.e(68688),i.e(912597),i.e(314621),i.e(272519),i.e(547199),i.e(842529),i.e(722198),i.e(394413),i.e(477708),i.e(931123),i.e(297312),i.e(165665),i.e(442766),i.e(328135),i.e(458414),i.e(799490),i.e(632783),i.e(389231),i.e(318355),i.e(468557)]).then(i.bind(i,836822)),tt=({coreServices:e,host:n,isResize:i})=>{const{minHeight:t,minWidth:a}=Zi.windowFeatures||{},o=null==n?void 0:n.screen;if(i&&!o)return Zi.windowFeatures||null;if(!o)return null;let{height:d=1,width:l=1}=((e,n)=>{const{minHeight:i=0,minWidth:t=0}=Zi.windowFeatures||{};let{width:a,height:o}=Zi.windowFeatures||{};if(!n)return{height:o,width:a,minHeight:i,minWidth:t};const{orientation:{type:d}}=e,{landscapeScreenRatio:l,portraitScreenRatio:r,widthHeightRatio:m}=n.coreSettings.get(s.J.Broadcast);if(l&&r&&m)switch(d){case"landscape-primary":case"landscape-secondary":const n=l*e.availHeight;o=n>i?n:i,a=m*o;break;case"portrait-primary":case"portrait-secondary":const d=r*e.availWidth;a=d>t?d:t,o=1/m*a}return{height:o,width:a}})(o,e);const r=o.availHeight-20,m=l>=o.availWidth||d>=r;m&&(d=o.availHeight,l=o.availWidth);const{left:c,top:u}=((e,n,i,t,a)=>{if(t)return{left:0,top:0};const o="availLeft"in e?e.availLeft:0,d="availTop"in e?e.availTop:0,l=o+e.availWidth/2-n/2;let r;switch(e.orientation.type){case"landscape-primary":case"landscape-secondary":r=d+a;break;default:r=d+e.availHeight/2-i/2}return{left:l,top:r}})(o,l,d,m,20);return{additionalFeatures:{minHeight:`${t}`,minWidth:`${a}`},height:d,width:l,fullScreen:m,left:c,top:u,minHeight:t,minWidth:a}};function at(){const e=()=>null;return{getAppViewEntities:Gi,getAppWindowFeatures:tt,onBeforeDeeplinkParsed:Hi,manifest:Zi,render:({appRenderMode:n,scenarioFactory:i})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=(0,et.v4)();switch(n){case Fe.S.HorizontalBar:case Fe.S.Main:case Fe.S.Rail:const a="broadcast-app",{BroadcastViewsRenderer:o}=yield(0,Pn.mT)(it,a,i);return(0,Ie.t)(nt.vb,Object.assign({joinId:t},{children:(0,Ie.t)(ri.f,Object.assign({namespace:"broadcast",loaderRenderer:null},{children:(0,Ie.t)(Li.yx,{children:(0,Ie.t)(o,{appRenderMode:n})})}))}));default:return(0,Ie.t)(e,{})}}))}}const ot=e=>{if(dt(e))return lt(e)?{subNavEntity:rt(e),headerEntity:st(e),startEntity:mt(e),mainEntity:ct(e),endEntity:ut(e)}:null},dt=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.standard,v.lO.focus].includes(e),o=[De.uk.create,De.uk.default,De.uk.view,De.uk.list],d=i&&o.includes(i),l=[De.py.calendar,De.py.schedulingform].includes(t),r=De.py.schedulingform!==t&&De.uk.view===i&&v.lO.focus===e;return!(!(a&&l&&d)||r)},lt=()=>!0,rt=()=>null,st=({entity:e,coreSettings:n})=>{const i=null==n?void 0:n.get(s.J.Calendar).enableCalendarSchedulingFormMultiSlot,t=null==n?void 0:n.get(s.J.Calendar).enableFluentCalendarSurface,a=!!i&&e.type===De.py.schedulingform,o=!!t&&e.type===De.py.calendar;return a||o?e:null},mt=()=>null,ct=({contextEntity:e,entity:n})=>{const i=[De.py.extensions,De.py.attendancereport,De.py.meetinganalytics,De.py.meetingrecap,De.py.transcriptcontent];return(null==e?void 0:e.type)&&i.includes(e.type)?e:n},ut=({contextEntity:e})=>e&&e.action&&e.type===De.py.meetingcollaboration?e:null,pt=({coreSettings:e})=>{const n=null==e?void 0:e.get(s.J.Calendar).enableCalendarAppTransparentBackground;return{mainEntity:{[Fe.S.Main]:{isBackgroundTransparent:!!n}}}},yt="calendar",vt="viewCalendarApp",kt=()=>({actor:yt,action:vt}),gt={id:"com.microsoft.teams.calendar",name:"CalendarApp",getLocalizedName:e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("calendar"),e.stringTranslate("calendar","calendar_app_name")})),actors:[yt],supportedEntities:[De.py.calendar,De.py.schedulingform,De.py.connectedcalendardialog,De.py.connectedcalendarsurfacedialog,De.py.channelcalendar],supportedRenderModes:[Fe.S.Main,Fe.S.HorizontalBar,Fe.S.Modal],getDefaultCommand:()=>({type:De.py.calendar,action:De.uk.default}),windowFeatures:{minWidth:565,width:1241,minHeight:720,height:720}};const Nt=({action:e,appRenderMode:n,type:i,coreSettings:t})=>{const a=new Ee.H,{calendarAppPhaseTimeouts:o}=t.get(s.J.Calendar,["calendarAppPhaseTimeouts"]),d=[],l=[];return i===De.py.calendar?function(e,n){switch(e){case Fe.S.Main:n.push(Me.G.CALENDAR_VIEW_RENDERED);break;case Fe.S.HorizontalBar:n.push(Me.G.CALENDAR_HEADER_RENDERED)}}(n,d):i===De.py.schedulingform&&function(e,n,i,t){switch(n){case Fe.S.Main:i.push(Me.G.CALENDAR_SF_VIEW_RENDERED),e===De.uk.view&&t.push(Me.G.CALENDAR_SF_TRACKING_VIEW_RENDERED);break;case Fe.S.HorizontalBar:i.push(Me.G.CALENDAR_SF_HEADER_RENDERED)}}(e,n,d,l),d.length>0&&a.registerAppPhase({phase:g.nh.CRITICAL,signals:d,timeout:(null==o?void 0:o.critical)||1e4}),l.length>0&&a.registerAppPhase({phase:g.nh.POST_CRITICAL,signals:l,timeout:(null==o?void 0:o.postCritical)||1e4}),a.appPhases},ht={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCalendarTryStartMeetingBotPublisherMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tryStartMeetingBotPublisher"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]}}]};function ft(e){const{client:n,coreSettings:i,loggerFactory:t}=e,a=n,o=t.newLogger("[MeetingBot-StartJob]","apps-calendar");return{id:"start-meeting-bot",runOncePerId:!0,job:()=>{i.get(s.J.MeetingBot).enableMeetingBot?a.mutate({mutation:ht,fetchPolicy:"no-cache"}):o.log("meetingbot is disabled")}}}const _t={onEventReceived:({eventInput:e})=>{var n,i;if(e.event.type===Ze.uS.requestPersonMoreInfo){const t=null===(i=(n=e.event).data)||void 0===i?void 0:i.call(n);return Promise.resolve({command:on(t)})}return Promise.resolve(void 0)}},St=({commandInput:e,requestContext:{loggerFactory:n}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:i}}=e,t=n.newLogger("CalendarApp onCommandReceived","apps-calendar");if(e.command.actor===yt)return i===vt?{entity:{type:De.py.calendar,action:De.uk.default},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,correlation:{source:sn.D.Unknown}}}:void t.error(`Command action '${i}' is not supported at CalendarApp.`);t.error(`Command for actor '${e.command.actor}' cannot be handled by CalendarApp.`)}));var Tt=i(974509);const bt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCalendarSyncConnectedCalendarSettingsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"syncConnectedCalendarSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"source"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConnectedCalendarSource"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"accountAddress"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"accountId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isSyncAllowed"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConnectedCalendarSetting"}}}}}}]}}]},Ct={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCalendarGetExternalAccountsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"connectedAccountRequestResource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConnectedAccountRequestSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getExternalAccounts"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"connectedAccountRequestResource"},value:{kind:"Variable",name:{kind:"Name",value:"connectedAccountRequestResource"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConnectedAccountRequestSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"oAuthProviderDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"oAuthProviderType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"UserExternalAccountOAuthProviderDetails"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"userAccount"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"alternateId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"emailAddress"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserExternalAccount"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"refreshTokenExpirationUnixTimestamp"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"GetExternalAccountResponse"}}}}]}}]},wt={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCalendarRefreshExternalAccountMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"accountId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"refreshExternalAccount"},arguments:[{kind:"Argument",name:{kind:"Name",value:"accountId"},value:{kind:"Variable",name:{kind:"Name",value:"accountId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]},It="lastRefreshAttemptTimestamp",At="pauseRefresh",Ft=e=>e/86400,Dt=()=>Math.round(Date.now()/1e3),Et=(e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{data:i}=yield n.query({query:Ct,fetchPolicy:"network-only",variables:{callerInfo:e,connectedAccountRequestResource:"TflCloudCache"}});return null==i?void 0:i.getExternalAccounts})),Mt=(e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var i;let t;const{data:a}=yield n.query({query:bt,fetchPolicy:"network-only",variables:{callerInfo:e}});return(null===(i=null==a?void 0:a.syncConnectedCalendarSettings)||void 0===i?void 0:i.length)&&(t=a.syncConnectedCalendarSettings.filter((e=>!1===e.isSyncAllowed))),t})),Pt=(e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){yield i.mutate({mutation:wt,variables:{accountId:e,callerInfo:n}})})),Rt=(e,n)=>{if(!e||!n)return!0;const i=Number(e);if(isNaN(i))return!0;const t=Dt();return Ft(i-t)<=n},Ot=e=>`tmp.${e}.refreshExternalAccount`,$t=(e,n,i,t)=>{const a={[It]:n,[At]:!!t};return null==i?void 0:i.trySet(Ot(e),JSON.stringify(a),"Calendar","UserAndExperience")},Lt=(e,n,i,t)=>{const a=((e,n)=>{const i={[It]:null,[At]:!1};if(!n)return i;const t=n.get(Ot(e));if(!t)return i;try{const e=JSON.parse(t);i[It]=e[It]||null,i[At]=e[At]||!1}catch(e){return i}return i})(e,i);if(a[At])return n.mark(c.ck.NoSrtRefreshNeededDueToPause),!1;if(!t)return!0;const o=a[It],d=Number(o);if(isNaN(d))return!0;const l=Dt();return!(Ft(l-d)<=t)||(n.mark(c.ck.NoSrtRefreshNeededBasedOnLastRefreshTimestamp),!1)},xt=(e,n,i,t)=>{let a=!1;for(const o of e){Lt(o.accountId,n,i,t)&&(a=!0)}return a},Bt=(e,n,i,t)=>{var a;const o=`Failed createConnectedAccountRefreshSrtJob with error code: ${t}`;null===(a=e.errorToTelemetry)||void 0===a||a.call(e,o,"connected_account_refresh_srt_job"),i&&n.fail({errors:o})},jt=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n,i;if(!e)return null;const t=e.graphQLErrors,a=t&&(null===(i=null===(n=t[0])||void 0===n?void 0:n.originalError)||void 0===i?void 0:i.serverResponse);if(!a)return null;try{const e=yield a.body.clone().json();return{errorCode:e.errorCode,message:e.message}}catch(e){return{message:"Failed to extract server response in extractServerError"}}})),Ut=e=>{var n,i,t;if(!e)return!1;const a=e.graphQLErrors,o=null===(n=null==a?void 0:a[0])||void 0===n?void 0:n.originalError,d=null===(t=null===(i=null==o?void 0:o.reason)||void 0===i?void 0:i.innerError)||void 0===t?void 0:t.context,l=null==o?void 0:o.serverResponse;return d===gn.w5.Authentication||(null==l?void 0:l.status)===Tt.qb.NOT_AUTHORIZED},Vt="createConnectedAccountRefreshSrtJob";var Wt=i(878652),Ht=i(883345);const Gt="/scheduling-form/";var Jt,qt,zt,Qt,Yt,Kt,Xt;!function(e){e[e.Channel=0]="Channel",e[e.PrivateChat=1]="PrivateChat"}(Jt||(Jt={})),function(e){e[e.UserEventUsingEventId=0]="UserEventUsingEventId",e[e.TeamEventUsingEventId=1]="TeamEventUsingEventId",e[e.UserEventUsingICalUId=2]="UserEventUsingICalUId",e[e.TeamEventUsingICalUId=3]="TeamEventUsingICalUId",e[e.UserSeriesEventUsingOccurenceEventId=4]="UserSeriesEventUsingOccurenceEventId"}(qt||(qt={})),function(e){e.newMeeting="/l/meeting/new",e.viewMeeting="/l/meeting/details",e.meetingDetails="/l/calendar/scheduling-form",e.surface="/l/calendar/surface"}(zt||(zt={})),function(e){e.NoEventId="calendar_on_before_deep_link_parsed_no_event_id_error",e.FeatureNotEnabled="calendar_on_before_deep_link_parsed_feature_not_enabled_error",e.InvalidContext="calendar_on_before_deep_link_parsed_invalid_context_error"}(Qt||(Qt={})),function(e){e.NoEventId="Parsed calendar deep link does not contain the event id",e.FeatureNotEnabled="Feature for parsing T1 calendar deep links in T2.1 is not enabled",e.InvalidContext="Parsed calendar deep link does not contain valid context query param"}(Yt||(Yt={})),function(e){e.StartTime="startTime",e.EndTime="endTime",e.Subject="subject",e.Content="content",e.Attendees="attendees",e.TemplateId="templateId",e.CorrelationId="correlationId",e.Source="source",e.SourceVersion="sourceVersion",e.UserObjectId="oid"}(Kt||(Kt={})),function(e){e.EventId="eventId",e.Context="context"}(Xt||(Xt={}));const Zt=({deeplinkUrl:e,parsedDeeplinkHash:n,preferredCommandInput:i,context:{coreSettings:t,loggerFactory:a}})=>{var o,d,l,r;const m=a.newLogger("CalendarApp onBeforeDeeplinkParsed","apps-calendar"),{enableParseT1CalendarDeeplinks:c}=t.get(s.J.Calendar);if(!c)throw null===(o=m.errorToTelemetry)||void 0===o||o.call(m,Yt.FeatureNotEnabled,Qt.FeatureNotEnabled),Error(Yt.FeatureNotEnabled);let u,p,y,k,g;if(null==n?void 0:n.search){const{search:e}=n;u=e.eventId,p=e.conversationId,y=parseInt(e.providerType,10)||qt.UserEventUsingEventId,k=parseInt(e.opener,10)||Jt.PrivateChat,g=ea(e.context,m)}else{const{search:n}=e,i=new URLSearchParams(n);u=i.get(Xt.EventId)||void 0,y=qt.UserEventUsingEventId,k=Jt.PrivateChat;const t=i.get(Xt.Context);g=ea(t,m)}const N=[sn.D.ActivityFeed,sn.D.ActivityFeedBellClick],h=!!(null==i?void 0:i.correlation.source)&&N.includes(i.correlation.source)?Ht.kH.NOTIFICATION_POPOVER:Ht.kH.DEEP_LINK;if(u)return Promise.resolve({entityCommand:{entity:{type:De.py.schedulingform,action:De.uk.view,id:u},command:{stateTransition:null!==(d=null==i?void 0:i.stateTransition)&&void 0!==d?d:v.su.flush,visibilityState:null!==(l=null==i?void 0:i.visibilityState)&&void 0!==l?l:v.fe.show},entityOptions:Object.assign({navCtx:h,eventId:u,opener:k,conversationId:p,providerType:y},g)},metadata:{allowAnonymous:!1}});throw null===(r=m.errorToTelemetry)||void 0===r||r.call(m,Yt.NoEventId,Qt.NoEventId),Error(Yt.NoEventId)},ea=(e,n)=>e&&(0,Wt.D)(e,{},(()=>{var e;throw null===(e=n.errorToTelemetry)||void 0===e||e.call(n,Yt.InvalidContext,Qt.InvalidContext),Error(Yt.InvalidContext)})),na=({deeplinkUrl:e,parsedDeeplinkHash:n,context:{coreSettings:i,loggerFactory:a,getUserContexts:o}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t;const d=a.newLogger("CalendarApp onBeforeDeeplinkParsed","apps-calendar"),{enableVirtualAppointmentDeepLink:l}=i.get(s.J.VirtualAppointments),{enableParseT1CalendarDeeplinks:r,enableCalendarSchedulingFormInNewWindow:m}=i.get(s.J.Calendar);if(!r)throw null===(t=d.errorToTelemetry)||void 0===t||t.call(d,Yt.FeatureNotEnabled,Qt.FeatureNotEnabled),Error(Yt.FeatureNotEnabled);let c,u,p,y,v,k,g,N,h,f;if(null==n?void 0:n.search){const{search:e}=n;c=e.startTime&&new Date(e.startTime)||void 0,u=e.endTime&&new Date(e.endTime)||void 0,p=e.subject,y=e.content,v=e.attendees,k=e.templateId,g=e.source,N=e.sourceVersion,h=e.correlationId,f=e.oid}else{const{search:n}=e,i=new URLSearchParams(n),t=i.get(Kt.StartTime),a=i.get(Kt.EndTime);c=t&&new Date(t)||void 0,u=a&&new Date(a)||void 0,p=i.get(Kt.Subject)||void 0,y=i.get(Kt.Content)||void 0,v=i.get(Kt.Attendees)||void 0,k=i.get(Kt.TemplateId)||void 0,g=i.get(Kt.Source)||void 0,N=i.get(Kt.SourceVersion)||void 0,h=i.get(Kt.CorrelationId)||void 0,f=i.get(Kt.UserObjectId)||void 0}let _,S=void 0!==k?{templateId:k}:void 0;!1==!!l&&(g=void 0,N=void 0,h=void 0,f=void 0,S=void 0),S&&(_=ra(yield o(),f));const T=sa(!!S,!!m);return Promise.resolve({entityCommand:{entity:{type:De.py.schedulingform,action:De.uk.create,id:(0,et.v4)()},command:T,entityOptions:{navCtx:Ht.kH.DEEP_LINK,startTime:c,endTime:u,subject:p,content:y,attendees:v,opener:1,templateMeetingParameters:S,externalSource:g,externalSourceVersion:N,externalSourceCorrelationId:h}},metadata:{allowAnonymous:!1,accountsToUse:_}})})),ia={filter:zt.surface,execute:({deeplinkUrl:e})=>{var n;const i="m365-calendar"===(null===(n=e.searchParams)||void 0===n?void 0:n.get("source"))?sn.D.CalendarM365:sn.D.Calendar;return Promise.resolve({entityCommand:{entity:{type:De.py.calendar,action:De.uk.view,id:(0,et.v4)()},command:{stateTransition:v.su.flush,visibilityState:v.fe.show},entityOptions:{navCtx:Ht.kH.DEEP_LINK,source:i}},metadata:{allowAnonymous:!1}})}},ta={filter:(e,n)=>{var i;return!!e.hash&&(null==n?void 0:n.pathname)===Gt&&!(null===(i=null==n?void 0:n.search)||void 0===i?void 0:i.eventId)},execute:na},aa={filter:zt.newMeeting,execute:na},oa={filter:(e,n)=>{var i;return!!e.hash&&(null==n?void 0:n.pathname)===Gt&&!!(null===(i=null==n?void 0:n.search)||void 0===i?void 0:i.eventId)},execute:Zt},da={filter:zt.viewMeeting,execute:Zt},la={filter:zt.meetingDetails,execute:({deeplinkUrl:e,preferredCommandInput:n,context:{coreSettings:i,loggerFactory:t}})=>{var a,o,d,l;const r=t.newLogger("CalendarApp onBeforeDeeplinkParsed","apps-calendar"),{enableParseT1CalendarDeeplinks:m}=i.get(s.J.Calendar);if(!m)throw null===(a=r.errorToTelemetry)||void 0===a||a.call(r,Yt.FeatureNotEnabled,Qt.FeatureNotEnabled),Error(Yt.FeatureNotEnabled);const{pathname:c,searchParams:u}=e,p=c.split("/")[4],y=(0,Wt.D)(u.get("context"),{},(()=>{var e;throw null===(e=r.errorToTelemetry)||void 0===e||e.call(r,Yt.InvalidContext,Qt.InvalidContext),Error(Yt.InvalidContext)}));if(!p)throw null===(o=r.errorToTelemetry)||void 0===o||o.call(r,Yt.NoEventId,Qt.NoEventId),Error(Yt.NoEventId);return Promise.resolve({entityCommand:{entity:{type:De.py.schedulingform,action:De.uk.view,id:p},command:{stateTransition:null!==(d=null==n?void 0:n.stateTransition)&&void 0!==d?d:v.su.flush,visibilityState:null!==(l=null==n?void 0:n.visibilityState)&&void 0!==l?l:v.fe.show},entityOptions:Object.assign({navCtx:Ht.kH.DEEP_LINK,opener:Jt.PrivateChat,eventId:p},y)},metadata:{allowAnonymous:!1}})}},ra=(e,n)=>{var i;const t=null===(i=e.filter((e=>{var i,t,a,o,d;return(null===(d=null===(o=null===(a=null===(t=null===(i=e.context)||void 0===i?void 0:i.client)||void 0===t?void 0:t.ctx)||void 0===a?void 0:a.authenticationUser)||void 0===o?void 0:o.profile)||void 0===d?void 0:d.objectId)===n}))[0])||void 0===i?void 0:i.userContextId;return t?[t]:void 0},sa=(e,n)=>e&&n?{stateTransition:v.su.new,visibilityState:v.fe.show,layoutMode:v.lO.focus}:{stateTransition:v.su.flush,visibilityState:v.fe.show},ma=[aa,da,ta,oa,la,ia],ca={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCalendarSaveCalendarSettingsIndexdbMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"calendarSettings"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CalendarSettingsInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"saveCalendarSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"calendarSettings"},value:{kind:"Variable",name:{kind:"Name",value:"calendarSettings"}},__type:{kind:"NamedType",name:{kind:"Name",value:"CalendarSettingsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CalendarSettings"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"enableM365Calendar"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CalendarSettingsUpdateResult"}}}}]}}]},ua=e=>{const{entityCommand:n,entityCommand:{entity:{type:i,action:t},entityOptions:a},requestContext:{userBiService:o,loggerFactory:d,client:l}}=e,r=d.newLogger("CallingOnBeforeCommandHandled","apps-calendar");return i===De.py.calendar&&t===De.uk.view&&(null==a?void 0:a.source)===sn.D.CalendarM365&&o.recordPanelAction({actionScenario:ei.Tk.toggleCalendarSwitcher,actionGesture:ei.uS.toggle,actionOutcome:ei.$K.Off},r),"viewM365CalendarSurface"===(null==a?void 0:a.searchQuery)?(l.mutate({mutation:ca,variables:{calendarSettings:{id:"calendarSettings",enableM365Calendar:!0}}}),o.recordPanelAction({actionScenario:ei.Tk.toggleCalendarSwitcher,actionGesture:ei.uS.toggle,actionOutcome:ei.$K.On},r),Promise.resolve({entity:{type:De.py.extensions,action:De.uk.view,id:JSON.stringify({appId:"5966c135-e05f-4ce0-81e0-e138fe8e9583"})},command:{stateTransition:v.su.flush,visibilityState:v.fe.show,correlation:{source:sn.D.Unknown}}})):Promise.resolve(n)},pa=()=>Promise.all([i.e(590393),i.e(256045),i.e(296056),i.e(680254),i.e(390537),i.e(409201),i.e(269296),i.e(633534),i.e(953275),i.e(788842),i.e(542511),i.e(989092),i.e(966573),i.e(778681),i.e(668778)]).then(i.bind(i,85772)),ya=()=>gt.windowFeatures||{};function va(){return{eventHandlers:_t,getAppViewEntities:ot,getAppViewEntitiesProps:pt,getAppWindowFeatures:ya,getCommandScenarioName:ka,getPlatformAppIdForEntity:e=>e.type===De.py.calendar||e.type===De.py.schedulingform?"ef56c0de-36fc-4ef8-b417-3d82ba9d073c":void 0,manifest:gt,render:({appRenderMode:e,onRenderEvent:n,scenarioFactory:i})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t="calendar-app";n("ChunkLoadStarted",{chunkName:t});const{CalendarViewsRenderer:a}=yield(0,Pn.mT)(pa,t,i);return n("ChunkLoadSucceeded",{chunkName:t}),(0,Ie.t)(ri.f,Object.assign({namespaces:["calendar","compose","extensibility","files"],loaderRenderer:null},{children:(0,Ie.t)(a,{appRenderMode:e,onRenderEvent:n,scenarioFactory:i})}))})),onBeforeDeeplinkParsed:ma,onBeforeCommandHandled:ua,onCommandReceived:St,onPreWarm:e=>{const{context:n}=e,i=n.coreSettings,{enableConnectedAccountSrtRefresh:a}=i.get(s.J.Calendar),o=[ft(n)];return a&&o.push(function(e){const{client:n,coreSettings:i,localStorage:a,loggerFactory:o,scenarioFactory:d}=e,l=o.newLogger("connected-account-refresh-srt-job","apps-calendar"),r=n,{numberOfDaysToWaitBeforeSrtExpires:m,numberOfDaysToWaitSinceLastSrtRefresh:u}=i.get(s.J.Calendar);return{id:"connected-account-refresh-srt-job",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var e,i;const t=d.newScenario(c.RG.ConnectedAccountRefreshSrtJob);let o=!1;const s=[];try{const d=yield Mt(Vt,n);if(t.mark(c.ck.GetConnectedCalendarSettingsComplete),!d||0===d.length)return t.mark(c.ck.NoUnsyncedConnectedCalendarSettingFound),void t.stop();if(!xt(d,t,a,u))return void t.stop();const p=yield Et(Vt,n);t.mark(c.ck.GetExternalAccountsComplete),p&&0!==p.length||t.mark(c.ck.NoExternalAccountsFound);for(let n=0;p&&n<p.length;n++){const u=p[n];if(!u)continue;const y=null===(e=u.userAccount)||void 0===e?void 0:e.id,v=d.find((e=>e.accountId===y));try{if(!v){t.mark(c.ck.NoMatchingExternalAccountToRefresh);continue}t.mark(c.ck.ExternalAccountFound);const e=u.refreshTokenExpirationUnixTimestamp;Rt(e,m)?(yield Pt(y,Vt,r),t.mark(c.ck.RefreshExternalAccountComplete)):t.mark(c.ck.NoSrtRefreshNeededBasedOnSrtExpirationTimestamp),$t(y,Dt(),a)}catch(e){let n;n=Ut(e)?gn.jK.Unauthorized:null===(i=yield jt(e))||void 0===i?void 0:i.errorCode,$t(y,Dt(),a,n===gn.jK.Unauthorized),Bt(l,t,!1,n),o=!0,s.push(n)}}t.stop()}catch(e){const{errorCode:n}=(yield jt(e))||{};Bt(l,t,!0,n)}o&&Bt(l,t,!0,s.join(", "))}))}}(n)),o},getAppPhases:Nt}}const ka=e=>{const{command:n,entity:i}=e;switch(i.type){case De.py.schedulingform:if(n.visibilityState===v.fe.hide)return;return i.action===De.uk.create?c.RG.CalSchedulingFormLoadForCreateMode:c.RG.CalSchedulingFormLoad;case De.py.calendar:return c.RG.CalendarSurfaceLoad;case De.py.channelcalendar:return c.RG.ChannelCalendarLoad;case De.py.connectedcalendardialog:return c.RG.ConnectedCalendarDialogLoad;default:return}},ga={onEventReceived:({eventInput:e})=>{var n,i;if(e.event.type===Ze.uS.requestPersonMoreInfo){const t=null===(i=(n=e.event).data)||void 0===i?void 0:i.call(n);return Promise.resolve({command:on(t)})}return Promise.resolve(void 0)}};var Na=i(427858);const ha=e=>{if(fa(e))return _a(e)?{subNavEntity:Sa(e),headerEntity:Ta(e),startEntity:ba(e),mainEntity:Ca(e),endEntity:wa(e)}:null},fa=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.callablechannels].includes(t),d=[De.uk.create,De.uk.default,De.uk.list,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},_a=()=>!0,Sa=({entity:e})=>e,Ta=({entity:e})=>e,ba=()=>null,Ca=({entity:e})=>e,wa=()=>null,Ia={id:"com.microsoft.teams.callable-channel",name:"CallableChannelApp",supportedEntities:[De.py.callablechannels],supportedRenderModes:[Fe.S.HorizontalBar,Fe.S.Main,Fe.S.Rail],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},Aa=()=>Promise.all([i.e(713782),i.e(767770),i.e(724526)]).then(i.bind(i,22537)),Fa=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(892924),i.e(256045),i.e(241602),i.e(371935),i.e(779478),i.e(888171),i.e(901509),i.e(547652),i.e(435876),i.e(400010),i.e(242959),i.e(202477),i.e(465019),i.e(697672),i.e(160200),i.e(959180),i.e(687465),i.e(340690),i.e(890555),i.e(864770),i.e(745400),i.e(577907),i.e(357068),i.e(871090),i.e(816167),i.e(479335),i.e(846077),i.e(232236),i.e(914152),i.e(169080),i.e(269104),i.e(890473),i.e(25663),i.e(347761),i.e(9081),i.e(137706),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(26466),i.e(430209),i.e(911758),i.e(435216),i.e(667549),i.e(609633),i.e(469488),i.e(548536),i.e(868838),i.e(803124),i.e(242863),i.e(29311),i.e(321833),i.e(186443),i.e(472638),i.e(68688),i.e(912597),i.e(127919),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(495500),i.e(403936),i.e(450605),i.e(329712),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(816906),i.e(831470),i.e(417169),i.e(451185),i.e(666579),i.e(913486),i.e(369093),i.e(364315),i.e(781662),i.e(53443),i.e(478388),i.e(327116),i.e(713782),i.e(553856),i.e(801349),i.e(399286),i.e(764391),i.e(425523),i.e(336995),i.e(537680),i.e(520174),i.e(506412),i.e(25019),i.e(918607),i.e(673615),i.e(568740)]).then(i.bind(i,173029)),Da=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(892924),i.e(256045),i.e(241602),i.e(371935),i.e(779478),i.e(888171),i.e(901509),i.e(547652),i.e(435876),i.e(400010),i.e(242959),i.e(202477),i.e(465019),i.e(697672),i.e(160200),i.e(959180),i.e(687465),i.e(340690),i.e(890555),i.e(864770),i.e(745400),i.e(577907),i.e(357068),i.e(871090),i.e(816167),i.e(479335),i.e(846077),i.e(232236),i.e(914152),i.e(169080),i.e(269104),i.e(890473),i.e(25663),i.e(347761),i.e(9081),i.e(137706),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(26466),i.e(430209),i.e(911758),i.e(435216),i.e(667549),i.e(609633),i.e(469488),i.e(548536),i.e(868838),i.e(803124),i.e(242863),i.e(29311),i.e(321833),i.e(186443),i.e(472638),i.e(68688),i.e(912597),i.e(127919),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(495500),i.e(403936),i.e(450605),i.e(329712),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(816906),i.e(831470),i.e(417169),i.e(451185),i.e(666579),i.e(913486),i.e(369093),i.e(364315),i.e(781662),i.e(53443),i.e(478388),i.e(327116),i.e(713782),i.e(553856),i.e(801349),i.e(399286),i.e(764391),i.e(425523),i.e(336995),i.e(537680),i.e(520174),i.e(506412),i.e(25019),i.e(918607),i.e(673615),i.e(568740)]).then(i.bind(i,228183));function Ea(){const e=()=>null;return{eventHandlers:ga,getAppViewEntities:ha,manifest:Ia,render:({appRenderMode:n,onRenderEvent:i,scenarioFactory:a,coreSettings:o})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main){const e="callable-channels-app";i("ChunkLoadStarted",{chunkName:e});const{enableEntityMoreInfo:n}=o.get(s.J.Core),t=({children:e})=>(0,Ie.t)(Ae.Fragment,{children:e}),{LPC:d}=n?{LPC:t}:yield(0,Pn.mT)(Da,e,a),l=n?t:Na.p3;i("ChunkLoadSucceeded",{chunkName:e});const[{CallableChannelEntryContainer:r},{CallsTabContextProvider:m}]=yield Promise.all([(0,Pn.mT)(Aa,e,a),(0,Pn.mT)(Fa,e,a)]);return(0,Ie.t)(ri.f,Object.assign({namespaces:["calling","messaging"],loaderRenderer:null},{children:(0,Ie.t)(d,{children:(0,Ie.t)(l,{children:(0,Ie.t)(m,{children:(0,Ie.t)(r,{})})})})}))}return(0,Ie.t)(e,{})}))}}const Ma={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"InitCallingService"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entryPoint"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingServiceEntrypointType"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"initCallingService"},arguments:[{kind:"Argument",name:{kind:"Name",value:"entryPoint"},value:{kind:"Variable",name:{kind:"Name",value:"entryPoint"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingServiceEntrypointType"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]},Pa={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingDisposeCallingServiceMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"disposeReason"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposeReason"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"disposeSource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposeSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"disposeCallingService"},arguments:[{kind:"Argument",name:{kind:"Name",value:"disposeReason"},value:{kind:"Variable",name:{kind:"Name",value:"disposeReason"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposeReason"}}}},{kind:"Argument",name:{kind:"Name",value:"disposeSource"},value:{kind:"Variable",name:{kind:"Name",value:"disposeSource"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DisposeSource"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]};var Ra;!function(e){e.DisposeMutationGenericJobError="DisposeMutationGenericJobError"}(Ra||(Ra={}));const Oa=(e,n,i,a,o)=>({id:"standup-calling",runOncePerId:!0,job:()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const d=a.newScenario(c.RG.CallingAppInit,{clientId:(0,et.v4)()});d.appendEventData({context:i});const l=a.newScenario(c.RG.StandupCallingAppExecute);l.appendEventData({context:i}),l.mark(c.ck.ExecuteJob);const r=n.newLogger("getStandupCallingJob","apps-calling");r.log("[getStandupCallingJob] Initializing calling service");const{enableCallingSignOut:m,callingServiceDisposeTimeoutInMs:u,enableStandupCallingAppExecuteErrorStack:p}=o.get(s.J.Calling);try{const n=(e=>{switch(e){case c.ck.OnAppPreWarm:return"onAppPreWarm";case c.ck.OnAppPreInit:return"onAppPreInit";default:throw new Error(`StandupCallingJob - ${c.ck} is not on_app_pre_warm or on_app_pre_init`)}})(i);if(d.mark(c.ck.InitCallingServiceMutation),l.pause({reason:gn.jK.WaitingForResponse}),!e||!e.mutate)throw new Error(`apollo is missing. [client:${!!e}, mutation:${!!(null==e?void 0:e.mutate)}]`);yield e.mutate({mutation:Ma,variables:{entryPoint:n},context:{scenarioClientId:d.clientId,scenarioName:d.name}}),l.resume()}catch(e){throw r.error(`[getStandupCallingJob] Error initializing calling service [error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`),p&&l.appendEventData({error:null==e?void 0:e.stack}),l.fail({errors:e.name,message:`${c.ck.ExecuteJob} failed with ${e.message}`}),d.fail({errors:e.name,message:`${c.ck.InitCallingServiceMutation} failed with ${e.message}`}),(0,yn.Tr)(i,gn.jK.StandupCallingJobError,e.name,void 0,e.message)}if(l.mark(c.ck.JobCompleted),d.mark(c.ck.EndStandupCallingJob),r.log("[getStandupCallingJob] Calling service initialized"),l.stop(),d.stop(),m)return()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){return $a(e,r,a,i,u||45e3)}))}))}),$a=(e,n,i,a,o)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t;const d="SignOut",l="StandupCallingAppJob",r=i.newScenario(c.RG.CallingServiceDispose);r.appendEventData({context:d,dataSource:l,origin:a}),null===(t=i.hoistScenarioToCore)||void 0===t||t.call(i,r),n.log(`[getStandupCallingJob] Calling service disposal initiated. [step: ${a}, reason:${d}, source:${l}, timeout:${o}]`);try{const n=e.mutate({mutation:Pa,variables:{disposeReason:d,disposeSource:l}});yield(0,pn.E)(n,o,`Dispose mutation timed out. [timeoutAmount:${o}]`)}catch(e){throw n.error(`[getStandupCallingJob] Error disposing calling service [error.name=${null==e?void 0:e.name}, error.code=${null==e?void 0:e.code}, error.message=${null==e?void 0:e.message}, timeout:${o}]`),r.fail({reason:(null==e?void 0:e.code)||Ra.DisposeMutationGenericJobError,message:(null==e?void 0:e.message)||e}),(0,yn.Tr)(c.RG.CallingServiceDispose,gn.jK.StandupCallingJobError,d,void 0,null==e?void 0:e.message)}r.stop(),n.log("[getStandupCallingJob] Calling service disposed")})),La={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingContentEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingContentEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"action"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visibility"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingContentActionVisibility"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingContentAction"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"content"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_callingBannerContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_callingLocalRecordingNotificationContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_mainAppContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_autoBrbDialogContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingWindowingContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingDialogContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingNotificationContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToChatContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToChatListContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToSettingsPaneContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingToCallListContent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"crossCloudMeetingJoinContent"}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingContent"}}},arguments:[]}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_callingBannerContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingBannerContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"text"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"intentLevel"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BannerNotificationIntentLevel"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dismissable"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"duration"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"bannerScenario"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"source"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CommandSource"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dismissOnAction"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"actionButtonText"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"bannerActions"},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},arguments:[]}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_callingLocalRecordingNotificationContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingLocalRecordingNotificationContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"text"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"fileId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"localRecordingNotificationType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingLocalRecordingNotificationType"}}},arguments:[]}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_mainAppContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MainAppContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsCallingCallingAppEventsFragment_autoBrbDialogContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AutoBrbDialogContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"category"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"correlationId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingWindowingContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingWindowingContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"coordsType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"WindowingCoordsType"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"windowingMode"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"WindowingMode"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"linkedContent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"type"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"WindowingLinkedContentType"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"WindowingLinkedContent"}},arguments:[]}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingDialogContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingDialogContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"name"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dialogActions"},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dialogStrings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DialogContentType"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"text"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingDialogContentText"}}}},arguments:[]}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingNotificationContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingNotificationContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"callId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"crossClientScenarioName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"subtitle"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"type"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"NotificationType"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"toastType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"bypassOsLevelDoNotDisturb"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"image"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"ringtoneAssetUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"time"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"userid"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"primaryAction"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"audioDeviceLabel"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"audioDeviceLabelSecondary"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"audioDeviceId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"audioDeviceIdSecondary"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"actions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"label"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"icon"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"actionType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingNotificationAction"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"header"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"defaultImageDataUrl"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"subtitle"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mri"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"NotificationHeaderData"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isSilent"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"conversationId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"members"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MemberDetails"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayDuration"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToChatContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToChatContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToChatListContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToChatListContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToSettingsPaneContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToSettingsPaneContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"tabItemId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingToCallListContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingToCallListContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"crossCloudMeetingJoinContent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CrossCloudMeetingJoinContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"meetingUrl"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]}}]}.definitions]},xa={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAppSetupEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAppSetupEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"result"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingAppEventsSetupSuccess"}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEventsSetupSuccess"}}},arguments:[]}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAppEventsSetupSuccess"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEventsSetupSuccess"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"_"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]}}]}.definitions]},Ba={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsCallingCallingAppEventsSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingAppEvents"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingAppEvent"}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEvent"}}},arguments:[]}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingAppEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"event"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingContentEvent"}},{kind:"FragmentSpread",name:{kind:"Name",value:"callingAppSetupEvent"}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEventType"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"context"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"externalId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"timeStamp"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"source"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEventSourceName"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"description"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEventSource"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEventContext"}}},arguments:[]}]}},...La.definitions,...xa.definitions]}.definitions]};var ja=i(660378);function Ua(e,n,i){const{id:t,title:a,callId:o,crossClientScenarioName:d,subtitle:l,image:r,time:m,actions:c,type:u,primaryAction:p,header:y,toastType:k,ringtoneAssetUrl:g,audioDeviceLabel:N,audioDeviceLabelSecondary:h,audioDeviceId:f,audioDeviceIdSecondary:_,isSilent:S,displayDuration:T}=e,b=parseInt(m,10),C=y?{alt:y.subtitle,src:y.defaultImageDataUrl}:void 0;return{command:{correlation:{source:sn.D.Notifications,id:i},stateTransition:v.su.new,visibilityState:v.fe.show},entityOptions:{buttons:null==c?void 0:c.map((e=>function(e,n,i,t,a){const{actionType:o,label:d,icon:l}=n;return Object.assign(Object.assign({},l&&{image:{alt:d,src:l}}),{targetEntity:{action:ja.A$.mutate,dataOptions:{actionType:o,toastId:e,toastType:a},id:e,type:ja.dt.calls},text:d,preferImageOnly:i.get(s.J.Calling).forceTextOnT2Notifications?void 0:!!l,style:Ha(o,t)})}(t,e,n,u,k))),callId:o,crossClientScenarioName:d,bypassOsLevelDoNotDisturb:Va(u,n),isIncomingCall:Wa(u),mainImage:{alt:a,src:r},ringtone:g,targetEntity:{action:ja.A$.mutate,dataOptions:{actionType:p,toastId:t,toastType:k},id:t,type:ja.dt.calls},text:l,time:new Date(b),title:a,headerImage:C,headerTitle:null==y?void 0:y.title,headerSubtitle:null==y?void 0:y.subtitle,deviceLabel:N,deviceLabelSecondary:h,deviceId:f,deviceIdSecondary:_,isSilent:S,displayDuration:T}}}const Va=(e,n)=>{let i;if("MeetingWentLive"===e)i=!!n.get(s.J.Calling).enableUrgentMeetingStartedNotificationV2;else i=!1;return i},Wa=e=>"MeetingWentLive"!==e;function Ha(e,n){if("Meeting"!==n)switch(e){case"ReplyIncomingCall":return;case"RejectIncomingCall":return ja.p6.critical;default:return ja.p6.success}}function Ga(e,n,i,t){const{id:a,coordsType:o,windowingMode:d,linkedContent:l}=i,{action:{visibility:r}}=n,{source:s,timeStamp:m}=t,c=function(e){return"Show"===e?v.fe.show:v.fe.hide}(r),u=function(e){return"SingleWindow"===e?v.su.flush:v.su.new}(d),p=l&&function(e){if(!e||!e.id)return;return{id:e.id,type:De.py.chats}}(l),y=function(e){switch(e){case"RigelGallery":return De.py.callsgallery;case"RigelContent":return De.py.callscontent;case"RigelGalleryAndContent":return De.py.callsgalleryandcontent;case"RigelMain":return De.py.meetingroomallinonecall;default:return De.py.calls}}(o);return{entity:{id:a,type:y,action:De.uk.view,linkedEntity:p},command:{visibilityState:c,stateTransition:u,correlation:{id:e,startTimestamp:m||void 0,source:`${sn.D.CallingAppEvent}::${s.name}::${s.description}`}}}}function Ja(e,n){switch(e){case"Show":return v.fe.show;case"Hide":return v.fe.hide;default:return n.warn(`${e} cannot be converted to visibility state, defaulting to hide`),v.fe.hide}}var qa,za=i(104694);!function(e){e.Calling="Calling",e.Notifications="Notifications",e.Devices="Devices",e.PremiumBenefits="PremiumBenefits",e.Privacy="Privacy"}(qa||(qa={}));const Qa={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaUserProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]}}]},Ya={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCallingMsaGroupProfilePictureQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MsaGroupProfilePictureInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaGroupProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"msaGroupInfo"},value:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MsaGroupProfilePictureInput"}}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]}}]},Ka={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCallingPriorityContactsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shouldFetchFromNetwork"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"priorityContacts"},arguments:[{kind:"Argument",name:{kind:"Name",value:"shouldFetchFromNetwork"},value:{kind:"Variable",name:{kind:"Name",value:"shouldFetchFromNetwork"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mri"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"objectId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"jobTitle"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"User"}}}}}}]}}]},Xa={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"toastImageAsDataUri"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]}}]};const Za=new class{constructor(){this.deeplinkEntitySet=!1,this.callingAppEventsSubscribed=!1,this.unlockDeeplinkEntity=()=>{const e=this.deeplinkEntityId;return this.deeplinkEntityId=void 0,this.deeplinkEntitySet=!1,this.resolvePromise&&this.resolvePromise(),e},this.lockDeeplinkEntity=e=>{this.deeplinkEntitySet||(this.initializingPromise=new Promise((e=>{this.resolvePromise=()=>{e()}})),this.deeplinkEntityId=e,this.deeplinkEntitySet=!0)},this.getDeeplinkEntityLocked=()=>this.deeplinkEntitySet,this.getDeeplinkReady=()=>this.initializingPromise,this.getCallingAppEventsSubscribed=()=>this.callingAppEventsSubscribed,this.setCallingAppEventsSubscribed=e=>{this.callingAppEventsSubscribed=e}}},eo={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"resolveCallingAppEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingAppEventResolution"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEventResolution"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resolveCallingAppEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingAppEventResolution"},value:{kind:"Variable",name:{kind:"Name",value:"callingAppEventResolution"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingAppEventResolution"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]};function no(e,n,i){const{eventId:t,resolution:a,context:o}=e,{source:d}=o;return i.log(`[resolveCallingAppEvent] Resolving calling app event [eventId=${t}, source.name=${d.name}, source.description=${d.description}]`),n.mutate({mutation:eo,variables:{callingAppEventResolution:{eventId:t,resolution:a,context:o}},fetchPolicy:"no-cache"})}var io=i(428768),to=i(507829),ao=i(815306),oo=i(528714);function lo(e,n,i){if(e&&n)return n.getAccountMode()===ao.b.MultipleAccounts?(i.log(io.f.ReturningUserKeyForToastCollection),(0,oo.b4)(e)):void i.error(io.f.CollectionIdUndefined);i.error(io.f.NoAutheticatedUserOrTrackingService)}function ro(e,n,i){const{id:t,name:a,dialogActions:o,dialogStrings:d}=n,{action:{visibility:l}}=e,{timeStamp:r}=i;let s;if("Show"===l)s=v.fe.show;else{if("Hide"!==l)return;s=v.fe.hide}const m={visibilityState:s,stateTransition:v.su.extend,correlation:{id:t,startTimestamp:r||void 0,source:a}},c=function(e){switch(e){case"WindowingError":return De.py.windowingerrordialog;case"CallingRestartRecomendedError":return De.py.restartrecomendeddialog;case"Alert":return De.py.callingalertdialog;case"CallingUnparkCall":return De.py.unparkcalldialog;case"CallingConfirm":return De.py.callingconfirmdialog;case"OptionsSettings":return De.py.optionssettingsdialog;case"PrejoinOverlay":return De.py.prejoinoverlaydialog;case"UserMedia":return De.py.usermediadialog;default:return}}(a);if(!c)return;const u={dialogActions:o?[...o]:[],dialogStrings:d?[...d]:[]};return{entity:{id:t,type:c,action:De.uk.create},entityOptions:u,command:m}}const so={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingTriggerDialogActionMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"dialogId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DialogAction"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"triggerDialogAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"dialogId"},value:{kind:"Variable",name:{kind:"Name",value:"dialogId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"actionName"},value:{kind:"Variable",name:{kind:"Name",value:"actionName"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DialogAction"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]};function mo(e,n,i){const{id:t,bannerScenario:a,bannerActions:o}=n,{action:{visibility:d}}=e,{timeStamp:l}=i,r=function(e){let n;if("Show"===e)n=v.fe.show;else{if("Hide"!==e)return;n=v.fe.hide}return n}(d);if(void 0===r)return;const s={visibilityState:r,stateTransition:v.su.extend,correlation:{id:t,startTimestamp:l||void 0,source:a}},m=function(e){switch(e){case"EndpointTransfer":case"LocationChange":return De.py.callingbannernotification;default:return}}(a),c=function(e,n){let i;if(e===v.fe.show)switch(n){case"EndpointTransfer":i=De.uk.join;break;case"LocationChange":i=De.uk.default;break;default:i=void 0}else e===v.fe.hide&&(i=De.uk.delete);return i}(r,a);return m&&c?{bannerPrimaryActionEntity:{id:t,type:m,action:c},entityOptions:{bannerActions:o},command:s,bannerDismissCommandEntity:{id:t,type:De.py.callingbannernotification,action:De.uk.delete}}:void 0}function co(e,n,i,a){return(0,t.__awaiter)(this,void 0,void 0,(function*(){try{const{eventId:t,resolution:a,context:o}=e;yield no({eventId:t,resolution:a,context:o},n,i)}catch(e){i.error(a,`error: [errorName=${e.name}, errorMessage=${e.message}]]`)}}))}function uo(e,n,i,t,a){let o={success:{_:!0}};return t&&a&&(o={error:{name:t,message:a}}),{eventId:e,resolution:o,context:{source:{name:n,description:i}}}}var po=i(285474),yo=i.n(po),vo=i(383657),ko=i.n(vo),go=i(381721),No=i.n(go);const ho={AssemblyStarted:yo(),AssemblyFinished:ko(),AssemblyError:No()};const fo="CN:",_o=(e,n,i,a,o,d,l,r)=>()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const m=i.newLogger("getSetupAppEventsJob","apps-calling"),{enableCallingAppEventSubscriptionTelemetry:u,enableCallingEventJobsCleanup:p}=a.get(s.J.Calling);let y=!1;const v=(0,to.P)();let k;u&&(k=o.newScenario(c.RG.CallingAppEventsSubscribe)),Za.setCallingAppEventsSubscribed(!0);const g=e.subscribe({query:Ba,fetchPolicy:"no-cache"}).map((({data:e})=>null==e?void 0:e.callingAppEvents)).subscribe({next:d=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){let t;if(u&&(t=o.newScenario(c.RG.CallingAppEventSubscriptionNext,{clientId:null==d?void 0:d.id})),!d)return m.error("[getSetupAppEventsInnerJob] Received undefined calling app event"),void(null==t||t.fail({reason:"undefined-calling-app-event"}));if("CallingAppSetupEvent"===d.event.__typename&&d.event.result&&"CallingAppEventsSetupSuccess"===d.event.result.__typename)return m.log("[getSetupAppEventsInnerJob] Successfully subscribed."),y=!0,v.resolve(),void(null==k||k.stop());const{context:s}=d,{source:p}=s;m.log(`[getSetupAppEventsInnerJob] Received calling app event [event.id=${d.id}][context.externalId=${s.externalId}][source.name=${p.name}][source.description=${p.description}]`);try{yield So(l,d,a,e,n,i,o,r),null==t||t.stop()}catch(n){m.error(`Calling app event handler threw error. [error.name=${null==n?void 0:n.name}][error.message=${null==n?void 0:n.message}]`),null==t||t.fail({errorCode:n.name,message:n.message,reason:"job-subscription-next-error"}),no({eventId:d.id,resolution:{error:{name:(null==n?void 0:n.errorCode)||gn.jK.HandleCallingAppEventError,message:(null==n?void 0:n.errorMessage)||`Unhandled exception while handling calling app events in job [eventId=${d.id}]`}},context:{source:{name:"CallingAppEventJobHandlerError",description:`Error handling event in app job setup calling app events [eventId=${d.id} error.errorCode=${null==n?void 0:n.errorCode}, error.message=${null==n?void 0:n.errorMessage}]`}}},e,m)}})),error:e=>{if(m.error(`[getSetupAppEventsInnerJob] Error in calling app events subscription [error.name=${null==e?void 0:e.name}][error.message=${null==e?void 0:e.message}]`),!y){const n=(0,yn.Tr)(d,gn.jK.SetupCallingAppEventsJobError,"",{},`[getSetupAppEventsInnerJob] error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}`);v.reject(n)}if(u){let n=o.findScenario(c.RG.CallingAppEventsSubscribe);n||(n=o.newScenario(c.RG.CallingAppEventsSubscribe)),n.fail({errorCode:null==e?void 0:e.name,message:null==e?void 0:e.message,reason:"app-job-subscription-error"})}},complete:()=>{if(u){o.newScenario(c.RG.CallingAppEventsUnsubscribe).stop()}}});return p?e=>{m.log(`Cleanup SetupCallingAppEventsJob called. reason: ${e}`),null==g||g.unsubscribe(),Za.unlockDeeplinkEntity(),Za.setCallingAppEventsSubscribed(!1)}:v.promise})),So=(e,n,i,a,o,d,l,r)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{id:m,event:u,context:p}=n;if(!("action"in u)||!("content"in u)){throw d.newLogger("appEventsHandler","apps-calling").error("[getSetupAppEventsInnerJob] Expected event of type CallingAppEvent, not CallingAppSetupEvent."),new Error("IncorrectCallingAppEventTypeError")}switch(u.content.__typename){case"AutoBrbDialogContent":!function(e,n,i,a,o,d){(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=e.newLogger("handleAutoBrbDialogContentEvent","apps-calling"),{enableAutoBrbViaScenarioCallback:l}=a.get(s.J.Calling);if(!l)return void t.warn("handleAutoBrbDialogContentEvent should not be called if enableAutoBrbViaScenarioCallback is false");const{title:r,category:m,correlationId:c}=i;if(t.log("Auto Brb with dialog request received"),!(r&&m&&c&&d)){const e=`[handleAutoBrbDialogContentEvent] Error handling auto brb content event due to undefined commanding with [eventId=${d},`,n=uo(d,"AutoBrbCommandingError",`Error converting auto brb content to commanding [eventId=${d}]`,"auto-brb-invalid-parameter",`Error in converting auto brb content to command, a required parameter is undefined [titleMissing: ${!!r}, categoryMissing: ${!!m}, correlationIdMissing: ${!!c}}, eventIdMissing: ${!!d}, eventId ${d}}]`);return void(yield co(n,o,t,e))}const u={feedbackSelectedCategory:i.category,feedbackText:i.title},p=sn.D.AutoBrb,y={visibilityState:v.fe.show,stateTransition:v.su.new,correlation:{id:c,source:p}};try{n.brbFeedback.autoBrbFlowDialog(y,u);const e=`Show auto brb dialog command resolved successfully [eventId=${d}, correlationId=${c}]`,i=`[handleAutoBrbDialogContentEvent] Error when reporting show auto brb event "success" with [eventId=${d}, correlationId=${c},`,a=uo(d,"AutoBrbCommandingSuccess",e);yield co(a,o,t,i)}catch(e){const n=(null==e?void 0:e.name)||"unknown-auto-brb-commanding-error-name",i=(null==e?void 0:e.message)||"unknown-auto-brb-app-commanding-error-message";t.error(`[handleAutoBrbDialogContentEvent] Commanding error errorName=${n}, eventSource=${p}, errorMessage=${i}, correlationId: ${c}}, eventId: ${d}]`);const a="AutoBrbCommandingError",l=`Error triggering Auto Brb command [eventId=${d}, eventSource=${p}, correlationId: ${c}]`,r=`[handleAutoBrbDialogContentEvent] Error when reporting event "error" [eventId=${d}, eventSource=${p}, correlationId: ${c}, error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message},`,s=uo(d,a,l,n,i);yield co(s,o,t,r)}}))}(d,o,u.content,i,a,m);break;case"MainAppContent":!function(e,n,i,a,o){(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=e.newLogger("handleMainAppContentEvent","apps-calling"),d={id:o.context.externalId||"undefined",startTimestamp:o.context.timeStamp||"undefined",scenarioName:c.RG.CallingAppEventMainApp,source:sn.D.CallingAppEvent};try{yield n.deepLink.launchMainApp(d)}catch(e){const n=(null==e?void 0:e.name)||"unknown-launch-main-app-commanding-error-name",o=(null==e?void 0:e.message)||"unknown-launch-main-app-commanding-error-message";t.error(`[handleMainAppContentEvent] Commanding error errorName=${n}, eventSource=${d.source}, errorMessage=${o}]`);try{yield no({eventId:a,resolution:{error:{name:n,message:o}},context:{source:{name:"MainAppCommandingError",description:`Error triggering launch main app command [eventId=${a}, eventSource=${d.source}]`}}},i,t)}catch(e){t.error(`[handleMainAppContentEvent] Error when reporting event "error" [eventId=${a}, eventSource=${d.source}, error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}return}t.log(`[handleMainAppContentEvent] Commanding success [eventId=${a}, eventSource=${d.source}]`);try{yield no({eventId:a,resolution:{success:{_:!0}},context:{source:{name:"MainAppCommandingSuccess",description:`Command resolved successfully [eventId=${a}, eventSource=${d.source}]`}}},i,t)}catch(e){t.error(`[handleMainAppContentEvent] Error when reporting event "success" [error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}}))}(d,o,a,m,n);break;case"CallingWindowingContent":!function(e,n,i,a,o,d,l,r){var m;(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=e.newLogger("handleCallingWindowingContentEvent","apps-calling"),{entity:c,command:u}=Ga(a,o,d,l),p=Za.unlockDeeplinkEntity();try{yield n.call.callById(c.id,{visibilityState:u.visibilityState,stateTransition:u.stateTransition,correlation:u.correlation},null===(m=null==c?void 0:c.linkedEntity)||void 0===m?void 0:m.id,c.type,p)}catch(e){const n=(null==e?void 0:e.name)||"unknown-windowing-commanding-error-name",o=(null==e?void 0:e.message)||"unknown-windowing-commanding-error-message";t.error(`[handleCallingWindowingContentEvent] Windowing commanding error [entity.id=${c.id}, errorName=${n}, errorMessage=${o}]`);try{yield no({eventId:a,resolution:{error:{name:n,message:o}},context:{source:{name:"WindowingCommandingTriggerError",description:`Error triggering windowing command [eventId=${a}, entity.id=${c.id}]`}}},i,t)}catch(e){t.error(`[handleCallingWindowingContentEvent] Error when reporting event "error" [eventId=${a}, entity.id=${c.id}, error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}return}const{enableCallingAppCommandResolvedHook:y}=r.get(s.J.Calling);if(!y){t.log(`[handleCallingWindowingContentEvent] Windowing commanding success [eventId=${a}, entity.id=${c.id}]`);try{yield no({eventId:a,resolution:{success:{_:!0}},context:{source:{name:"WindowingCommandingSuccess",description:`Windowing command resolved successfully [eventId=${a}, entity.id=${c.id}]`}}},i,t)}catch(e){t.error(`[handleCallingWindowingContentEvent] Error when reporting event "success" [entity.id=${c.id}, error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}}}))}(d,o,a,m,u,u.content,p,i);break;case"CallingToChatContent":!function(e,n,i,a,o){var d;(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=e.newLogger("handleCallingToChatContentEvent","apps-calling"),{entity:l,command:r}=function(e,n,i,t){const a=n.id,{action:{visibility:o}}=e,{externalId:d,timeStamp:l}=t,r=Ja(o,i),s=n.messageId?{id:n.messageId,type:De.py.messages}:void 0;return{entity:{id:a,type:De.py.chats,action:De.uk.view,linkedEntity:s},command:{visibilityState:r,stateTransition:v.su.new,correlation:{id:d||void 0,startTimestamp:l||void 0,source:sn.D.CallingAppEvent}}}}(i,a,t,o);try{yield n.chat.chatById(l.id,{entityCommand:{visibilityState:r.visibilityState,stateTransition:r.stateTransition,correlation:r.correlation},entityOptions:{messageId:null===(d=l.linkedEntity)||void 0===d?void 0:d.id}})}catch(e){t.error(`[getSetupAppEventsInnerJob] Navigation to chat commanding error [entity.id: ${l.id}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}t.log(`[getSetupAppEventsInnerJob] Navigation to chat commanding success [entity.id: ${l.id}]`)}))}(d,o,u,u.content,p);break;case"CrossCloudMeetingJoinContent":!function(e,n,i,a,{meetingUrl:o}){(0,t.__awaiter)(this,void 0,void 0,(function*(){let t;const d=e.newLogger("handleCrossCloudMeetingJoinContentEvent","apps-calling");d.log("handleCrossCloudMeetingJoinContentEvent called");try{yield n.deepLink.executeFromUrlV2(o,void 0,void 0),t={success:{_:!0}}}catch(e){const n=(null==e?void 0:e.name)||"unknown-cross-cloud-meeting-join-content-event";t={error:{name:n,message:(null==e?void 0:e.message)||"unknown-windowing-commanding-error-message"}},d.error(`[handleCrossCloudMeetingJoinContentEvent] Cross Cloud commanding error [meetingUrl=${o}, errorName=${n}]`)}try{yield no({eventId:a,resolution:t,context:{source:{name:"WindowingCommandingTriggerError",description:`Error triggering windowing command [eventId=${a}]`}}},i,d)}catch(e){d.error(`[handleCrossCloudMeetingJoinContentEvent] Error when reporting event resolution [eventId=${a}, error.name=${null==e?void 0:e.name}, error.message=${null==e?void 0:e.message}]`)}}))}(d,o,a,m,u.content);break;case"CallingToChatListContent":!function(e,n,i,a){(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=e.newLogger("handleCallingToChatListContentEvent","apps-calling"),{command:o}=function(e,n,i){const{action:{visibility:t}}=e,{externalId:a,timeStamp:o}=i,d=Ja(t,n);return{entity:{type:De.py.chats,action:De.uk.view},command:{visibilityState:d,stateTransition:v.su.none,correlation:{id:a||void 0,startTimestamp:o||void 0,source:sn.D.CallingAppEvent}}}}(i,t,a);try{yield n.chat.chatList({visibilityState:o.visibilityState,stateTransition:o.stateTransition,correlation:o.correlation})}catch(e){t.error(`[getSetupAppEventsInnerJob] Navigation to chat list commanding error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}t.log("[getSetupAppEventsInnerJob] Navigation to chat list commanding success")}))}(d,o,u,p);break;case"CallingToCallListContent":!function(e,n,i,a){(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=e.newLogger("handleCallingToCallListContentEvent","apps-calling"),{command:o}=function(e,n,i){const{action:{visibility:t}}=e,{externalId:a,timeStamp:o}=i,d=Ja(t,n);return{entity:{type:De.py.callsmain,action:De.uk.view},command:{visibilityState:d,stateTransition:v.su.none,correlation:{id:a||void 0,startTimestamp:o||void 0,source:sn.D.CallingAppEvent}}}}(i,t,a);try{yield n.call.callList({visibilityState:o.visibilityState,stateTransition:o.stateTransition,correlation:o.correlation})}catch(e){t.error(`[getSetupAppEventsInnerJob] Navigation to call list commanding error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}t.log("[getSetupAppEventsInnerJob] Navigation to call list commanding success")}))}(d,o,u,p);break;case"CallingToSettingsPaneContent":!function(e,n,i){(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=e.newLogger("handleCallingToSettingsPaneContentEvent","apps-calling"),a=function(e){const n=new Map([[qa.Calling,za.Y.Calls],[qa.Notifications,za.Y.Notifications],[qa.Devices,za.Y.Devices],[qa.PremiumBenefits,za.Y.Benefits],[qa.Privacy,za.Y.Privacy]]);return{id:e.tabItemId?n.get(e.tabItemId):void 0,command:{stateTransition:v.su.flush,visibilityState:v.fe.show,correlation:{source:sn.D.CallingAppEvent}}}}(i),{id:o,command:d}=a;try{yield n.settings.launchSection(o,d)}catch(e){t.error(`[getSetupAppEventsInnerJob] setting commanding error [entity.id: ${o}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}))}(d,o,u.content);break;case"CallingBannerContent":!function(e,n,i,a,o,d,l,r){(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=e.newLogger("handleCallingBannerContentEvent","apps-calling"),{enableCallingBannerContent:m}=r.get(s.J.Calling);if(!m)return;const c=mo(o,d,l);if(!c){t.error("[handleCallingBannerContentEvent] Banner commanding error - no command to fire, visibility state is undefined");const e=`[handleCallingBannerContentEvent] Error in handling calling banner content event due to undefined commanding with [eventId=${a},`,n=uo(a,"BannerContentToCommandingConversionError",`Error converting banner content to commanding [eventId=${a}]`,"Unknown-banner-commanding-error-name",`Unhandled exception while handling calling app events in job, error in converting banner content to command, visibility state is undefined [eventId=${a}]`);return void(yield co(n,i,t,e))}const{bannerPrimaryActionEntity:u,entityOptions:p,command:y,bannerDismissCommandEntity:v}=c,{action:{visibility:k}}=o;if("Show"===k)try{yield n.shell.showBanner({id:d.id,text:d.text,intentLevel:d.intentLevel,action:d.actionButtonText?{text:d.actionButtonText,command:{entity:u,entityOptions:p,command:y},dismissOnAction:d.dismissOnAction}:void 0,dismissable:d.dismissable||void 0,dismissActionCommand:{entity:v,entityOptions:p,command:y},duration:d.duration,bannerScenario:d.bannerScenario,source:d.source});const e="ShowBannerSuccess",o=`Show banner command resolved successfully [eventId=${a}, entity.id=${u.id}]`,l=`[handleCallingBannerContentEvent] Error when reporting show banner event "success" with [eventId=${a}, entity.id=${u.id},`,r=uo(a,e,o);yield co(r,i,t,l)}catch(e){t.error(`Error is displaying banner through shell.showBanner with [entity.id: ${u.id}, error.name: ${e.name}, error.message: ${e.message}]`);const n=`[handleCallingBannerContentEvent] Error in handling calling banner content event due to failure of shell.showBanner with [eventId=${a},`,o=uo(a,"ShowBannerError",`Error in showing banner through shell.showBanner [eventId=${a}]`,"Unknown-show-banner-error-name",`Unhandled exception while handling calling app events in job, failed to trigger shell.showBanner function, error in showing banner [eventId=${a}]`);yield co(o,i,t,n)}if("Hide"===k)try{yield n.shell.dismissBanner(d.id,d.source),t.log(`[dismissBanner] Successfully hiding the banner with [bannerId: ${d.id}] when call is no longer active.`);const e="DismissBannerSuccess",o=`Dismiss banner command resolved successfully [eventId=${a}, entity.id=${v.id}]`,l=`[handleCallingBannerContentEvent] Error when reporting dismiss banner event "success" with [eventId=${a}, entity.id=${v.id},`,r=uo(a,e,o);yield co(r,i,t,l)}catch(e){t.error(`Error in dismissing the banner when call is no longer active. entity.id: ${v.id}, entity.action: ${v.action}, error.name=${e.name}, error.message=${e.message}]`);const n=`[handleCallingBannerContentEvent] Error in handling calling banner content event due to failure of shell.dismissBanner with [eventId=${a},`,o=uo(a,"DismissBannerError",`Error in dismissing banner through shell.dismissBanner [eventId=${a}]`,"Unknown-dismiss-banner-error-name",`Unhandled exception while handling calling app events in job, failed to trigger shell.dimissBanner function, error in dismissing banner [eventId=${a}]`);yield co(o,i,t,n)}}))}(d,o,a,m,u,u.content,p,i);break;case"CallingLocalRecordingNotificationContent":!function(e,n,i){e.newLogger("handleCallingLocalRecordingNotificationEvent","apps-calling").log("Local recording notification event received",i.localRecordingNotificationType),n.toasts.showLocalRecordingAssemblyNotification(`${Date.now()}`,{title:i.title,text:i.text,mainImage:{alt:"",src:ho[i.localRecordingNotificationType]},time:new Date,type:"LocalRecordingAssembly",quickReply:!1,conversationId:""})}(d,o,u.content);break;case"CallingDialogContent":!function(e,n,i,a,o,d,l,r){(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=e.newLogger("handleCallingDialogContentEvent","apps-calling"),{id:m}=o,u=l.findScenarioByNameAndId(c.RG.CallingDialogOpen,m);u||t.error(`[getSetupAppEventsInnerJob] Cannot find calling_dialog_open scenario [dialogId: ${m}]`),null==u||u.mark(c.ck.CallingDialogCallingAppEventReceived);const p=ro(a,o,d);if(!p){const e="[getSetupAppEventsInnerJob] Dialog commanding error - no command to fire, command is undefined";return t.error(e),void(null==u||u.fail({errors:e,errorCode:"command-is-undefined"}))}const{entity:y,entityOptions:k,command:g}=p;if(!y.type){const e=`[getSetupAppEventsInnerJob] Dialog commanding error - no command to fire, entity type is undefined [entity.id: ${y.id}]`;return t.error(e),void(null==u||u.fail({errors:e,errorCode:"entity-type-is-undefined"}))}const{enableDialogWindow:N}=r.get(s.J.Calling);if(N){null==u||u.mark(c.ck.BeforeCallingDialogContainerCommandTriggered);try{i.call.dialogContainer({command:Object.assign(Object.assign({},g),{visibilityState:v.fe.show}),viewOptions:{command:g,entity:y,options:k}})}catch(e){const n=`[getSetupAppEventsInnerJob] Dialog CONTAINER commanding error [entity.id: ${y.id}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`;t.error(n),null==u||u.fail({errors:n,errorCode:"dialog-container-commanding-error"})}null==u||u.mark(c.ck.AfterCallingDialogContainerCommandTriggered)}else{let e;null==u||u.mark(c.ck.BeforeCallingDialogEntityCommandTriggered);try{e=yield i.call.openDialog(y,g,k)}catch(e){const n=`[getSetupAppEventsInnerJob] Dialog ENTITY commanding error [entity.id: ${y.id}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`;return t.error(n),void(null==u||u.fail({errors:n,errorCode:"open-dialog-commanding-error"}))}null==u||u.mark(c.ck.AfterCallingDialogEntityCommandTriggered);const a=e.subscribe({next:({containerState:e})=>{switch(e){case v.oq.Closed:n.mutate({mutation:so,variables:{dialogId:o.id,actionName:"PostClose"}}),a.unsubscribe();break;case v.oq.Open:null==u||u.stop({reason:`Dialog container opened [dialogId: ${m}]`})}}});null==u||u.mark(c.ck.SubscribedToDialogObservable)}t.log(`[getSetupAppEventsInnerJob] Dialog commanding success [entity.id: ${y.id}]`)}))}(d,a,o,u,u.content,p,l,i);break;case"CallingNotificationContent":!function(e,n,i,a,o,d,l,r,m,u,p){var y,v,k,g,N,h,f,_;(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=e.newLogger("handleCallingNotificationContentEvent","apps-calling");let S;const T=(0,et.v4)(),{enableIncomingCallCrossClientTelemetry:b}=l.get(s.J.Calling);b&&i.callId&&i.crossClientScenarioName&&(S=r.findScenarioByNameAndId(i.crossClientScenarioName,i.callId)),S&&(null==S?void 0:S.isHoisted)||(S=r.newScenario(c.RG.CrossClientToastView),S.clientId=T,S.appendEventData({mainEntityType:De.py.calls}),null===(y=r.hoistScenarioToCore)||void 0===y||y.call(r,S));const C=Ua(i,l,T);if(C.entityOptions&&l.get(s.J.Notifications).enableToastCollections&&(C.entityOptions.collectionId=lo(u,p,t)),yield Promise.all([Co(i,d,C,t,S),To(i,d,C,t,S)]),"CreateNotificationWithActions"===(null===(v=o.source)||void 0===v?void 0:v.name))if("Show"===a){S.mark(c.ck.CrossClientTriggerShowToast);try{!function(e,n,i,t){no({eventId:n,resolution:e?{success:{_:!0}}:{error:{name:"Notification dropped",message:`Call Notification was not executed, notification might be dropped for expected reasons [eventId=${n}]`}},context:{source:{name:"CallingAppEventJobHandlerError",description:`Commading call notification [eventId=${n}] [notificationResult=${e}]`}}},i,t)}(yield n.call.callNotification(C,i.id,T,"Show"),m,d,t)}catch(e){S.fail({errorCode:io.f.SubscriptionFailed,reason:"Subscription failed on show"}),t.error(`${fo}${i.id}:[handleCallingNotificationContentEvent] Notification commanding error on [${null===(k=o.source)||void 0===k?void 0:k.name}] [[content.id: ${i.id}], entity.id: toasts, visibility: ${a.toString()}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}else{S.mark(c.ck.CrossClientTriggerHideToast);try{yield n.call.callNotification(C,i.id,T,"Hide")}catch(e){S.fail({errorCode:io.f.SubscriptionFailed,reason:"Subscription failed on hide"}),t.error(`${fo}${i.id}:[handleCallingNotificationContentEvent] Notification commanding error on [${null===(g=o.source)||void 0===g?void 0:g.name}] [[content.id: ${i.id}], entity.id: toasts, visibility: ${a.toString()}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}else{if("UpdateNotification"!==(null===(N=o.source)||void 0===N?void 0:N.name))return S.fail({errorCode:io.f.SubscriptionFailed,reason:`Invalid context.source.name [${null===(f=o.source)||void 0===f?void 0:f.name}]`}),void t.error(`${fo}${i.id}:[handleCallingNotificationContentEvent] Notification commanding error invalid context.source.name [${null===(_=o.source)||void 0===_?void 0:_.name}] [[content.id: ${i.id}], entity.id: toasts, visibility: ${a.toString()}`);S.mark(c.ck.CrossClientTriggerUpdateToast);try{yield n.call.callNotification(C,i.id,T,"Show")}catch(e){S.fail({errorCode:io.f.SubscriptionFailed,reason:"Subscription failed on update"}),t.error(`${fo}${i.id}:[handleCallingNotificationContentEvent] Notification commanding error on [${null===(h=o.source)||void 0===h?void 0:h.name}] [[content.id: ${i.id}], entity.id: toasts, visibility: ${a.toString()}, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}S.mark(c.ck.CrossClientEntityCommandTriggered),t.log(`${fo}${i.id}:[handleCallingNotificationContentEvent] Notification commanding success [content.id: ${i.id}][entity.id: toasts][visibility: ${a.toString()}]`)}))}(d,o,u.content,u.action.visibility,p,a,i,l,m,e,r)}}));function To(e,n,i,a,o){return(0,t.__awaiter)(this,void 0,void 0,(function*(){try{const d=yield function(e,n){return(0,t.__awaiter)(this,void 0,void 0,(function*(){try{const i=yield e.query({query:Ka,fetchPolicy:"network-only"});return i?i.data.priorityContacts.map((e=>e.id)):(n.error(`${fo}[handleCallingNotificationContentEvent] Failed to fetch priority contacts`),[])}catch(e){return n.error(`${fo}[handleCallingNotificationContentEvent] Failed to fetch priority contacts`),[]}}))}(n,a);i.entityOptions.isUrgent=d.includes(e.userid),o.mark(c.ck.PriorityContactsFetched)}catch(n){a.error(`${fo}${e.id}:[handleCallingNotificationContentEvent] Error when fetching priority contacts. Error: ${n}`)}}))}function bo(e,n,i,a,o,d,l){return(0,t.__awaiter)(this,void 0,void 0,(function*(){try{const r=d?yield function(e,n,i){return(0,t.__awaiter)(this,void 0,void 0,(function*(){if(!(null==i?void 0:i.length))return null;const t=yield e.query({query:Ya,variables:{msaGroupInfo:{pictureReadyUsers:i.map((({id:e,displayName:n})=>({userId:e,displayName:n}))).slice(0,4),conversationId:n}}});return null==t?void 0:t.data.msaGroupProfilePicture}))}(e,l||"",d):yield function(e,n,i){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=yield e.query({query:Qa,variables:{userId:n,displayName:i,profilePictureSize:"HR96x96"}});return null==t?void 0:t.data.msaUserProfilePicture}))}(e,n,i);if(!r)return void o.error(`${fo}${a}:[handleCallingNotificationContentEvent] Failed to generate avatar image url`);const s=yield e.query({query:Xa,variables:{url:r}});return(null==s?void 0:s.data.toastImageAsDataUri)||void 0}catch(e){return void o.error(`${fo}${a}:[handleCallingNotificationContentEvent] failed to fetch avatar image. Error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}`)}}))}function Co(e,n,i,a,o){var d,l,r,s,m,u,p,y,v,k,g;return(0,t.__awaiter)(this,void 0,void 0,(function*(){try{let t,N;e.userid&&(null===(d=i.entityOptions)||void 0===d?void 0:d.mainImage)?t=bo(n,e.userid,e.title,e.id,a):(null===(l=e.members)||void 0===l?void 0:l.length)&&(null===(r=i.entityOptions)||void 0===r?void 0:r.mainImage)&&"HuddleMeetingStart"===(null===(u=null===(m=null===(s=i.entityOptions)||void 0===s?void 0:s.targetEntity)||void 0===m?void 0:m.dataOptions)||void 0===u?void 0:u.toastType)?t=bo(n,"",e.title,e.id,a,e.members,e.conversationId||""):a.log("[handleCallingNotificationContentEvent] Primary avatar not fetched, user id or main image property is not present on the content."),(null===(p=e.header)||void 0===p?void 0:p.mri)&&(null===(y=i.entityOptions)||void 0===y?void 0:y.headerImage)&&(N=bo(n,e.header.mri,e.header.subtitle,e.id,a));const[h,f]=yield Promise.all([t,N]);h&&(i.entityOptions.mainImage={src:h,alt:null!==(v=e.title)&&void 0!==v?v:""},o.mark(c.ck.CrossClientAvatarFetched)),f&&(i.entityOptions.headerImage={src:f,alt:null!==(g=null===(k=e.header)||void 0===k?void 0:k.subtitle)&&void 0!==g?g:""})}catch(e){a.error(`[handleCallingNotificationContentEvent] failed handle avatar fetches. Error: ${e}`)}}))}var wo=i(89062),Io=i(483416);const Ao={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingSetCallStatePresenceMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingClientState"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingClientStatePresence"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setCallStatePresence"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingClientState"},value:{kind:"Variable",name:{kind:"Name",value:"callingClientState"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingClientStatePresence"}}}}],__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]}}]},Fo={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"callingClientStateEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingClientStateEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingClientStateEvent"}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingClientStateEvent"}}},arguments:[]}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingClientStateEvent"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingClientStateEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"inCall"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isScreenSharing"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]}]}}]}.definitions]},Do={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateClientStateVeryActive"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isVeryActive"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UpdateClientStateSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateClientStateVeryActive"},arguments:[{kind:"Argument",name:{kind:"Name",value:"isVeryActive"},value:{kind:"Variable",name:{kind:"Name",value:"isVeryActive"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UpdateClientStateSource"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]},Eo=(e,n,i)=>()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const a=n.newLogger("getCallingClientEventsJob","apps-calling"),{enableCallingEventJobsCleanup:o}=i.get(s.J.Calling),d=e.subscribe({query:Fo,fetchPolicy:"no-cache"}).subscribe((({data:i,errors:o})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){if(o){const e=o.map((e=>e.message));a.error(`handleCallingClientStateEvent: Error receiving callingClientStateEvent [Errors: ${e.join()}]`)}else i&&(a.log(`handleCallingClientStateEvent: Processing callingClientStateEvent [Received: ${(0,wo.u4)(i)}]`),function(e,n,i){(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=e.newLogger("handleCallingClientStateEvent","apps-calling");t.log(`Event received: ${(0,wo.u4)(n)}`);try{yield i.mutate({mutation:Do,variables:{isVeryActive:n.inCall||n.isScreenSharing,source:"Calling"}})}catch(e){t.error(`mutation updateClientStateVeryActiveDocument error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}))}(n,i.callingClientStateEvent,e),i.callingClientStateEvent.inCall&&i.callingClientStateEvent.isScreenSharing?(Mo(n,"Presenting",e),Po("ScreenSharing",e)):i.callingClientStateEvent.inCall?(Mo(n,"InACall",e),Po("InCall",e)):(Mo(n,"NotInACall",e),Po("None",e)))}))));if(o){return e=>{a.log(`Cleanup CallingClientEventsJob called. reason: ${e}`),null==d||d.unsubscribe()}}}));function Mo(e,n,i){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=e.newLogger("setCallingClientStatePresence","apps-calling");t.log(`Call state presence received: ${n}`);try{yield i.mutate({mutation:Ao,variables:{callingClientState:n}})}catch(e){t.error(`mutation AppsCallingSetCallStatePresenceMutationDocument error, error.name: ${null==e?void 0:e.name}, error.message: ${null==e?void 0:e.message}]`)}}))}function Po(e,n){return(0,t.__awaiter)(this,void 0,void 0,(function*(){yield n.mutate({mutation:Io.b,variables:{newState:e},fetchPolicy:"no-cache"})}))}var Ro=i(647995),Oo=i(243446);function $o(e,n,i,a,o){const d=i.newLogger("emergency-location-notification-job-logger","apps-shell");return{id:"emergency-location-notification",job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const i=a.stringTranslate(s.J.Calling,"emergency_manage_location_button_text"),t=e.subscribe({query:Ro.x}).subscribe((({data:e})=>{if((0,Oo.uF)(null==e?void 0:e.emergencyAddressUpdatedEvent)){const t=((e,n)=>{const i=e.stringTranslate(s.J.Calling,"emergency_location_needs_confirmation_banner_text"),t=e.stringTranslate(s.J.Calling,"emergency_location_not_detected_banner_text");return"CLS"===(null==n?void 0:n.type)?i:!n||n.editable&&"None"===n.type?t:""})(a,null==e?void 0:e.emergencyAddressUpdatedEvent);!function(e,n,i){i.shell.showBanner({id:"E911LocationBanner",source:sn.D.ShellE911LocationChange,bannerScenario:"emergency_location_banner",intentLevel:"Severe",cause:"EmergencyLocationBanner",text:e,action:{text:n,command:{entity:{type:De.py.locationnotificationbanner,action:De.uk.view},command:{visibilityState:v.fe.show,stateTransition:v.su.extend,correlation:{source:sn.D.ShellE911LocationChange}}},dismissOnAction:!0},dismissable:!0,duration:0})}(t,i,n)}else n.shell.dismissBanner("E911LocationBanner",sn.D.ShellE911LocationChange);o&&o()}));return()=>{t.unsubscribe(),d.log("[location] unsubscribing ...")}}))}}const Lo=(e,n,i,t,a,o,d,l,r)=>{const{enableCallingStackInitialization:m,enableCallingClientEvents:u,enableCallingAppEvents:p,enableEmergencyLocationGlobalBanner:y}=a.get(s.J.Calling),v=[];if(m){const n=xo(t,c.RG.StandupCallingAppJob,o);v.push(Oa(e,i,o,t,a)),n.mark(c.ck.JobAdded),n.stop()}return p&&v.push(((e,n,i,t,a,o,d,l)=>({id:"setup-calling-app-events",runOncePerId:!0,job:_o(e,n,i,t,a,o,d,l)}))(e,n,i,a,t,o,r,l)),u&&v.push(((e,n,i)=>({id:"calling-client-events",runOncePerId:!0,job:Eo(e,n,i)}))(e,i,a)),y&&d&&v.push($o(e,n,i,d)),v},xo=(e,n,i)=>{let t=e.findScenario(n);return t||(t=e.newScenario(n)),t.mark(i),t},Bo=({context:{authenticationUser:e,client:n,coreSettings:i,entityCommanding:t,i18n:a,loggerFactory:o,scenarioFactory:d,userTrackingService:l}})=>Lo(n,t,o,d,i,c.ck.OnAppPreWarm,a,l,e),jo=({context:{client:e,coreSettings:n,entityCommanding:i,loggerFactory:t,scenarioFactory:a}})=>Lo(e,i,t,a,n,c.ck.OnAppPreInit);var Uo=i(405501);const Vo=e=>"tel:"===e||"callto:"===e,Wo={filter:({protocol:e})=>Vo(e),execute:({deeplinkUrl:{pathname:e,protocol:n},context:{coreSettings:i,loggerFactory:a}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,o;const d=a.newLogger("[Calling][OnBeforeDeeplinkParsed][CallingProtocol]","apps-calling"),{enableCallWithUsersDeeplink:l}=i.get(s.J.Calling);if(!l||!Vo(n)){const e=`enableCallWithUsersDeeplink=${l} or protocol=${n} is not supported`;throw null===(t=d.warnToTelemetry)||void 0===t||t.call(d,e,"calling_protocol_deeplink_condition",void 0,!0),new Error(e)}null===(o=d.infoToTelemetry)||void 0===o||o.call(d,`Returning calling protocol dialog intent for protocol=${n}`,"calling_protocol_deeplink_condition",void 0,!0),e=decodeURIComponent(e);const r=(0,Uo.TE)(e);return{entityCommand:{entity:{type:De.py.callingprotocoldeeplinkdialog,action:De.uk.create},command:{visibilityState:v.fe.show,stateTransition:v.su.extend,layoutMode:v.lO.standard},entityOptions:{protocol:n,target:e,isPSTNNumber:r}},metadata:{allowAnonymous:!1}}}))};var Ho;!function(e){e.EmptyDeeplinkUrl="empty-deeplink-url-received",e.MeetingCodeParse="meeting-code-parse-error",e.LegacyCoordinatesParse="legacy-coordinates-parse-error",e.EmptyContext="empty-context-received",e.EmptyParsedUrlParams="empty-parsed-url-params",e.None="no-entity-command-expected",e.PresentDeepLinkT2Disabled="present-deeplink-t2-disabled",e.EmptySearch="empty-search-url",e.MeetingShareDeepLinkT2Disabled="meeting-share-deeplink-t2-disabled"}(Ho||(Ho={}));const Go=e=>({visibilityState:v.fe.show,stateTransition:e?v.su.flush:v.su.new,layoutMode:e?v.lO.standard:v.lO.focus}),Jo=(e,n)=>{if("null"!==e)return e;const i=n.get("fqdn");return i?`https://${i}`:void 0},qo=(e,n)=>n.get("fqdn")||(0,Vi.uO)(e),zo="/l/meetup-join",Qo={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingHandlePresentDeeplinkMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ver"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"deeplinkId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pptContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"handlePresentDeepLink"},arguments:[{kind:"Argument",name:{kind:"Name",value:"ver"},value:{kind:"Variable",name:{kind:"Name",value:"ver"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"deeplinkId"},value:{kind:"Variable",name:{kind:"Name",value:"deeplinkId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"pptContext"},value:{kind:"Variable",name:{kind:"Name",value:"pptContext"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]},Yo={filter:"/l/present",execute:({deeplinkUrl:{search:e},context:{coreSettings:n,loggerFactory:i,__doNotUse_globalDataClient:a}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t;const{enablePresentDeepLinkForMTMA:o}=n.get(s.J.Calling),d=i.newLogger("[Calling][onBeforeDeeplinkParsed][/present]","apps-calling");if(d.log(`EnablePresentToTeamsT2: ${o}. Parsing search length: ${e.length}`),!o)return Promise.reject({message:Ho.PresentDeepLinkT2Disabled});if(""===e)return Promise.reject({message:Ho.EmptySearch});const l=new URLSearchParams(e),r=l.get("ver"),m=l.get("deeplinkId"),c=l.get("pptContext");if(d.log(`Parsed params ver: ${r}, deeplinkId: ${m}`),!r||!m||!c)return Promise.reject({message:Ho.EmptyParsedUrlParams});let u;try{u=yield a.mutate({mutation:Qo,variables:{ver:r,deeplinkId:m,pptContext:c}})}catch(e){throw null===(t=d.errorToTelemetry)||void 0===t||t.call(d,e.message,"cmd_meetings_pptsharing_handle_present_deeplink_mutation_error"),new Error(e.message)}return u&&u.data&&!u.data.handlePresentDeepLink?Promise.resolve({entityCommand:{entity:{type:De.py.presentdeeplinknomeetingcontextdialog,action:De.uk.create},command:{visibilityState:v.fe.show,stateTransition:v.su.extend,layoutMode:v.lO.standard}},metadata:{allowAnonymous:!1}}):void 0}))},Ko=e=>{const[,,n,i]=e.pathname.split("/"),{users:t,withVideo:a}=(({searchParams:e})=>{const n=(e.get("users")||"").trim(),i="true"===(e.get("withVideo")||"").toLocaleLowerCase();if(0===n.length)return{users:[],withVideo:i};const t=n.split(",").filter(Boolean).map((e=>e.toLocaleLowerCase()));return{users:[...new Set(t)],withVideo:i}})(e);return{type:n,containerId:i,users:t,withVideo:a}},Xo=e=>{const{type:n,containerId:i,users:t}=Ko(e);return"call"===n&&"0"===i&&t.length>0},Zo={filter:e=>Xo(e),execute:({deeplinkUrl:e,context:{coreSettings:n,loggerFactory:i}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,a;const o=i.newLogger("[Calling][OnBeforeDeeplinkParsed][CallingDeeplink]","apps-calling"),{enableCallingDeeplink:d}=n.get(s.J.Calling),{type:l,containerId:r,users:m,withVideo:c}=Ko(e),u=JSON.stringify({type:l,containerId:r,usersCount:m.length});if(!d||!Xo(e)){const e=`Skip rendering deeplink dialog: enableCallingDeeplink=${d}, infoFromUrl=${u}`;throw null===(t=o.warnToTelemetry)||void 0===t||t.call(o,e,"calling_deeplink_navigation",void 0,!0),new Error(e)}return null===(a=o.infoToTelemetry)||void 0===a||a.call(o,`Render deeplink dialog: infoFromUrl=${u}`,"calling_deeplink_navigation",void 0,!0),{entityCommand:{entity:{type:De.py.callingdeeplinkDialog,action:De.uk.create},command:{visibilityState:v.fe.show,stateTransition:v.su.extend,layoutMode:v.lO.standard},entityOptions:{users:m,withVideo:c}},metadata:{allowAnonymous:!1}}}))},ed={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingHandleMeetingShareDeeplinkMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"deeplinkId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"handleShareDeeplinkToStage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"deeplinkId"},value:{kind:"Variable",name:{kind:"Name",value:"deeplinkId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"appContext"},value:{kind:"Variable",name:{kind:"Name",value:"appContext"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]},nd={filter:"/l/meeting-share",execute:({deeplinkUrl:{search:e},context:{coreSettings:n,loggerFactory:i,getUserContexts:a}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,o;const{enableDeepLinkShareExtensibleApp:d}=n.get(s.J.Calling),l=i.newLogger("[Calling][onBeforeDeeplinkParsed][/meeting-share]","apps-calling");l.log(`enableDeepLinkShareExtensibleAppT2: ${d}. Parsing search length: ${e.length}`);const r=yield a(),m=r[r.length-1].context.client;if(!d)return Promise.reject({message:Ho.MeetingShareDeepLinkT2Disabled});if(""===e)return Promise.reject({message:Ho.EmptyParsedUrlParams});const c=new URLSearchParams(e),u=c.get("deeplinkId"),p=c.get("appContext");if(l.log(`Parsed params - deeplinkId: ${u}`),!u||!p)return null===(t=l.errorToTelemetry)||void 0===t||t.call(l,`Empty Params for either deeplinkId or AppContext -deeplinkId: ${u}`,"cmd_meetings_appsharing_handle_meetingshare_deeplink"),Promise.reject({message:Ho.EmptyParsedUrlParams});let y;try{y=yield m.mutate({mutation:ed,variables:{deeplinkId:u,appContext:p}})}catch(e){throw null===(o=l.errorToTelemetry)||void 0===o||o.call(l,e.message,"cmd_meetings_appsharing_handle_meetingshare_deeplink"),new Error(e.message)}return y&&y.data&&!y.data.handleShareDeeplinkToStage?Promise.resolve({entityCommand:{entity:{type:De.py.presentdeeplinknomeetingcontextdialog,action:De.uk.create},command:{visibilityState:v.fe.show,stateTransition:v.su.extend,layoutMode:v.lO.standard}},metadata:{allowAnonymous:!1}}):void 0}))},id=[Wo,{filter:e=>{if(!(e.pathname.startsWith(zo)||e.pathname.startsWith("/v2"+zo)))return!1;const n=new URLSearchParams(e.search).get("context");if(!n)return!1;try{const{IsBroadcastMeeting:e}=JSON.parse(n);return!e}catch(e){return!n.includes("IsBroadcastMeeting")}},execute:({deeplinkUrl:e,context:{coreSettings:n,loggerFactory:i},homeCloud:t})=>{var a;const o=i.newLogger("[Calling][onBeforeDeeplinkParsed][/l/meetup-join]","apps-calling"),d=e=>{var n;null===(n=o.infoToTelemetry)||void 0===n||n.call(o,`Legacy deepling condition: ${e}`,"cmd_meeting_join",void 0,!1)};d("Execution started");const l=decodeURIComponent(e.href),r=new URL(l),{pathname:m,search:c,origin:u}=r,{allowAnonymousMeetingJoin:p,enableDeeplinkFlushCommand:y}=n.get(s.J.Calling);if(o.log(`Parsing pathname: ${m}, search: ${c}, allowAnonymousMeetingJoin: ${p}`),!m)return Promise.reject({message:Ho.EmptyDeeplinkUrl});const v=m.split(/[/?&]/),k=v.indexOf("meetup-join")+1,g=v[k],N=v[k+1],h=new URLSearchParams(c);h.set("anon","true");const f=h.get("context");if(!f)return Promise.reject({message:Ho.EmptyContext});const _=h.get("pp"),{Tid:S,Oid:T,MessageId:b,prid:C,isPublic:w}=JSON.parse(f);if(!(g&&N&&S&&T)){const e=`${g?"":"empty-conversationId"} ${N?"":"empty-rootMessageId"} ${S?"":"empty-tenantId"} ${T?"":"empty-organizerId"}`;return null===(a=o.infoToTelemetry)||void 0===a||a.call(o,`Legacy deepling condition Promise.reject(${e}).`,"cmd_meeting_join",void 0,!1),Promise.reject({message:Ho.LegacyCoordinatesParse,reason:e})}let I;const A=Jo(u,h);A&&(I=`${A}/_#${m}?${h.toString()}`),d(`deeplink origin present: ${!!A}`);const F={joinType:"Legacy",conversationId:g,messageId:b||N,rootMessageId:N,isChannel:"0"!==N,isAdhoc:!1,tenantId:S,organizerId:T,meetingCloud:qo(u,h),participantPin:_,registration:C?{participantRegistrationId:C,isPublicEvent:w||!1}:null},D=h.get("deeplinkId");o.log(`Resolving ${JSON.stringify(F)}`),d(`Requesting entity command. deeplinkId: ${D}`);const E=Go(!!y);return d(`Resolving legacy deeplink condition with coordinates. deeplinkId: ${D}`),Promise.resolve({entityCommand:{entity:{type:De.py.callingdeeplink,action:De.uk.join,id:`${g}/${N}`},command:E,entityOptions:{deeplinkUrl:m,coordinates:F,directMeetingLink:I,homeCloud:t,deeplinkId:D,correlationId:h.get("correlationId")||void 0,laEntry:h.get("laEntry")||void 0,laExpId:h.get("laExpId")||void 0}},metadata:{allowAnonymous:p||!1,tenantId:S}})}},{filter:({pathname:e})=>e.startsWith("/meet/")||e.startsWith("/v2/meet/"),execute:({deeplinkUrl:{pathname:e,search:n,origin:i},context:{coreSettings:t,loggerFactory:a},homeCloud:o})=>{var d,l,r;const m=a.newLogger("[Calling][onBeforeDeeplinkParsed][/meet]","apps-calling");null===(d=m.infoToTelemetry)||void 0===d||d.call(m,"Meet deepling condition executed.","cmd_meeting_join",void 0,!1);const{allowAnonymousMeetingJoin:c,defaultAnonTenantId:u,doNotPassTenantIdForAnonMeetingJoins:p,enableDeeplinkFlushCommand:y}=t.get(s.J.Calling),{enableXboxWatchparties:v}=t.get(s.J.WindowsSignatureExperiences);if(m.log(`Parsing pathname: ${e}, search: ${n}, allowAnonymousMeetingJoin: ${c}`),!e)return Promise.reject({message:Ho.EmptyDeeplinkUrl});const k=e.split(/[/?&]/),g=k.indexOf("meet"),N=k[g+1];if(!N||-1===g)return Promise.reject({message:Ho.MeetingCodeParse});const h=new URLSearchParams(n);let f,_;h.set("anon","true");const S=Jo(i,h);S&&(f=`${S}/_#${e}?${h.toString()}`,_=`${S}${e}${n}`);const T=h.get("deeplinkId");null===(l=m.infoToTelemetry)||void 0===l||l.call(m,`Requesting entity command. deeplinkId: ${T}`,"cmd_meeting_join",void 0,!1);const b=Go(!!y);return m.log(`Resolving ${N}`),null===(r=m.infoToTelemetry)||void 0===r||r.call(m,`Resolving meet deeplink condition, deeplinkId=${T}`,"cmd_meeting_join",void 0,!1),Promise.resolve({entityCommand:{entity:{type:De.py.callingdeeplink,action:De.uk.join,id:N},command:b,entityOptions:{deeplinkUrl:e,coordinates:{joinType:"MeetingData",meetingData:{meetingCode:N,passcode:h.get("p"),meetingUrl:_},participantPin:h.get("pp"),isAdhoc:!1,meetingCloud:qo(i,h)},directMeetingLink:f,homeCloud:o,deeplinkId:T,correlationId:h.get("correlationId")||void 0,laEntry:h.get("laEntry")||void 0,laExpId:h.get("laExpId")||void 0,isWatchParty:"true"===h.get("isWatchParty")&&v}},metadata:{allowAnonymous:c||!1,tenantId:p?void 0:u||void 0}})}},Yo,{filter:"/convene/events",execute:({deeplinkUrl:{pathname:e,search:n,origin:i},context:{coreSettings:t,loggerFactory:a}})=>{var o;const d=a.newLogger("[Calling][onBeforeDeeplinkParsed][events]","apps-calling"),{allowAnonymousMeetingJoin:l}=t.get(s.J.Calling);if(d.log(`Parsing pathname: ${e}, search: ${n}, allowAnonymousMeetingJoin: ${l}`),!e)return Promise.reject({message:Ho.EmptyDeeplinkUrl});if(!e.startsWith("/convene/events"))return Promise.reject({message:Ho.MeetingCodeParse});const r=new URLSearchParams(n);r.set("anon","true");const m=`${i}/_#${e}?${r.toString()}`,c=r.get("url");if(!c)return Promise.reject({message:Ho.MeetingCodeParse});const u=new URL(c),p=null!==(o=decodeURIComponent(u.pathname).split("/").find((e=>e.startsWith("19:"))))&&void 0!==o?o:"",y=u.searchParams.get("context");if(!y)return Promise.reject({message:Ho.MeetingCodeParse});const{Tid:k,Oid:g,prid:N}=JSON.parse(y),h=u.searchParams.get("displayName");return Promise.resolve({entityCommand:{entity:{type:De.py.events,action:De.uk.join},command:{visibilityState:v.fe.show,stateTransition:v.su.none,layoutMode:v.lO.standard,correlation:{id:(0,et.v4)(),startTimestamp:Date.now(),source:sn.D.CallingOnBeforeDeeplinkParsed}},entityOptions:{embedUrl:m,meetingUrl:c,threadId:p,messageId:"0",tenantId:k,organizerId:g,registrationId:N,displayName:h}},metadata:{allowAnonymous:l||!1,tenantId:k}})}},Zo,nd],td={shouldAddEntitiesToWindowHistory:e=>{var n,i;return(null===(n=e.mainEntity)||void 0===n?void 0:n.type)!==De.py.callingdeeplink&&(null===(i=e.mainEntity)||void 0===i?void 0:i.type)!==De.py.calls},shouldRestoreClientToEntities:e=>{var n,i;return(null===(n=e.mainEntity)||void 0===n?void 0:n.type)!==De.py.callingdeeplink&&(null===(i=e.mainEntity)||void 0===i?void 0:i.type)!==De.py.calls}};var ad=i(979176),od=i(528765);const dd={onEventReceived:({eventInput:e})=>{var n,i,t,a;switch(e.event.type){case Ze.uS.requestPersonMoreInfo:const o=null===(i=(n=e.event).data)||void 0===i?void 0:i.call(n);return Promise.resolve({command:on(o)});case ad.uS.showMonitor:return Promise.resolve({command:od.CN.showMonitor(null===(a=(t=e.event).data)||void 0===a?void 0:a.call(t))});case ad.uS.closeMonitor:return Promise.resolve({command:od.CN.closeMonitor()});case ad.uS.hideMonitor:return Promise.resolve({command:od.CN.hideMonitor()});case ad.uS.unhideMonitor:return Promise.resolve({command:od.CN.unhideMonitor()})}return Promise.resolve(void 0)}},ld=({appRenderMode:e,coreSettings:n})=>{const i=new Ee.H,{criticalPhaseTimeout:t}=n.get(s.J.Calling);return e!==Fe.S.Main||i.registerAppPhase({phase:g.nh.CRITICAL,signals:[Me.G.CALLING_SCREEN_RENDERED],timeout:t||9e4}),i.appPhases};var rd=i(56981);const sd=e=>{if(md(e))return ud(e)?{subNavEntity:pd(e),headerEntity:yd(e),startEntity:vd(e),mainEntity:kd(e),endEntity:gd(e)}:null},md=({layoutMode:e,entity:n,contextEntity:i})=>{const{action:t=null,type:a}=Object.assign({},n),o=[v.lO.focus,v.lO.standard].includes(e),d=[De.py.callingdeeplink,De.py.calls,De.py.callsmonitor,De.py.meetings,De.py.events,De.py.meetingcollaboration,De.py.meetingroomallinonecall,De.py.yammerqna].includes(a),l=[De.uk.create,De.uk.default,De.uk.list,De.uk.view,De.uk.join],r=t&&l.includes(t)||a===De.py.callingdeeplink&&!t&&!!i;return!!(o&&d&&r)},cd=[De.py.identity,De.py.tflfre],ud=({contextEntity:e})=>!e||!cd.includes(e.type),pd=()=>null,yd=({entity:e,contextEntity:n})=>e.type===De.py.callingdeeplink||e.type===De.py.events?n||null:e,vd=()=>null,kd=({entity:e,contextEntity:n})=>e.type===De.py.callingdeeplink&&(null==n?void 0:n.type)===De.py.calls?n:e,gd=({contextEntity:e})=>{const n=[De.py.byodchat,De.py.chats,De.py.devicesettings,De.py.meetings,De.py.extensions,De.py.transcript,De.py.meetingdetails,De.py.roster,De.py.byodroster,De.py.breakoutroomspanel,De.py.yammerqna,De.py.accessibilitypanel,De.py.meetingcollaboration,De.py.closedcaptionssettings,De.py.videobackgrounds,De.py.extensibilityapppickercallingpanel,De.py.stagecustomizationpanel,De.py.roomremote,De.py.audiosettings,De.py.videoeffectsandsettings];return e&&e.action&&n.includes(e.type)||(null==e?void 0:e.action)===De.uk.info&&(null==e?void 0:e.type)===De.py.calls||(null==e?void 0:e.action)===De.uk.health&&(null==e?void 0:e.type)===De.py.calls?e:null},Nd=({entity:e,coreSettings:n,themeOptions:i})=>{var t;const{enableLightThemeSupport:a=!1,forceDisableTitleBar:o=!1,renderHeaderAtBottomForCalls:d=!1,enableSmartDeviceLayout:l=!1,monitorSlotPosition:r=rd.Y.BottomRight}=null!==(t=null==n?void 0:n.get(s.J.Calling))&&void 0!==t?t:{},m=new Set([De.py.calls,De.py.meetingroomallinonecall]),c=null==i?void 0:i.isCallingWindowDarkTheme;return(null==e?void 0:e.type)===De.py.callsmonitor||(null==e?void 0:e.type)===De.py.callingdialog?{mainEntity:{[Fe.S.Main]:{disableNotificationsBanners:!0,forceDisableTitleBar:!!o,doesHeaderOverlapMain:!1,isBackgroundTransparent:!0,isThemePinnedToDarkOrHighContrast:!a||c,UNSAFE_enablePptProvider:!0}},headerEntity:{[Fe.S.HorizontalBar]:{slotHeightOverrides:"5.4rem",doesHeaderOverlapMain:!1,isBackgroundTransparent:!0}}}:{mainEntity:{[Fe.S.Main]:{forceDisableTitleBar:!!o,doesHeaderOverlapMain:!1,isBackgroundTransparent:!0,isThemePinnedToDarkOrHighContrast:!a||c,canOverrideMeetingTheme:!1,UNSAFE_enablePptProvider:!0}},headerEntity:{[Fe.S.HorizontalBar]:{slotHeightOverrides:"auto",doesHeaderOverlapMain:!1,isBackgroundTransparent:!1,renderHeaderAtBottom:!(!d&&!l||void 0===(null==e?void 0:e.type)||!m.has(e.type))}},endEntity:{[Fe.S.Rail]:{doesHeaderOverlapMain:(null==e?void 0:e.type)===De.py.videobackgrounds,isBackgroundTransparent:!!e&&hd.includes(e.type),isHideInfoPaneDisabled:!0}},monitorEntity:{[Fe.S.Monitor]:{areaRectangle:{height:"auto",position:r,width:"32rem"},draggableAreaHeight:"3.2rem"}}}},hd=[De.py.videobackgrounds,De.py.videoeffectsandavatar,De.py.videoeffectscustomization,De.py.videoeffectsmoreview,De.py.stylemyroom,De.py.videoeffectsandsettings],fd={id:"com.microsoft.teams.calling",name:"Calls",supportedEntities:[De.py.callingdeeplink,De.py.callingdeeplinkDialog,De.py.callingprotocoldeeplinkdialog,De.py.calls,De.py.callscontent,De.py.callsgallery,De.py.callsgalleryandcontent,De.py.meetingroomallinonecall,De.py.callsmonitor,De.py.cameraeffects,De.py.contentcamerasetup,De.py.callingalertdialog,De.py.callingdialog,De.py.callingbannernotification,De.py.callingconfirmdialog,De.py.unparkcalldialog,De.py.usermediadialog,De.py.devicesettings,De.py.audiosettings,De.py.notes,De.py.mediastreams,De.py.meetingdetails,De.py.meetings,De.py.meetingstream,De.py.roster,De.py.pstncallmedialog,De.py.videobackgrounds,De.py.stylemyroom,De.py.broadcastqna,De.py.transcript,De.py.shareMeetingInfo,De.py.stagecontent,De.py.breakoutroomspanel,De.py.invisionwhiteboard,De.py.videoeffectscustomization,De.py.videoeffectsmoreview,De.py.videoeffectsandavatar,De.py.videoeffectsandsettings,De.py.windowingerrordialog,De.py.restartrecomendeddialog,De.py.stagingroomstartmeetingconfirmationdialog,De.py.meshavatar,De.py.events,De.py.yammerqna,De.py.roomremote,De.py.accessibilitypanel,De.py.closedcaptionssettings,De.py.meetingcollaboration,De.py.presentdeeplinknomeetingcontextdialog,De.py.floatingmonitor,De.py.byodattendeewindow,De.py.stagecustomizationpanel,De.py.byodroster,De.py.extensibilityapppickercallingpanel],supportedRenderModes:[Fe.S.HorizontalBar,Fe.S.Main,Fe.S.Modal,Fe.S.Rail,Fe.S.Monitor],windowFeatures:{otherEntityTypes:{minWidth:800,width:800,minHeight:670,height:600},[De.py.callingdialog]:{width:700,height:400,top:300,left:400,additionalFeatures:{alwaysOnTop:"true",resizable:"false",transparent:"true"}},[De.py.callsmonitor]:{height:247,width:304,additionalFeatures:{alwaysOnTop:"true",resizable:"false",fullscreenable:"false",maximizable:"false",closable:"false",hideWindowControl:"true",frame:"false",contentprotection:"true",excludeWindowFromScreenSharing:"true",closeoverride:"true"}},[De.py.byodattendeewindow]:{minWidth:800,width:800,minHeight:600,height:600,additionalFeatures:{contentprotection:"true",excludeWindowFromScreenSharing:"true"}}},shouldErrorOnEntityCommandTimeout:!0},_d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"triggerCallingToastAction"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"notificationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"triggerCallingToastAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"notificationId"},value:{kind:"Variable",name:{kind:"Name",value:"notificationId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"actionType"},value:{kind:"Variable",name:{kind:"Name",value:"actionType"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]},Sd={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"fireCallingIntent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntentInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fireCallingIntent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntent"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntentInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntent"}}}]}}]},Td={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingMoveUpcomingMeetingToPastMeetingsMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"moveUpcomingMeetingToPastMeetings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}]}}]};var bd=i(659726),Cd=i(412183),wd=i(923975);const Id={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallingTriggerBannerActionMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bannerId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BannerAction"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"triggerBannerAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"bannerId"},value:{kind:"Variable",name:{kind:"Name",value:"bannerId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"actionName"},value:{kind:"Variable",name:{kind:"Name",value:"actionName"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BannerAction"}}}}],__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]}}]},Ad={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCallingBroadcastRoleQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"roleHint"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"joinId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"broadcast"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"roleHint"},value:{kind:"Variable",name:{kind:"Name",value:"roleHint"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"Argument",name:{kind:"Name",value:"joinId"},value:{kind:"Variable",name:{kind:"Name",value:"joinId"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"userRole"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BroadcastParticipantRole"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"byoe"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isEnabled"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"BYOEDetails"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"streamResource"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"encoderSource"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"StreamResource"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Broadcast"}}}}]}}]};var Fd=i(516909);const Dd={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCallingCallByCallIdQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamsCallIdByCallId"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callId"},value:{kind:"Variable",name:{kind:"Name",value:"callId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}]}}]},Ed={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCallingCallMeetingInfoQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callMeetingInfo"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tenantId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"organizerId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"threadId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"CallMeetingInfo"}}}]}}]},Md=(e,n,i,a)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var o,d;const{enableAppOnBeforeCommandHandledExtraTelemetry:l}=e.coreSettings.get(s.J.Calling);if(l&&(null===(o=a.infoToTelemetry)||void 0===o||o.call(a,`handleBroadcastDeeplink. correlationId=${n.command.correlation.id}`,"app_on_before_command_handled_info")),!n.entityOptions){const e="[handleDeeplink] No entity options";return a.error(e),Promise.reject(e)}const{coordinates:r,roleHint:m}=n.entityOptions,{tenantId:u,organizerId:p,conversationId:y,messageId:k,broadcast:g}=r,{allowBroadcastProducerJoinsInT2:N}=e.coreSettings.get(s.J.Broadcast),h=`${u}__${p}__${y}__${k}`,f=yield((e,n,i,a,o,d)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const t=e.newScenario(c.RG.BroadcastResolveRole);t.appendEventData({correlationId:o});try{const{data:e}=yield n.query({query:Ad,variables:{id:i,roleHint:a,joinId:o}});return d.log(`[getBroadcastRole] userRole: ${e.broadcast.userRole}`),t.stop({"Call.BroadcastRole":e.broadcast.userRole}),e.broadcast}catch(e){return d.log("[getBroadcastRole] error: broadcastRoleQuery failed"),t.fail({"Call.BroadcastRole":null,broadcastError:"broadcastRoleQuery failed"}),{userRole:Fd.tf.None,streamResource:null,byoe:null}}})))(e.scenarioFactory,i,h,m,n.command.correlation.id,a),_=(null==g?void 0:g.role)||f.userRole;return Rd(f,_,e,N||!1)?(null===(d=a.infoToTelemetry)||void 0===d||d.call(a,`[handleBroadcastMeetingRedirect] launch launchUnsupportedDeeplink with userRole - ${_} and correlationId ${n.command.correlation.id} succeeded`,"cmd_meetings_virtual_events_broadcast_trigger_unsupported_deeplink_dialog_success"),Object.assign(Object.assign({},n),{entity:Object.assign(Object.assign({},n.entity),{type:De.py.unsupporteddeeplinkdialog,action:De.uk.view}),command:Object.assign(Object.assign({},n.command),{layoutMode:v.lO.standard,stateTransition:v.su.extend,visibilityState:v.fe.show})})):Pd(_,N||!1)?(n.entityOptions=Object.assign(Object.assign({},n.entityOptions),{coordinates:Object.assign(Object.assign({},r),{broadcast:{role:_}})}),Od(e,n,a)):Object.assign(Object.assign({},n),{entity:Object.assign(Object.assign({},n.entity),{id:h,type:De.py.broadcasts,action:De.uk.view}),command:Object.assign(Object.assign({},n.command),{visibilityState:v.fe.show,stateTransition:v.su.new,layoutMode:v.lO.focus}),entityOptions:Object.assign(Object.assign({},n.entityOptions),{threadId:y,messageId:k,tenantId:u,organizerId:p})})})),Pd=(e,n)=>e===Fd.tf.Contributor||e===Fd.tf.Producer&&n,Rd=(e,n,i,t)=>{var a,o,d,r,s;return n===Fd.tf.Producer&&!t||n===Fd.tf.Contributor&&(null===(a=i.platformService)||void 0===a?void 0:a.config.clientType)===l.Bh.Web||!!(null===(o=e.byoe)||void 0===o?void 0:o.isEnabled)&&null===(null===(d=e.streamResource)||void 0===d?void 0:d.encoderSource)||n!==Fd.tf.Contributor&&!!(null===(r=e.byoe)||void 0===r?void 0:r.isEnabled)&&"teams"===(null===(s=e.streamResource)||void 0===s?void 0:s.encoderSource)},Od=(e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t;const{coordinates:a}=n.entityOptions,o=Za.getDeeplinkEntityLocked(),{enableAppOnBeforeCommandHandledExtraTelemetry:d}=e.coreSettings.get(s.J.Calling);if(d&&(null===(t=i.infoToTelemetry)||void 0===t||t.call(i,`handleLockedDeeplink. coordinates=${JSON.stringify(a)} - locked=${o}`,"app_on_before_command_handled_info")),o||!o&&Za.getCallingAppEventsSubscribed())return Za.getDeeplinkReady()&&(i.log("[handleDeeplink] awaiting getDeeplinkReady"),yield Za.getDeeplinkReady()),$d(e,n,i);const{conversationId:l,rootMessageId:r}=a,m=`${l}/${r}`;if(!m){const e="[handleDeeplink] Deeplink entity cannot be locked because lockId is undefined";return i.error(e),Promise.reject(e)}return i.log("[handleDeeplink] lockDeeplinkEntity"),Za.lockDeeplinkEntity(m),n})),$d=(e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t;const a=n.entityOptions,{coordinates:o,deeplinkId:d}=a,{enableAppOnBeforeCommandHandledExtraTelemetry:l}=e.coreSettings.get(s.J.Calling);l&&(null===(t=i.infoToTelemetry)||void 0===t||t.call(i,`handleDeeplink. coordinates=${JSON.stringify(o)} - deeplinkId=${d} - correlationId=${n.command.correlation.id}`,"app_on_before_command_handled_info"));const r=(0,wd.sM)(o,d);return i.log("[handleDeeplink] triggering fireCallingIntent mutation"),e.client.mutate({mutation:Sd,variables:{callingIntent:r}}).then((()=>{i.log("[handleDeeplink] fireCallingIntent succeeded")})).catch((e=>(i.error(`failed to fireCallingintent with ${(0,bd.A)(e)}`),Promise.reject(e))))})),Ld=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:n,entityCommand:{entity:{type:i,action:a},dataOptions:o},requestContext:d,requestContext:{client:l}}=e,{allowBroadcastPresenterJoinsInT2:r,allowBroadcastProducerJoinsInT2:m}=d.coreSettings.get(s.J.Broadcast),{enableMeetNowLinksReminder:c}=d.coreSettings.get(s.J.Host),{enableAppOnBeforeCommandHandledExtraTelemetry:u}=d.coreSettings.get(s.J.Calling),p=d.loggerFactory.newLogger("CallingOnBeforeCommandHandled","apps-calling");if(qd(p,`CallingOnBeforeCommandHandled. type=${i} - action=${a} - correlationId=${n.command.correlation.id}`,!!u),Vd(i,a))return Wd(d,n,p);if(((e,n)=>e===De.py.callingbannernotification&&n===De.uk.join)(i,a))return((e,n)=>{const i=e.loggerFactory.newLogger("CallingBannerCommandHandler[handleBannerPrimaryAction]","apps-calling");if(!n.entityOptions){const e=`Error when handling banner's primary action, join click since entity options is undefined for entityId=${n.entity.id}, entityType=${n.entity.type} and entityAction=${n.entity.action}`;return i.error(e),Promise.reject(new Error(e))}return e.client.mutate({mutation:Id,variables:{bannerId:n.entity.id,actionName:"PrimaryAction"}})})(d,n);if(((e,n)=>e===De.py.callingbannernotification&&n===De.uk.delete)(i,a))return((e,n)=>{const i=e.loggerFactory.newLogger("CallingBannerCommandHandler[handleBannerDismiss]","apps-calling");if(!n.entityOptions){const e=`Error when handling banner dismiss since entity options is undefined for entityId=${n.entity.id}, entityType=${n.entity.type} and entityAction=${n.entity.action}`;return i.error(e),Promise.reject(new Error(e))}return e.client.mutate({mutation:Id,variables:{bannerId:n.entity.id,actionName:"DismissAction"}})})(d,n);if(Bd(i,a,n.entityOptions||{}))return Md(d,n,l,p);if(Ud(i,a)){const{coordinates:e}=n.entityOptions,i=Za.getDeeplinkEntityLocked();if(qd(p,`shouldHandleDeeplink. coordinates=${JSON.stringify(n.entityOptions)}} - locked=${i} - correlationId=${n.command.correlation.id}`,!!u),i||!i&&Za.getCallingAppEventsSubscribed())return Za.getDeeplinkReady()&&(yield(e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){e.log("[handleDeeplink] awaiting getDeeplinkReady"),yield Za.getDeeplinkReady()})))(p)),c&&(yield((e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t;return e.mutate({mutation:Td,variables:{id:null===(t=i.entityOptions)||void 0===t?void 0:t.deeplinkId}}).catch((()=>{var e;return null===(e=n.errorToTelemetry)||void 0===e||e.call(n,"[CallingToastActionMutationFailed] failed","calling_deeplink_navigation"),Promise.reject(io.f.CallingToastActionMutationFailed)}))})))(l,p,n)),Hd(d,n,p);const a=(0,Cd.N6)(e)?`${e.conversationId}/${e.rootMessageId}`:e.meetingData.meetingCode||(e.meetingData.meetingUrl?(e=>{const n=e.split(/[/?&]/);return n[n.indexOf("meet")+1]})(e.meetingData.meetingUrl):void 0);if(!a)return(e=>{var n;const i="[handleDeeplink] Deeplink entity cannot be locked because lockId is undefined";return null===(n=e.errorToTelemetry)||void 0===n||n.call(e,i,"calling_deeplink_navigation"),Promise.reject(i)})(p);qd(p,`[handleDeeplink] lockDeeplinkEntity. lockId=${a} - correlationId=${n.command.correlation.id}`,!!u),Za.lockDeeplinkEntity(a)}return o&&xd(i,a,o)?Gd(o,r,m,l,n):Promise.resolve(n)})),xd=(e,n,i)=>!!jd(i)&&(!!i.toastId&&e===De.py.calls&&n===De.uk.mutate&&"Unknown"!==i.actionType),Bd=(e,n,i)=>e===De.py.callingdeeplink&&n===De.uk.join&&!!i.isBroadcastMeeting,jd=e=>void 0!==e.toastId,Ud=(e,n)=>e===De.py.callingdeeplink&&n===De.uk.join,Vd=(e,n)=>e===De.py.meetings&&n===De.uk.join,Wd=(e,n,i)=>{const{enableAppOnBeforeCommandHandledExtraTelemetry:t}=e.coreSettings.get(s.J.Calling);if(qd(i,`handleMeetingJoin. correlationId=${n.command.correlation.id}`,!!t),!n.entityOptions||!n.entityOptions.callingIntent){const e=`entityOptions must be of type IMeetingJoinOptions. entity.id=${n.entity.id} - correlationId=${n.command.correlation.id} - source=${n.command.correlation.source}`;return qd(i,e,!!t,!0),Promise.reject(e)}const{callingIntent:a}=n.entityOptions,{correlation:o}=n.command;return qd(i,`[handleMeetingJoin] triggering fireCallingIntent mutation. correlationId=${o.id}`,!!t),Jd(e,i,a,o.id)},Hd=(e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{enableAppOnBeforeCommandHandledExtraTelemetry:t}=e.coreSettings.get(s.J.Calling);if(qd(i,`handleDeeplink. correlationId=${n.command.correlation.id}`,!!t),!n.entityOptions){const e="[handleDeeplink] No entity options";return qd(i,e,!!t,!0),Promise.reject(e)}const{correlation:a}=n.command,o=n.entityOptions,{coordinates:d,deeplinkId:l,isWatchParty:r,homeCloud:m,correlationId:c}=o;let u;return u=r?(0,wd.W5)(l):(0,wd.sM)(d,l,m,c),qd(i,"[handleDeeplink] triggering fireCallingIntent mutation",!!t),Jd(e,i,u,a.id)})),Gd=(e,n,i,a,o)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const d=e,l=d.toastId,r=d.actionType;return r?"AcceptIncomingCallThroughPrejoin"===r&&n&&!i&&(yield((e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var i,t,a,o,d;if(!e||!n)return!1;const{data:l}=yield n.query({query:Dd,variables:{callId:e}});if(!l||!l.teamsCallIdByCallId)return!1;const{data:r}=yield n.query({query:Ed,variables:{id:l.teamsCallIdByCallId}});if(!r||!r.callMeetingInfo)return!1;const s=(0,xi.l0)(null===(i=r.callMeetingInfo)||void 0===i?void 0:i.tenantId,null===(t=r.callMeetingInfo)||void 0===t?void 0:t.organizerId,null===(a=r.callMeetingInfo)||void 0===a?void 0:a.threadId,null===(o=r.callMeetingInfo)||void 0===o?void 0:o.messageId),{data:m}=yield n.query({query:Ad,variables:{id:s}});return(null===(d=null==m?void 0:m.broadcast)||void 0===d?void 0:d.userRole)===Fd.tf.Producer})))(d.callId,a))?Promise.resolve(Object.assign(Object.assign({},o),{entity:Object.assign(Object.assign({},o.entity),{type:De.py.unsupporteddeeplinkdialog,action:De.uk.view}),command:Object.assign(Object.assign({},o.command),{layoutMode:v.lO.standard,stateTransition:v.su.extend,visibilityState:v.fe.show})})):a.mutate({mutation:_d,variables:{notificationId:l,actionType:r}}).then((()=>{})).catch((()=>Promise.reject(io.f.CallingToastActionMutationFailed))):Promise.reject(io.f.CallsActionTypeToNotificationActionFailed)})),Jd=(e,n,i,a)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{enableAppOnBeforeCommandHandledExtraTelemetry:t}=e.coreSettings.get(s.J.Calling),o=Qd(i),d=zd(e.scenarioFactory,o,a);return e.client.mutate({mutation:Sd,variables:{callingIntent:o},context:{correlationId:a}}).then((()=>{qd(n,`fireCallingIntent succeeded. correlationId=${a}`,!!t)})).catch((e=>{const i=`failed to fireCallingintent with ${(0,bd.A)(e)}`;return qd(n,i,!!t,!0),d.fail({message:i}),Promise.reject(e)}))})),qd=(e,n,i=!1,t=!1)=>{var a,o;t?(e.error(n),i&&(null===(a=e.errorToTelemetry)||void 0===a||a.call(e,n,"app_on_before_command_handled_info"))):(e.log(n),i&&(null===(o=e.infoToTelemetry)||void 0===o||o.call(e,n,"app_on_before_command_handled_info")))},zd=(e,n,i)=>{var t,a;const o=e.newScenario(c.RG.FireCallingIntent),d=n.coordinates,l=null===(t=n.joinOptions)||void 0===t?void 0:t.meeting;return o.appendEventData({secondaryCorrelationId:i,context:(null===(a=n.joinOptions)||void 0===a?void 0:a.context)||""}),l&&o.appendEventData({correlationId:l.correlationId||"",homeCloud:l.homeCloud||"",deeplinkId:l.deeplinkId||""}),d.legacyMeeting?o.appendEventData({threadId:d.legacyMeeting.conversationId,messageId:d.legacyMeeting.messageId,organizerId:d.legacyMeeting.organizerId,meetingTenantId:d.legacyMeeting.tenantId}):d.meetingData&&o.appendEventData({meetingCode:d.meetingData.meetingCode||""}),o},Qd=e=>{var n;return(null===(n=e.joinOptions)||void 0===n?void 0:n.meeting)?Object.assign(Object.assign({},e),{joinOptions:Object.assign(Object.assign({},e.joinOptions),{meeting:Object.assign(Object.assign({},e.joinOptions.meeting),{correlationId:e.joinOptions.meeting.correlationId||e.joinOptions.meeting.deeplinkId||(0,et.v4)()})})}):e};var Yd,Kd=i(342737);!function(e){e.Success="Success",e.Failure="Failure"}(Yd||(Yd={}));const Xd=[De.py.calls,De.py.callsgalleryandcontent,De.py.callscontent,De.py.callsgallery,De.py.meetingroomallinonecall],Zd=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n;const{entityCommand:{entity:{type:i,action:t},command:{visibilityState:a,correlation:o}},requestContext:{coreSettings:d,loggerFactory:l}}=e,r=l.newLogger("CallingApp[onCommandResult]","apps-calling"),{enableCallingAppCommandResolvedHook:m,enableBlockUnsanctionedAppEventsResolution:c,enableCallingAppEventLogging:u}=d.get(s.J.Calling);if(m&&(Xd.includes(i)&&t===De.uk.view)){if(c&&!o.id.includes("calling-app-event")){const e=`CMD windowing triggered outside of calling app event. [correlationId:${o.id}, source:${o.source}, correlatedScenario:${o.scenarioName}]`;return void(u?null===(n=r.errorToTelemetry)||void 0===n||n.call(r,e,"cmd_horizontals_app_events",void 0,!0):r.warn(e))}if(r.log(`[onCommandResult] Windowing command with visibilityState: ${a}, correlation: ${o.id}, type: ${i}, action: ${t}`),a===v.fe.show)return el(e)}})),el=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:{entity:{id:n},command:{correlation:{id:i}}},result:t,requestContext:{client:a,loggerFactory:o,scenarioFactory:d,error:l}}=e,r=o.newLogger("CallingApp[onCommandResult]","apps-calling");let s,m;if(t===Kd.P.Failure){s=Yd.Failure;const e=n?d.findScenarioByNameAndId(c.RG.CallingWindowPopoutIntent,n):void 0;null==e||e.mark("OnAfterCommandResolved"),null==e||e.appendEventData({errorCode:(null==l?void 0:l.errorCode)||gn.jK.CallingCallsViewCommandError,message:(null==l?void 0:l.errorMessage)||"[onCommandResult] Window Rendering command for a call resulted in Failure or Incomplete.",context:"CallingApp"}),m=nl(s,i,n,l)}else s=Yd.Success,m=nl(s,i,n);try{yield no(m,a,r)}catch(l){throw r.error(`[handleCallingWindowingContentEvent] Error when reporting event "${s}" [entity.id=${n}, error.name=${l.name}, error.message=${l.message}]`),new Error(`onCommandResult[error.name=${l.name},error.message=${l.message}]::resolveCallingAppEvent::${s}`)}})),nl=(e,n,i,t)=>e===Yd.Success?{eventId:n,resolution:{success:{_:!0}},context:{source:{name:"WindowingCommandingSuccess",description:`Windowing command resolved successfully [eventId=${n}, entity.id=${i}]`}}}:{eventId:n,resolution:{error:{name:(null==t?void 0:t.errorCode)||gn.jK.CallingCallsViewCommandError,message:(null==t?void 0:t.errorMessage)||`[onCommandResult] calls-view command resolved with an error [eventId=${n}][entity.id=${i}]`}},context:{source:{name:"WindowingCommandingTriggerError",description:`Error processing windowing command [eventId=${n}, entity.id=${i}, error.errorCode=${null==t?void 0:t.errorCode}, error.message=${null==t?void 0:t.errorMessage}]`}}};var il=i(306244);const tl=e=>{const{entity:{type:n,action:i}}=e;if(n===De.py.calls&&i===De.uk.view)return c.RG.CallingEntityCommandCallsView};var al=i(390698),ol=i(469025),dl=i(394347),ll=i(761517),rl=i(554694),sl=i(132333),ml=i(464208),cl=i(869938),ul=i(614545);const pl=(0,zn.s)({isWebCallMonitorWrapper:{Bbmb7ep:["fclariu","fyjfh2l"],Beyfa6y:["fyjfh2l","fclariu"],B7oj6ja:["f11xeu6h","f1knf8zw"],Btl43ni:["f1knf8zw","f11xeu6h"],B4j52fo:"ftac7j7",Bekrc4i:["f1w0yd9v","f1h0xgbp"],Bn0qgzm:"fdwcyh7",ibv6hh:["f1h0xgbp","f1w0yd9v"],icvyot:"fzkkow9",vrafjx:["fcdblym","fjik90z"],oivjwe:"fg706s2",wvpqe5:["fjik90z","fcdblym"],g2u3we:"fgybt4j",h3c5rm:["fm8sagc","f10vrri"],B9xav0g:"f1pr7p4w",zhjwy3:["f10vrri","fm8sagc"],Bqenvij:"fk3a66p",a9b677:"fly5x3f"},isWebCallMonitorWrapperWithinMCM:{Bqenvij:"fk3a66p",a9b677:"fly5x3f"},isWebCallMonitorUbar:{a9b677:"fly5x3f",Bqenvij:"fyhdfh7"},isWebCallMonitorCallingScreen:{a9b677:"fly5x3f",Bqenvij:"f1l02sjl"}},{d:[".fclariu{border-bottom-right-radius:3px;}",".fyjfh2l{border-bottom-left-radius:3px;}",".f11xeu6h{border-top-right-radius:3px;}",".f1knf8zw{border-top-left-radius:3px;}",".ftac7j7{border-top-width:2px;}",".f1w0yd9v{border-right-width:2px;}",".f1h0xgbp{border-left-width:2px;}",".fdwcyh7{border-bottom-width:2px;}",".fzkkow9{border-top-style:solid;}",".fcdblym{border-right-style:solid;}",".fjik90z{border-left-style:solid;}",".fg706s2{border-bottom-style:solid;}",".fgybt4j{border-top-color:var(--colorStrokeFocus2);}",".fm8sagc{border-right-color:var(--colorStrokeFocus2);}",".f10vrri{border-left-color:var(--colorStrokeFocus2);}",".f1pr7p4w{border-bottom-color:var(--colorStrokeFocus2);}",".fk3a66p{height:25.7rem;}",".fly5x3f{width:100%;}",".fyhdfh7{height:7.2rem;}",".f1l02sjl{height:100%;}"]});var yl=i(377509);const vl=({ubar:e,callingScreen:n})=>{const i=(0,yl.NC)(s.J.Calling),t=pl(),{intentIdOverride:a}=(0,ol.Te)();return a?(0,Ie.t)(dl.k,Object.assign({"data-tid":"floating-call-monitor",column:!0,className:i.enableMultiCallMonitorForWeb?t.isWebCallMonitorWrapperWithinMCM:t.isWebCallMonitorWrapper},{children:[(0,Ie.t)(ul.W,Object.assign({className:t.isWebCallMonitorUbar},{children:e})),(0,Ie.t)(ul.W,Object.assign({className:t.isWebCallMonitorCallingScreen},{children:n}))]})):null},kl=({ubar:e,callingScreen:n})=>{const i=(0,yl.NC)(s.J.Calling),{id:t}=(0,al.sV)().getEntityOptions(De.py.floatingmonitor,De.uk.view);return i.enableMultiCallMonitorForWeb?(0,Ie.t)(dl.k,Object.assign({"data-tid":"floating-monitor",column:!0},{children:(0,Ie.t)(vl,{ubar:e,callingScreen:n})})):(0,Ie.t)(ol.UN,Object.assign({intentIdOverride:t},{children:(0,Ie.t)(dl.k,Object.assign({"data-tid":"floating-monitor",column:!0},{children:(0,Ie.t)(vl,{ubar:e,callingScreen:n})}))}))},gl=(0,zn.s)({isWebMultiCallMonitorWrapper:{a9b677:"fly5x3f",Bqenvij:"f1l02sjl",De3pzq:"f1dmdbja",Bbmb7ep:["fclariu","fyjfh2l"],Beyfa6y:["fyjfh2l","fclariu"],B7oj6ja:["f11xeu6h","f1knf8zw"],Btl43ni:["f1knf8zw","f11xeu6h"],B4j52fo:"ftac7j7",Bekrc4i:["f1w0yd9v","f1h0xgbp"],Bn0qgzm:"fdwcyh7",ibv6hh:["f1h0xgbp","f1w0yd9v"],icvyot:"fzkkow9",vrafjx:["fcdblym","fjik90z"],oivjwe:"fg706s2",wvpqe5:["fjik90z","fcdblym"],g2u3we:"fgybt4j",h3c5rm:["fm8sagc","f10vrri"],B9xav0g:"f1pr7p4w",zhjwy3:["f10vrri","fm8sagc"]},isIconWrapper:{a9b677:"fly5x3f",Bqenvij:"f3ra7uv",De3pzq:"f1dmdbja",Brf1p80:"f4d9j23",Bt984gj:"f122n59"}},{d:[".fly5x3f{width:100%;}",".f1l02sjl{height:100%;}",".f1dmdbja{background-color:var(--colorNeutralBackground2);}",".fclariu{border-bottom-right-radius:3px;}",".fyjfh2l{border-bottom-left-radius:3px;}",".f11xeu6h{border-top-right-radius:3px;}",".f1knf8zw{border-top-left-radius:3px;}",".ftac7j7{border-top-width:2px;}",".f1w0yd9v{border-right-width:2px;}",".f1h0xgbp{border-left-width:2px;}",".fdwcyh7{border-bottom-width:2px;}",".fzkkow9{border-top-style:solid;}",".fcdblym{border-right-style:solid;}",".fjik90z{border-left-style:solid;}",".fg706s2{border-bottom-style:solid;}",".fgybt4j{border-top-color:var(--colorStrokeFocus2);}",".fm8sagc{border-right-color:var(--colorStrokeFocus2);}",".f10vrri{border-left-color:var(--colorStrokeFocus2);}",".f1pr7p4w{border-bottom-color:var(--colorStrokeFocus2);}",".f3ra7uv{height:1.5rem;}",".f4d9j23{justify-content:center;}",".f122n59{align-items:center;}"]});var Nl=i(489390),hl=i(118418),fl=i(466149),_l=i(347600),Sl=i(965116),Tl=i(373241),bl=i(136209),Cl=i(194053),wl=i(959394),Il=i(124910),Al=i(507884);const Fl=(0,zn.s)({isMultiCallListItemWrapper:{Bt984gj:"f122n59",a9b677:"fly5x3f",Bqenvij:"fyw3hzw",jrapky:"f1itd6yx",B6of3ja:"f10kaskc",De3pzq:"f1dmdbja",z8tnut:"fttrv26",z189sj:["fymo3i9","ff1nj48"],Byoj8tv:"f6p0d5s",uwmqm3:["ff1nj48","fymo3i9"]},isMultiCallListItemButtonContainer:{Brf1p80:"f9c4gz4",a9b677:"f43i5ed"},isResumeCallButton:{Jwef8y:"ftrin2t",ecr2s2:"fazgzzr",iro3zm:"ff7k10l",f5ssp4:"f1kntyx9"},isLeaveCallButton:{Jwef8y:"fpsin02",ecr2s2:"f1au4jtj",iro3zm:"fmvue4i",f5ssp4:"f1mcyvn2",t0hwav:"f14p701a",g1a405:"fabs2s9",B1wtsvt:["f13fn5ob","f757zx4"],dm7nc1:"f17rcxh0",n6tcun:["f757zx4","f13fn5ob"]},isStatusText:{sj55zd:"f11d4kpn"},isCallInfo:{Haddrg:"f14ujvnu",a9b677:"fr584hq",Frg6f3:["f9swhlu","f1wift5j"],t21cq0:["f1wift5j","f9swhlu"]},isCallTitle:{B68tc82:"f1p9o1ba",Bmxbyg5:"f1sil6mw",Huce71:"fz5stix"}},{d:[".f122n59{align-items:center;}",".fly5x3f{width:100%;}",".fyw3hzw{height:6rem;}",".f1itd6yx{margin-bottom:0.1rem;}",".f10kaskc{margin-top:0.1rem;}",".f1dmdbja{background-color:var(--colorNeutralBackground2);}",".fttrv26{padding-top:1.5rem;}",".fymo3i9{padding-right:1.5rem;}",".ff1nj48{padding-left:1.5rem;}",".f6p0d5s{padding-bottom:1.5rem;}",".f9c4gz4{justify-content:flex-end;}",".f43i5ed{width:30%;}",".f11d4kpn{color:var(--colorNeutralForeground3);}",".f14ujvnu{over-flow:hidden;}",".fr584hq{width:50%;}",".f9swhlu{margin-left:1.5rem;}",".f1wift5j{margin-right:1.5rem;}",".f1p9o1ba{overflow-x:hidden;}",".f1sil6mw{overflow-y:hidden;}",".fz5stix{white-space:nowrap;}"],h:[".ftrin2t:hover{background-color:var(--colorCompoundBrandForeground1);}",".ff7k10l:hover:active{background-color:var(--colorCompoundBrandForeground1);}",".fpsin02:hover{background-color:var(--colorPaletteRedBackground3);}",".fmvue4i:hover:active{background-color:var(--colorPaletteRedBackground3);}"],a:[".fazgzzr:active{background-color:var(--colorCompoundBrandForeground1);}",".f1au4jtj:active{background-color:var(--colorPaletteRedBackground3);}"],f:[".f1kntyx9:focus{background-color:var(--colorCompoundBrandForeground1);}",".f1mcyvn2:focus{background-color:var(--colorPaletteRedBackground3);}",".f14p701a:focus{color:var(--colorNeutralForeground1Selected);}",".fabs2s9:focus{border-top-color:var(--colorNeutralStroke1Selected);}",".f13fn5ob:focus{border-right-color:var(--colorNeutralStroke1Selected);}",".f757zx4:focus{border-left-color:var(--colorNeutralStroke1Selected);}",".f17rcxh0:focus{border-bottom-color:var(--colorNeutralStroke1Selected);}"]});var Dl=i(165690);const El={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsWebMultiCallMonitorGetCallTitleQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getCallTitle"},arguments:[{kind:"Argument",name:{kind:"Name",value:"teamsCallId"},value:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]}}]},Ml={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsWebMultiCallMonitorGetParticipantsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"participantCount"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nParticipants"},arguments:[{kind:"Argument",name:{kind:"Name",value:"teamsCallId"},value:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"participantCount"},value:{kind:"Variable",name:{kind:"Name",value:"participantCount"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"User"}}}}}]}}]},Pl={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ComponentsWebMultiCallMonitorToggleHoldCallMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context"}},type:{kind:"NamedType",name:{kind:"Name",value:"ToggleHoldCallContext"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toggleHoldCall"},arguments:[{kind:"Argument",name:{kind:"Name",value:"teamsCallId"},value:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"context"},value:{kind:"Variable",name:{kind:"Name",value:"context"}},__type:{kind:"NamedType",name:{kind:"Name",value:"ToggleHoldCallContext"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Call"}}}]}}]},Rl={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ComponentsWebMultiCallMonitorStopCallMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"stopOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"StopOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"stopCall"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callId"},value:{kind:"Variable",name:{kind:"Name",value:"callId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"context"},value:{kind:"Variable",name:{kind:"Name",value:"context"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"stopOptions"},value:{kind:"Variable",name:{kind:"Name",value:"stopOptions"}},__type:{kind:"NamedType",name:{kind:"Name",value:"StopOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Call"}}}]}}]},{useState:Ol,useEffect:$l,useCallback:Ll}=Ae,xl=({callId:e,callHeldAt:n,title:i,callState:t,extendedCallState:a,callStateTitle:o,isServerHold:d,failureType:l,showDuration:r})=>{const s=Fl(),m=(0,wl.Cq)(),c=Ll((n=>(0,Ie.t)(_l.x,Object.assign({"data-testid":`multi-call-list-item-${e}-duration`,className:s.isStatusText,size:200},{children:n}))),[e,s.isStatusText]);return(0,Ie.t)(dl.k,Object.assign({className:s.isCallInfo,"data-testid":`multi-call-list-item-${e}-title`,column:!0},{children:[(0,Ie.t)(_l.x,Object.assign({className:s.isCallTitle,size:300},{children:i})),(0,Ie.t)(dl.k,Object.assign({"data-testid":`multi-call-list-item-${e}-status`,gap:"gap.small"},{children:[(0,Ie.t)((()=>{if((0,Dl.Hj)(a)||(0,Dl._u)(a))return(0,Ie.t)(_l.x,Object.assign({className:s.isStatusText,size:200},{children:o}));switch(t){case hl.OX.LocalHold:case hl.OX.RemoteHold:return(0,Ie.t)(_l.x,Object.assign({className:s.isStatusText,size:200},{children:m.stringTranslate("calling","calling_hold_button_icon_label")}));case hl.OX.Disconnecting:case hl.OX.Disconnected:return l===fl.Qq.CallDropped?(0,Ie.t)(_l.x,Object.assign({className:s.isStatusText,size:200},{children:m.stringTranslate("calling","calling_call_dropped")})):(0,Ie.t)(_l.x,Object.assign({className:s.isStatusText,size:200},{children:m.stringTranslate("calling","calling_call_ended")}));case hl.OX.Observing:if(d)return(0,Ie.t)(_l.x,Object.assign({className:s.isStatusText,size:200},{children:m.stringTranslate("calling","calling_hold_button_icon_label")}))}return(0,Ie.t)(il.e,{})}),{}),r&&(0,Ie.t)(Il.W5,{startedAt:n,render:c})]}))]}))},Bl=({callId:e,title:n,disableMonitorSwitch:i,shouldShowResumeButton:t,leaveCall:a,toggleHoldResume:o})=>{const d=Fl(),l=(0,wl.Cq)(),{loggerFactory:{newLogger:r}}=(0,Cl.SE)();return(0,Ie.t)(dl.k,Object.assign({className:d.isMultiCallListItemButtonContainer,gap:"gap.small"},{children:[(0,Ie.t)(Al.q,Object.assign({panelRegion:ei.Ai.multiCallMonitor,panelType:ei.wh.ResumeButton,newLogger:r,disableWrapper:!0},{children:t&&(0,Ie.t)(Sl.z,{className:d.isResumeCallButton,"data-testid":`multi-call-list-item-${e}-resume-button`,icon:(0,Ie.t)(ll.shV,{filled:!0}),shape:"circular",appearance:"outline",disabled:i,title:l.stringTranslate("calling","resume_call_multi_call_title",{callTitle:n}),onClick:o})})),(0,Ie.t)(Al.q,Object.assign({panelRegion:ei.Ai.multiCallMonitor,panelType:ei.wh.LeaveButton,newLogger:r,disableWrapper:!0},{children:(0,Ie.t)(Sl.z,{className:d.isLeaveCallButton,"data-testid":`multi-call-list-item-${e}-leave-button`,icon:(0,Ie.t)(ll.dB2,{filled:!0}),shape:"circular",appearance:"outline",title:l.stringTranslate("calling","end_call_multi_call_title",{callTitle:n}),onClick:a})}))]}))},jl=({callId:e,teamsCallId:n,callState:i,extendedCallState:a,callOrigin:o,callStateTitle:d,failureType:l,isServerHold:r,callHeldAt:s,intentId:m,isCallingWindowVisible:c,disableMonitorSwitch:u,disableCallSwitchToggle:p})=>{var y;const v=(0,rl.w)("MultiCallListItem"),k=Fl(),{setIntentIdOverride:g,showCallWindow:N}=(0,ol.Te)(),[h,f]=Ol(""),[_]=(0,Nl.D)(Pl,{fetchPolicy:"no-cache"}),[S]=(0,Nl.D)(Rl,{ignoreResults:!0,fetchPolicy:"no-cache"}),{data:T,loading:b,error:C}=(0,sl.a)(El,{variables:{teamsCallId:n},fetchPolicy:"no-cache"}),{data:w,loading:I,error:A}=(0,sl.a)(Ml,{variables:{teamsCallId:n,participantCount:2},fetchPolicy:"no-cache"}),F=Ll((()=>{m?(p(!0),v.log(`ResumeCall triggered for call ${e}, teamsCallId ${n}`),_({variables:{teamsCallId:n}}).catch((n=>{v.error(`Error in toggleHoldCall [callId:${e}][error:${n}]`)})).finally((()=>{p(!1)})),g(m),c&&N(n)):v.error(`Intent id is undefined for call ${e}`)}),[e,p,m,c,v,g,N,n,_]);$l((()=>{b||(C?v.error(`Could not fetch call title for callId: ${e} - ${C.message}`):(null==T?void 0:T.getCallTitle)?f(T.getCallTitle):v.log(`No call title found for callId: ${e} - ${null==T?void 0:T.getCallTitle}`))}),[T,b,C,e,v]),$l((()=>{I||(A?v.error(`Could not fetch participants for callId: ${e} - ${A.message}`):(null==w?void 0:w.nParticipants)||v.log(`No participants found for callId: ${e} - ${null==w?void 0:w.nParticipants}`))}),[w,I,A,e,v]);return(0,Ie.t)(dl.k,Object.assign({className:k.isMultiCallListItemWrapper,"data-testid":`multi-call-list-item-${e}`},{children:[(0,Ie.t)(Tl.mw,{"aria-hidden":!0,"data-testid":`multi-call-list-item-${e}-avatar`,users:(null===(y=null==w?void 0:w.nParticipants)||void 0===y?void 0:y.map((e=>({id:e.id,displayName:null}))))||[],profilePictureSize:bl.$D.Large,showPresence:!1,isFocusable:!1,callerInfo:"multi-call-list-item"}),(0,Ie.t)(xl,{callId:e,callHeldAt:s,title:h,callState:i,extendedCallState:a,callStateTitle:d,isServerHold:r,failureType:l,showDuration:(0,Dl.Rb)(i)&&!(0,Dl.Bw)(i)&&!(0,Dl._u)(a)&&!(0,Dl.Hj)(a)}),(0,Ie.t)(Bl,{callId:e,title:h,disableMonitorSwitch:u,shouldShowResumeButton:!!((0,Dl.Rb)(i)&&a!==fl.Tk.Transferring&&a!==fl.Tk.TransferSucceeded&&a!==fl.Tk.Parking&&a!==fl.Tk.ParkSucceeded&&!(0,Dl.fg)(o)||(0,Dl.tO)(i,r)),leaveCall:()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){v.log(`LeaveCall triggered for call ${e}`);try{yield S({variables:{callId:e,context:"multi-call-list-hangup_click",stopOptions:{forEveryone:!1,forAllUserEndpoints:!1}}})}catch(n){v.error(`Leave call failed for call ${e} - ${n.message}`)}})),toggleHoldResume:F})]}))};var Ul=i(973345);const Vl={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsWebMultiCallMonitorGetAllCallsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getAllCalls"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingFields"}}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Call"}}}}},arguments:[]}]}},...Ul.fJ.definitions]},Wl={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ComponentsWebMultiCallMonitorCallCreatedRemovedUpdatedSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callCreatedRemovedUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallAdded"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"call"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingFields"}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Call"}}},arguments:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallRemoved"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"call"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingFields"}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Call"}}},arguments:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallUpdated"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"call"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingFields"}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Call"}}},arguments:[]}]}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallCreatedRemovedUpdatedEvent"}}},arguments:[]}]}},...Ul.fJ.definitions]},Hl={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsWebMultiCallMonitorGetRenderedCallQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getRenderedCallInCallingWindow"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingFields"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Call"}},arguments:[]}]}},...Ul.fJ.definitions]},Gl={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ComponentsWebMultiCallMonitorCallingWindowingContainerVisibilityEventForMultiCallMonitorSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingWindowingContainerVisibilityEventForMultiCallMonitor"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CallingWindowingContainerVisibilityEventForMultiCallMonitor"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isCallingWindowVisible"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingWindowingContainerVisibilityEventForMultiCallMonitor"}}},arguments:[]}]}}]},Jl={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsWebMultiCallMonitorIsCallingWindowVisibleQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isCallingWindowVisible"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]}]}}]},{useState:ql,useEffect:zl,useCallback:Ql}=Ae,Yl=({ubar:e,callingScreen:n})=>{const i=(0,rl.w)("MultiCallList"),t=gl(),{close:a,mounted:o}=(0,ol.Te)(),[d,l]=ql([]),[r,s]=ql(""),[m,c]=ql(!1),[u,p]=ql(!1),{data:y,loading:v,error:k}=(0,sl.a)(Vl,{fetchPolicy:"no-cache"}),[g,{data:N,loading:h,error:f}]=(0,ml.t)(Hl,{fetchPolicy:"no-cache"}),{data:_,loading:S,error:T}=(0,sl.a)(Jl,{fetchPolicy:"no-cache"}),{data:b,error:C}=(0,cl.m)(Wl),{data:w,error:I}=(0,cl.m)(Gl),A=Ql((e=>{p(e)}),[]);zl((()=>{o("call-list"),g()}),[o,g]),zl((()=>{v||(k?i.error(`Could not fetch call details - ${k.message}`):(null==y?void 0:y.getAllCalls)?(i.log(`Received ${y.getAllCalls.length} calls`),l([...y.getAllCalls])):i.log(`No calls found - ${null==y?void 0:y.getAllCalls}`))}),[y,v,k,l,i]),zl((()=>{if(!h){if(f)return i.error(`Could not fetch rendered call details - ${f.message}`),void s("");if(!(null==N?void 0:N.getRenderedCallInCallingWindow))return i.log(`No rendered calls found - ${null==N?void 0:N.getRenderedCallInCallingWindow}`),void s("");i.log(`Rendered call id is ${N.getRenderedCallInCallingWindow.callId}`),s(N.getRenderedCallInCallingWindow.callId)}}),[N,h,f,s,i]),zl((()=>{S||(T?i.error(`Could not fetch calling window visibility - ${T.message}`):_&&0!==Object.keys(_).length?(i.log(`Calling window visibility is ${_.isCallingWindowVisible}`),_.isCallingWindowVisible&&g(),c(_.isCallingWindowVisible)):i.log("Calling window visibility not found"))}),[S,T,_,c,g,i]),zl((()=>{var e,n;if(C)return void i.error(`Call subscription error - ${C.message}`);if(!(null===(e=null==b?void 0:b.callCreatedRemovedUpdatedEvent)||void 0===e?void 0:e.call))return void i.log(`No calls found in the subscription - ${null===(n=null==b?void 0:b.callCreatedRemovedUpdatedEvent)||void 0===n?void 0:n.call}`);const t=b.callCreatedRemovedUpdatedEvent.call,o=b.callCreatedRemovedUpdatedEvent.__typename;i.log(`Call subscription received for call ${t.callId} and operation ${o}`);let r=[];switch(o){case"CallAdded":g(),r=[...d,t],l(r);break;case"CallRemoved":g();for(const e of d)e.callId!==t.callId&&r.push(e);0===r.length&&(i.log("Closing the call list"),a("call-list")),l(r);break;case"CallUpdated":for(const e of d)e.callId===t.callId?(e.state!==t.state&&g(),r.push(t)):r.push(e);l(r)}}),[b,C,l,i]),zl((()=>{I?i.error(`Calling window subscription error - ${I.message}`):(null==w?void 0:w.callingWindowingContainerVisibilityEventForMultiCallMonitor)&&void 0!==w.callingWindowingContainerVisibilityEventForMultiCallMonitor.isCallingWindowVisible&&null!==w.callingWindowingContainerVisibilityEventForMultiCallMonitor.isCallingWindowVisible?(w.callingWindowingContainerVisibilityEventForMultiCallMonitor.isCallingWindowVisible&&g(),c(w.callingWindowingContainerVisibilityEventForMultiCallMonitor.isCallingWindowVisible)):i.log("Calling window visibility not found")}),[w,I,c,g,i]);const[F,D]=(({allCalls:e,isCallingWindowVisible:n,renderedCallId:i,ubar:t,callingScreen:a,disableMonitorSwitch:o,disableCallSwitchToggle:d,logger:l})=>{let r=0;return n&&1===e.length||0===e.length?(l.log(`CallList is empty - isCallingWindowVisible: ${n}, totalCallsCount - ${e.length}`),[null,0]):[(0,Ie.t)(Ae.Fragment,{children:e.map((e=>{var s,m,c;return n&&e.callId===i?(l.log(`MultiCallList skipped displaying for a call with call id ${e.callId} and intent id ${null===(s=e.intent)||void 0===s?void 0:s.id} because calling window visibility is ${n} and rendered call id is ${i}`),(0,Ie.t)(il.e,{},e.id)):(0,Dl.Xf)(e)?(l.log(`MultiCallListItem displayed for ${e.callId} with call state as ${e.state} and extended state as ${e.extendedCallState} with calling window visibility as ${n}`),r++,(0,Ie.t)(jl,{callId:e.callId,teamsCallId:e.id,callState:e.state,extendedCallState:e.extendedCallState,callOrigin:e.callOrigin,callStateTitle:null===(m=e.callStateProps)||void 0===m?void 0:m.title,failureType:e.failureType,isServerHold:e.isServerHold,callHeldAt:e.callHeldAt||void 0,intentId:null===(c=e.intent)||void 0===c?void 0:c.id,isCallingWindowVisible:n,disableMonitorSwitch:o,disableCallSwitchToggle:d},e.id)):(0,Dl.A4)(e)?(l.log(`Call Monitor Window displayed for ${e.callId} with call state as ${e.state} and extended state as ${e.extendedCallState} with calling window visibility as ${n}`),r++,(0,Ie.t)(kl,{ubar:t,callingScreen:a},e.id)):(l.log(`MultiCallList skipped displaying for call ${e.callId} with call state as ${e.state} and extended state as ${e.extendedCallState} with calling window visibility as ${n}`),(0,Ie.t)(il.e,{},e.id))}))}),r]})({allCalls:d,isCallingWindowVisible:m,renderedCallId:r,ubar:e,callingScreen:n,disableMonitorSwitch:u,disableCallSwitchToggle:A,logger:i});return 0===D?(i.log("MultiCallList is hidden - callCountInSlotView - 0"),(0,Ie.t)(il.e,{})):(0,Ie.t)(dl.k,Object.assign({className:t.isWebMultiCallMonitorWrapper,"data-tid":"multi-call-list",column:!0},{children:[(0,Ie.t)(dl.k,Object.assign({className:t.isIconWrapper},{children:(0,Ie.t)(ll.cSU,{filled:!0})})),F]}))},Kl=e=>{const n=(0,al.sV)(),{id:i}=n.getEntityOptions(De.py.floatingmonitor,De.uk.view);return(0,Ie.t)(ol.UN,Object.assign({intentIdOverride:i},{children:(0,Ie.t)(Yl,Object.assign({},e))}))},Xl=()=>Promise.all([i.e(917388),i.e(790026),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(241602),i.e(976609),i.e(133950),i.e(779478),i.e(315215),i.e(400010),i.e(160200),i.e(680254),i.e(551830),i.e(161922),i.e(565637),i.e(332018),i.e(347761),i.e(409201),i.e(475063),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(26466),i.e(745659),i.e(116187),i.e(792594),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(722198),i.e(613692),i.e(403936),i.e(394413),i.e(207856),i.e(477708),i.e(450605),i.e(329712),i.e(673758),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(816906),i.e(749021),i.e(931123),i.e(297312),i.e(623295),i.e(74043),i.e(597930),i.e(96495),i.e(542511),i.e(165665),i.e(442766),i.e(232044),i.e(853246),i.e(328135),i.e(746399),i.e(458414),i.e(104683),i.e(707014),i.e(231523),i.e(112665),i.e(799490),i.e(114423),i.e(347271),i.e(675514),i.e(566847),i.e(64834),i.e(512052),i.e(220279),i.e(883442),i.e(761750),i.e(667135),i.e(942163),i.e(441838),i.e(263490),i.e(770326)]).then(i.bind(i,503736)),Zl=()=>Promise.all([i.e(917388),i.e(790026),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(241602),i.e(976609),i.e(133950),i.e(779478),i.e(315215),i.e(400010),i.e(160200),i.e(680254),i.e(551830),i.e(161922),i.e(565637),i.e(332018),i.e(347761),i.e(409201),i.e(475063),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(26466),i.e(745659),i.e(116187),i.e(792594),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(722198),i.e(613692),i.e(403936),i.e(394413),i.e(207856),i.e(477708),i.e(450605),i.e(329712),i.e(673758),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(816906),i.e(749021),i.e(931123),i.e(297312),i.e(623295),i.e(74043),i.e(597930),i.e(96495),i.e(542511),i.e(165665),i.e(442766),i.e(232044),i.e(853246),i.e(328135),i.e(746399),i.e(458414),i.e(104683),i.e(707014),i.e(231523),i.e(112665),i.e(799490),i.e(114423),i.e(347271),i.e(675514),i.e(566847),i.e(64834),i.e(512052),i.e(220279),i.e(883442),i.e(761750),i.e(667135),i.e(942163),i.e(441838),i.e(263490),i.e(770326)]).then(i.bind(i,283766)),er=()=>Promise.all([i.e(917388),i.e(790026),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(241602),i.e(976609),i.e(133950),i.e(779478),i.e(315215),i.e(400010),i.e(160200),i.e(680254),i.e(551830),i.e(161922),i.e(565637),i.e(332018),i.e(347761),i.e(409201),i.e(475063),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(26466),i.e(745659),i.e(116187),i.e(792594),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(722198),i.e(613692),i.e(403936),i.e(394413),i.e(207856),i.e(477708),i.e(450605),i.e(329712),i.e(673758),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(816906),i.e(749021),i.e(931123),i.e(297312),i.e(623295),i.e(74043),i.e(597930),i.e(96495),i.e(542511),i.e(165665),i.e(442766),i.e(232044),i.e(853246),i.e(328135),i.e(746399),i.e(458414),i.e(104683),i.e(707014),i.e(231523),i.e(112665),i.e(799490),i.e(114423),i.e(347271),i.e(675514),i.e(566847),i.e(64834),i.e(512052),i.e(220279),i.e(883442),i.e(761750),i.e(667135),i.e(942163),i.e(441838),i.e(263490),i.e(770326)]).then(i.bind(i,228183)),nr="calling-app-LPC",ir="calling-app",tr=({appRenderMode:e,coreSettings:n,host:i,isHeader:a,isMainPanel:o,logger:d,onRenderEvent:l,scenarioFactory:r})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){d.log(`renderWithLPC: import LPC: isMainPanel=${o} isHeader=${a}`);const t=(0,Pn.mT)(er,nr,r);if(e===Fe.S.Main){l("ChunkLoadStarted",{chunkName:nr});const{chunkLoadTimerPromise:e,chunkLoadTimer:r}=(({coreSettings:e,host:n})=>{let i=0;return{chunkLoadTimerPromise:new Promise(((t,a)=>{let{chunkLoadTimeout:o}=e.get(s.J.Calling);o||(o=Number.MAX_SAFE_INTEGER),i=n.setTimeout(a,o,(0,yn.Tr)("CallingApp",gn.jK.ChunkLoadTimedOut,"renderMain"))})),chunkLoadTimer:i}})({coreSettings:n,host:i});yield Promise.race([t,e]).then((()=>clearTimeout(r))).catch((e=>{throw d.error(`renderWithLPC: ChunkLoadTimedOut: isMainPanel=${o} isHeader=${a}`),e})),l("ChunkLoadSucceeded",{chunkName:nr})}const{LPC:m}=yield t;return d.log(`renderWithLPC: construct the slot element: isMainPanel=${o} isHeader=${a}`),m})),ar=({coreServices:e,host:n,isResize:i,entityType:t,windowOptions:a,entityOptions:o})=>{var d,l,r,m;const{minHeight:c,minWidth:u}=(null===(d=fd.windowFeatures)||void 0===d?void 0:d.otherEntityTypes)||{},p=null==n?void 0:n.screen;if(t===De.py.callsmonitor)return(({host:e,windowOptions:n,coreServices:i})=>{var t,a;const o=null!==(a=Object.assign({},null===(t=fd.windowFeatures)||void 0===t?void 0:t[De.py.callsmonitor]))&&void 0!==a?a:{},d={width:o.width||0,height:o.height||0};return n&&(d.width=n.width||d.width,d.height=n.height||d.height),!!(null==i?void 0:i.coreSettings.get(s.J.Calling,["disableContentprotection"]).disableContentprotection)&&o.additionalFeatures&&(o.additionalFeatures=Object.assign(Object.assign({},o.additionalFeatures),{contentprotection:"false"})),e&&e.screen&&d.width&&d.height&&(o.top=0===(null==n?void 0:n.top)||(null==n?void 0:n.top)?n.top:e.screen.availHeight-(d.height+100),o.left=0===(null==n?void 0:n.left)||(null==n?void 0:n.left)?n.left:e.screen.availWidth-(d.width+100)),Object.assign(Object.assign({},o),d)})({host:n,windowOptions:a,coreServices:e});if(t===De.py.byodattendeewindow)return(({entityOptions:e,coreServices:n})=>{var i;const{minHeight:t,minWidth:a,additionalFeatures:o}=(null===(i=fd.windowFeatures)||void 0===i?void 0:i.byodattendeewindow)||{};if(!e)return null;const d=JSON.parse(e).displayProperties;return{additionalFeatures:{minHeight:`${t}`,minWidth:`${a}`,show:"false",contentprotection:`${(null==n?void 0:n.coreSettings.get(s.J.Calling,["disableContentprotection"]).disableContentprotection)?"false":null==o?void 0:o.contentprotection}`,excludeWindowFromScreenSharing:`${null==o?void 0:o.excludeWindowFromScreenSharing}`},height:null==d?void 0:d.height,width:null==d?void 0:d.width,fullScreen:!0,left:null==d?void 0:d.x,top:null==d?void 0:d.y,minHeight:t,minWidth:a}})({entityOptions:o,coreServices:e});if(t===De.py.callingdialog)return null!==(r=null===(l=fd.windowFeatures)||void 0===l?void 0:l[De.py.callingdialog])&&void 0!==r?r:{};if(i&&!p)return(null===(m=fd.windowFeatures)||void 0===m?void 0:m.otherEntityTypes)||null;if(!p)return null;let{height:y=1,width:v=1}=((e,n)=>{var i,t;const{minHeight:a=0,minWidth:o=0}=(null===(i=fd.windowFeatures)||void 0===i?void 0:i.otherEntityTypes)||{};let{width:d,height:l}=(null===(t=fd.windowFeatures)||void 0===t?void 0:t.otherEntityTypes)||{};if(!n)return{height:l,width:d,minHeight:a,minWidth:o};const{orientation:{type:r}}=e,{landscapeScreenRatio:m,portraitScreenRatio:c,widthHeightRatio:u}=n.coreSettings.get(s.J.Calling);if(m&&c&&u)switch(r){case"landscape-primary":case"landscape-secondary":const n=m*e.availHeight;l=n>a?n:a,d=u*l;break;case"portrait-primary":case"portrait-secondary":const i=c*e.availWidth;d=i>o?i:o,l=1/u*d}return{height:l,width:d}})(p,e);const k=p.availHeight-20,g=v>=p.availWidth||y>=k;g&&(y=p.availHeight,v=p.availWidth);const{left:N,top:h}=((e,n,i,t,a)=>{if(t)return{left:0,top:0};const o="availLeft"in e?e.availLeft:0,d="availTop"in e?e.availTop:0,l=o+e.availWidth/2-n/2;let r;switch(e.orientation.type){case"landscape-primary":case"landscape-secondary":r=d+a;break;default:r=d+e.availHeight/2-i/2}return{left:l,top:r}})(p,v,y,g,20);return{additionalFeatures:{minHeight:`${c}`,minWidth:`${u}`},height:y,width:v,fullScreen:g,left:N,top:h,minHeight:c,minWidth:u}},or=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{logger:n,scenarioFactory:i,isMainPanel:t,isHeader:a,isModal:o,onRenderEvent:d}=e;d("ChunkLoadStarted",{chunkName:ir}),n.log(`render: import the necessary subcomponents: isMainPanel=${t} isHeader=${a} isModal=${o}`);const[{CallingViewsRenderer:l},{CallingContextProvider:r}]=yield Promise.all([(0,Pn.mT)(Xl,ir,i),(0,Pn.mT)(Zl,ir,i)]);return d("ChunkLoadSucceeded",{chunkName:ir}),{CallingViewsRenderer:l,CallingContextProvider:r}})),dr=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{isMainPanel:n,isHeader:i,isModal:t,logger:a,conveneHostMessaging:o}=e,{CallingViewsRenderer:d,CallingContextProvider:l}=yield or(e);return a.log(`render: construct the slot element: isMainPanel=${n} isHeader=${i} isModal=${t}`),(null==o?void 0:o.isInEmbedContext())?(0,Ie.t)(sr,{children:(0,Ie.t)(l,{children:(0,Ie.t)(Li.yx,Object.assign({conveneHostMessaging:o},{children:(0,Ie.t)(d,{isMainPanel:n,isHeader:i,isModal:t})}))})}):(0,Ie.t)(sr,{children:(0,Ie.t)(l,{children:(0,Ie.t)(d,{isMainPanel:n,isHeader:i,isModal:t})})})})),lr=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var{appRenderMode:n,loggerFactory:i,host:a,scenarioFactory:o}=e,d=(0,t.__rest)(e,["appRenderMode","loggerFactory","host","scenarioFactory"]);if(n===Fe.S.HorizontalBar||n===Fe.S.Main){const e=i.newLogger("CallingApp","apps-calling"),t=n===Fe.S.HorizontalBar;return dr(Object.assign({isMainPanel:!0,isHeader:t,isModal:!1,logger:e,scenarioFactory:o,appRenderMode:n,host:a},d))}return(0,Ie.t)(il.e,{})}));function rr(e){return{eventHandlers:dd,getAppPhases:ld,getAppViewEntities:sd,getAppViewEntitiesProps:Nd,getAppWindowFeatures:ar,getCommandScenarioName:tl,manifest:fd,render:n=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var{appRenderMode:i,entity:a,loggerFactory:o}=n,d=(0,t.__rest)(n,["appRenderMode","entity","loggerFactory"]);const l=o.newLogger("CallingApp","apps-calling");if(a.type===De.py.floatingmonitor)return r=Object.assign({appRenderMode:i,entity:a,loggerFactory:o},d),(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var{loggerFactory:e,entity:n,appRenderMode:i}=r,a=(0,t.__rest)(r,["loggerFactory","entity","appRenderMode"]);const o=a.coreSettings.get(s.J.Calling),[d,l]=yield Promise.all([lr(Object.assign({appRenderMode:Fe.S.HorizontalBar,entity:n,loggerFactory:e},a)),lr(Object.assign({appRenderMode:Fe.S.Main,entity:n,loggerFactory:e},a))]);return o.enableMultiCallMonitorForWeb?(0,Ie.t)(Kl,{ubar:d,callingScreen:l}):(0,Ie.t)(kl,{ubar:d,callingScreen:l})}));var r,m;if(a.type===De.py.callsmonitor)return lr(Object.assign({appRenderMode:i,entity:a,loggerFactory:o},d));if(i===Fe.S.HorizontalBar||i===Fe.S.Modal){const n=i===Fe.S.HorizontalBar,t=i===Fe.S.HorizontalBar,a=i===Fe.S.Modal;return dr(Object.assign({conveneHostMessaging:e,isMainPanel:n,isHeader:t,isModal:a,logger:l,appRenderMode:i},d))}if(i===Fe.S.Main||i===Fe.S.Rail){const n=i===Fe.S.Main,a=!1,o=!1;return m=Object.assign({conveneHostMessaging:e,isMainPanel:n,isHeader:a,isModal:o,appRenderMode:i,logger:l},d),(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{isMainPanel:e,isHeader:n,isModal:i,logger:t,coreSettings:a,conveneHostMessaging:o}=m,{CallingViewsRenderer:d,CallingContextProvider:l}=yield or(m);t.log(`render: construct the slot element: isMainPanel=${e} isHeader=${n} isModal=${i}`);const{enableEntityMoreInfo:r=!1}=a.get(s.J.Core),c=({children:e})=>(0,Ie.t)(Ae.Fragment,{children:e}),u=r?c:yield tr(m),p=r?c:Na.p3;return(null==o?void 0:o.isInEmbedContext())?(0,Ie.t)(sr,{children:(0,Ie.t)(u,{children:(0,Ie.t)(p,{children:(0,Ie.t)(Li.yx,Object.assign({conveneHostMessaging:o||Li.Id},{children:(0,Ie.t)(l,{children:(0,Ie.t)(d,{isMainPanel:e,isHeader:n,isModal:i})})}))})})}):(0,Ie.t)(sr,{children:(0,Ie.t)(u,{children:(0,Ie.t)(p,{children:(0,Ie.t)(l,{children:(0,Ie.t)(d,{isMainPanel:e,isHeader:n,isModal:i})})})})})}))}return(0,Ie.t)(il.e,{})})),onPreWarm:Bo,onPreInit:jo,onBeforeAddToNavigation:td,onBeforeCommandHandled:Ld,onBeforeDeeplinkParsed:id,onCommandResult:Zd}}const sr=({children:e})=>(0,Ie.t)(ri.f,Object.assign({namespaces:["calling","broadcast","extensibility","hololens","messaging","meetingOptions","datepicker"],loaderRenderer:null},{children:e})),mr={id:"com.microsoft.teams.campaign-notifications",name:"CampaignNotificationsApp",supportedEntities:[De.py.campaignnotifications],supportedRenderModes:[Fe.S.Main]},cr=e=>{if(ur(e))return pr(e)?{subNavEntity:yr(e),headerEntity:vr(e),startEntity:kr(e),mainEntity:gr(e),endEntity:Nr(e)}:null},ur=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=Boolean(De.py.campaignnotifications===t),d=[De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},pr=()=>!0,yr=()=>null,vr=()=>null,kr=()=>null,gr=({entity:e})=>e,Nr=()=>null,hr=({appRenderMode:e})=>{const n=new Ee.H,i=[],t=[],a={};if(e===Fe.S.Main)fr({criticalSignals:i,featureFlags:a,postCriticalSignals:t});return n.registerAppPhase({phase:g.nh.CRITICAL,signals:i,timeout:1e4}),n.appPhases},fr=({criticalSignals:e})=>{e.push(Me.G.CAMPAIGN_VIEW_RENDERED)},_r=()=>Promise.all([i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(241602),i.e(133950),i.e(268372),i.e(775758),i.e(236315),i.e(529375),i.e(669939),i.e(9081),i.e(511611),i.e(481020),i.e(677762)]).then(i.bind(i,95780));function Sr(){const e=()=>null;return{getAppPhases:hr,getAppViewEntities:cr,manifest:mr,render:({appRenderMode:n,onRenderEvent:i,scenarioFactory:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main){const e="campaign-notifications";i("ChunkLoadStarted",{chunkName:e});const{CampaignNotifications:n}=yield(0,Pn.mT)(_r,e,a);return i("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(n,{})}return(0,Ie.t)(e,{})}))}}const Tr={id:"com.microsoft.teams.changeDefaultApp",name:"ChangeDefaultApp",supportedEntities:[De.py.fileopensettings],supportedRenderModes:[Fe.S.Modal]};var br=i(475230);var Cr;!function(e){e.DeepLinkNotEnabled="deeplink-not-enabled-error",e.MissingFileType="missing-fileType-error"}(Cr||(Cr={}));const wr=e=>{const{fileType:n,serviceName:i,context:t}=e;return Promise.resolve({entityCommand:{entity:{type:De.py.fileopensettings,action:De.uk.update},command:{visibilityState:v.fe.show,stateTransition:v.su.extend,correlation:{source:sn.D.ChangeDefaultAppDialog}},entityOptions:{fileType:n,serviceName:i,context:t}},metadata:{allowAnonymous:!1}})},Ir=[{filter:"/l/change-file-open-preference",execute:({deeplinkUrl:e,context:{coreSettings:n}})=>{if(!Ar(n))return Promise.reject({message:Cr.DeepLinkNotEnabled});const{entityOptions:i}=(e=>{var n,i;const{searchParams:t}=e;return{entityOptions:{fileType:null!==(n=t.get("fileType"))&&void 0!==n?n:"",serviceName:null!==(i=t.get("serviceName"))&&void 0!==i?i:"",context:br.Hr.ns}}})(e);return i.fileType?wr(i):Promise.reject({message:Cr.MissingFileType})}}],Ar=e=>!!(null==e?void 0:e.get(s.J.Files).enableChangeDefaultAppDialogV2),Fr=()=>Promise.all([i.e(917388),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(976609),i.e(133950),i.e(779478),i.e(315215),i.e(680254),i.e(984256),i.e(555551),i.e(844369),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(26466),i.e(745659),i.e(462317),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(613692),i.e(403936),i.e(207856),i.e(450605),i.e(586146),i.e(329712),i.e(673758),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(788842),i.e(427163),i.e(749021),i.e(542511),i.e(232044),i.e(660340),i.e(988150),i.e(258171),i.e(658803),i.e(966573),i.e(868123)]).then(i.bind(i,147868));function Dr(){const e=()=>null;return{manifest:Tr,render:({appRenderMode:n,onRenderEvent:i,scenarioFactory:a,loggerFactory:o})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=o.newLogger("ChangeDefaultApp","apps-change-default-app");if(n===Fe.S.Modal){const e="change-default-app";t.log("chunk load start"),i("ChunkLoadStarted",{chunkName:e}),t.log("experimental import start");const{ChangeDefaultAppDialog:n}=yield(0,Pn.mT)(Fr,e,a);return t.log("report chunk load success"),i("ChunkLoadSucceeded",{chunkName:e}),t.log("Rendering change default app dialog"),(0,Ie.t)(n,{})}return(0,Ie.t)(e,{})})),onBeforeDeeplinkParsed:Ir}}var Er=i(916987),Mr=i(876661),Pr=i(289931),Rr=i(661424),Or=i(810425);const $r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"sendMessage"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"message"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"action"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageAction"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"correlationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendMessage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"message"},value:{kind:"Variable",name:{kind:"Name",value:"message"}},__type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageInput"}}},{kind:"Argument",name:{kind:"Name",value:"action"},value:{kind:"Variable",name:{kind:"Name",value:"action"}},__type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageAction"}}},{kind:"Argument",name:{kind:"Name",value:"correlationId"},value:{kind:"Variable",name:{kind:"Name",value:"correlationId"}},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Message"}}}]}}]},Lr={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsChatChatHighlightsCommandOptionsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chatHighlightsDetailsCommandOptions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"convId"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"lastMessageOriginalArrivalTime"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ChatHighlightsDetailsCommandOptions"}},arguments:[]}]}}]},xr={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsChatNotifyActiveContextChangedMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activeContextId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activeContextType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ActiveContextType"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"notifyActiveContextChangedToCDLWorker"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activeContextId"},value:{kind:"Variable",name:{kind:"Name",value:"activeContextId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"activeContextType"},value:{kind:"Variable",name:{kind:"Name",value:"activeContextType"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ActiveContextType"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]};var Br=i(32552),jr=i(760005);const Ur=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:n,entityCommand:{entity:{type:i,action:t,id:a},dataOptions:o,entityOptions:d},requestContext:l}=e,r=l.client,{enableChatEnablePolicyCheckForCommand:m}=l.coreSettings.get(s.J.Chat);if(m&&i===De.py.chats&&d&&d.shouldCheckChatPolicy&&(0,Pr.t3)(l.coreSettings.get(s.J.Messaging))===Pr.i1.Disabled)return Promise.resolve(void 0);if(qr(r,l.coreSettings,i,t,a),i===De.py.chatHighlightsDetails&&"chatHighlightsDetailsCoachmark"===a)return Vr(r,n,l.loggerFactory);const c=yield(0,Or.z)(r,l.coreSettings.get(s.J.SimpleCollab));if(Gr(n,c)){const e=Object.assign(Object.assign({},n),{entity:Object.assign(Object.assign({},n.entity),{type:De.py.simplecollab})});return Promise.resolve(e)}return Wr(r,o,n,i,t)})),Vr=(e,n,i)=>{const t=i.newLogger("chatCopilotCoachmark","apps-chat");try{const i=e.readQuery({query:Lr});if(!(null==i?void 0:i.chatHighlightsDetailsCommandOptions))throw new Error;{const{convId:e,lastMessageOriginalArrivalTime:a}=i.chatHighlightsDetailsCommandOptions;n.entity.id=e,n.entityOptions?n.entityOptions=Object.assign(Object.assign({},n.entityOptions),{lastMessageOriginalArrivalTime:a}):n.entityOptions={lastMessageOriginalArrivalTime:a},t.log(`Received chat id: ${e} ${a}`)}}catch(e){return Promise.reject("handleChatHighlightsDetailsCoachmark: falied to get chat id")}return Promise.resolve(n)},Wr=(e,n,i,t,a)=>n&&Hr(t,a)?Jr(n)&&n.convId&&n.message?e.mutate({mutation:$r,variables:{convId:n.convId,message:{clientMessageId:(0,Br.K)(),messageType:jr.Cs.HTML,content:n.message},action:Fd.xy.Create}}).then((()=>{})).catch((()=>Promise.reject(io.f.ChatToastActionMutationFailed))):Promise.reject(io.f.ChatActionTypeToNotificationActionFailed):Promise.resolve(i),Hr=(e,n)=>e===De.py.chats&&n===De.uk.mutate,Gr=(e,n)=>{var i;return!(e.entity.type===De.py.simplecollab||!n||["flow","none","new","extend"].includes(e.command.stateTransition)||e.entity.linkedEntity&&(null===(i=e.entity.linkedEntity)||void 0===i?void 0:i.type)===De.py.simplecollab)},Jr=e=>e.actionType===Rr.u.quickReply,qr=(e,n,i,t,a)=>{n.get(s.J.CdlWorker).enableNotifyActiveContextChangedToCDLWorker&&a&&i===De.py.chats&&t===De.uk.view&&e.mutate({mutation:xr,fetchPolicy:"no-cache",variables:{activeContextId:a,activeContextType:"chat"}})},zr=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(241602),i.e(371935),i.e(976609),i.e(1053),i.e(133950),i.e(779478),i.e(268372),i.e(775758),i.e(315215),i.e(191673),i.e(780208),i.e(242959),i.e(160200),i.e(363327),i.e(384342),i.e(680254),i.e(508746),i.e(704079),i.e(479335),i.e(458415),i.e(595506),i.e(213363),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(269296),i.e(26466),i.e(745659),i.e(911758),i.e(405309),i.e(589993),i.e(191254),i.e(708472),i.e(84215),i.e(553142),i.e(880261),i.e(138365),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(842529),i.e(485984),i.e(12921),i.e(495500),i.e(756029),i.e(722198),i.e(613692),i.e(403936),i.e(271428),i.e(394413),i.e(207856),i.e(477708),i.e(386201),i.e(450605),i.e(769716),i.e(586146),i.e(329712),i.e(673758),i.e(839180),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(628109),i.e(788842),i.e(427163),i.e(494306),i.e(762318),i.e(816906),i.e(749021),i.e(591822),i.e(931123),i.e(509115),i.e(435933),i.e(761598),i.e(449768),i.e(297312),i.e(414875),i.e(249903),i.e(927109),i.e(623295),i.e(696028),i.e(826227),i.e(597930),i.e(550425),i.e(203459),i.e(96495),i.e(451185),i.e(714478),i.e(913486),i.e(267871),i.e(55587),i.e(354250),i.e(542511),i.e(622291),i.e(9447),i.e(516532),i.e(989092),i.e(648907),i.e(853246),i.e(693257),i.e(529454),i.e(629274),i.e(162022),i.e(878203),i.e(651426),i.e(403930),i.e(749157),i.e(56767),i.e(143168),i.e(750645),i.e(602039),i.e(541936),i.e(405687),i.e(750078),i.e(114423),i.e(988602),i.e(714153),i.e(903803),i.e(15722),i.e(307418),i.e(745557),i.e(481647)]).then(i.bind(i,135630)),Qr=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(241602),i.e(371935),i.e(976609),i.e(1053),i.e(133950),i.e(779478),i.e(268372),i.e(775758),i.e(315215),i.e(191673),i.e(780208),i.e(242959),i.e(160200),i.e(363327),i.e(384342),i.e(680254),i.e(508746),i.e(704079),i.e(479335),i.e(458415),i.e(595506),i.e(213363),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(269296),i.e(26466),i.e(745659),i.e(911758),i.e(405309),i.e(589993),i.e(191254),i.e(708472),i.e(84215),i.e(553142),i.e(880261),i.e(138365),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(842529),i.e(485984),i.e(12921),i.e(495500),i.e(756029),i.e(722198),i.e(613692),i.e(403936),i.e(271428),i.e(394413),i.e(207856),i.e(477708),i.e(386201),i.e(450605),i.e(769716),i.e(586146),i.e(329712),i.e(673758),i.e(839180),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(628109),i.e(788842),i.e(427163),i.e(494306),i.e(762318),i.e(816906),i.e(749021),i.e(591822),i.e(931123),i.e(509115),i.e(435933),i.e(761598),i.e(449768),i.e(297312),i.e(414875),i.e(249903),i.e(927109),i.e(623295),i.e(696028),i.e(826227),i.e(597930),i.e(550425),i.e(203459),i.e(96495),i.e(451185),i.e(714478),i.e(913486),i.e(267871),i.e(55587),i.e(354250),i.e(542511),i.e(622291),i.e(9447),i.e(516532),i.e(989092),i.e(648907),i.e(853246),i.e(693257),i.e(529454),i.e(629274),i.e(162022),i.e(878203),i.e(651426),i.e(403930),i.e(749157),i.e(56767),i.e(143168),i.e(750645),i.e(602039),i.e(541936),i.e(405687),i.e(750078),i.e(114423),i.e(988602),i.e(714153),i.e(903803),i.e(15722),i.e(307418),i.e(745557),i.e(481647)]).then(i.bind(i,228183)),Yr=({action:e,appRenderMode:n,coreSettings:i,type:t})=>{const a=new Ee.H,{isHeaderDisabled:o=!1}=i.get(s.J.Core),{chatAppPhaseTimeouts:d,enableComposeCriticalPhaseLoad:l=!1,enableComposeCriticalPhaseLoadSecondaryViewport:r=!1,enableComposeCriticalPhaseLoadSecondaryViewportGate:m=!1}=i.get(s.J.Messaging),c=[],u=[];switch(n){case Fe.S.HorizontalBar:Kr({criticalSignals:c,featureFlags:{isHeaderDisabled:o},postCriticalSignals:u,type:t});break;case Fe.S.Main:Xr({action:e,criticalSignals:c,featureFlags:{enableComposeCriticalPhaseLoad:l},postCriticalSignals:u,type:t});break;case Fe.S.Rail:Zr({action:e,criticalSignals:c,featureFlags:{enableComposeCriticalPhaseLoad:l,enableComposeCriticalPhaseLoadSecondaryViewport:r,enableComposeCriticalPhaseLoadSecondaryViewportGate:m},postCriticalSignals:u,type:t})}return a.registerAppPhase({phase:g.nh.CRITICAL,signals:c,timeout:(null==d?void 0:d.critical)||6e4}),a.registerAppPhase({phase:g.nh.POST_CRITICAL,signals:u,timeout:(null==d?void 0:d.postCritical)||1e4}),a.appPhases},Kr=({featureFlags:{isHeaderDisabled:e},criticalSignals:n,postCriticalSignals:i,type:t})=>{t!==De.py.chatschannelconv?(!e&&n.push(Me.G.CHAT_HEADER_TITLE_RENDERED),!e&&i.push(Me.G.CHAT_HEADER_BUTTONS_RENDERED)):n.push(Me.G.CHANNEL_HEADER_RENDERED)},Xr=({action:e,criticalSignals:n,featureFlags:{enableComposeCriticalPhaseLoad:i},postCriticalSignals:t,type:a})=>{if(e===De.uk.join)return;if(a===De.py.chatschannelconv){n.push(Me.G.MESSAGES_RENDERED);return i?n.push(Me.G.COMPOSE_LOADED):t.push(Me.G.COMPOSE_LOADED),void t.push(Me.G.MESSAGE_REACTIONS_RENDERED,Me.G.PRESENCES_RENDERED,Me.G.VIRTUAL_LIST_RENDER_BUFFER_FILLED)}n.push(Me.G.MESSAGES_RENDERED);const o=i;o&&n.push(Me.G.COMPOSE_LOADED),t.push(Me.G.MESSAGE_REACTIONS_RENDERED,Me.G.PRESENCES_RENDERED,Me.G.VIRTUAL_LIST_RENDER_BUFFER_FILLED),!o&&t.push(Me.G.COMPOSE_LOADED)},Zr=({action:e,criticalSignals:n,featureFlags:{enableComposeCriticalPhaseLoad:i,enableComposeCriticalPhaseLoadSecondaryViewport:t,enableComposeCriticalPhaseLoadSecondaryViewportGate:a},postCriticalSignals:o,type:d})=>{if(e===De.uk.list)n.push(Me.G.CHAT_LIST_ITEMS_RENDERED),o.push(Me.G.PRESENCES_RENDERED);else if(e===De.uk.view){n.push(Me.G.MESSAGES_RENDERED);const e=a&&t,l=d!==De.py.byodchat&&(i||e);l&&n.push(Me.G.COMPOSE_LOADED),o.push(Me.G.MESSAGE_REACTIONS_RENDERED,Me.G.PRESENCES_RENDERED,Me.G.VIRTUAL_LIST_RENDER_BUFFER_FILLED),l||d===De.py.byodchat||o.push(Me.G.COMPOSE_LOADED)}},es={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ToastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attributionText"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"contentType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"conversationId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"correlationId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"discardDuringMeetingsAndCalls"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"interopConversationStatus"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"members"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"givenName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserDetails"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messagePreviewTemplateOption"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"parentEntityTitle"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"reaction"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"senderDisplayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"senderDecoratedDisplayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"senderGivenName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"senderId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"subtype"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"tabId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"text"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"timestamp"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"topic"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"translatedPreview"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"type"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"fromExternalUser"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"activityId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isFromPriorityContact"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isUrgent"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isTextMessageVisible"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"externalAppIcon"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ToastEvent"}}},arguments:[]}]}}]};var ns,is;!function(e){e.GroupMessage="GroupMessage",e.Message="Message",e.Mention="Mention",e.Reaction="Reaction",e.InviteJoined="InviteJoined",e.TeamsTasks="TeamsTasks",e.Reminder="Reminder",e.Priority="Priority",e.DLP="DLP"}(ns||(ns={})),function(e){e.Small="HR64x64"}(is||(is={}));var ts=i(711676),as=i(815573);const os={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaUserProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]}}]},ds={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaGroupProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MsaGroupProfilePictureInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaGroupProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"msaGroupInfo"},value:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MsaGroupProfilePictureInput"}}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]}}]},ls={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"toastImageAsDataUri"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]}}]};var rs=i(726727);const ss={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsChatEmoticonQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoryId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"searchEmoticons"},arguments:[{kind:"Argument",name:{kind:"Name",value:"searchFilter"},value:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"exactMatch"},value:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"Argument",name:{kind:"Name",value:"includeShortCuts"},value:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"Argument",name:{kind:"Name",value:"includeKeywords"},value:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"Argument",name:{kind:"Name",value:"maxResultCount"},value:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"Argument",name:{kind:"Name",value:"categoryId"},value:{kind:"Variable",name:{kind:"Name",value:"categoryId"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsChatEmoticonFragment"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Emoticon"}}}}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsChatEmoticonFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Emoticon"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"description"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"unicode"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"animation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsChatEmoticonFragment_animation"}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EmoticonAnimation"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"etag"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"diverse"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"shortcuts"},__type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"searchMatch"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsChatEmoticonFragment_animation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmoticonAnimation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fps"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"framesCount"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"firstFrame"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]}]}}]}.definitions]}.definitions]};var ms=i(451567),cs=i(46845),us=i(662707),ps=i(668096);function ys(e,n){const i=e.senderGivenName||e.senderDisplayName||hs(n);if(e.subtype)return n.stringTranslate("toastNotifications","new_task_list_added_toast_title",{sender:i})}function vs(e,n){const i=function(e,n){var i,t;const a=n.topic;if(a)return a;if(!(null===(i=n.members)||void 0===i?void 0:i.length))return;return null===(t=js(e,n.members))||void 0===t?void 0:t.displayName}(e,n);return n.subtype===ps.YQ.tFLPlanCreated&&i&&n.text?e.stringTranslate("toastNotifications","task_list_in_group_chat_added_text",{groupChatTitle:i,taskListTitle:n.text}):n.text||void 0}function ks(e,n,i){const{enableInviteeJoinedActivity:t}=i.get(s.J.Activity),a=Ns(e,t?n.senderDisplayName:n.senderGivenName);return e.stringTranslate("toastNotifications",t?"toast_invite_joined_with_activity_feed_title":"toast_invite_joined",{sender:a})}function gs(e,n,i,t){const{enableInviteeJoinedActivity:a}=t.get(s.J.Activity);if(a){const n=Ns(e,i.senderDisplayName);return e.stringTranslate("toastNotifications","toast_invite_joined_with_activity_feed_text",{sender:n})}return i.members&&i.members.length?i.topic||n(e,i.members):void 0}function Ns(e,n){return n||hs(e)}function hs(e){return e.stringTranslate("toastNotifications","toast_unknown_user")}var fs=i(308292),_s=i(709009),Ss=i(219418);function Ts(e,n,i,a){var o;return(0,t.__awaiter)(this,void 0,void 0,(function*(){const{enableInAppNotificationsForChatsAndChannels:d}=a.get(s.J.Notifications,["enableInAppNotificationsForChatsAndChannels"]),{enableCustomNotificationsForChats:l}=a.get(s.J.Core,["enableCustomNotificationsForChats"]);try{const a=!d&&!l;if(i.type===ns.Priority&&a)return n.log(`${io.f.ReturningHardcodedImage}: Returning default priority message avatar for toast ${i.correlationId}`),fs.ap;if(i.type===ns.DLP)return n.log(`${io.f.ReturningHardcodedImage}: Returning default dlp message avatar for toast ${i.correlationId}`),fs.Uw;if(1===(null===(o=i.members)||void 0===o?void 0:o.length)&&i.type===ns.GroupMessage)return n.log(`${io.f.ReturningHardcodedImage} Returning default group message avatar for toast ${i.correlationId} as there is just one member`),fs.dA;if((0,Mr.j8)(i.conversationId)&&(0,ts.EG)(i.senderId))return n.log(`${io.f.ReturningHardcodedImage} Returning default PSTN avatar for toast ${i.correlationId} as sender is PSTN contact`),fs.Az;const r=i.type===ns.GroupMessage?yield function(e,n){var i;return(0,t.__awaiter)(this,void 0,void 0,(function*(){if(!(null===(i=n.members)||void 0===i?void 0:i.length))return null;const{data:t}=yield e.query({query:ds,variables:{msaGroupInfo:{pictureReadyUsers:n.members.map((({id:e,displayName:n})=>({userId:e,displayName:n}))).slice(0,rs.gT.FOUR),conversationId:n.conversationId}}});return t.msaGroupProfilePicture}))}(e,i):yield function(e,n){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const{data:i}=yield e.query({query:os,variables:{userId:n.senderId,displayName:n.senderDisplayName,profilePictureSize:is.Small}});return i.msaUserProfilePicture}))}(e,i);if(!r)return void n.error(io.f.ImageUrlGenerationFailed);const s=yield e.query({query:ls,variables:{url:r}}),m=null==s?void 0:s.data.toastImageAsDataUri;return m?(n.log(io.f.ReturningFetchedImage),n.log(`Returning fetched image for toast ${i.correlationId}`),m):void n.error(io.f.ToastImageAsDataUriIsUndefined)}catch(e){return void n.error(io.f.ImageFetchFailed)}}))}function bs(e,n,i){const{enableToastMediaTextPreview:t,enableUrgentToastsContentFixes:a,enableToastDefaultTextFallbackFix:o}=e.get(s.J.Notifications);return i.interopConversationStatus===jr.uI.AcceptPending||i.interopConversationStatus===jr.uI.ExtendedDirectoryAcceptPending?n.stringTranslate("people","invite_free_quarantined_notification_content"):i.isUrgent&&a?Cs(n,i,!!o):t?ws(n,i,!!o):As(n,i.text,!!o)}function Cs(e,n,i){return n.messagePreviewTemplateOption===mn.yF.hasText?Is(e,n,i):As(e,n.translatedPreview,i)}function ws(e,n,i){switch(n.contentType){case Ss.zc.FILE:return e.stringTranslate("toastNotifications","toast_messaging_sent_a_file");case Ss.zc.VOICE:return e.stringTranslate("toastNotifications","toast_messaging_sent_a_voice_message");case Ss.zc.IMAGE:return e.stringTranslate("toastNotifications","toast_messaging_sent_an_image");case Ss.zc.LOCATION:return e.stringTranslate("toastNotifications","toast_messaging_sent_a_location_message");case Ss.zc.VIDEO:return e.stringTranslate("toastNotifications","toast_messaging_sent_an_video");case Ss.zc.TEXT:return Is(e,n,i);default:return As(e,n.text,i)}}function Is(e,n,i){return!n.isTextMessageVisible&&i?e.stringTranslate("toastNotifications","toast_messaging_preview_hidden"):As(e,n.text,i)}function As(e,n,i){const t=function(e){const n=(0,cs.S)(e,!0).replace(/\s\s+/g," ");return(i=n,i.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g,"Â ").replace(/&quot;/g,'"')).trim();var i}(n||"");return i?t||e.stringTranslate("toastNotifications","toast_messaging_default_fallback"):t}function Fs(e,n,i,a,o){return(0,t.__awaiter)(this,void 0,void 0,(function*(){switch(o.log(`${io.f.MappingCommandOptions}: Generating command options for type ${i.type}`),i.type){case ns.Message:case ns.Priority:return function(e,n,i){return Object.assign(Object.assign(Object.assign({},$s(i)),Os(n,i.interopConversationStatus)),{text:bs(e,n,i),title:Ds(e,n,i),isUrgent:!!i.isUrgent,isFromPriorityContact:!!i.isFromPriorityContact,externalAppIconType:i.externalAppIcon?i.externalAppIcon:void 0})}(e,n,i);case ns.GroupMessage:return function(e,n,i){return Object.assign(Object.assign(Object.assign({},$s(i)),Os(n,i.interopConversationStatus)),{text:Ps(e,n,i),title:i.topic||Bs(n,i.members)})}(e,n,i);case ns.Mention:case ns.Reaction:return function(e,n,i,a){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const o=n.type===ns.Reaction?yield function(e,n,i){return(0,t.__awaiter)(this,void 0,void 0,(function*(){try{const{id:n}=(0,_s.Mc)(null==i?void 0:i.toLocaleLowerCase().trim());if(!n)return;const{data:t}=yield e.query({query:ss,variables:{searchFilter:n,exactMatch:!0}});return((null==t?void 0:t.searchEmoticons)||[])[0]}catch(e){return void n.error(io.f.ChatToastEmoticonsQueryFailed)}}))}(i,a,n.reaction):void 0;return Object.assign(Object.assign({},$s(n)),{text:n.topic||xs(e,n.senderGivenName||n.senderDisplayName,n.members),isUrgent:!!n.isUrgent,isFromPriorityContact:!!n.isFromPriorityContact,title:Es(e,n,(null==o?void 0:o.unicode)||void 0)})}))}(n,i,a,o);case ns.InviteJoined:return function(e,n,i){return Object.assign(Object.assign({},$s(i)),{text:gs(n,Bs,i,e),title:ks(n,i,e)})}(e,n,i);case ns.TeamsTasks:return function(e,n,i,a){var o;return(0,t.__awaiter)(this,void 0,void 0,(function*(){const d=yield function(e,n,i,a){var o;return(0,t.__awaiter)(this,void 0,void 0,(function*(){if(!a)return;const t=yield e.query({query:us.br,variables:{id:i,queryType:Fd.rt.QueryByThread},fetchPolicy:"network-only"}).catch((()=>{n.error(io.f.ChatTabsFetchFailed)})),d=null===(o=null==t?void 0:t.data.platformTabs)||void 0===o?void 0:o.find((e=>(null==e?void 0:e.entityId)&&(null==e?void 0:e.entityId.toLowerCase().includes(a.toLowerCase()))));return d||n.log(io.f.ToastNavigationDataNotFound),d}))}(i,a,n.conversationId,n.tabId);return Object.assign(Object.assign({},$s(n)),{text:vs(e,n)||"",title:null!==(o=ys(n,e))&&void 0!==o?o:"",type:ns.TeamsTasks,tabId:JSON.stringify({tabId:null==d?void 0:d.baseInfo.id,threadId:n.conversationId,appId:null==d?void 0:d.baseInfo.appId,tabEntityId:null==d?void 0:d.entityId})})}))}(n,i,a,o);case ns.DLP:return function(e,n){return(0,t.__awaiter)(this,void 0,void 0,(function*(){return Object.assign(Object.assign({},$s(n)),{text:n.topic||Ls(e,n.displayName||n.senderDisplayName,n.members),isUrgent:!!n.isUrgent,title:Ms(e,n)})}))}(n,i);default:return}}))}function Ds(e,n,i){var t;let a=Rs(n,i);if(ms.eo.isTFLSmsMri(i.senderId))return n.stringTranslate("toastNotifications","toast_messaging_sms_user_given_name",{sender:a});return i.fromExternalUser&&i.senderDecoratedDisplayName&&(a=i.senderDecoratedDisplayName),i.isUrgent&&(null===(t=e.get(s.J.Notifications))||void 0===t?void 0:t.enableUrgentToastsContentFixes)?n.stringTranslate("toastNotifications","toast_messaging_urgent_message_title",{sender:a}):a}function Es(e,n,i){switch(n.type){case ns.Mention:const t="everyone"===n.subtype?"toast_messaging_mention_everyone":"toast_messaging_mention";return`@ ${e.stringTranslate("toastNotifications",t,{sender:n.senderDisplayName})}`;case ns.Reaction:return e.stringTranslate("toastNotifications","toast_messaging_reaction",{sender:n.senderDisplayName,emoji:i})}}function Ms(e,n){if(n.type===ns.DLP)return e.stringTranslate("toastNotifications","dlp_notify_sender_header")}function Ps(e,n,i){const{enableToastMediaTextPreview:t,enableUrgentToastsContentFixes:a,enableToastDefaultTextFallbackFix:o}=e.get(s.J.Notifications);let d=i.text;if(d=i.isUrgent&&a?Cs(n,i,!!o):t?ws(n,i,!!o):As(n,i.text,!!o),!d)return;let l=i.senderGivenName||Rs(n,i);if(ms.eo.isTFLSmsMri(i.senderId))return n.stringTranslate("toastNotifications","toast_messaging_sms_group_text_with_sender",{sender:l,text:d});l=i.senderDecoratedDisplayName||l;const{enableGroupChatInviteFlow:r}=e.get(s.J.Messaging);return r&&i.interopConversationStatus===jr.uI.AcceptPending?n.stringTranslate("toastNotifications","toast_messaging_group_chat_invite_flow_text_with_sender",{displayName:l}):n.stringTranslate("toastNotifications","toast_messaging_group_text_with_sender",{sender:l,text:d})}function Rs(e,n){return!n.senderDisplayName||ms.eo.isDisplayNameUnknownUser(n.senderDisplayName)?e.stringTranslate("toastNotifications","toast_unknown_user"):n.senderDisplayName}function Os(e,n){return n===jr.uI.AcceptPending||n===jr.uI.ExtendedDirectoryAcceptPending||n===jr.uI.Quarantined?{quickReply:!1}:{quickReply:!0,quickReplyPlaceholder:e.stringTranslate("toastNotifications","toast_messaging_quickreply_placeholder_text"),quickReplyButton:e.stringTranslate("toastNotifications","toast_messaging_quickreply_button_text")}}function $s(e){return{conversationId:e.conversationId,messageId:e.messageId,quickReply:!1,time:new Date(+e.timestamp),discardDuringMeetingsAndCalls:!!e.discardDuringMeetingsAndCalls}}function Ls(e,n,i){if(n)return e.stringTranslate("toastNotifications","toast_messaging_activity_text",{participants:n});const t=js(e,i);return t?e.stringTranslate("toastNotifications",t.count?"toast_messaging_activity_text_with_count":"toast_messaging_activity_text",{participants:t.displayName,count:t.count}):e.stringTranslate("toastNotifications","toast_messaging_default_group_topic")}function xs(e,n,i){const t=js(e,i);return t?e.stringTranslate("toastNotifications",t.count?"toast_messaging_activity_text_with_count":"toast_messaging_activity_text",{participants:t.displayName,count:t.count}):n?e.stringTranslate("toastNotifications","toast_messaging_activity_text",{participants:n}):e.stringTranslate("toastNotifications","toast_messaging_default_group_topic")}function Bs(e,n){const i=js(e,n);return i?e.stringTranslate("toastNotifications",i.count?"toast_messaging_group_topic_with_count":"toast_messaging_group_topic",{participants:i.displayName,count:i.count}):e.stringTranslate("toastNotifications","toast_messaging_default_group_topic")}function js(e,n){if(!n||!Array.isArray(n)||0===n.length)return;const i=e.stringTranslate("toastNotifications","toast_unknown_user"),t=n.map((e=>e.givenName||i));return(0,as.Nh)(t,n.length)}function Us(e,n,i,a,o,d,l,r,m){const{enableCommandToHostCommService:u}=n.get(s.J.Core,["enableCommandToHostCommService"]),{enableBrowserToasts:p,enableInAppNotifications:y,enableInAppNotificationsForChatsAndChannels:v}=n.get(s.J.Notifications,["enableBrowserToasts","enableInAppNotifications","enableInAppNotificationsForChatsAndChannels"]);return{id:"toast-event-subscription",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const k=l.newLogger("ToastEventSubscription","apps-chat");u||p||y&&v?(k.log(io.f.Subscribing),i.subscribe({query:es,fetchPolicy:"no-cache"}).forEach(function(e,n,i,a,o,d,l,r,m){const{enableToastCollections:u}=n.get(s.J.Notifications);return s=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var t,p;if(s.errors){const e=(0,wo.u4)(s.errors.map((e=>e.message)).join());return l.error(`${io.f.SubscriptionFailed} ${e}`),void Vs(r,{errorCode:io.f.SubscriptionFailed,errors:e})}if(!(null===(t=s.data)||void 0===t?void 0:t.toastEvent))return l.error(io.f.EmptyEvent),void Vs(r,{errorCode:io.f.EmptyEvent});l.log(`${io.f.ToastEventReceivedInJob}: Received a valid event in the toast subscription job, correlationId:${s.data.toastEvent.correlationId}, activityId:${s.data.toastEvent.activityId}`);const{toastEvent:y}=s.data,v=r.newScenario(c.RG.CrossClientToastView,{startTime:+y.timestamp});v.clientId=y.correlationId,v.appendEventData({activityId:s.data.toastEvent.activityId,isUrgent:!!s.data.toastEvent.isUrgent,mainEntityType:De.py.chats,mainEntitySubtype:s.data.toastEvent.type,messageId:s.data.toastEvent.messageId}),v.mark(c.ck.CrossClientToastEventReceived),l.log(`${io.f.LogToastInfo}: ${JSON.stringify(v.eventData)}`);const k=yield Fs(n,o,y,i,l);if(!k)return l.log(`${io.f.UnhandledType} ${y.type}`),void v.incomplete({reason:io.f.UnhandledType});const g=yield d({id:k.conversationId,type:De.py.chats,action:De.uk.view,linkedEntity:null},i);if(v.mark(c.ck.CrossClientConversationFocusChecked),g)return l.log(io.f.ToastSuppressedForWindowInFocus),void v.incomplete({reason:io.f.ToastSuppressedForWindowInFocus});const N=yield Ts(i,l,y,n);v.mark(c.ck.CrossClientAvatarFetched),N&&(k.mainImage={alt:"",src:N}),null===(p=r.hoistScenarioToCore)||void 0===p||p.call(r,v),u&&(k.collectionId=lo(e,m,l)),k.type===ns.TeamsTasks?a.toasts.showChatTabEntityNotification(y.correlationId,k):a.toasts.showMessage(y.correlationId,k),v.mark(c.ck.CrossClientEntityCommandTriggered),l.log(`${io.f.ToastCommandSent} type:${k.type} correlationId:${y.correlationId} activityId:${y.activityId}`)}))}(e,n,i,a,o,d,k,r,m))):k.log(io.f.NotEnabled)}))}}function Vs(e,n){const i=e.newScenario(c.RG.CrossClientToastView);i.appendEventData({mainEntityType:De.py.chats}),i.fail(n)}const Ws=({context:{authenticationUser:e,client:n,coreSettings:i,entityCommanding:t,i18n:a,isEntityInView:o,loggerFactory:d,scenarioFactory:l,userTrackingService:r}})=>[Us(e,i,n,t,a,o,d,l,r)],Hs=({context:{scenarioFactory:e,coreSettings:n}})=>{const i=[{id:"import-chat-bundle",runOncePerId:!0,job:()=>(({scenarioFactory:e,coreSettings:n})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const i="chat-app";if(null==n?void 0:n.get(s.J.Core).enableSerializeChunkImport){const n=e.findScenario("application_launch_time");null==n||n.mark("load_chat_app_start"),yield(0,Pn.mT)(zr,i,e),null==n||n.mark("load_chat_app_end")}else(0,Pn.mT)(zr,i,e)})))({scenarioFactory:e,coreSettings:n})}];return i};var Gs=i(152386);var Js=i(220180);function qs({scenarioFactory:e,loggerFactory:n,client:i,windowProvider:a,coreSettings:o,localStorage:d,authenticationUser:l}){return{id:"bizchat-app-pre-warm",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){return((e,n,i,a,o,d,l)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var r,m,u,p,y,v,k,g,N,h,f,_;const S=n.newLogger("BizChatAppPreWarmStrategy","apps-chat"),T=e.newScenario(c.RG.BizChatPreWarm);T.appendEventData({correlationId:(0,et.v4)()});const b=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var e,n;null===(e=a.document.getElementById("bizChatAppIframe"))||void 0===e||e.remove(),null===(n=S.infoToTelemetry)||void 0===n||n.call(S,"Removed Hidden Iframe","bizchat_pre_warm_info"),null==T||T.stop({reason:"iframe-removed"}),Promise.resolve()}));try{if(null===(r=S.infoToTelemetry)||void 0===r||r.call(S,"BizChat pre-warm job started","bizchat_pre_warm_info"),!(null==l?void 0:l.profile.objectId)||!(null==l?void 0:l.profile.tenantId))return null===(m=S.errorToTelemetry)||void 0===m||m.call(S,"No authentication user found","bizchat_pre_warm_error"),void(null==T||T.fail());const{data:e}=yield i.query({query:Gs.VY,variables:{scope:Fd.qi.Personal,appId:"b5abf2ae-c16b-4310-8f8a-d3bcdb52f162"},context:{callerInfo:"BizChatAppPreWarmStrategy"}});if(!e||!e.appDefinition)return null===(u=S.infoToTelemetry)||void 0===u||u.call(S,"No app definition found. Cancelling bizchat pre-warm job","bizchat_pre_warm_info"),void(null==T||T.cancel({reason:"No App Definition"}));let n=(null===(p=e.appDefinition)||void 0===p?void 0:p.staticTabs)&&(null===(y=e.appDefinition.staticTabs[0])||void 0===y?void 0:y.contentUrl)||void 0;if(!n)return null===(v=S.errorToTelemetry)||void 0===v||v.call(S,"No contentUrl found in the app definition","bizchat_pre_warm_error"),void(null==T||T.fail());const t=n.split("hosted/semanticoverview"),c=t[0],_=t[1],C=null===(g=null===(k=a.loader)||void 0===k?void 0:k.getProperties)||void 0===g?void 0:g.call(k),w=(null==C?void 0:C.sessionId)||Js.get("sessionId"),{telemetryRegion:I}=o.get(s.J.Telemetry),{ring:A}=o.get(s.J.Metadata),F=encodeURIComponent(l.profile.objectId),D=encodeURIComponent(l.profile.tenantId),E=encodeURIComponent(null!=w?w:""),M=encodeURIComponent(null!==(N=T.eventData.correlationId)&&void 0!==N?N:"");n=`${c}semanticoverview/Users('OID:${F}@${D}')${_}&prewarm=true&sessionid=${E}&prewarmid=${M}&isEU=${encodeURIComponent("EMEA"===I)}&hostring=${encodeURIComponent(null!==(h=null==A?void 0:A.id)&&void 0!==h?h:"")}`;const P=((e,n)=>{const i=e.document.createElement("iframe");return i&&(i.setAttribute("id","bizChatAppIframe"),i.style.display="none",i.setAttribute("target","_self"),i.setAttribute("sandbox","allow-scripts allow-same-origin"),i.setAttribute("referrerpolicy","strict-origin-when-cross-origin"),i.setAttribute("allow",""),i.setAttribute("src",n),e.document.body.appendChild(i)),i&&i.contentWindow||null})(a,n);if(!P)return null===(f=S.errorToTelemetry)||void 0===f||f.call(S,"Failed to create hidden iframe","bizchat_pre_warm_error"),void(null==T||T.fail());((e,n,i)=>{let t;t=void 0,t=n.setTimeout((()=>{null==i||i(!0),n.clearTimeout(t)}),e)})(18e3,a,b),null==d||d.set("BizChatAppPreWarmTimeStamp",Date.now().toString(),"Messaging")}catch(e){const n=`Failed BizChatAppPreWarmStrategy with errorCode ${(null==e?void 0:e.errorCode)||(null==e?void 0:e.code)}`;null===(_=S.errorToTelemetry)||void 0===_||_.call(S,n,"bizchat_pre_warm_error"),null==T||T.fail()}})))(e,n,i,a,o,d,l)}))}}const zs=({context:{coreSettings:e,hostCommunicationService:n,loggerFactory:i,scenarioFactory:t,client:a,localStorage:o,windowProvider:d,entityCommanding:l,platformService:r,networkState:m,config:u,clientState:p,rebootService:y,userTrackingService:v,authenticationUser:k}})=>{const g=[],{enableBizChatPreWarm:N,bizChatPreWarmRelaunchInterval:h}=e.get(s.J.Messaging);if(N){const s=null==t?void 0:t.newScenario(c.RG.BizChatPreWarmIdleStateTrigger),N=null==o?void 0:o.get("BizChatAppPreWarmTimeStamp");let f=!0;if(N){const e=null!=h?h:288e5,n=+N;f=Date.now()-n>e}f?(null==s||s.stop({reason:"Job-pushed"}),g.push(qs({coreSettings:e,hostCommunicationService:n,loggerFactory:i,scenarioFactory:t,client:a,localStorage:o,windowProvider:d,entityCommanding:l,platformService:r,networkState:m,config:u,clientState:p,rebootService:y,userTrackingService:v,authenticationUser:k}))):null==s||s.stop({reason:"Job-Skipped"})}return g},Qs=e=>{if(Ys(e))return Ks(e)?{subNavEntity:Xs(e),headerEntity:Zs(e),startEntity:em(e),mainEntity:nm(e),endEntity:im(e)}:null},Ys=({contextEntity:e,entity:n,layoutMode:i})=>{const{action:t=null,type:a}=Object.assign({},n),{type:o,action:d}=e||{},l=[v.lO.standard,v.lO.focus].includes(i),r=[De.uk.create,De.uk.default,De.uk.empty,De.uk.info,De.uk.infoDetails,De.uk.join,De.uk.list,De.uk.view,De.uk.manage],s=t&&r.includes(t),m=d&&o,c=[De.py.byodchat,De.py.chats,De.py.chatschannelconv,De.py.chatsInfo,De.py.chatContextualSearch,De.py.chatsInfoView,De.py.chatManageApps,De.py.chatHighlightsDetails,De.py.chatfluidthread,De.py.chatfilesdetails,De.py.chatpeopledetails,De.py.chatworkflows,De.py.chatpinnedmessagesdetails].includes(a),u=i===v.lO.focus&&t===De.uk.list;return!(!l||!c||!s&&!m||u)},Ks=({entity:e,contextEntity:n})=>{const{type:i}=n||{},{action:t=null,type:a}=e||{},o=[De.py.byodattendeewindow,De.py.calls,De.py.callsgalleryandcontent,De.py.callsgallery,De.py.callscontent,De.py.platformStage,De.py.meetingroomallinonecall];return!(a!==De.py.chats&&a!==De.py.byodchat&&a!==De.py.chatsInfoView&&a!==De.py.chatschannelconv&&!pm(a)||!(t||i&&!o.includes(i)))},Xs=({entity:e,layoutMode:n})=>{if(n===v.lO.focus)return null;const{type:i,action:t}=e;let a;if("options"in e){const n=e.options&&(0,Wt.D)(e.options);((null==n?void 0:n.messageId)||(null==n?void 0:n.searchSessionId)||(null==n?void 0:n.focusOnLoad))&&(a=kn.Y.DoNotMove)}a||i!==De.py.chats&&i!==De.py.chatschannelconv||t!==De.uk.default||(a=kn.Y.LeftRailSelectedItem);return{action:De.uk.list,entityState:{flushableByLinkedEntity:!0},id:null,linkedEntity:null,options:a?(0,wo.u4)({focusOnLoad:a}):null,type:i,windowOptions:null}},Zs=({entity:e})=>{let n=De.uk.view;const{action:i=null}=Object.assign({},e),t=[De.uk.create,De.uk.default,De.uk.empty,De.uk.join];return i&&t.includes(i)&&(n=i),Object.assign(Object.assign({},e),{action:n})},em=()=>null,nm=({entity:e,contextEntity:n})=>{let i=De.uk.view;const{action:t=null}=Object.assign({},e),a=[De.uk.create,De.uk.default,De.uk.empty,De.uk.join,De.uk.manage];return t&&a.includes(t)&&(i=t),n||Object.assign(Object.assign({},e),{action:i})},im=({entity:e,contextEntity:n,coreSettings:i,layoutMode:t,userPreferences:a})=>{const{chatInfoPaneVisibilityState:o}=(null==i?void 0:i.get(s.J.Host))||{},{enableChatInfoPaneSearch:d}=(null==i?void 0:i.get(s.J.Messaging))||{},{enableExtensibilityAppPicker:l}=(null==i?void 0:i.get(s.J.Extensibility))||{},r=am(i),m=dm(o,a,r);let c,u,p,y;if(n){if(({id:c,type:u,options:p,action:y}=n),u===De.py.meetingcollaboration)return n}else({id:c,type:u}=e),"options"in e&&(p=e.options);if(!((e,n,i,t,a)=>{var o;return!(a!==De.py.chatContextualSearch&&a!==De.py.chatHighlightsDetails&&a!==De.py.chatfluidthread&&a!==De.py.chatsInfoView&&a!==De.py.chatsInfo&&a!==De.py.chatpeopledetails&&a!==De.py.chatfilesdetails&&a!==De.py.chatpinnedmessagesdetails&&a!==De.py.extensibilityapppickersidepanel&&(n!==v.lO.standard||e||!(null===(o=null==t?void 0:t.get(s.J.Core))||void 0===o?void 0:o.enableInfoPaneAsResponsiveMenu))||i&&n!==v.lO.standard&&n!==v.lO.focus)})(m,t,d,i,u))return null;const k=om(c),g=(0,Er.fM)(c),N=tm(u);if(!k&&!g&&um(u,y,d,!!l)){return{action:De.uk.info,id:c||"",type:u,options:p}}if(!k&&!g&&N){return{action:De.uk.info,id:c||"",type:De.py.chatsInfoView}}if(!k&&!g&&pm(u)){return{action:De.uk.infoDetails,id:c||"",type:u,options:p}}return null},tm=e=>e===De.py.byodchat||e===De.py.chats||e===De.py.chatschannelconv||e===De.py.chatsInfoView,am=e=>{if(e){const{enableChatInfoPaneDefaultOpen:n}=e.get(s.J.Messaging),{enableChatInfoPaneDefaultOpen:i}=e.get(s.J.Host);return n||i}return!1},om=e=>(0,Er.wm)(e)||(0,Er.UL)(e),dm=(e,n,i)=>{var t,a;return"closed"===(null!==(a=null!=e?e:null===(t=null==n?void 0:n.infoPane)||void 0===t?void 0:t.chatsInfoView)&&void 0!==a?a:i?"hidden":"closed")},lm=e=>new Map([[k.Rd.IS_GREATER_THAN_0,e],[k.Rd.IS_AT_LEAST_947,e],[k.Rd.IS_AT_LEAST_1350,e],[k.Rd.IS_AT_LEAST_1500,e]]),rm=(e,n)=>{var i;return null===(i=null==e?void 0:e.find((e=>e.breakpoint===n)))||void 0===i?void 0:i.width},sm="41rem",mm="32rem",cm=({areEmptySlotsTransparent:e,coreSettings:n,entity:i})=>{var t,a,o,d,l,r,m;const{isFlyoutChat:c}=null!==(t=null==n?void 0:n.get(s.J.Flyout))&&void 0!==t?t:{},{isNonInteractiveMeetingChat:u,chatPaneWidthOnLargeScreen:p}=null!==(a=null==n?void 0:n.get(s.J.Calling))&&void 0!==a?a:{};let y=["Teacher","Student"].includes(null==n?void 0:n.get(s.J.UserResources).licenseType)?lm("32rem"):void 0;if(!y&&u){const{enableResponsiveChatPanel:e}=null!==(o=null==n?void 0:n.get(s.J.Calling))&&void 0!==o?o:{};y=e?new Map([[k.Rd.IS_GREATER_THAN_0,mm],[k.Rd.IS_AT_LEAST_1350,null!==(d=rm(p,k.Rd.IS_AT_LEAST_1350))&&void 0!==d?d:sm],[k.Rd.IS_AT_LEAST_2560,null!==(l=rm(p,k.Rd.IS_AT_LEAST_2560))&&void 0!==l?l:"47rem"],[k.Rd.IS_AT_LEAST_3840,null!==(r=rm(p,k.Rd.IS_AT_LEAST_3840))&&void 0!==r?r:"72rem"]]):lm(sm)}const{chatInfoPaneVisibilityState:v}=null!==(m=null==n?void 0:n.get(s.J.Host))&&void 0!==m?m:{};return y=v&&"hidden"===v?new Map([[k.Rd.IS_GREATER_THAN_0,"0"],[k.Rd.IS_AT_LEAST_947,"0"],[k.Rd.IS_AT_LEAST_1350,mm],[k.Rd.IS_AT_LEAST_1500,mm]]):y,y=(null==i?void 0:i.type)===De.py.chatfluidthread?new Map([[k.Rd.IS_GREATER_THAN_0,"30rem"],[k.Rd.IS_AT_LEAST_947,"40rem"],[k.Rd.IS_AT_LEAST_1350,"50rem"],[k.Rd.IS_AT_LEAST_1500,"75rem"],[k.Rd.IS_AT_LEAST_1680,"85rem"],[k.Rd.IS_AT_LEAST_2560,"100rem"]]):y,{endEntity:{[Fe.S.Rail]:{slotWidthOverrides:y,isHideInfoPaneDisabled:(null==i?void 0:i.type)===De.py.chatContextualSearch||(null==i?void 0:i.type)===De.py.chatHighlightsDetails||(null==i?void 0:i.type)===De.py.chatfluidthread||(null==i?void 0:i.type)===De.py.extensibilityapppickersidepanel,infoPaneVisibilityStateInHybrid:v}},subNavEntity:{[Fe.S.Rail]:{areSlotShadowsDisabled:e,isBackgroundTransparent:!!(null==n?void 0:n.get(s.J.Core).enableTransparentLeftRail)||e,isColorSchemeDefaultBackground3:!e}},mainEntity:{[Fe.S.Main]:{isBackgroundTransparent:!!c,infoPaneVisibilityStateInHybrid:v}},headerEntity:{[Fe.S.HorizontalBar]:{isBackgroundTransparent:e}}}},um=(e,n,i,t)=>n!==De.uk.infoDetails&&(e===De.py.chatHighlightsDetails||e===De.py.chatfluidthread||e===De.py.extensibilityapppickersidepanel&&t||e===De.py.chatContextualSearch&&i),pm=e=>e===De.py.chatpeopledetails||e===De.py.chatfilesdetails||e===De.py.chatpinnedmessagesdetails||e===De.py.chatHighlightsDetails||e===De.py.chatContextualSearch||e===De.py.chatfluidthread||e===De.py.chatsInfo;var ym=i(551675),vm=i(598135),km=i(651966),gm=i(491465);const Nm={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsChatShowPrivateMeetingConversationMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showPrivateMeetingConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"context"},value:{kind:"Variable",name:{kind:"Name",value:"context"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]},hm={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsChatSaveCopilotAppStatesMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"streamStopped"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appFocused"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"saveCopilotAppStates"},arguments:[{kind:"Argument",name:{kind:"Name",value:"streamStopped"},value:{kind:"Variable",name:{kind:"Name",value:"streamStopped"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"Argument",name:{kind:"Name",value:"appFocused"},value:{kind:"Variable",name:{kind:"Name",value:"appFocused"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"streamStopped"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"appFocused"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CopilotAppStates"}}}}]}}]},fm="/l/invite/",_m="/l/claim",Sm={[_m]:ym.DL.Claim,[fm]:ym.DL.Invite},Tm=new Set([_m,fm]),bm=(e,n,i,t,a)=>{var o;const d=new URLSearchParams(e.search),l=null===(o=d.get("users"))||void 0===o?void 0:o.split(",").map((e=>e.trim())),r=d.get("message"),s=d.get("topicName");return i.stop({reason:`deeplink to chat with users: userCount-${null==l?void 0:l.length} isMessagePresent:${!!r} isTopicNamePresent:${!!s}`}),n.log("deeplink_to_chat_qsp_received"),Promise.resolve({entityCommand:{entity:{type:De.py.chats,action:De.uk.view},command:{visibilityState:v.fe.show,stateTransition:v.su.new},correlation:{source:sn.D.ChatDeeplinkUsers},entityOptions:{initialComposeMessage:r,groupName:s,users:l,isViewFromChatDeeplink:!0}},metadata:{allowAnonymous:!1,accountsToUse:Im(a,t)}})},Cm=(e,n,i,t,a)=>{var o;const d=e.pathname.split("/");return d.length>3&&(d[3].startsWith(jr.at.SkypeSpacesThread)||(0,Mr.mB)(d[3])||(0,Er.wm)(d[3]))?(i.stop({reason:`deeplink to chat with id: ${d[3]}`}),Promise.resolve({entityCommand:{entity:{type:De.py.chats,action:De.uk.view,id:d[3]},command:{visibilityState:v.fe.show,stateTransition:v.su.new},correlation:{source:sn.D.ChatDeeplinkId}},metadata:{allowAnonymous:!1,accountsToUse:Im(a,t)}})):(i.fail({reason:`deeplink to chat fail with invalid path: ${(0,bd.A)(e.pathname.replace(/@/g,"_at_"))}`}),null===(o=n.warnNoPii)||void 0===o||o.call(n,`invalid path name ${e.pathname}`),Promise.reject("Deeplink to chat path invalid"))},wm=(e,n)=>Promise.resolve({entityCommand:{entity:{type:De.py.chats,action:De.uk.join},command:{visibilityState:v.fe.show,stateTransition:v.su.flush},entityOptions:{inviteLinkType:n,inviteLinkUrl:e.toString()}},metadata:{allowAnonymous:!1}}),Im=(e,n)=>{if(e)return n?[n.userContextId]:void 0},Am=(e,n,i,a)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t;try{yield e.mutate({mutation:Nm,variables:{conversationId:n,context:"apps-chat"}}),a.mark(c.ck.ExtDeeplinkToChatMessageUnhideThreadSuccess)}catch(e){const o=`Failed to unhide chat thread ${n} in deeplink to chat message`;null===(t=i.errorNoPii)||void 0===t||t.call(i,o),a.mark(c.ck.ExtDeeplinkToChatMessageUnhideThreadFail)}})),Fm="chat",Dm="viewChatApp",Em="chatWithUsers",Mm="newChat",Pm="popNewChat",Rm=()=>({actor:Fm,action:Dm}),Om=e=>({actor:Fm,action:Em,data:e}),$m=()=>({actor:Fm,action:Mm}),Lm=()=>({actor:Fm,action:Pm}),xm={id:"com.microsoft.teams.chat",name:"Chat",getLocalizedName:e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("messaging"),e.stringTranslate("messaging","messaging_app_name")})),actors:[Fm],supportedEntities:[De.py.alttext,De.py.byodchat,De.py.chats,De.py.chatschannelconv,De.py.chatContextualSearch,De.py.chatHighlightsDetails,De.py.chatfilesdetails,De.py.chatpinnedmessagesdetails,De.py.chatfluidthread,De.py.chatManageApps,De.py.chatmaxmultiplepinnedmessages,De.py.chatpeopledetails,De.py.chatsInfo,De.py.chatsInfoView,De.py.codesnippet,De.py.customizereactions,De.py.customemojiupload,De.py.deletechat,De.py.dlp,De.py.fluid,De.py.giphyconsent,De.py.hyperlink,De.py.chatInviteConfirmation,De.py.leavechat,De.py.messagedraft,De.py.pinnedchatsmaxreached,De.py.pinnedconversationitems,De.py.removechatuser,De.py.reportConcern,De.py.forwardMessage,De.py.reportConcernForTFW,De.py.sharechatlink,De.py.streamcamera,De.py.streamcamerainchannels,De.py.streamcameraincommunities,De.py.translationfeedback,De.py.twowaysmsfriendlyname,De.py.updategroupchatavatar,De.py.tfwupdategroupchatavatar,De.py.blockChat,De.py.multiStepAcceptChat,De.py.leaveGroupAndBlockUser,De.py.m365ChatLike,De.py.m365ChatDislike,De.py.m365ChatReportHarm,De.py.chatworkflows,De.py.extensibilityapppickersidepanel],supportedRenderModes:[Fe.S.HorizontalBar,Fe.S.Main,Fe.S.Modal,Fe.S.Rail],getDefaultCommand:e=>{const{enableFilterPinnedAppsBasedOnPolicy:n}=e.get(s.J.Extensibility);if(!n||(0,Pr.t3)(e.get(s.J.Messaging))!==Pr.i1.Disabled)return{action:De.uk.default,type:De.py.chats}},windowFeatures:{minWidth:602,width:602,minHeight:500,height:500,offset:20,widthToScreenWidthRatio:.3,heightToWidthRatio:1.125},infoPaneStateMapping:{[De.py.chatpeopledetails]:De.py.chatsInfoView,[De.py.chatfilesdetails]:De.py.chatsInfoView,[De.py.chatpinnedmessagesdetails]:De.py.chatsInfoView},getAllowUserWindowingPreference:({coreSettings:e})=>!!e.get(s.J.Chat).chatDeeplinkRespectUserPreference},Bm={shouldAddEntitiesToWindowHistory:e=>{var n,i;return!(0,Er.UL)(null===(n=null==e?void 0:e.mainEntity)||void 0===n?void 0:n.id)&&(null===(i=null==e?void 0:e.mainEntity)||void 0===i?void 0:i.action)!==De.uk.create},shouldRestoreClientToEntities:()=>!0,shouldStoreLastVisitedInAppHistory:()=>!0},jm={onEventReceived:({eventInput:e})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n,i,t,a,o,d,l,r;switch(e.event.type){case Ze.uS.requestPersonMoreInfo:const s=null===(i=(n=e.event).data)||void 0===i?void 0:i.call(n);return Promise.resolve({command:on(s)});case Ze.uS.requestTopicMoreInfo:{const n=null===(a=(t=e.event).data)||void 0===a?void 0:a.call(t);return Promise.resolve({command:ln(n)})}case ad.uS.expandTab:{const n=null===(d=(o=e.event).data)||void 0===d?void 0:d.call(o);return Promise.resolve({command:od.CN.expandTab(n)})}case ad.uS.resetLayoutOverrides:return Promise.resolve({command:od.CN.resetLayoutOverrides()});case ad.uS.maximizeTab:return Promise.resolve({command:od.CN.maximizeTab()});case ad.uS.showMonitor:return Promise.resolve({command:od.CN.showMonitor(null===(r=(l=e.event).data)||void 0===r?void 0:r.call(l))});case ad.uS.closeMonitor:return Promise.resolve({command:od.CN.closeMonitor()});case ad.uS.hideMonitor:return Promise.resolve({command:od.CN.hideMonitor()});case ad.uS.unhideMonitor:return Promise.resolve({command:od.CN.unhideMonitor()})}return Promise.resolve(void 0)}))},Um="openContextualSearch",Vm=e=>({actor:"chat",action:Um,data:e}),Wm={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsChatChatWithUserQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"createLieIfNotFound"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chatWithUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"createLieIfNotFound"},value:{kind:"Variable",name:{kind:"Name",value:"createLieIfNotFound"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}}}]}}]},Hm={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsChatUserPreferenceNewChatQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPersonalSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messagingSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"alwaysPopOutNewChat"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MessagingSettings"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserSettings"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferences"}}},arguments:[]}]}}]},Gm={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsChatCreateNewChatMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createNewChat"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"conversation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"timeStamp"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ConsumptionHorizon"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"memberIds"},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"membersLimited"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"email"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"givenName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"User"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"memberDisplayNamesLimited"},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"chatDisabledContext"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUIDisabled"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"disabledReason"},__type:{kind:"NamedType",name:{kind:"Name",value:"ChatDisabledContextReason"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"extendedData"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"lastUpdatedTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ChatDisabledContext"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hasIBPolicyRejectedUsers"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CreateChatResult"}}},arguments:[]}]}}]};var Jm=i(90586);const qm=(e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){yield e.mutate({mutation:Gm});let a=i;return a||(a=yield((e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var i,t,a,o;const{enableNewChatPopOut:d,enableDefaultSettingsNewChatPopOut:l}=n.get(s.J.Chat);if(!d)return!1;const{data:r}=yield e.query({query:Hm});return null!==(o=null===(a=null===(t=null===(i=null==r?void 0:r.userPreferences)||void 0===i?void 0:i.userPersonalSettings)||void 0===t?void 0:t.messagingSettings)||void 0===a?void 0:a.alwaysPopOutNewChat)&&void 0!==o?o:!!l})))(e,n)),{entity:{type:De.py.chats,action:De.uk.view,id:Er.FX},command:{visibilityState:v.fe.show,stateTransition:a?v.su.new:v.su.forceFlush,correlation:{source:sn.D.AppBarContextMenu}}}})),zm=({commandInput:e,requestContext:{loggerFactory:n,client:i,executionContext:a,coreSettings:o}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:d,data:l}}=e,r=n.newLogger("ChatApp onCommandReceived","apps-chat");if(e.command.actor===Fm)switch(d){case Dm:return{entity:{type:De.py.chats,action:De.uk.default},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,correlation:{source:sn.D.Unknown}}};case Mm:return qm(i,o,!1);case Pm:return qm(i,o,!0);case Em:if(!(e=>"object"==typeof e&&null!==e&&"mri"in e&&"correlationSource"in e)(l))return void r.error(`Command for action '${d}' requires an mri and correlationSource.`);const e=i,n=yield((e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{data:i}=yield e.query({query:Wm,variables:{userId:n,createLieIfNotFound:!0},fetchPolicy:"network-only"});return null==i?void 0:i.chatWithUser})))(e,l.mri),s=null==n?void 0:n.id;return s?{entity:{type:De.py.chats,action:De.uk.view,id:s},command:{stateTransition:v.su.new,visibilityState:v.fe.show,correlation:{id:(0,et.v4)(),source:l.correlationSource,startTimestamp:Date.now()}}}:void r.error("Could not fetch the user conversation using the mri");case Um:if(!(e=>"object"==typeof e&&null!==e&&"searchQuery"in e&&"entrySource"in e&&"convId"in e&&"logicalId"in e)(l))return void r.error(`Command for action '${d}' requires a searchQuery, entrySource, convId and logiclaId.`);const{entityTypeChat:m,entityTypeChannel:c}=(e=>{var n;const i=null===(n=e.viewEntities.mainEntity)||void 0===n?void 0:n.type;return{entityTypeChat:i===De.py.chats,entityTypeChannel:i===De.py.channels}})(a);if(!m&&!c)return void r.error(`Command for action '${d}' requires entity type to be ${De.py.chats} or ${De.py.channels}`);const u=((e,n)=>{var i,t;let a;if(n)a=(null===(i=e.viewEntities.mainEntity)||void 0===i?void 0:i.id)||"";else{const n=JSON.parse((null===(t=e.viewEntities.mainEntity)||void 0===t?void 0:t.id)||"").channelId;a=JSON.stringify({channelId:`${n}`})}return a})(a,m),p=m?De.py.chatContextualSearch:De.py.channelcontextualsearch,y=m?sn.D.ChatContextualSearch:sn.D.ChannelContextualSearch;return{entity:{id:u,action:De.uk.info,type:p},command:{visibilityState:v.fe.show,stateTransition:v.su.none,correlation:{id:(0,et.v4)(),source:y}},entityOptions:{detailViewType:Jm.em.Search,searchQuery:l.searchQuery,entrySource:l.entrySource,convId:l.convId,logicalId:l.logicalId}};default:r.error(`Command action '${d}' is not supported at ChatApp.`)}else r.error(`Command for actor '${e.command.actor}' cannot be handled by ChatApp.`)})),Qm=({appViewState:e,availableEntities:n,requestContext:i})=>{var t,a,o,d,l,r,m,c,u,p,y;const{selectedChatId:v}=e,{coreSettings:k}=i,g=k.get(s.J.ChatList).bizChatMetaOSAppId;if((null===(t=n.mainEntity)||void 0===t?void 0:t.type)===De.py.chats&&((null===(a=n.mainEntity)||void 0===a?void 0:a.action)===De.uk.view||(null===(o=n.mainEntity)||void 0===o?void 0:o.action)===De.uk.create||(null===(d=n.mainEntity)||void 0===d?void 0:d.action)===De.uk.default)||(null===(l=n.mainEntity)||void 0===l?void 0:l.type)===De.py.chatschannelconv&&(null===(r=n.mainEntity)||void 0===r?void 0:r.action)===De.uk.view||(null===(m=n.mainEntity)||void 0===m?void 0:m.type)===De.py.chatManageApps){const e=null===(c=n.mainEntity)||void 0===c?void 0:c.id;(null==v?void 0:v.read())!==e&&(null==v||v.update((null===(u=n.mainEntity)||void 0===u?void 0:u.action)===De.uk.create||null===(p=n.mainEntity)||void 0===p?void 0:p.id))}else if((null===(y=n.mainEntity)||void 0===y?void 0:y.type)===De.py.extensions&&n.mainEntity.action===De.uk.view&&n.mainEntity.id){let e;try{e=JSON.parse(n.mainEntity.id).appId}catch(n){e=void 0}e&&g===e&&(null==v?void 0:v.read())!==e&&(null==v||v.update(e))}return Promise.resolve(void 0)},Ym={gqlTypeName:"ChatAppViewState",queryFieldName:"chatAppViewState",computedValues:void 0,navigationalFieldDefaultValues:{},nonNavigationalFieldDefaultValues:{selectedChatId:null}};var Km=i(766052),Xm=i(541986);const Zm=({children:e})=>(0,Ie.t)(Ae.Fragment,{children:e}),ec=(e,n,i)=>{const t=e.command.correlation.source,{entity:a,command:o,entityOptions:d}=e,l=!(!d||!d.messageId);return a.type===De.py.chats&&o.stateTransition===v.su.new&&o.visibilityState===v.fe.show?l?c.RG.EntityCommand:(0,Mr.j8)(a.id)?c.RG.PhonelinkSmsChatPopOut:c.RG.ChatPopOut:a.type!==De.py.chats&&a.type!==De.py.byodchat||a.action!==De.uk.view&&a.action!==De.uk.default||o.visibilityState!==v.fe.show||t===sn.D.StandAlone?a.type===De.py.chatContextualSearch&&a.action===De.uk.info&&o.visibilityState!==v.fe.hide?c.RG.ContextualSearchStart:a.type===De.py.chatHighlightsDetails&&a.action===De.uk.info&&o.visibilityState===v.fe.show?c.RG.ChatHighlightsDetailsStart:c.RG.EntityCommand:l?c.RG.EntityCommand:((e,n,i)=>{if(e.id===Er.FX)return c.RG.NewChat;if(n===sn.D.ChatListMeetingItem||n===sn.D.Calendar||(0,Er.Eu)(e.id))return c.RG.MeetingChatSwitch;const{isFlyoutChat:t}=i.get(s.J.Flyout);if(t)return(0,Mr.j8)(e.id)?c.RG.PhonelinkSmsInlineChatSwitch:c.RG.InlineChatSwitch;const{chatSwitchInPopOut:a}=i.get(s.J.Chat);return a?c.RG.ChatSwitchPopOut:(0,Mr.j8)(e.id)?c.RG.PhonelinkSmsChatSwitch:c.RG.ChatSwitch})(a,t,i)},nc=({coreServices:e,host:n,prevEntityType:i,screenState:t,windowOptions:a})=>{if(i===De.py.chats)return null;const{height:o,minHeight:d,minWidth:l,offset:r,width:m}=xm.windowFeatures||{},c={left:(null==n?void 0:n.screenX)||0,top:(null==n?void 0:n.screenY)||0},u=((null==t?void 0:t.numOpenWindows)||1)*(r||1);return Object.assign(Object.assign({additionalFeatures:{minHeight:`${d}`,minWidth:`${l}`},height:o,left:(null==c?void 0:c.left)+u,minHeight:d,minWidth:l,top:(null==c?void 0:c.top)+u,width:m},(null==e?void 0:e.coreSettings.get(s.J.Core).enableRatioToScreenBasedSizing)&&function(e,n){const{widthToScreenWidthRatio:i,heightToWidthRatio:t}=n||{};if(!e||!t||!i)return{};const a=i*e.screen.availWidth;return{height:a*t,width:a}}(n,xm.windowFeatures)),a)};const ic=()=>{const e=({deeplinkUrl:e,context:n})=>{const i=n.loggerFactory.newLogger("ChatApp","apps-chat");return((e,n,i)=>{const{pathname:t}=i,{enableInviteLinks:a}=e.get(s.J.InviteLinks);for(const e of Array.from(Tm))if(t.startsWith(e)){if(!a){const e="Invite link redemption is disabled for this experience";return n.error(e),Promise.reject(e)}const t=Sm[e];if(void 0===t){const e="No Invite link type found for the specified prefixType";return n.error(e),Promise.reject(e)}return wm(i,t)}const o="No DeeplinkPrefixType found for the specified deeplinkUrl";return n.error(o),Promise.reject(o)})(n.coreSettings,i,e)},n=(e,n)=>{if(n){const n=e.find((e=>e.userContextAccountType===Km.K.SourceWindow));if(n)return n}const i=e.find((e=>e.userContextAccountType===Km.K.MainWindow));return i||(e&&e.length>0?e[e.length-1]:void 0)},i={filter:"/l/chat",execute:({deeplinkUrl:e,context:{getUserContexts:i,loggerFactory:a,scenarioFactory:o,coreSettings:d}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const t=a.newLogger("ChatApp_parseChatDeeplink","apps-chat"),l=!!d.get(s.J.Chat).chatDeeplinkRespectUserPreference,r=yield i(),m=n(r,l);return((e,n,i,t,a)=>{const o=i.newScenario(c.RG.ExtDeeplinkToChat);if(e.pathname.startsWith("/l/chat/0/0"))return bm(e,n,o,t,a);{const{pathname:d,search:l}=e;n.log(`Parsing deeplinkUrl - pathname: ${d}, search: ${l}`);const r=decodeURIComponent(d),s=r.split("/"),m=null==r?void 0:r.split(/[/?&]/),c=null==m?void 0:m.indexOf("chat"),u=null==m?void 0:m[c+km.ei],p=s.findIndex((e=>e.startsWith(jr.at.SkypeSpacesThread))),y=s[p],v=new URLSearchParams(l),k=v.get("context");let g;try{g=k&&JSON.parse(k)}catch(e){const n="executeChatDeeplinkUrl(): Unable to parse context.";throw o.fail({reason:n}),new Error(n)}const N=v.get("tenantId")||void 0;if((null==u?void 0:u.startsWith(km.pQ))||Object.keys(km.ox).includes(u)){const n=(0,km.Jj)("",y,e,N,g,u,i);return o.stop({reason:"deeplink to chat tab"}),Promise.resolve(n)}return Cm(e,n,o,t,a)}})((0,Xm.P)(e,d),t,o,m,l)}))};return[{filter:"/l/claim",execute:e},{filter:"/l/invite/",execute:e},i,{filter:e=>{var n;if(null===(n=e.pathname)||void 0===n?void 0:n.startsWith("/l/message")){const n=new URLSearchParams(e.search).get("context");try{const e=null==n?null:JSON.parse(n);return"chat"===(null==e?void 0:e.contextType)}catch(e){return!1}}return!1},execute:({deeplinkUrl:e,preferredCommandInput:i,context:{getUserContexts:a,loggerFactory:o,scenarioFactory:d,coreSettings:l}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var r,m;const u=o.newLogger("ChatApp_parseChatDeeplink","apps-chat"),p=[sn.D.ActivityFeed,sn.D.ActivityFeedBellClick],y=!(!!(null===(r=null==i?void 0:i.correlation)||void 0===r?void 0:r.source)&&p.includes(null===(m=null==i?void 0:i.correlation)||void 0===m?void 0:m.source))&&!!l.get(s.J.Chat).chatDeeplinkRespectUserPreference,k=yield a(),g=n(k,y);return((e,n,i,a,o,d,l)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,r,m;const u=a.newScenario(c.RG.ExtDeeplinkToChatMessage),{enableChatDeeplinkUnhideThread:p}=n.get(s.J.Calling);if(!e.pathname.startsWith("/l/message"))return u.fail({reason:c.ck.ExtDeeplinkToChatMessagePathNotFound}),i.log("ext_deeplink_to_chat_message_path_not_found"),Promise.reject("Deeplink to chat message path not found");const y=e.pathname.split("/"),k=y[3];if(u.appendEventData({"Thread.Id":k}),y.length>3&&!k.startsWith(jr.at.SkypeSpacesThread)&&!k.startsWith(jr.at.PrivateFeed))return u.fail({reason:c.ck.ExtDeeplinkToChatMessageTypeNotSupported}),i.log("ext_deeplink_to_chat_message_type_not_supported"),Promise.reject("Deeplink to chat message type not supported");let g=4<=y.length?y[4]:void 0;g="0"===g?void 0:g,u.mark(c.ck.ExtDeeplinkToChatMessageParamsReceived),i.log("ext_deeplink_to_chat_message_params_received");const N=null===(t=null==d?void 0:d.context)||void 0===t?void 0:t.client;if(N){if(p&&(0,Er.Eu)(k)){const e=`Unhiding chat thread ${k} in deeplink to chat message`;i.log(e),u.mark(c.ck.ExtDeeplinkToChatMessageUnhideThreadStart),yield Am(N,k,i,u)}const{data:e}=yield N.query({query:gm.vh,variables:{convId:k},context:{callerInfo:"apps-chat"}}),n=null==e?void 0:e.chat;if(n&&(!n.memberIds||0===n.memberIds.length))return u.fail({reason:c.ck.ExtDeeplinkToChatMessageUserIsNotMember}),i.log("ext_deeplink_to_chat_message_user_is_not_member."),Promise.resolve({entityCommand:{entity:{type:De.py.chats,action:De.uk.error,id:vm.P.UnableToViewChat},command:{stateTransition:v.su.extend,visibilityState:v.fe.show}},metadata:{allowAnonymous:!1}})}u.stop({reason:c.ck.ExtDeeplinkToChatMessageResolved}),i.log("ext_deeplink_to_chat_message_resolved");const h=(0,et.v4)();return Promise.resolve({entityCommand:{entity:{type:De.py.chats,action:De.uk.view,id:k},command:{visibilityState:null!==(r=null==o?void 0:o.visibilityState)&&void 0!==r?r:v.fe.show,stateTransition:null!==(m=null==o?void 0:o.stateTransition)&&void 0!==m?m:v.su.flush},correlation:{source:sn.D.ChatDeeplinkMessage},entityOptions:{messageId:g,uniqueId:h}},metadata:{allowAnonymous:!1,accountsToUse:Im(l,d)}})})))((0,Xm.P)(e,l),l,u,d,i,g,y)}))},{filter:({protocol:e,pathname:n})=>{return"im:"===e||"sip:"===e&&(i=n.trim(),/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(i.toLowerCase()));var i},execute:({deeplinkUrl:e,context:{getUserContexts:i,loggerFactory:a,coreSettings:o}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t;const d=a.newLogger("ChatApp_parseChatProtocolDeeplink","apps-chat"),l=(null===(t=xm.getAllowUserWindowingPreference)||void 0===t?void 0:t.call(xm,{coreSettings:o}))||!1,r=yield i(),s=n(r,l);return((e,n,i,t)=>{const{protocol:a,pathname:o}=e;return n.log(`ChatApp_parseChatProtocolDeeplink: Deeplink to chat from protocol ${a} with pathname: ${o} received`),Promise.resolve({entityCommand:{entity:{type:De.py.chats,action:De.uk.view},command:{visibilityState:v.fe.show,stateTransition:v.su.new},correlation:{source:sn.D.ChatProtocolDeeplink},entityOptions:{users:[e.pathname],isViewFromChatDeeplink:!0}},metadata:{allowAnonymous:!1,accountsToUse:Im(t,i)}})})(e,d,s,l)}))},{filter:"/l/copilot",execute:({deeplinkUrl:e,context:{getUserContexts:i,loggerFactory:a,coreSettings:o,scenarioFactory:d}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const t=!!o.get(s.J.ChatList).enableBizChatMetaOSEntryPoint,l=a.newLogger("ChatApp_parseCopilotDeeplink","apps-chat"),r=!!o.get(s.J.Chat).chatDeeplinkRespectUserPreference,m=yield i(),u=n(m,r);return((e,n,i,t,a)=>{var o,d;const l=null===(o=null==a?void 0:a.context)||void 0===o?void 0:o.client,{search:r}=e,s=i.newScenario(c.RG.CopilotAppDeeplinkExecute);if(!e.pathname.startsWith("/l/copilot"))return s.fail({reason:"Invalid deeplink path"}),Promise.reject("Invalid deeplink path");if(s.mark(c.ck.CopilotAppDeeplinkReceived),!t)return s.stop({reason:"Deeplink call not handled because enableBizChatMetaOSEntryPoint is not enabled."}),Promise.resolve(void 0);if("?bold=false"===r)return s.stop({reason:"Expected: deeplink call not handled due to app reloads."}),Promise.resolve(void 0);try{l.mutate({mutation:hm,variables:{streamStopped:!0},fetchPolicy:"no-cache"}).then((()=>{s.mark(c.ck.CopilotAppDeeplinkStatesWritten),s.stop({reason:"Deeplink call successfully handled."})}))}catch(e){null===(d=n.errorToTelemetry)||void 0===d||d.call(n,"Could not write copilot app states to the cache.","messaging_copilot_app",void 0,!0),s.fail({reason:"Could not write copilot app states to the cache."})}return Promise.resolve(void 0)})(e,l,d,t,u)}))},{filter:"/l/loopthread",execute:({deeplinkUrl:e,preferredCommandInput:i,context:{getUserContexts:a,coreSettings:o}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const t=!!o.get(s.J.Chat).chatDeeplinkRespectUserPreference,d=yield a(),l=n(d,t);return((e,n,i,t)=>{var a,o;if(!e.pathname.startsWith("/l/loopthread/"))return Promise.reject("Invalid deeplink path");const d=e.pathname.split("/");return Promise.resolve({type:"navigateWithEntityCommand",entityCommand:{entity:{type:De.py.chatfluidthread,action:De.uk.view,id:d[3]},command:{visibilityState:null!==(a=null==n?void 0:n.visibilityState)&&void 0!==a?a:v.fe.show,stateTransition:null!==(o=null==n?void 0:n.stateTransition)&&void 0!==o?o:v.su.new},correlation:{source:sn.D.ChatDeeplinkId}},metadata:{allowAnonymous:!1,accountToUse:Im(t,i)}})})(e,i,l,t)}))}]};function tc(){const e=ic();return{eventHandlers:jm,getAppPhases:Yr,getAppViewEntities:Qs,getAppViewEntitiesProps:cm,getAppWindowFeatures:nc,getCommandScenarioName:ec,getPlatformAppIdForEntity:e=>e.type===De.py.chats||e.type===De.py.chatschannelconv?"86fcd49b-61a2-4701-b771-54728cd291fb":void 0,manifest:xm,onBeforeAddToNavigation:Bm,onBeforeCommandHandled:Ur,onBeforeDeeplinkParsed:e,onCommandReceived:zm,onPreInit:Hs,onPreWarm:Ws,onRegister:e=>{e.registerTask(new Si.K)},onViewUpdateCommandResolved:Qm,render:({appRenderMode:e,onRenderEvent:n,scenarioFactory:i,coreSettings:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const{enableEntityMoreInfo:o=!1}=a.get(s.J.Core),{ChatViewsRenderer:d,LPC:l}=yield((e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const t="chat-app";n("ChunkLoadStarted",{chunkName:t});const{ChatViewsRenderer:a}=yield(0,Pn.mT)(zr,t,e),{LPC:o}=i?{LPC:Zm}:yield(0,Pn.mT)(Qr,t,e);return n("ChunkLoadSucceeded",{chunkName:t}),{ChatViewsRenderer:a,LPC:o}})))(i,n,!!o),r=o?Zm:Na.p3;return(0,Ie.t)(ri.f,Object.assign({namespaces:["calling","chatList","compose","extensibility","files","lightbox","messaging","meetingAnalytics","meetingRecap","urlPreview","datepicker","phonelinkSms"],loaderRenderer:null},{children:(0,Ie.t)(l,{children:(0,Ie.t)(r,{children:(0,Ie.t)(d,{appRenderMode:e})})})}))})),viewStateRegistration:Ym,onExperienceLongIdle:zs}}const ac="shell",oc="showToast",dc="updateProfilePicture",lc="updateDisplayName",rc=e=>({actor:ac,action:oc,data:e}),sc=()=>({actor:ac,action:dc}),mc=()=>({actor:ac,action:lc}),cc={People:"People",LivePersonaEditor:"LivePersonaEditor"},uc="viewPeopleApp",pc="switchToContactTag",yc="changeQueryVariables",vc="openLivePersonaEditorDialog",kc="closeLivePersonaEditorDialog",gc="openAddContactDialog",Nc=e=>({actor:cc.LivePersonaEditor,action:vc,data:e}),hc=()=>({actor:cc.LivePersonaEditor,action:kc}),fc=e=>({actor:cc.People,action:pc,data:e}),_c=e=>({actor:cc.People,action:yc,data:e}),Sc=()=>({actor:cc.People,action:uc}),Tc=()=>({actor:cc.People,action:gc});var bc=i(260955),Cc=i(24125);const wc={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallsMainSetSpeedDialMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"setSpeedDialSystemTagInput"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SetSpeedDialSystemTagInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setSpeedDialSystemTag"},arguments:[{kind:"Argument",name:{kind:"Name",value:"setSpeedDialSystemTagInput"},value:{kind:"Variable",name:{kind:"Name",value:"setSpeedDialSystemTagInput"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SetSpeedDialSystemTagInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SetSpeedDialSystemTagMutationSuccess"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"successMessage"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"edge"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cursor"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OneGQL_Person"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"contactId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonOneGqlPersonFragment"}}]}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"OneGQL_Person"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"OneGQL_PersonContactEdge"}}},arguments:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SpeedDialContactsError"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errorMessage"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SetSpeedDialSystemTagMutationResult"}}}}]}},...i(845526).W.definitions]},Ic={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallsMainDeleteContactMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"contactPayload"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"OneGQL_DeleteContactInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteContact"},arguments:[{kind:"Argument",name:{kind:"Name",value:"contactPayload"},value:{kind:"Variable",name:{kind:"Name",value:"contactPayload"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"OneGQL_DeleteContactInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OneGQL_ContactMutationSuccess"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"successMessage"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OneGQL_ContactMutationErrorGeneric"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errorMessage"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OneGQL_ContactMutationErrorNetworkOffline"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errorMessage"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"OneGQL_ContactMutationResult"}}}}]}}]},Ac={onEventReceived:({eventInput:{event:e},requestContext:n})=>{return Fc(e)?Promise.resolve({command:on(e.data())}):Dc(e)?Promise.resolve({command:dn(e.data())}):(0,Cc.Pu)(e)?Promise.resolve({command:Nc(e.data())}):(0,bc.VR)(e)?(i=n.client,t=e.data(),i.mutate({mutation:wc,variables:{setSpeedDialSystemTagInput:t}})).then((({data:e})=>({command:rc({title:"SetSpeedDialSystemTagMutationSuccess"===e.setSpeedDialSystemTag.__typename?e.setSpeedDialSystemTag.successMessage:e.setSpeedDialSystemTag.errorMessage,intent:"SetSpeedDialSystemTagMutationSuccess"===e.setSpeedDialSystemTag.__typename?"Success":"Error",dismissOnAction:!0,duration:3e3})}))):(0,bc.sF)(e)?Promise.resolve({command:rc({title:e.data().errorMessage,intent:"Error",dismissOnAction:!0,duration:3e3})}):(0,bc.DE)(e)?((e,n)=>e.mutate({mutation:Ic,variables:{contactPayload:n},update(e){const i=e.identify({id:n.id,__typename:"OneGQL_Person"});e.evict({id:i}),e.gc()}}))(n.client,e.data()).then((({data:{deleteContact:e}})=>({command:rc({title:"OneGQL_ContactMutationSuccess"===e.__typename?e.successMessage:e.errorMessage,intent:"OneGQL_ContactMutationSuccess"===e.__typename?"Success":"Error",dismissOnAction:!0,duration:3e3})}))):Promise.resolve(void 0);var i,t}},Fc=e=>e.type===Ze.uS.requestPersonMoreInfo,Dc=e=>e.type===Ze.uS.requestPersonMoreOrgInfo,Ec=e=>{if(Mc(e))return Pc(e)?{subNavEntity:Rc(e),headerEntity:Oc(e),startEntity:$c(e),mainEntity:Lc(e),endEntity:xc(e)}:null},Mc=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.callsmain,De.py.locationnotification,De.py.locationnotificationbanner].includes(t),d=[De.uk.create,De.uk.default,De.uk.list,De.uk.view,De.uk.locationhandler],l=i&&d.includes(i);return!!(a&&o&&l)},Pc=()=>!0,Rc=()=>null,Oc=({entity:e})=>e,$c=()=>null,Lc=({entity:e})=>e,xc=()=>null,Bc="calls-main",jc="viewCallsMainApp",Uc="markAllAsRead",Vc="startAudioCall",Wc=()=>({actor:Bc,action:jc}),Hc=()=>({actor:Bc,action:Uc}),Gc=e=>({actor:Bc,action:Vc,data:e}),Jc={id:"com.microsoft.teams.callsmain",name:"CallsMain",actors:[Bc],supportedEntities:[De.py.callsmain,De.py.locationnotification,De.py.locationnotificationbanner],supportedRenderModes:[Fe.S.HorizontalBar,Fe.S.Main,Fe.S.Rail,Fe.S.Modal],windowFeatures:{minWidth:800,width:800,minHeight:670,height:600},getDefaultCommand:()=>({type:De.py.callsmain,action:De.uk.view})},qc=({appRenderMode:e,coreSettings:n})=>{const{callsAppPhaseTimeouts:i,enableCallsAppPhaseStateMachine:t,enableNovaSpeedDial:a}=n.get(s.J.Calling),o=new Ee.H;if(!t)return o.appPhases;const d=[],l=[];if(e===Fe.S.Main)d.push(Me.G.DIALPAD_RENDERED),l.push(Me.G.CALL_GROUP_OWNERS_RENDERED),l.push(Me.G.CALL_FORWARDING_SETTINGS_RENDERED),l.push(Me.G.AUDIO_DEVICE_SETTINGS_RENDERED),d.push(Me.G.CALLS_APP_HISTORY_FETCH_STARTED),d.push(Me.G.CALLS_APP_HISTORY_FETCH_COMPLETED),d.push(Me.G.CALL_HISTORY_RENDERED),a&&(d.push(Me.G.CALLS_APP_SPEED_DIAL_FETCH_STARTED),d.push(Me.G.CALLS_APP_SPEED_DIAL_FETCH_COMPLETED)),d.push(Me.G.SPEED_DIAL_RENDERED);return o.registerAppPhase({phase:g.nh.CRITICAL,signals:d,timeout:(null==i?void 0:i.critical)||1e4}),o.registerAppPhase({phase:g.nh.POST_CRITICAL,signals:l,timeout:(null==i?void 0:i.postCritical)||1e4}),o.appPhases},zc={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallsMainMarkAllCallsAsReadMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markMissedCallsAsRead"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ActivityReadStatusUpdateError"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errorFaced"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ActivityReadStatusUpdate"}}},arguments:[]}]}}]},Qc={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsCallsMainFireCallingIntentMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntentInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fireCallingIntent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntent"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntentInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntent"}}}]}}]},Yc=({commandInput:e,requestContext:{loggerFactory:n,client:i}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var a;const{command:{action:o,data:d}}=e,l=n.newLogger("CallsMainApp onCommandReceived","apps-calling");if(e.command.actor===Bc)switch(o){case jc:return{entity:{type:De.py.callsmain,action:De.uk.view},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,correlation:{source:sn.D.Unknown}}};case Uc:return null===(a=l.infoToTelemetry)||void 0===a||a.call(l,"[UI]: marking all missed calls as read","calling_badge",void 0,!0),void i.mutate({mutation:zc}).then((({data:e})=>{var n,i,t;const a=null===(n=null==e?void 0:e.markMissedCallsAsRead)||void 0===n?void 0:n.errorFaced;a?null===(i=l.errorToTelemetry)||void 0===i||i.call(l,`[UI]: marking all as read action failed: ${a}.`,"calling_badge",void 0,!0):null===(t=l.infoToTelemetry)||void 0===t||t.call(l,"[UI]: successfully marked all missed calls as read","calling_badge",void 0,!0)})).catch((e=>{var n;null===(n=l.errorToTelemetry)||void 0===n||n.call(l,`[UI]: marking all as read action failed: ${e.message}.`,"calling_badge",void 0,!0)}));case Vc:if(!(e=>"object"==typeof e&&null!==e&&"mri"in e&&"correlationSource"in e)(d))return void l.error(`Command for action '${o}' requires an mri and correlationSource.`);const e=i,n=yield((e,n,i=!1)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t;const a={callingIntent:{type:"OneToOneCall",joinOptions:{outgoingVideo:i,outgoingAudio:!0,oneToOne:{sharingSourceId:void 0},context:"NovaCommandStartAudioCall"},coordinates:{oneToOne:{mri:n}}}},{data:o}=yield e.mutate({mutation:Qc,variables:a});return null===(t=null==o?void 0:o.fireCallingIntent)||void 0===t?void 0:t.id})))(e,d.mri);return n?{entity:{type:De.py.calls,action:De.uk.view,id:n},command:{stateTransition:v.su.new,visibilityState:v.fe.show,correlation:{intentId:(0,et.v4)(),source:d.correlationSource,startTimestamp:Date.now()}}}:void l.error("Could not fetch the user calling IntentId using user mri");default:l.error(`Command action '${o}' is not supported at CallsMainApp.`)}else l.error(`Command for actor '${e.command.actor}' cannot be handled by CallsMainApp.`)})),Kc=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(892924),i.e(256045),i.e(241602),i.e(371935),i.e(779478),i.e(888171),i.e(901509),i.e(547652),i.e(435876),i.e(400010),i.e(242959),i.e(202477),i.e(465019),i.e(697672),i.e(160200),i.e(959180),i.e(687465),i.e(340690),i.e(890555),i.e(864770),i.e(745400),i.e(577907),i.e(357068),i.e(871090),i.e(816167),i.e(479335),i.e(846077),i.e(232236),i.e(914152),i.e(169080),i.e(269104),i.e(890473),i.e(25663),i.e(347761),i.e(9081),i.e(137706),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(26466),i.e(430209),i.e(911758),i.e(435216),i.e(667549),i.e(609633),i.e(469488),i.e(548536),i.e(868838),i.e(803124),i.e(242863),i.e(29311),i.e(321833),i.e(186443),i.e(472638),i.e(68688),i.e(912597),i.e(127919),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(495500),i.e(403936),i.e(450605),i.e(329712),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(816906),i.e(831470),i.e(417169),i.e(451185),i.e(666579),i.e(913486),i.e(369093),i.e(364315),i.e(781662),i.e(53443),i.e(478388),i.e(327116),i.e(713782),i.e(553856),i.e(801349),i.e(399286),i.e(764391),i.e(425523),i.e(336995),i.e(537680),i.e(520174),i.e(506412),i.e(25019),i.e(918607),i.e(673615),i.e(568740)]).then(i.bind(i,83866)),Xc=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(892924),i.e(256045),i.e(241602),i.e(371935),i.e(779478),i.e(888171),i.e(901509),i.e(547652),i.e(435876),i.e(400010),i.e(242959),i.e(202477),i.e(465019),i.e(697672),i.e(160200),i.e(959180),i.e(687465),i.e(340690),i.e(890555),i.e(864770),i.e(745400),i.e(577907),i.e(357068),i.e(871090),i.e(816167),i.e(479335),i.e(846077),i.e(232236),i.e(914152),i.e(169080),i.e(269104),i.e(890473),i.e(25663),i.e(347761),i.e(9081),i.e(137706),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(26466),i.e(430209),i.e(911758),i.e(435216),i.e(667549),i.e(609633),i.e(469488),i.e(548536),i.e(868838),i.e(803124),i.e(242863),i.e(29311),i.e(321833),i.e(186443),i.e(472638),i.e(68688),i.e(912597),i.e(127919),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(495500),i.e(403936),i.e(450605),i.e(329712),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(816906),i.e(831470),i.e(417169),i.e(451185),i.e(666579),i.e(913486),i.e(369093),i.e(364315),i.e(781662),i.e(53443),i.e(478388),i.e(327116),i.e(713782),i.e(553856),i.e(801349),i.e(399286),i.e(764391),i.e(425523),i.e(336995),i.e(537680),i.e(520174),i.e(506412),i.e(25019),i.e(918607),i.e(673615),i.e(568740)]).then(i.bind(i,173029)),Zc=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(892924),i.e(256045),i.e(241602),i.e(371935),i.e(779478),i.e(888171),i.e(901509),i.e(547652),i.e(435876),i.e(400010),i.e(242959),i.e(202477),i.e(465019),i.e(697672),i.e(160200),i.e(959180),i.e(687465),i.e(340690),i.e(890555),i.e(864770),i.e(745400),i.e(577907),i.e(357068),i.e(871090),i.e(816167),i.e(479335),i.e(846077),i.e(232236),i.e(914152),i.e(169080),i.e(269104),i.e(890473),i.e(25663),i.e(347761),i.e(9081),i.e(137706),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(26466),i.e(430209),i.e(911758),i.e(435216),i.e(667549),i.e(609633),i.e(469488),i.e(548536),i.e(868838),i.e(803124),i.e(242863),i.e(29311),i.e(321833),i.e(186443),i.e(472638),i.e(68688),i.e(912597),i.e(127919),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(495500),i.e(403936),i.e(450605),i.e(329712),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(816906),i.e(831470),i.e(417169),i.e(451185),i.e(666579),i.e(913486),i.e(369093),i.e(364315),i.e(781662),i.e(53443),i.e(478388),i.e(327116),i.e(713782),i.e(553856),i.e(801349),i.e(399286),i.e(764391),i.e(425523),i.e(336995),i.e(537680),i.e(520174),i.e(506412),i.e(25019),i.e(918607),i.e(673615),i.e(568740)]).then(i.bind(i,445953)),eu=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(892924),i.e(256045),i.e(241602),i.e(371935),i.e(779478),i.e(888171),i.e(901509),i.e(547652),i.e(435876),i.e(400010),i.e(242959),i.e(202477),i.e(465019),i.e(697672),i.e(160200),i.e(959180),i.e(687465),i.e(340690),i.e(890555),i.e(864770),i.e(745400),i.e(577907),i.e(357068),i.e(871090),i.e(816167),i.e(479335),i.e(846077),i.e(232236),i.e(914152),i.e(169080),i.e(269104),i.e(890473),i.e(25663),i.e(347761),i.e(9081),i.e(137706),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(26466),i.e(430209),i.e(911758),i.e(435216),i.e(667549),i.e(609633),i.e(469488),i.e(548536),i.e(868838),i.e(803124),i.e(242863),i.e(29311),i.e(321833),i.e(186443),i.e(472638),i.e(68688),i.e(912597),i.e(127919),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(495500),i.e(403936),i.e(450605),i.e(329712),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(816906),i.e(831470),i.e(417169),i.e(451185),i.e(666579),i.e(913486),i.e(369093),i.e(364315),i.e(781662),i.e(53443),i.e(478388),i.e(327116),i.e(713782),i.e(553856),i.e(801349),i.e(399286),i.e(764391),i.e(425523),i.e(336995),i.e(537680),i.e(520174),i.e(506412),i.e(25019),i.e(918607),i.e(673615),i.e(568740)]).then(i.bind(i,228183)),nu=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(892924),i.e(256045),i.e(241602),i.e(371935),i.e(779478),i.e(888171),i.e(901509),i.e(547652),i.e(435876),i.e(400010),i.e(242959),i.e(202477),i.e(465019),i.e(697672),i.e(160200),i.e(959180),i.e(687465),i.e(340690),i.e(890555),i.e(864770),i.e(745400),i.e(577907),i.e(357068),i.e(871090),i.e(816167),i.e(479335),i.e(846077),i.e(232236),i.e(914152),i.e(169080),i.e(269104),i.e(890473),i.e(25663),i.e(347761),i.e(9081),i.e(137706),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(26466),i.e(430209),i.e(911758),i.e(435216),i.e(667549),i.e(609633),i.e(469488),i.e(548536),i.e(868838),i.e(803124),i.e(242863),i.e(29311),i.e(321833),i.e(186443),i.e(472638),i.e(68688),i.e(912597),i.e(127919),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(495500),i.e(403936),i.e(450605),i.e(329712),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(816906),i.e(831470),i.e(417169),i.e(451185),i.e(666579),i.e(913486),i.e(369093),i.e(364315),i.e(781662),i.e(53443),i.e(478388),i.e(327116),i.e(713782),i.e(553856),i.e(801349),i.e(399286),i.e(764391),i.e(425523),i.e(336995),i.e(537680),i.e(520174),i.e(506412),i.e(25019),i.e(918607),i.e(673615),i.e(568740)]).then(i.bind(i,331176)),iu=()=>Jc.windowFeatures||{},tu=()=>c.RG.CallsAppSwitch,au="calls-main-app",ou=({children:e})=>(0,Ie.t)(Ae.Fragment,{children:e});function du(){const e=()=>null;return{eventHandlers:Ac,getAppPhases:qc,getAppViewEntities:Ec,getAppWindowFeatures:iu,getCommandScenarioName:tu,getPlatformAppIdForEntity:e=>e.type===De.py.callsmain?"20c3440d-c67e-4420-9f80-0e50c39693df":void 0,manifest:Jc,onCommandReceived:Yc,render:({appRenderMode:n,coreSettings:i,onRenderEvent:a,scenarioFactory:o})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){let t=!0;const d=e=>t=e,{enableLocationNotificationPopup:l,enableEmergencyLocationGlobalBanner:r}=i.get(s.J.Calling);if(n===Fe.S.Rail||n===Fe.S.Main){const e=n===Fe.S.Main,{enableEntityMoreInfo:t}=i.get(s.J.Core),d=e=>e?{LPC:ou}:(0,Pn.mT)(eu,au,o),l=t?ou:Na.p3;e&&a("ChunkLoadStarted",{chunkName:au});const[{CallsMainViewsRenderer:r},{CallsTabContextProvider:m},{LPC:c}]=yield Promise.all([(0,Pn.mT)(Kc,au,o),(0,Pn.mT)(Xc,au,o),d(!!t)]);return e&&a("ChunkLoadSucceeded",{chunkName:au}),(0,Ie.t)(ri.f,Object.assign({namespaces:["calling","messaging"],loaderRenderer:null},{children:(0,Ie.t)(c,{children:(0,Ie.t)(l,{children:(0,Ie.t)(m,{children:(0,Ie.t)(r,{isMainPanel:e})})})})}))}if(n===Fe.S.Modal&&(l||r)){const e="calls-main-app";a("ChunkLoadStarted",{chunkName:au});const{EditEmergencyAddressDialogComponent:n}=yield(0,Pn.mT)(nu,e,o);return a("ChunkLoadSucceeded",{chunkName:au}),(0,Ie.t)(n,{showEditAddressDialog:t,setShowEditAddressDialog:d,moduleName:ei.rA.emergencyLocationManageLocationButton})}const{enableCallsAppHeader:m}=i.get(s.J.Calling);if(m&&n===Fe.S.HorizontalBar){a("ChunkLoadStarted",{chunkName:au});const[{CallsHeaderRenderer:e},{CallsTabContextProvider:n}]=yield Promise.all([(0,Pn.mT)(Zc,au,o),(0,Pn.mT)(Xc,au,o)]);return a("ChunkLoadSucceeded",{chunkName:au}),(0,Ie.t)(n,{children:(0,Ie.t)(e,{})})}return(0,Ie.t)(e,{})}))}}const lu={id:"com.microsoft.teams.cast",name:"CastApp",supportedEntities:[De.py.cast],supportedRenderModes:[Fe.S.Main],windowFeatures:{width:640,height:720,minWidth:640,minHeight:720}},ru=e=>{if(su(e))return mu(e)?{subNavEntity:cu(e),headerEntity:uu(e),startEntity:pu(e),mainEntity:yu(e),endEntity:vu(e)}:null},su=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.cast].includes(t),d=[De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},mu=()=>!0,cu=()=>null,uu=()=>null,pu=()=>null,yu=({entity:e})=>e,vu=()=>null,ku=()=>({mainEntity:{[Fe.S.Main]:{isBackgroundTransparent:!1,isThemePinnedToDarkOrHighContrast:!0,UNSAFE_enablePptProvider:!0}}}),gu={shouldAddEntitiesToWindowHistory:e=>{var n;return(null===(n=e.mainEntity)||void 0===n?void 0:n.type)!==De.py.cast},shouldRestoreClientToEntities:()=>!0},Nu=()=>Promise.all([i.e(917388),i.e(790026),i.e(590393),i.e(141603),i.e(65477),i.e(976609),i.e(879697),i.e(821007),i.e(347761),i.e(409201),i.e(588921),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(756029),i.e(613692),i.e(207856),i.e(673758),i.e(749021),i.e(232044),i.e(566847),i.e(942163),i.e(376657)]).then(i.bind(i,422103)),hu=({host:e})=>{const n=null==e?void 0:e.screen;if(!n)return{};if(!lu.windowFeatures)return{};const{minHeight:i,minWidth:t}=lu.windowFeatures,{height:a=1,width:o=1}=lu.windowFeatures,{left:d,top:l}=((e,n,i,t)=>{const a=e.availLeft+e.availWidth/2-n/2;let o;switch(e.orientation.type){case"landscape-primary":case"landscape-secondary":o=e.availTop+t;break;default:o=e.availTop+e.availHeight/2-i/2}return{left:a,top:o}})(n,o,a,20);return{additionalFeatures:{minHeight:`${i}`,minWidth:`${t}`},height:a,width:o,left:d,top:l,minHeight:i,minWidth:t}};function fu(){const e=()=>null;return{getAppViewEntities:ru,getAppViewEntitiesProps:ku,getAppWindowFeatures:hu,manifest:lu,render:({appRenderMode:n,onRenderEvent:i,scenarioFactory:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main){const e="cast-app";i("ChunkLoadStarted",{chunkName:e});const{CastWizard:n}=yield(0,Pn.mT)(Nu,e,a);return i("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(n,{})}return(0,Ie.t)(e,{})})),onBeforeAddToNavigation:gu}}const _u="communities",Su="viewCommunitiesApp",Tu=()=>({actor:_u,action:Su}),bu={id:"com.microsoft.teams.communities",name:"CommunitiesApp",getLocalizedName:e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("communities"),e.stringTranslate("communities","communities_app_name")})),actors:[_u],supportedEntities:[De.py.communities,De.py.communitiesonboarding,De.py.sharecommunitieslink,De.py.reportconcerncommunities,De.py.communitiesaddmember,De.py.communitiesblockmembers,De.py.communitiescreatechannel,De.py.communitieseditchannel,De.py.communitiesdelete,De.py.communitiesdeletechannel,De.py.communitiesevents,De.py.communitiescreateevent,De.py.communitiesguidelinesdialog,De.py.communitiesmembers,De.py.communitiesremovemember,De.py.communitiessendpostasemaildialog,De.py.communitiesgetappdialog,De.py.communitiescreatedialog,De.py.communitieswelcomebotconfigdialog,De.py.communitieseditdialog,De.py.communitiesjoinrequest,De.py.communitiesjoininviteview,De.py.embedcommunitycodedialog,De.py.leavecommunity,De.py.percommunitynotificationsettingsdialog,De.py.ownerleavecommunity,De.py.communitiessettings,De.py.communitiesreplychain,De.py.communitiescopilot,De.py.communitiesnickname,De.py.communitiesgallery],supportedRenderModes:[Fe.S.Main,Fe.S.HorizontalBar,Fe.S.Rail,Fe.S.Modal],getDefaultCommand:()=>({type:De.py.communitiesonboarding,action:De.uk.default}),windowFeatures:{minWidth:602,width:602,minHeight:500,height:500,offset:20,widthToScreenWidthRatio:.3,heightToWidthRatio:1.125}},Cu=({commandInput:e,requestContext:{loggerFactory:n}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:i}}=e,t=n.newLogger("CommunitiesApp onCommandReceived","apps-communities");if(e.command.actor===_u)return i===Su?{entity:{type:De.py.communitiesonboarding,action:De.uk.default},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,correlation:{source:sn.D.Unknown}}}:void t.error(`Command action '${i}' is not supported at CommunitiesApp.`);t.error(`Command for actor '${e.command.actor}' cannot be handled by CommunitiesApp.`)}));var wu=i(557273);const Iu="VirtualConsumerEvents",Au="createVirtualConsumerEvent",Fu=e=>({actor:Iu,action:Au,data:e}),Du={onEventReceived:({requestContext:{loggerFactory:e},eventInput:{event:{originator:n,type:i,data:a},source:o}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const t=e.newLogger("onEventReceived","apps-communities-on-event-received");if(n!==wu.kn)t.error(`Event from originator '${n}' cannot be handled by CommunitiesApp.`);else{if(i===wu.uS.createVirtualConsumerEvent){if(!a)return void t.error(`Event data is missing for event type '${i}'.`);const e=a();return(0,wu.RB)(e)?{command:Fu(Object.assign({},e)),source:o}:void t.error(`Event data is invalid for event type '${i}'.`)}t.error(`Event type '${i}' is not supported by CommunitiesApp.`)}}))};var Eu=i(637683);const Mu=e=>{if(Pu(e))return Ru(e)?{subNavEntity:Ou(e),headerEntity:$u(e),startEntity:Lu(e),mainEntity:xu(e),endEntity:Bu(e)}:null},Pu=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.standard].includes(e),o=[De.py.communities,De.py.communitiesonboarding,De.py.communitiesevents,De.py.communitiescreateevent,De.py.communitiesmembers,De.py.communitiesjoinrequest,De.py.communitiesjoininviteview,De.py.communitiesblockmembers,De.py.communitiessettings,De.py.communitiescopilot,De.py.communitiesgallery].includes(t),d=[De.uk.default,De.uk.view,De.uk.join,De.uk.manage,De.uk.update,De.uk.info],l=i&&d.includes(i);return!!(a&&o&&l)},Ru=()=>!0,Ou=({entity:e})=>{switch(e.type){case De.py.communitiesonboarding:case De.py.communitiescreateevent:return null;default:return e}},$u=({entity:e,coreSettings:n})=>{if(e.type===De.py.communitiesonboarding)return null;const i=null==n?void 0:n.get(s.J.Calendar).enableCalendarSchedulingFormMultiSlot;return e.type!==De.py.communitiescreateevent||i?e:null},Lu=()=>null,xu=({entity:e})=>e,Bu=({entity:e,contextEntity:n})=>{if((null==n?void 0:n.type)===De.py.communitiescopilot){return{id:n.id||e.id||"",action:De.uk.info,type:De.py.communitiescopilot}}return null},ju=({areEmptySlotsTransparent:e,coreSettings:n})=>({subNavEntity:{[Fe.S.Rail]:{areSlotShadowsDisabled:!1,isBackgroundTransparent:!!(null==n?void 0:n.get(s.J.Core).enableTransparentLeftRail)||e}},mainEntity:{[Fe.S.Main]:{isColorSchemeDefaultBackground2:!0}}});var Uu,Vu=i(862186),Wu=i(580765),Hu=i(644272),Gu=i(317655);!function(e){e.invitecommunity="/l/community/invite",e.message="/l/message",e.community="/l/community",e.createeventcommunity="/l/community/create-event",e.eventscommunity="/l/community/events",e.createpostcommunity="/l/community/create-post",e.createcommunity="/l/community/create",e.editcommunity="/l/community/edit",e.addmembercommunity="/l/community/add-member"}(Uu||(Uu={}));const Ju=Object.values(Uu),qu=Ju.reduce(((e,n)=>Object.assign(Object.assign({},e),{[n]:ym.DL.Community})),{}),zu=new Set(Ju),Qu=e=>{const n=(0,Gu.qK)(),i=n?{channelId:n}:null;return Promise.resolve({entityCommand:{entity:Object.assign({type:De.py.communities,action:De.uk.update},i?{id:JSON.stringify(i)}:{}),command:{visibilityState:v.fe.show,stateTransition:v.su.forceFlush},entityOptions:{inviteLinkUrl:e.toString()}},metadata:{allowAnonymous:!1}})},Yu={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCommunitiesCommunityWithoutPostQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"newestCommunityWithoutPosts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Communities"}},arguments:[]}]}}]},Ku={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCommunitiesLastCreatedCommunityQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lastCreatedCommunity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Communities"}},arguments:[]}]}}]};var Xu,Zu;!function(e){e.NoChannelId="Parsed communities deep link does not contain the channel id",e.NoJoinCode="Parsed communities join link does not contain the join code",e.MinorAccount="Communities use is forbidden for the minor"}(Xu||(Xu={})),function(e){e.NoChannelId="channel_on_before_deep_link_parsed_no_channel_id_error",e.NoJoinCode="communities_join_no_join_code_failure",e.MinorAccount="channel_on_before_deep_link_parsed_feature_not_enabled_error"}(Zu||(Zu={}));const ep=(e,n,i)=>Promise.resolve({entityCommand:{entity:{type:De.py.communities,action:De.uk.view,id:JSON.stringify({channelId:e,replyChainId:n})},command:{stateTransition:v.su.forceFlush,visibilityState:v.fe.show},entityOptions:{deepLinkId:i,isPostLink:!0}},metadata:{allowAnonymous:!1}}),np={filter:Uu.message,execute:({deeplinkUrl:e,context:{loggerFactory:n,coreSettings:i}})=>{var t,a;const o=n.newLogger("CommunitiesApp onBeforeDeeplinkParsed","apps-communities"),{pathname:d,search:l}=e;o.log(`Parsing deeplinkUrl - pathname: ${d}, search: ${l}`);const r=d.split("/"),s=r.findIndex((e=>e.startsWith("19:"))),m=new URLSearchParams(l),c=r[s],u=r[s+1],p=m.get("parentMessageId")||void 0;if((0,Hu.su)(i))throw null===(t=o.errorToTelemetry)||void 0===t||t.call(o,Xu.MinorAccount,Zu.MinorAccount),Error(Xu.MinorAccount);if(c)return o.log(`toNavigationIntent - channelId: ${c}, messageId: ${u}`),ep(c,p,u);throw null===(a=o.errorToTelemetry)||void 0===a||a.call(o,Xu.NoChannelId,Zu.NoChannelId),Error(Xu.NoChannelId)}},ip=({deeplinkUrl:e,context:n})=>{var i,t;const a=n.loggerFactory.newLogger("CommunitiesApp","apps-communities"),{pathname:o}=e,d=o.split("/")[3];if((0,Hu.su)(n.coreSettings))throw null===(i=a.errorToTelemetry)||void 0===i||i.call(a,Xu.MinorAccount,Zu.MinorAccount),Error(Xu.MinorAccount);return d?((e,n,i)=>{const{pathname:t}=i,{enableCommunitiesLinkJoin:a}=e.get(s.J.Communities);if(!a){const e="Invite link redemption is disabled for this experience";return n.error(e),Promise.reject(e)}for(const e of Array.from(zu)){const n=qu[e];if(t.startsWith(e)&&n)return Qu(i)}const o="No DeeplinkPrefixType found for the specified deeplinkUrl";return n.error(o),Promise.reject(o)})(n.coreSettings,a,e):(null===(t=a.errorToTelemetry)||void 0===t||t.call(a,Xu.NoJoinCode,Zu.NoJoinCode),Promise.resolve({entityCommand:{entity:{type:De.py.communities,action:De.uk.default},command:{visibilityState:v.fe.show,stateTransition:v.su.forceFlush}},metadata:{allowAnonymous:!1}}))},tp=({deeplinkUrl:e,context:n})=>ip({deeplinkUrl:e,context:n}),ap={filter:Uu.community,execute:tp},op={filter:Uu.invitecommunity,execute:tp},dp={filter:Uu.createcommunity,execute:({deeplinkUrl:e,context:n})=>(({deeplinkUrl:e,context:n})=>{const i=n.loggerFactory.newLogger("CommunitiesApp","apps-communities"),{enableCommunitiesCreationDeeplink:t}=n.coreSettings.get(s.J.Communities);return t?Promise.resolve({entityCommand:{entity:{id:"",type:De.py.communitiescreatedialog,action:De.uk.view},command:{stateTransition:v.su.extend,visibilityState:v.fe.show}},metadata:{allowAnonymous:!1}}):(i.debug(`Flag enableCommunitiesCreationDeeplink is not enabled. Skipping deeplink processing. Deeplink: ${e}`),Promise.resolve(void 0))})({deeplinkUrl:e,context:n})},lp={filter:Uu.createeventcommunity,execute:({deeplinkUrl:e,context:n})=>(({deeplinkUrl:e,context:n})=>{const i=n.loggerFactory.newLogger("CommunitiesApp","apps-communities"),{pathname:t}=e,a=t.split("/")[4];if(!a)return i.debug(`CommunityId is not defined. Skipping deeplink processing. Deeplink: ${e}`),Promise.resolve(void 0);const{enableCommunitiesEventCreationDeeplink:o}=n.coreSettings.get(s.J.Communities);return o?Promise.resolve({entityCommand:{entity:{id:JSON.stringify({channelId:a}),type:De.py.communitiescreateevent,action:De.uk.view},command:{stateTransition:v.su.flush,visibilityState:v.fe.show},entityOptions:{isGroup:!0,conversationId:a}},metadata:{allowAnonymous:!0}}):(i.debug(`Flag enableCommunitiesEventCreationDeeplink is not enabled. Skipping deeplink processing. Deeplink: ${e}`),Promise.resolve(void 0))})({deeplinkUrl:e,context:n})},rp={filter:Uu.eventscommunity,execute:({deeplinkUrl:e,context:n})=>(({deeplinkUrl:e,context:n})=>{const i=n.loggerFactory.newLogger("CommunitiesApp","apps-communities"),{pathname:t}=e,a=t.split("/")[4];if(!a)return i.debug(`CommunityId is not defined. Skipping deeplink processing. Deeplink: ${e}`),Promise.resolve(void 0);const{enableCommunitiesEventsDeeplink:o}=n.coreSettings.get(s.J.Communities);return o?Promise.resolve({entityCommand:{entity:{id:a,type:De.py.communitiesevents,action:De.uk.view},command:{stateTransition:v.su.flush,visibilityState:v.fe.show}},metadata:{allowAnonymous:!0}}):(i.debug(`Flag enableCommunitiesEventCreationDeeplink is not enabled. Skipping deeplink processing. Deeplink: ${e}`),Promise.resolve(void 0))})({deeplinkUrl:e,context:n})},sp={filter:Uu.createpostcommunity,execute:({deeplinkUrl:e,context:n})=>(({deeplinkUrl:e,context:n})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const i=n.loggerFactory.newLogger("CommunitiesApp","apps-communities"),{enableCommunitiesPostCreationDeeplink:a}=n.coreSettings.get(s.J.Communities);if(!a)return i.debug(`Flag enableCommunitiesPostCreationDeeplink is not enabled. Skipping deeplink processing. Deeplink: ${e}`),Promise.resolve(void 0);const o=(yield n.getUserContexts())[0].context.client,d=yield(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var e;try{const{data:e}=yield o.query({query:Yu,fetchPolicy:"no-cache"});return null==e?void 0:e.newestCommunityWithoutPosts}catch(n){const t=`Error while fetching last created community id. Failed with code: ${n.errorCode}. The reason is: ${n.reason}`;return void(null===(e=i.errorToTelemetry)||void 0===e||e.call(i,t,"life_web_and_desktop_growth_synthetic_notification_campaign_error"))}}));if(!d||!d.id)return i.debug(`CommunityId is not defined. Skipping deeplink processing. Deeplink: ${e}`),Promise.resolve(void 0);const l=d.id;return Promise.resolve({entityCommand:{entity:{id:l,type:De.py.communities,action:De.uk.view},command:{stateTransition:v.su.flow,visibilityState:v.fe.show}},metadata:{allowAnonymous:!1}})})))({deeplinkUrl:e,context:n})},mp={filter:Uu.editcommunity,execute:({deeplinkUrl:e,context:n})=>(({deeplinkUrl:e,context:n})=>{const i=n.loggerFactory.newLogger("CommunitiesApp","apps-communities"),{pathname:t}=e,a=t.split("/")[4];if(!a)return i.debug(`CommunityId is not defined. Skipping deeplink processing. Deeplink: ${e}`),Promise.resolve(void 0);const{enableCommunitiesEditDeeplink:o}=n.coreSettings.get(s.J.Communities);return o?Promise.resolve({entityCommand:{entity:{id:a,type:De.py.communitieseditdialog,action:De.uk.view},command:{correlation:{source:sn.D.CommunitiesEditDialog},stateTransition:v.su.extend,visibilityState:v.fe.show}},metadata:{allowAnonymous:!0}}):(i.debug(`Flag enableCommunitiesEditDeeplink is not enabled. Skipping deeplink processing. Deeplink: ${e}`),Promise.resolve(void 0))})({deeplinkUrl:e,context:n})},cp={filter:Uu.addmembercommunity,execute:({deeplinkUrl:e,context:n})=>(({deeplinkUrl:e,context:n})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const i=n.loggerFactory.newLogger("CommunitiesApp","apps-communities"),{enableCommunitiesAddMemberDeeplink:a}=n.coreSettings.get(s.J.Communities);if(!a)return i.debug(`Flag enableCommunitiesAddMemberDeeplink is not enabled. Skipping deeplink processing. Deeplink: ${e}`),Promise.resolve(void 0);const o=(yield n.getUserContexts())[0].context.client,d=yield(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var e;try{const{data:e}=yield o.query({query:Ku,fetchPolicy:"no-cache"});return null==e?void 0:e.lastCreatedCommunity}catch(n){const t=`Error while fetching last created community id. Failed with code: ${n.errorCode}. The reason is: ${n.reason}`;return void(null===(e=i.errorToTelemetry)||void 0===e||e.call(i,t,"life_web_and_desktop_growth_synthetic_notification_campaign_error"))}}));if(!d||!d.id)return i.debug(`CommunityId is not defined. Skipping deeplink processing. Deeplink: ${e}`),Promise.resolve(void 0);const l=d.id;return Promise.resolve({entityCommand:{entity:{id:l,type:De.py.campaignnotifications,action:De.uk.view},command:{stateTransition:v.su.flow,visibilityState:v.fe.show},entityOptions:{campaignId:"communityInviteCampaign"}},metadata:{allowAnonymous:!1}})})))({deeplinkUrl:e,context:n})},up=[lp,sp,dp,rp,mp,cp,np,ap,op],pp={shouldAddEntitiesToWindowHistory:e=>{var n;return(null===(n=e.mainEntity)||void 0===n?void 0:n.type)!==De.py.communitiesonboarding},shouldRestoreClientToEntities:()=>!0,shouldStoreLastVisitedInAppHistory:e=>{const{replyChainId:n}=(0,Eu.jd)((null==e?void 0:e.id)||"");return(null==e?void 0:e.type)===De.py.communities&&(null==e?void 0:e.action)===De.uk.view&&!n}},yp={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsCommunitiesToastEventSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"communitiesToastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attributionText"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"conversationId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"count"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"correlationId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamName"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"channelName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"reaction"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"senderDisplayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"senderGivenName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"senderMri"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"subtype"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"text"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"startTimestamp"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"type"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"replyChainId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"userNickname"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CommunitiesToastEvent"}}},arguments:[]}]}}]};var vp,kp,gp;!function(e){e.Follow="Follow",e.Reply="Reply",e.PersonalReply="PersonalReply",e.ReplyToReply="ReplyToReply",e.MentionInCommunity="MentionInCommunity",e.MentionInSubCommunity="MentionInSubCommunity",e.CommunityMention="CommunityMention",e.ReactionInCommunity="ReactionInCommunity",e.ReactionInSubCommunity="ReactionInSubCommunity",e.CommunityReply="CommunityReply",e.CommunityReplyToReply="CommunityReplyToReply",e.CommunityMembership="CommunityMembership",e.Calendar="Calendar"}(vp||(vp={})),function(e){e.Person="Person",e.Team="Team",e.Community="Community",e.CommunityMembershipJoinRequestCreated="CommunityMembershipJoinRequestCreated",e.CommunityMembershipJoinRequestAccepted="CommunityMembershipJoinRequestAccepted",e.CommunityMembershipPromotedToAdmin="CommunityMembershipPromotedToAdmin",e.NewCalendarEvent="NewCalendarEvent",e.CalendarEventCanceled="CalendarEventCanceled",e.CalendarEventUpdated="CalendarEventUpdated"}(kp||(kp={})),function(e){e.L1="L1",e.L2="L2",e.MemberRequests="MemberRequests",e.MembersView="MembersView"}(gp||(gp={}));const Np="toastNotifications",hp={communitiesPost:"new_community_post_toast_header",reply:"community_reply_toast_header",personalreply:"community_personal_reply_toast_header",mentionInCommunityPerson:"community_mention_person_toast_header",communityMentionEveryone:"community_mention_everyone_toast_header",singleMemberReactionInCommunity:"community_single_member_reaction_header",multipleMembersRactionInCommunity:"community_multiple_members_reaction_header",communityMembershipJoinRequestCreated:"community_join_request_created_toast_header",communityMembershipRequestToJoinAccepted:"community_request_to_join_accepted_header",communityMembershipPromotedToAdmin:"community_membership_promoted_to_admin_header",newCalendarEvent:"new_community_calendar_event_toast_header",calendarEventCancelled:"community_calendar_event_canceled_toast_header",calendarEventUpdated:"community_calendar_event_updated_toast_header"},fp={communityMembershipJoinRequestCreated:"community_join_request_created_toast_text",communityMembershipPromotedToAdmin:"community_membership_promoted_to_admin_toast_text"},_p="communities_toast_event_subscription_job";var Sp=i(900288);const Tp={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCommunitiesMsaUserProfilePictureQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]}}]},bp={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCommunitiesToastImageAsDataUriQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]}}]};function Cp(e,n,i,a){var o,d;return(0,t.__awaiter)(this,void 0,void 0,(function*(){try{const d=yield function(e,n,i){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const{data:t}=yield e.query({query:Tp,variables:{userId:n,displayName:i,profilePictureSize:Sp.$D.Small}});return t.msaUserProfilePicture}))}(e,i,a);if(!d)return void(null===(o=n.errorToTelemetry)||void 0===o||o.call(n,io.f.ImageUrlGenerationFailed,_p,void 0,!0));const l=yield e.query({query:bp,variables:{url:d}});return(null==l?void 0:l.data.toastImageAsDataUri)||void 0}catch(e){return void(null===(d=n.errorToTelemetry)||void 0===d||d.call(n,io.f.ImageFetchFailed,_p,void 0,!0))}}))}const wp={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsCommunitiesToastEmoticonQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoryId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"searchEmoticons"},arguments:[{kind:"Argument",name:{kind:"Name",value:"searchFilter"},value:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"exactMatch"},value:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"Argument",name:{kind:"Name",value:"includeShortCuts"},value:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"Argument",name:{kind:"Name",value:"includeKeywords"},value:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"Argument",name:{kind:"Name",value:"maxResultCount"},value:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"Argument",name:{kind:"Name",value:"categoryId"},value:{kind:"Variable",name:{kind:"Name",value:"categoryId"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"AppsCommunitiesToastEmoticonFragment"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Emoticon"}}}}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsCommunitiesToastEmoticonFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Emoticon"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"description"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"unicode"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"animation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsCommunitiesToastEmoticonFragment_animation"}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EmoticonAnimation"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"etag"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"diverse"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"shortcuts"},__type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"searchMatch"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsCommunitiesToastEmoticonFragment_animation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmoticonAnimation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fps"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"framesCount"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"firstFrame"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]}]}}]}.definitions]}.definitions]};function Ip(e,n,i){const{enableCommunitiesNicknamesToast:t}=e.get(s.J.Communities);return t&&n!==kp.CommunityMembershipJoinRequestCreated&&i?i:""}const Ap="";function Fp({teamName:e,type:n,senderDisplayName:i,senderGivenName:a,subtype:o,count:d,userNickname:l},r,s,m,c){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const u=i||a;if(!u)return Ap;const p={senderDisplayName:Ip(c,o,l)||u,teamName:e};switch(n){case vp.Follow:return Dp(hp.communitiesPost,p,r);case vp.Reply:case vp.PersonalReply:case vp.ReplyToReply:return Dp(hp.reply,p,r);case vp.CommunityReply:return Dp(hp.personalreply,p,r);case vp.CommunityReplyToReply:return Dp(hp.reply,p,r);case vp.MentionInCommunity:case vp.MentionInSubCommunity:return o===kp.Person?Dp(hp.mentionInCommunityPerson,p,r):Ap;case vp.CommunityMention:return o===kp.Community?Dp(hp.communityMentionEveryone,p,r):Ap;case vp.ReactionInCommunity:case vp.ReactionInSubCommunity:const e=yield function(e,n,i){var a;return(0,t.__awaiter)(this,void 0,void 0,(function*(){try{const{id:n}=(0,_s.Mc)(null==i?void 0:i.toLocaleLowerCase().trim());if(!n)return;const{data:t}=yield e.query({query:wp,variables:{searchFilter:n,exactMatch:!0}});return((null==t?void 0:t.searchEmoticons)||[])[0]}catch(e){return void(null===(a=n.errorToTelemetry)||void 0===a||a.call(n,`communities toast emoticon query failed for ${i}`,"communities_toast_emoticon_query_failed"))}}))}(s,m,o),n=(null==e?void 0:e.unicode)||void 0;return d&&d>0?Dp(hp.multipleMembersRactionInCommunity,Object.assign(Object.assign({},p),{emoji:n,count:d}),r):Dp(hp.singleMemberReactionInCommunity,Object.assign(Object.assign({},p),{emoji:n}),r);case vp.CommunityMembership:switch(o){case kp.CommunityMembershipJoinRequestCreated:return Dp(hp.communityMembershipJoinRequestCreated,p,r);case kp.CommunityMembershipJoinRequestAccepted:return Dp(hp.communityMembershipRequestToJoinAccepted,p,r);case kp.CommunityMembershipPromotedToAdmin:return Dp(hp.communityMembershipPromotedToAdmin,p,r)}return Ap;case vp.Calendar:switch(o){case kp.NewCalendarEvent:return Dp(hp.newCalendarEvent,p,r);case kp.CalendarEventCanceled:return Dp(hp.calendarEventCancelled,p,r);case kp.CalendarEventUpdated:return Dp(hp.calendarEventUpdated,p,r);default:return Ap}default:return Ap}}))}function Dp(e,{emoji:n,teamName:i,senderDisplayName:t,count:a},o){return o.stringTranslate(Np,e,{emoji:n,senderDisplayName:t,teamName:i,count:a})}const Ep="";function Mp(e,{teamName:n,senderDisplayName:i},t){return t.stringTranslate(Np,e,{senderDisplayName:i,teamName:n})}function Pp(e,n,i,a,o){var d;return(0,t.__awaiter)(this,void 0,void 0,(function*(){const{conversationId:l,messageId:r,startTimestamp:m,teamName:c,senderMri:u,senderDisplayName:p,type:y,subtype:v,replyChainId:k,text:g}=e,N=yield Cp(i,a,u,p||""),h=function(e,n){switch(e){case vp.Reply:case vp.PersonalReply:case vp.ReplyToReply:case vp.CommunityReply:case vp.CommunityReplyToReply:case vp.MentionInCommunity:case vp.MentionInSubCommunity:case vp.CommunityMention:case vp.ReactionInCommunity:case vp.ReactionInSubCommunity:return gp.L2;case vp.Follow:case vp.CommunityMembership:if(n)switch(n){case kp.CommunityMembershipJoinRequestCreated:return gp.MemberRequests;case kp.CommunityMembershipJoinRequestAccepted:return gp.L1;case kp.CommunityMembershipPromotedToAdmin:return gp.MembersView}return gp.L1;default:return gp.L1}}(y,v),f=k&&h===gp.L2?k:void 0,_=yield Fp(e,n,i,a,o),S=yield function({teamName:e,type:n,senderDisplayName:i,senderGivenName:a,subtype:o,channelName:d,userNickname:l},r,m){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const{enableSubCommunitiesToastNotifications:t}=m.get(s.J.Notifications);if(d&&t)return r.stringTranslate(Np,"shared_channel_toast_text",{teamName:e,channelName:d});const c=Ip(m,o,l)||i||a;if(!c)return Ep;const u={senderDisplayName:c,teamName:e};if(n===vp.CommunityMembership){switch(o){case kp.CommunityMembershipJoinRequestCreated:return Mp(fp.communityMembershipJoinRequestCreated,u,r);case kp.CommunityMembershipPromotedToAdmin:return Mp(fp.communityMembershipPromotedToAdmin,u,r)}return Ep}return Ep}))}(e,n,o);return{conversationId:l,quickReply:!1,messageId:(T=y,b=v,T===vp.CommunityMembership&&b&&b===kp.CommunityMembershipJoinRequestAccepted?void 0:r),time:new Date(+m),replyChainId:f,text:null!==(d=S||c||g)&&void 0!==d?d:void 0,title:_,mainImage:N?{alt:"",src:N}:void 0,type:y};var T,b}))}function Rp(e,n,i,a,o,d,l,r,m){const{enableCommandToHostCommService:u}=n.get(s.J.Core,["enableCommandToHostCommService"]),{enableBrowserToasts:p,enableInAppNotifications:y,enableInAppNotificationsForChatsAndChannels:v}=n.get(s.J.Notifications,["enableBrowserToasts","enableInAppNotifications","enableInAppNotificationsForChatsAndChannels"]);return{id:"communities-toast-event-subscription",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var k;const g=a.newLogger("CommunitiesToastEventSubscription","apps-communities");u||p||y&&v?i.subscribe({query:yp,fetchPolicy:"no-cache"}).subscribe(function(e,n,i,a,o,d,l,r,m){const{enableToastCollections:u}=n.get(s.J.Notifications);return s=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var t,p,y,v,k,g;if(s.errors)return void(null===(t=i.errorToTelemetry)||void 0===t||t.call(i,`${io.f.SubscriptionFailed}`,_p,void 0,!0));const N=null===(p=null==s?void 0:s.data)||void 0===p?void 0:p.communitiesToastEvent;if(!N)return void(null===(y=i.errorToTelemetry)||void 0===y||y.call(i,io.f.EmptyEvent,_p,void 0,!0));const h=a.newScenario(c.RG.CrossClientToastView,{startTime:+N.startTimestamp});h.clientId=N.correlationId,h.appendEventData({mainEntityType:De.py.communities}),h.mark("get_communities_toast_display_data_started");const f={channelId:N.conversationId,replyChainId:N.replyChainId},_=yield m({id:JSON.stringify(f),type:De.py.communities,action:De.uk.view},l);if(h.mark(c.ck.CrossClientConversationFocusChecked),_)return null===(v=i.debugToTelemetry)||void 0===v||v.call(i,io.f.ToastSuppressedForWindowInFocus,_p,void 0,!0),void h.stop({reason:io.f.ToastSuppressedForWindowInFocus});const S=yield Pp(N,o,l,i,n);if(h.mark("get_communities_toast_display_data_completed"),!(null==S?void 0:S.title))return h.mark("unhandled_type_in_communities_toast"),null===(k=i.errorToTelemetry)||void 0===k||k.call(i,`${io.f.UnhandledType} ${N.type}`,_p,void 0,!0),void h.stop({reason:io.f.UnhandledType});switch(u&&(S.collectionId=lo(e,r,i)),null===(g=a.hoistScenarioToCore)||void 0===g||g.call(a,h),N.type){case vp.Calendar:return d.toasts.showCommunitiesCalendarEventsNotifications(N.correlationId,S);case vp.CommunityMembership:switch(N.subtype){case kp.CommunityMembershipJoinRequestCreated:return d.toasts.showCommunitiesMemberRequestsNotifications(N.correlationId,S);case kp.CommunityMembershipPromotedToAdmin:return d.toasts.showCommunitiesMembersViewNotifications(N.correlationId,S)}}return d.toasts.showCommunitiesNotifications(N.correlationId,S)}))}(e,n,g,o,d,l,i,r,m)):null===(k=g.debugToTelemetry)||void 0===k||k.call(g,io.f.NotEnabled,_p,void 0,!0)}))}}const Op=({context:{authenticationUser:e,client:n,coreSettings:i,loggerFactory:t,scenarioFactory:a,i18n:o,entityCommanding:d,userTrackingService:l,isEntityInView:r}})=>[Rp(e,i,n,t,a,o,d,l,r)],$p=({action:e,appRenderMode:n,coreSettings:i,type:t})=>{const a=new Ee.H,{enableComposeCriticalPhaseLoadCommunities:o=!1,communitiesAppPhaseTimeouts:d}=i.get(s.J.Communities),l=[],r=[];switch(n){case Fe.S.HorizontalBar:Lp({type:t,criticalSignals:l,featureFlags:{},postCriticalSignals:r});break;case Fe.S.Main:xp({type:t,criticalSignals:l,featureFlags:{enableComposeCriticalPhaseLoadCommunities:o},postCriticalSignals:r});break;case Fe.S.Rail:Bp({action:e,criticalSignals:l,postCriticalSignals:r,type:t,featureFlags:{}})}return a.registerAppPhase({phase:g.nh.CRITICAL,signals:l,timeout:(null==d?void 0:d.critical)||25e3}),a.registerAppPhase({phase:g.nh.POST_CRITICAL,signals:r,timeout:(null==d?void 0:d.postCritical)||1e4}),a.appPhases},Lp=({criticalSignals:e,type:n})=>{switch(n){case De.py.communities:case De.py.communitiesjoinrequest:case De.py.communitiesmembers:e.push(Me.G.COMMUNITIES_HEADER_RENDERED)}},xp=({criticalSignals:e,featureFlags:{enableComposeCriticalPhaseLoadCommunities:n},postCriticalSignals:i,type:t})=>{switch(t){case De.py.communities:e.push(Me.G.MESSAGES_RENDERED),n?e.push(Me.G.COMPOSE_LOADED):i.push(Me.G.COMPOSE_LOADED),i.push(Me.G.MESSAGE_REACTIONS_RENDERED,Me.G.PRESENCES_RENDERED,Me.G.VIRTUAL_LIST_RENDER_BUFFER_FILLED);break;case De.py.communitiesjoininviteview:e.push(Me.G.COMMUNITIES_JOIN_INVITE_VIEW_RENDERED);break;case De.py.communitiesjoinrequest:case De.py.communitiesmembers:e.push(Me.G.COMMUNITIES_MANAGE_VIEW_RENDERED)}},Bp=({action:e,criticalSignals:n,type:i})=>{i!==De.py.communities||e!==De.uk.view&&e!==De.uk.default||n.push(Me.G.CHANNEL_LIST_ITEMS_RENDERED)},jp=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(241602),i.e(976609),i.e(133950),i.e(779478),i.e(775758),i.e(780208),i.e(242959),i.e(102207),i.e(160200),i.e(363327),i.e(384342),i.e(704079),i.e(181914),i.e(862805),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(269296),i.e(26466),i.e(405309),i.e(591300),i.e(51182),i.e(589993),i.e(739133),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(495500),i.e(756029),i.e(613692),i.e(403936),i.e(271428),i.e(207856),i.e(386201),i.e(450605),i.e(769716),i.e(586146),i.e(329712),i.e(673758),i.e(839180),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(788842),i.e(427163),i.e(494306),i.e(762318),i.e(816906),i.e(591822),i.e(931123),i.e(509115),i.e(435933),i.e(449768),i.e(414875),i.e(249903),i.e(927109),i.e(623295),i.e(696028),i.e(362036),i.e(826227),i.e(597930),i.e(550425),i.e(203459),i.e(96495),i.e(231772),i.e(714478),i.e(839074),i.e(267871),i.e(55587),i.e(9447),i.e(471768),i.e(989092),i.e(648907),i.e(67844),i.e(124985),i.e(3150),i.e(770342),i.e(420565),i.e(143168),i.e(860599),i.e(383789),i.e(221368),i.e(165174),i.e(689945),i.e(99909),i.e(740085)]).then(i.bind(i,739483)),Up=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(241602),i.e(976609),i.e(133950),i.e(779478),i.e(775758),i.e(780208),i.e(242959),i.e(102207),i.e(160200),i.e(363327),i.e(384342),i.e(704079),i.e(181914),i.e(862805),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(269296),i.e(26466),i.e(405309),i.e(591300),i.e(51182),i.e(589993),i.e(739133),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(495500),i.e(756029),i.e(613692),i.e(403936),i.e(271428),i.e(207856),i.e(386201),i.e(450605),i.e(769716),i.e(586146),i.e(329712),i.e(673758),i.e(839180),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(788842),i.e(427163),i.e(494306),i.e(762318),i.e(816906),i.e(591822),i.e(931123),i.e(509115),i.e(435933),i.e(449768),i.e(414875),i.e(249903),i.e(927109),i.e(623295),i.e(696028),i.e(362036),i.e(826227),i.e(597930),i.e(550425),i.e(203459),i.e(96495),i.e(231772),i.e(714478),i.e(839074),i.e(267871),i.e(55587),i.e(9447),i.e(471768),i.e(989092),i.e(648907),i.e(67844),i.e(124985),i.e(3150),i.e(770342),i.e(420565),i.e(143168),i.e(860599),i.e(383789),i.e(221368),i.e(165174),i.e(689945),i.e(99909),i.e(740085)]).then(i.bind(i,228183)),Vp=({coreServices:e,host:n,screenState:i,windowOptions:t})=>{const{height:a,minHeight:o,minWidth:d,offset:l,width:r}=bu.windowFeatures||{},m={left:(null==n?void 0:n.screenX)||0,top:(null==n?void 0:n.screenY)||0},c=((null==i?void 0:i.numOpenWindows)||1)*(l||1);return Object.assign(Object.assign(Object.assign({additionalFeatures:{minHeight:`${o}`,minWidth:`${d}`},height:a,left:(null==m?void 0:m.left)+c,minHeight:o,minWidth:d,top:(null==m?void 0:m.top)+c,width:r},bu.windowFeatures),(null==e?void 0:e.coreSettings.get(s.J.Core).enableRatioToScreenBasedSizing)&&function(e,n){const{widthToScreenWidthRatio:i,heightToWidthRatio:t}=n||{};if(!e||!t||!i)return{};const a=i*e.screen.availWidth;return{height:a*t,width:a}}(n,bu.windowFeatures)),t)};const Wp=(e,n)=>{var i;const{entity:t,command:a}=e,o=null===(i=null==a?void 0:a.correlation)||void 0===i?void 0:i.source,d=a.stateTransition===v.su.flush||a.stateTransition===v.su.forceFlush||a.stateTransition===v.su.new;if(t.type===De.py.communitiesonboarding&&t.action===De.uk.default)return c.RG.CommunitiesAppInitiate;if(t.type===De.py.communities&&t.action===De.uk.default)return c.RG.CommunitiesAppLoad;if(t.type===De.py.communities&&t.action===De.uk.view&&a.visibilityState===v.fe.show&&d&&t.id){const{channelId:e,replyChainId:i}=(0,Eu.jd)(t.id,n);if(e){const e=[sn.D.ChannelListItem,sn.D.CommunitiesList,sn.D.ChannelPostMessage,sn.D.ChannelRepliesPane];if(a.stateTransition===v.su.new)return i?c.RG.CommunitiesSwitchL2Popout:void 0;if(i)return c.RG.CommunitiesSwitchL2;if(e.includes(o))return c.RG.CommunitiesSwitchL1}}};function Hp(){return{getAppPhases:$p,getAppViewEntitiesProps:ju,getAppWindowFeatures:Vp,getPlatformAppIdForEntity:e=>[De.py.communities,De.py.communitiesonboarding,De.py.communitiesevents,De.py.communitiescreateevent,De.py.communitiesmembers,De.py.communitiesjoinrequest,De.py.communitiesblockmembers,De.py.communitiessettings,De.py.communitiesgallery].includes(e.type)?Vu.n.communities:void 0,onBeforeAddToNavigation:pp,getAppViewEntities:Mu,manifest:bu,onCommandReceived:Cu,eventHandlers:Du,onBeforeDeeplinkParsed:up,getCommandScenarioName:Wp,render:({appRenderMode:e,onRenderEvent:n})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const i="communities-app";n("ChunkLoadStarted",{chunkName:i});const[{CommunitiesAppViews:t},{LPC:a}]=yield Promise.all([(0,Pn.mT)(jp,i),(0,Pn.mT)(Up,i)]);return n("ChunkLoadSucceeded",{chunkName:i}),(0,Ie.t)(a,{children:(0,Ie.t)(Na.p3,{children:(0,Ie.t)(ri.f,Object.assign({namespaces:["communities","chatList","extensibility","channels","lightbox"],loaderRenderer:null},{children:(0,Ie.t)(Wu.N,{children:(0,Ie.t)(t,{appRenderMode:e})})}))})})})),onPreWarm:Op}}const Gp="homepage",Jp="viewHomepageApp",qp=()=>({actor:Gp,action:Jp}),zp="com.microsoft.teams.homepage",Qp={id:zp,name:"HomepageApp",actors:[Gp],supportedEntities:[De.py.homepage],supportedRenderModes:[Fe.S.Main],getDefaultCommand:e=>{const{enableTflHomepage:n}=e.get(s.J.Homepage),{coreColdBootAppId:i}=e.get(s.J.Core);if(n&&(i&&i===zp))return{type:De.py.homepage,action:De.uk.default}}},Yp=({commandInput:e,requestContext:{loggerFactory:n}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:i}}=e,t=n.newLogger("HomepageApp onCommandReceived","apps-homepage");if(e.command.actor===Gp)return i===Jp?{entity:{type:De.py.homepage,action:De.uk.default},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,correlation:{source:sn.D.Unknown}}}:void t.log(`Command action '${i}' is not supported at HomepageApp.`);t.log(`Command for actor '${e.command.actor}' cannot be handled by HomepageApp.`)})),Kp=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(256045),i.e(65477),i.e(371935),i.e(976609),i.e(1053),i.e(133950),i.e(191673),i.e(105434),i.e(239234),i.e(332634),i.e(347761),i.e(9081),i.e(409201),i.e(215133),i.e(196348),i.e(269296),i.e(462317),i.e(51182),i.e(708472),i.e(84215),i.e(880261),i.e(735655),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(481020),i.e(842529),i.e(495500),i.e(722198),i.e(394413),i.e(477708),i.e(386201),i.e(769716),i.e(839180),i.e(788842),i.e(249903),i.e(863698),i.e(103246),i.e(998258),i.e(779792),i.e(651426),i.e(285317),i.e(159885),i.e(918143),i.e(212780),i.e(66082),i.e(405687),i.e(893559),i.e(721778)]).then(i.bind(i,759554)),Xp=()=>null,Zp=e=>{const{entity:n,command:i}=e;return(i.stateTransition===v.su.flush||i.stateTransition===v.su.forceFlush||i.stateTransition===v.su.new)&&n.type===De.py.homepage&&n.action===De.uk.default?c.RG.HomepageAppLoad:void 0};function ey(){return{manifest:Qp,render:({appRenderMode:e,onRenderEvent:n})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(e===Fe.S.Main){const e="homepage-app";n("ChunkLoadStarted",{chunkName:e});const[{TflHomepage:i}]=yield Promise.all([(0,Pn.mT)(Kp,e)]);return n("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(ri.f,Object.assign({namespaces:["tflHomepage","svFlyout"],loaderRenderer:null},{children:(0,Ie.t)(i,{})}))}return(0,Ie.t)(Xp,{})})),getPlatformAppIdForEntity:ny,onCommandReceived:Yp,getCommandScenarioName:Zp}}const ny=e=>e.type===De.py.homepage?"7133fca9-0853-4e7a-bb5d-32d4e5f6020a":void 0;var iy=i(406002);const ty={id:"com.microsoft.teams.contacts-sync",name:"ContactsSyncApp",supportedEntities:[De.py.contactssync],supportedRenderModes:[Fe.S.Main,Fe.S.Modal],windowFeatures:{additionalFeatures:{minHeight:"490",minWidth:"530"},minWidth:530,width:775,minHeight:490,height:585}},ay=()=>Promise.all([i.e(790026),i.e(256045),i.e(296056),i.e(694858),i.e(882718),i.e(22763),i.e(68688),i.e(912597),i.e(495500),i.e(863698),i.e(159885),i.e(988406)]).then(i.bind(i,327202)),oy=()=>Promise.all([i.e(872637),i.e(708146),i.e(440548)]).then(i.bind(i,764383)),dy=()=>Promise.all([i.e(178625),i.e(186160)]).then(i.bind(i,401711)),ly=()=>ty.windowFeatures||{};function ry(){const e=()=>null;return{getAppWindowFeatures:ly,manifest:ty,render:({appRenderMode:n,entity:i,onRenderEvent:a,scenarioFactory:o})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if("contactssync"===i.type)switch(i.id){case void 0:case null:case iy.M.Default:if(n===Fe.S.Main||n===Fe.S.Modal){const e="contacts-sync-dialog";a("ChunkLoadStarted",{chunkName:e});const[{ContactsSyncDialog:i}]=yield Promise.all([(0,Pn.mT)(ay,e,o)]);return a("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(i,{isModal:n===Fe.S.Modal})}break;case iy.M.MobileSync:if(n===Fe.S.Modal||n===Fe.S.Main){const e="contacts-sync-mobile-sync-dialog";a("ChunkLoadStarted",{chunkName:e});const[{ContactsSyncMobileSyncDialog:i}]=yield Promise.all([(0,Pn.mT)(oy,e,o)]);return a("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(i,{isModal:n===Fe.S.Modal})}break;case iy.M.MobileUnsync:if(n===Fe.S.Modal){const e="contacts-sync-mobile-unsync-dialog";a("ChunkLoadStarted",{chunkName:e});const[{ContactsSyncMobileUnsyncDialog:n}]=yield Promise.all([(0,Pn.mT)(dy,e,o)]);return a("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(n,{})}}return(0,Ie.t)(e,{})}))}}const sy={id:"com.microsoft.teams.discover-surface",name:"DiscoverSurfaceApp",supportedEntities:[De.py.discoversurface,De.py.discoversurfacesettings],supportedRenderModes:[Fe.S.Main,Fe.S.Rail,Fe.S.HorizontalBar,Fe.S.Modal],getDefaultCommand:()=>({type:De.py.discoversurface,action:De.uk.default})},my=e=>{if(cy(e))return uy(e)?{subNavEntity:py(e),headerEntity:yy(e),startEntity:vy(e),mainEntity:ky(e),endEntity:gy(e)}:null},cy=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.standard].includes(e),o=[De.uk.view,De.uk.default],d=i&&o.includes(i),l=[De.py.discoversurface].includes(t);return!!(a&&l&&d)},uy=()=>!0,py=({coreSettings:e})=>{const{enableHybridChannelList:n}=(null==e?void 0:e.get(s.J.Host))||{};return n?{action:De.uk.list,entityState:{flushableByLinkedEntity:!0},id:null,linkedEntity:null,options:null,type:De.py.channels,windowOptions:null}:null},yy=({entity:e})=>e,vy=()=>null,ky=({entity:e})=>e,gy=()=>null,Ny=()=>({}),hy=({appRenderMode:e,coreSettings:n})=>{const i=new Ee.H,{criticalPhaseTimeout:t,postCriticalPhaseTimeout:a}=n.get(s.J.DiscoverSurface),o=[];switch(e){case Fe.S.HorizontalBar:o.push(Me.G.DISCOVER_SURFACE_HEADER_RENDERED);break;case Fe.S.Main:o.push(Me.G.DISCOVER_SURFACE_VIEW_RENDERED)}return i.registerAppPhase({phase:g.nh.CRITICAL,signals:o,timeout:t||25e3}),i.registerAppPhase({phase:g.nh.POST_CRITICAL,signals:[],timeout:a||1e4}),i.appPhases};var fy=i(632262);const _y=e=>c.RG.DiscoverSurfaceSwitchV2,Sy=()=>Promise.all([i.e(917388),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(241602),i.e(976609),i.e(779478),i.e(780208),i.e(242959),i.e(363327),i.e(384342),i.e(704079),i.e(867663),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(26466),i.e(591300),i.e(589993),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(613692),i.e(403936),i.e(271428),i.e(207856),i.e(386201),i.e(450605),i.e(769716),i.e(329712),i.e(673758),i.e(839180),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(788842),i.e(494306),i.e(762318),i.e(816906),i.e(591822),i.e(931123),i.e(509115),i.e(435933),i.e(449768),i.e(414875),i.e(927109),i.e(623295),i.e(696028),i.e(362036),i.e(826227),i.e(597930),i.e(550425),i.e(203459),i.e(96495),i.e(714478),i.e(3150),i.e(420565),i.e(143168),i.e(165174),i.e(996583)]).then(i.bind(i,833569)),Ty=()=>Promise.all([i.e(917388),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(241602),i.e(976609),i.e(779478),i.e(780208),i.e(242959),i.e(363327),i.e(384342),i.e(704079),i.e(867663),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(26466),i.e(591300),i.e(589993),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(613692),i.e(403936),i.e(271428),i.e(207856),i.e(386201),i.e(450605),i.e(769716),i.e(329712),i.e(673758),i.e(839180),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(788842),i.e(494306),i.e(762318),i.e(816906),i.e(591822),i.e(931123),i.e(509115),i.e(435933),i.e(449768),i.e(414875),i.e(927109),i.e(623295),i.e(696028),i.e(362036),i.e(826227),i.e(597930),i.e(550425),i.e(203459),i.e(96495),i.e(714478),i.e(3150),i.e(420565),i.e(143168),i.e(165174),i.e(996583)]).then(i.bind(i,228183)),by="discover-surface-app";function Cy(){const e=()=>null;return{manifest:sy,render:({appRenderMode:n,entity:i,scenarioFactory:a,onRenderEvent:o})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(o("ChunkLoadStarted",{chunkName:by}),n===Fe.S.Modal&&i.type===De.py.discoversurfacesettings){const{DiscoverSurfaceUserPreferencesDialogLazyRenderer:e}=yield(0,Pn.mT)(Sy,by,a);return(0,Ie.t)(e,{})}const[{DiscoverFeed:t,DiscoverSurfaceHeader:d},{LPC:l}]=yield Promise.all([(0,Pn.mT)(Sy,by,a),(0,Pn.mT)(Ty,by,a)]);return o("ChunkLoadSucceeded",{chunkName:by}),n===Fe.S.Main||n===Fe.S.HorizontalBar?(0,Ie.t)(ri.f,Object.assign({namespaces:["channels","teamsAndChannels","funstuff","discoverSurface"],loaderRenderer:null},{children:[n===Fe.S.Main&&(0,Ie.t)(l,{children:(0,Ie.t)(Na.p3,{children:(0,Ie.t)(fy.l8,{children:(0,Ie.t)(t,{})})})}),n===Fe.S.HorizontalBar&&(0,Ie.t)(d,{})]})):(0,Ie.t)(e,{})})),getAppPhases:hy,getAppViewEntities:my,getAppViewEntitiesProps:Ny,getCommandScenarioName:_y}}var wy=i(321781);const Iy=e=>{if(Ay(e))return{subNavEntity:Fy(e),headerEntity:Dy(e),startEntity:Ey(e),mainEntity:My(e),endEntity:Py(e)}},Ay=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=t===De.py.error,d=i===De.uk.view;return!!(a&&o&&d)},Fy=()=>null,Dy=()=>null,Ey=()=>null,My=({entity:e})=>e,Py=()=>null,Ry=()=>({mainEntity:{[Fe.S.Main]:{disableNotificationsBanners:!0,isBackgroundTransparent:!0}}});var Oy=i(5575),$y=i(820061),Ly=i(561849),xy=i(818997);const By={id:"com.microsoft.teams.error",name:"ErrorApp",supportedEntities:[De.py.error],supportedRenderModes:[Fe.S.Main]};var jy=i(373554);function Uy(){return{getAppViewEntities:Iy,getAppViewEntitiesProps:Ry,manifest:By,render:({appRenderMode:e,onRenderEvent:n})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){return Vy(e,n)}))}}const Vy=(e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){if(e!==Fe.S.Main)return(0,Ie.t)(il.e,{});const{ErrorActionContextProvider:t,ErrorPage:a}=yield Promise.all([i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(241602),i.e(133950),i.e(268372),i.e(775758),i.e(315215),i.e(236315),i.e(529375),i.e(425552),i.e(9081),i.e(150486),i.e(405309),i.e(511611),i.e(141550),i.e(716618),i.e(127919),i.e(158563),i.e(802054)]).then(i.bind(i,46286));return(0,Ie.t)((()=>{const{getEntityOptions:e}=(0,al.sV)(),{serializedError:i}=e(De.py.error,De.uk.view),o=(0,jy.x)(),{coreSettings:d,host:l,loggerFactory:r}=(0,Cl.SE)(),s=r.newLogger("ErrorAppViewsRenderer","apps-error"),{isOnline:m}=(0,Cl.cJ)(),c=i&&function(e){let n;try{n=JSON.parse(e)}catch(n){return new $y.K(n,{source:"error-app",serializedError:e})}const i=Hy(n);return null!=i?i:new $y.K(new Error(e),{source:"error-app",serializedError:e})}(i),u=m?c||new Oy.G(Oy.$.UNKNOWN):new Oy.G(Oy.$.NETWORK_OFFLINE);return Wy(m,n,i,s),(0,Ie.t)(t,Object.assign({coreServices:{client:o}},{children:(0,Ie.t)(a,{error:u,coreSettings:d,windowProvider:l,skipFluentThemeProvider:!0})}))}),{})})),Wy=(e,n,i,t)=>{e?(t.errorToTelemetry&&t.errorToTelemetry(`ErrorAppViewsRenderer: errorApp caught an error ${i}`,"webclient_framework_foundation_apps_error",void 0,!0),n("RenderingFailure",{errorInfo:wy.y.ErrorAppError,errorMessage:i})):n("RenderingCanceled",{errorInfo:wy.y.NetworkOffline})};function Hy(e){if(!e)return;if(e.prevError){const n=Hy(e.prevError);n&&(e.prevError=n)}let n=null;switch(null==e?void 0:e.type){case"AuthError":n=Ly.l.fromSerialized(e);break;case"CoreError":n=Oy.G.fromSerialized(e);break;case"TaskError":n=xy.x.fromSerialized(e)}return n}const Gy={id:"com.microsoft.teams.esp",name:"EspApp",supportedEntities:[De.py.esp],supportedRenderModes:[Fe.S.Modal],getDefaultCommand:()=>({type:De.py.esp,action:De.uk.default}),windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}};var Jy=i(466094);const qy=()=>Promise.all([i.e(119073),i.e(966725)]).then(i.bind(i,318530)),zy=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){return(0,Pn.mT)(qy,"esp-engine",e)}));var Qy=i(505676),Yy=i(186546);class Ky{constructor(e,n){this.userBiService=e,this.logger=n.newLogger("esp-bi-telemetry","apps-esp")}recordEspPanelView(e,n,i){var t,a,o;const d=null===(a=null===(t=this.userBiService)||void 0===t?void 0:t.createDatabag)||void 0===a?void 0:a.call(t);d&&(d.identifier=n);const l={panelType:i?ei.wh.EligibleEngagementSurface:ei.wh.DisplayedEngagementSurface,panelRegion:(0,Yy.v)(e),dataBag:d};null===(o=this.userBiService)||void 0===o||o.recordPanelView(l,this.logger),d&&d.dispose()}}function Xy(e){const{client:n,coreSettings:i,entityCommanding:a,loggerFactory:o,platformService:d,scenarioFactory:r,userBiService:m,authenticationUser:u}=e;return{id:"start-esp",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var e;const{enableEsp:p,enableEspAppReadyTrigger:y,enableSetFirstLoginInformation:v}=i.get(s.J.Esp);if((null==u?void 0:u.type)===Jy.Ch.Anonymous)return;if(v){const i="growth_growthplatform_start_esp_job",a=o.newLogger(i,"apps-esp");a.debug("start-esp started");const r=yield(0,Qy.I1)(n,a);try{const e=yield function(e,n){var i;return(0,t.__awaiter)(this,void 0,void 0,(function*(){const{clientType:t}=null!==(i=null==n?void 0:n.config)&&void 0!==i?i:{},a=t===l.Bh.Maglev&&!(null==e?void 0:e.maglev),o=t===l.Bh.Web&&!(null==e?void 0:e.WebNorthStar);return a?"maglev":o?"WebNorthStar":void 0}))}(r,d);e&&(yield(0,Qy.Zm)(n,e,new Date,r,a))}catch(n){const t=(0,yn.qZ)(n);null===(e=a.errorToTelemetry)||void 0===e||e.call(a,`Failed to update first login information ${t}`,i)}}if(!p||!y)return;const k=r.newScenario(c.RG.EspAppReady);try{const{displayEspSurface:e}=yield zy(r),t=yield e(n,i,o,d,"AppReady",new Ky(m,o));if(k.stop(),t){const{entity:{id:e,type:n}}=t;e&&a.esp.launchDialog(e,n)}}catch(e){k.fail()}}))}}function Zy(e){const{client:n,coreSettings:i,entityCommanding:a,loggerFactory:o,platformService:d,scenarioFactory:l,userBiService:r}=e;return{id:"start-esp-app-ready-hander",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var t;const{enableEsp:m,enableEspAppReadyTrigger:c,enableEspAppReadyWindowWarmTrigger:u,enableBlockingUntilAppReadyTriggers:p}=i.get(s.J.Esp);if(m&&u&&!c&&e.isMainWindow){const e=o.newLogger("esp-engine/AppReady","apps-esp");try{const{displayEspSurface:e}=yield zy(l),t=yield e(n,i,o,d,"AppReady",new Ky(r,o));if(t){const{entity:{id:e,type:n}}=t;e&&a.esp.launchDialog(e,n)}}catch(n){null===(t=e.errorToTelemetry)||void 0===t||t.call(e,"AppReady failed to show any surface","growth_growthplatform_esp_engine")}finally{p&&(yield(0,Qy.m8)(n,o.newLogger("esp","apps-esp")))}}}))}}const ev={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsEspTriggerSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"espTriggerEvent"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]}}]};function nv(e){const{client:n,coreSettings:i,authenticationUser:a}=e;return{id:"esp-time-based-trigger-job",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const{enableEsp:o,enableTimeBasedEspTrigger:d}=i.get(s.J.Esp);if(!o||!d)return;if((null==a?void 0:a.type)===Jy.Ch.Anonymous)return;const l=n.subscribe({query:ev,fetchPolicy:"no-cache"}).subscribe((()=>function(e){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const{client:n,coreSettings:i,loggerFactory:t,platformService:a,scenarioFactory:o,userBiService:d}=e,l="esp_time_based_trigger_job",r=t.newLogger(l,"apps-esp");try{const{displayEspSurface:e}=yield zy(o);yield e(n,i,t,a,"Daily",new Ky(d,t)),r.infoToTelemetry?r.infoToTelemetry("Daily Trigger was invoked",l):r.log("Daily Trigger was invoked")}catch(e){const n=(0,yn.qZ)(e);r.errorToTelemetry?r.errorToTelemetry(`Daily Trigger has an error ${n}`,l):r.error("Daily Trigger has an error")}}))}(e)));return()=>{l.unsubscribe()}}))}}const iv=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:n,entityCommand:{entity:{type:i,action:t,id:a},entityOptions:o},requestContext:{client:d,coreSettings:l,loggerFactory:r,platformService:m,scenarioFactory:u,userBiService:p}}=e,{enableEsp:y}=l.get(s.J.Esp),v=a||void 0;if(i===De.py.esp&&t===De.uk.create){let e;if(y){const n=u.newScenario(c.RG.EspDisplaySurface);try{const{displayEspSurface:i}=yield zy(u),{forceShow:t,triggerType:a,customParams:s}=o||{};e=yield i(d,l,r,m,"FollowUp"===a?"FollowUp":"Manual",new Ky(p,r),{surfaceId:v,forceShow:t,customParams:s}),n.stop({surfaceId:v})}catch(e){n.fail({surfaceId:v})}}return e}return n})),tv=[{filter:"/l/discover-teams",execute:({deeplinkUrl:{pathname:e,searchParams:n},context:{loggerFactory:i,coreSettings:a}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const t=i.newLogger("[ESP][/discover-teams]","apps-esp");t.debug(`Deeplink path: ${e}`,`, Deeplink params: ${n}`);const{enableDiscoverTeamsDeeplink:o}=a.get(s.J.Esp);return o?{entityCommand:{entity:{id:"",type:De.py.teamsgallery,action:De.uk.view},command:{stateTransition:v.su.flow,visibilityState:v.fe.show}},metadata:{allowAnonymous:!1}}:void t.debug("Flag enableDiscoverTeamsDeeplink is not enabled. Skipping deeplink processing.")}))},{filter:"/l/campaign/chat",execute:({deeplinkUrl:{pathname:e,searchParams:n},context:{loggerFactory:i,coreSettings:a}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const t=i.newLogger("[ESP][/campaign/chat]","apps-esp");t.debug(`Deeplink path: ${e}`,`, Deeplink params: ${n}`);const{enableSyntheticNotificationCampaignDeeplink:o}=a.get(s.J.Esp);return o?{entityCommand:{entity:{id:"chatCampaign",type:De.py.campaignnotifications,action:De.uk.view},command:{stateTransition:v.su.flow,visibilityState:v.fe.show}},metadata:{allowAnonymous:!1}}:void t.debug("Flag enableSyntheticNotificationCampaignDeeplink is not enabled. Skipping deeplink processing.")}))},{filter:"/l/campaign/meeting",execute:({deeplinkUrl:{pathname:e,searchParams:n},context:{loggerFactory:i,coreSettings:a}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const t=i.newLogger("[ESP][/campaign/meeting]","apps-esp");t.debug(`Deeplink path: ${e}`,`, Deeplink params: ${n}`);const{enableSyntheticNotificationCampaignDeeplink:o}=a.get(s.J.Esp);return o?{entityCommand:{entity:{id:"meetingCampaign",type:De.py.campaignnotifications,action:De.uk.view},command:{stateTransition:v.su.flow,visibilityState:v.fe.show}},metadata:{allowAnonymous:!1}}:void t.debug("Flag enableSyntheticNotificationCampaignDeeplink is not enabled. Skipping deeplink processing.")}))}],av={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsEspSyntheticNotificationToastSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"syntheticNotificationToastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attributionText"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"correlationId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"senderDisplayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"senderGivenName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"senderId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"subtype"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"text"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"timestamp"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"type"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"campaignType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"imageUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SyntheticNotificationToastEvent"}}},arguments:[]}]}}]},ov={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsEspToastImageAsDataUriQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"credentials"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"credentials"},value:{kind:"Variable",name:{kind:"Name",value:"credentials"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]}}]};var dv;function lv(e){const{client:n,coreSettings:i,i18n:a,entityCommanding:o,loggerFactory:d,authenticationUser:l}=e;return{id:"esp-synthetic-notification-toast-subscription-job",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const{enableEsp:e,enableSyntheticNotificationToast:r}=i.get(s.J.Esp);if(!e||!r)return;if((null==l?void 0:l.type)===Jy.Ch.Anonymous)return;const m=n.subscribe({query:av,fetchPolicy:"no-cache"}).subscribe(function(e,n,i,a){return o=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var t,d,l;const r=i.newLogger("SyntheticNotificationToastEventSubscription","apps-esp");if(o.errors){const e=(0,wo.u4)(o.errors.map((e=>e.message)).join());return void(null===(t=r.error)||void 0===t||t.call(r,`${io.f.SubscriptionFailed} ${e}`))}if(!(null===(d=o.data)||void 0===d?void 0:d.syntheticNotificationToastEvent))return void(null===(l=r.error)||void 0===l||l.call(r,io.f.EmptyEvent));const{syntheticNotificationToastEvent:s}=o.data,m=function(e,n,i){var t;return{conversationId:n.messageId,messageId:n.messageId,quickReply:!1,time:new Date(+n.timestamp),text:rv(e,n,"description",i),title:rv(e,n,"title",i),type:"SyntheticNotification",campaignType:null!==(t=n.campaignType)&&void 0!==t?t:void 0}}(n,s,r),c=yield sv(a,r,s.imageUrl||void 0);return c&&(m.mainImage={alt:"",src:c}),e.toasts.showEspSyntheticNotification(s.correlationId,m)}))}(o,a,d,n));return()=>{m.unsubscribe()}}))}}function rv(e,n,i,t){if(n.campaignType){const a=(()=>{switch(n.campaignType){case dv.meeting:return`activity_esp_meeting_recommendation_${i}`;case dv.chat:return`activity_esp_chat_recommendation_${i}`;case dv.upgrade:return`activity_esp_upgrade_recommendation_${i}`;case dv.files:return`activity_esp_files_recommendation_${i}`;default:return void t.error(`Campaign Type is not valid ${n.campaignType}`)}})();return a?e.stringTranslate("activity",a):""}return"title"===i?n.title||"":n.text||""}!function(e){e.chat="chatCampaign",e.meeting="meetingCampaign",e.upgrade="upgradeCampaign",e.files="filesCampaign"}(dv||(dv={}));const sv=(e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){if(i)try{const n=yield e.query({query:ov,fetchPolicy:"no-cache",variables:{url:i,credentials:"omit"}});return(null==n?void 0:n.data.toastImageAsDataUri)||void 0}catch(e){return void n.error(io.f.ImageFetchFailed)}}));const mv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ComponentsEspCommonEspSurfacesUpdateSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"espSurfacesUpdateEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsEspCommonSurfaceFragment"}}]},__type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"EspSurfaceConfiguration"}}},arguments:[]}]}},...i(42656).wh.definitions]};var cv=i(879980),uv=i(410770);const pv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsEspSurfaceShownSubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"surfaceIds"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"espSurfaceShownEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"surfaceIds"},value:{kind:"Variable",name:{kind:"Name",value:"surfaceIds"}},__type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}]}}]};class yv{constructor(e,n,i,a,o,d,l,r){this.logger=a,this.entityCommanding=o,this.parseExpression=d,this.getEspConfig=l,this.displaySurface=r;const m=n.getObservable(s.J.Esp);this.biSurfaces=this.toBiSurfaces(e),this.configSubscription=m.subscribe((()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){yield this.updateSurfaces()})))),this.espCdlSurfaceSubscription=i.subscribe({query:mv,fetchPolicy:"no-cache"}).subscribe((()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){yield this.updateSurfaces(),yield i.query({query:cv.Y,fetchPolicy:"network-only"})})))),this.surfaceShownSubscription=i.subscribe({query:pv,variables:{surfaceIds:this.biSurfaces.map((e=>e.id))},fetchPolicy:"no-cache"}).subscribe((()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){yield this.updateSurfaces()}))))}onSignal(e){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const n=this.biSurfaces.filter((n=>n.invoke(e))).map((e=>e.id));if(!n.length)return;let i=e.data["Panel.WindowID"];this.isEventFromSyntheticNotificationToast(e)&&(i=uv.f5);const t=yield this.displaySurface(n,i);if(t){const{entity:{id:e,type:n}}=t;e&&this.entityCommanding.esp.launchDialog(e,n)}}))}unsubscribe(){this.configSubscription.unsubscribe(),this.surfaceShownSubscription.unsubscribe(),this.espCdlSurfaceSubscription.unsubscribe()}toBiSurfaces(e){return e.filter((e=>-1===e.recur||e.recur>e.displayed.length)).filter((e=>"BIEvent"===e.trigger)).map((e=>{try{const n=this.parseExpression(e.triggerFilter||"");return{id:e.id,invoke:e=>n.evaluate(e)}}catch(n){return void this.logger.error(`invalid BITrigger trigger filter value for surface ${e.id} with triggerFilter ${e.triggerFilter}`)}})).filter((e=>!!e))}isEventFromSyntheticNotificationToast(e){return"SyntheticNotification"===e.data["Panel.Type"]&&"toast"===e.data["Panel.Region"]}updateSurfaces(){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const{surfaces:e}=yield this.getEspConfig();this.biSurfaces=this.toBiSurfaces(e)}))}}const vv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsEspRecordCompletedActionMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actions"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"recordEspCompletedActions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"actions"},value:{kind:"Variable",name:{kind:"Name",value:"actions"}},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"completedActions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"action"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EspCompletedAction"}}}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EspUserState"}}}}]}}]};var kv=i(204961);class gv{constructor(e,n,i,a,o,d){this.logger=n,this.parseExpression=i,this.client=a,this.coreSettings=o;const l=o.getObservable(s.J.Esp);this.actionRegistrations=this.getActionRegistrations(e),this.configSubscription=l.subscribe((()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const{espState:e}=yield d();this.actionRegistrations=this.getActionRegistrations(e)}))))}onSignal(e){const n=this.actionRegistrations.filter((n=>n.invoke(e))).map((e=>e.action));if(n.length){this.actionRegistrations=this.actionRegistrations.filter((e=>-1===n.indexOf(e.action)));const{enableEspStateApolloCache:e}=this.coreSettings.get(s.J.Esp);this.client.mutate({mutation:vv,variables:{actions:n},refetchQueries:e?[{query:kv.$,fetchPolicy:"no-cache"}]:void 0})}}unsubscribe(){this.configSubscription.unsubscribe()}getActionRegistrations(e){const n=e.userState.completedActions.reduce(((e,n)=>e.add(n.action)),new Set);return this.getEspTrackedActions(this.coreSettings).filter((e=>!n.has(e.action))).map((e=>{var n,i;try{const n=this.parseExpression(e.expression);return{action:e.action,invoke:e=>n.evaluate(e)}}catch(t){return void(null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,`invalid data registration expression for action ${e.action} with expression ${e.expression}`,"esp_signal_handler"))}})).filter((e=>!!e))}getEspTrackedActions(e){const n=e.get(s.J.Esp),i=[];return Object.keys(n).forEach((e=>{const t=n[e];(null==t?void 0:t.trackedAction)&&!(null==t?void 0:t.disabled)&&i.push({action:t.trackedAction,expression:t.expression})})),i}}class Nv{onSignal(e){}unsubscribe(){}}function hv(e){const{coreSettings:n,userBiService:i,scenarioFactory:a,client:o,loggerFactory:d,platformService:l,entityCommanding:r,authenticationUser:m}=e;return{id:"esp-signal-handler-job",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var e;const{enableEsp:c,enableEspBiEventTrigger:u,enableEspCompletedActions:p}=n.get(s.J.Esp);if(!c)return;if((null==m?void 0:m.type)===Jy.Ch.Anonymous)return;if(!u&&!p)return;const{getConfig:y,parseExpression:v,displayEspSurface:k}=yield zy(a),g=d.newLogger("esp-signal-handler-job","apps-esp"),{surfaces:N,espState:h}=yield y(o,n,g),f=()=>y(o,n,g,"network-only"),_=u?new yv(N,n,o,g,r,v,f,((e,t)=>k(o,n,d,l,"BIEvent",new Ky(i,d),{surfaceIds:e},t))):new Nv,S=p?new gv(h,g,v,o,n,f):new Nv,T=null===(e=null==i?void 0:i.observe)||void 0===e?void 0:e.call(i).subscribe({next:e=>(0,t.__awaiter)(this,void 0,void 0,(function*(){S.onSignal(e),_.onSignal(e)}))});return()=>{null==T||T.unsubscribe(),_.unsubscribe()}}))}}const fv=()=>Promise.all([i.e(44922),i.e(270657),i.e(849736)]).then(i.bind(i,234154));function _v(){const e=()=>null;return{manifest:Gy,render:({appRenderMode:n,onRenderEvent:i,scenarioFactory:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Modal){const e="esp-dialog";i("ChunkLoadStarted",{chunkName:e});const{EspDialogComponent:n}=yield(0,Pn.mT)(fv,e,a);return i("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(n,{})}return(0,Ie.t)(e,{})})),onPreWarm:e=>{const{context:n}=e;return[Xy(n),nv(n),lv(n),hv(n)]},onUserWindowPreWarm:e=>{const{context:n}=e;return[Zy(n)]},onBeforeCommandHandled:iv,onBeforeDeeplinkParsed:tv}}const Sv={id:"com.microsoft.teams.filePicker",name:"FilePickerApp",supportedEntities:[De.py.filepicker],supportedRenderModes:[Fe.S.Modal]},Tv=()=>Promise.all([i.e(917388),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(976609),i.e(133950),i.e(779478),i.e(315215),i.e(680254),i.e(984256),i.e(555551),i.e(844369),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(26466),i.e(745659),i.e(462317),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(613692),i.e(403936),i.e(207856),i.e(450605),i.e(586146),i.e(329712),i.e(673758),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(788842),i.e(427163),i.e(749021),i.e(542511),i.e(232044),i.e(660340),i.e(988150),i.e(258171),i.e(658803),i.e(966573),i.e(868123)]).then(i.bind(i,316299));function bv(){const e=()=>null;return{manifest:Sv,render:({appRenderMode:n,onRenderEvent:i,scenarioFactory:a,loggerFactory:o})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=o.newLogger("FilePickerApp","apps-file-picker");if(n===Fe.S.Modal){const e="file-picker-app";t.log("chunk load start"),i("ChunkLoadStarted",{chunkName:e}),t.log("experimental import start");const{FilePickerComposeDialogRenderer:n}=yield(0,Pn.mT)(Tv,e,a);return t.log("report chunk load success"),i("ChunkLoadSucceeded",{chunkName:e}),t.log("Rendering file picker compose dialog"),(0,Ie.t)(n,{})}return(0,Ie.t)(e,{})}))}}const Cv={id:"com.microsoft.teams.add-cloud-storage-folder-dialog",name:"AddCloudStorageFolderDialogApp",supportedEntities:[De.py.cloudStorageDialog],supportedRenderModes:[Fe.S.Modal]},wv=()=>Promise.all([i.e(917388),i.e(590393),i.e(141603),i.e(65477),i.e(976609),i.e(364037),i.e(984256),i.e(879697),i.e(555551),i.e(347761),i.e(409201),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(756029),i.e(613692),i.e(207856),i.e(673758),i.e(749021),i.e(232044),i.e(258171),i.e(658803),i.e(260071)]).then(i.bind(i,316299));function Iv(){return{manifest:Cv,render:({appRenderMode:e,onRenderEvent:n,scenarioFactory:i})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t="apps-add-cloud-storage",a={chunkName:t};if(e===Fe.S.Modal){n("ChunkLoadStarted",a);const{AddCloudStorageDialogRenderer:e}=yield(0,Pn.mT)(wv,t,i);return n("ChunkLoadSucceeded",a),(0,Ie.t)(e,{})}return(0,Ie.t)((()=>null),{})}))}}const Av={id:"com.microsoft.teams.files",name:"FilesApp",supportedEntities:[De.py.file],supportedRenderModes:[Fe.S.Main],getDefaultCommand:()=>({type:De.py.file,action:De.uk.error}),windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},Fv=({appRenderMode:e,coreSettings:n})=>{const i=new Ee.H,{criticalPhaseTimeout:t,postCriticalPhaseTimeout:a}=n.get(s.J.Files),o=[];if(e===Fe.S.Main)o.push(Me.G.P2P_FILES_LIST_VIEW_RENDERED);return i.registerAppPhase({phase:g.nh.CRITICAL,signals:o,timeout:t||6e4}),i.registerAppPhase({phase:g.nh.POST_CRITICAL,signals:[],timeout:a||1e4}),i.appPhases},Dv=({entity:e})=>e.type!==De.py.file||e.action!==De.uk.list&&e.action!==De.uk.update?c.RG.FilesAppSwitch:c.RG.P2PFilesListSwitch,Ev=e=>{if(Mv(e))return Pv(e)?{subNavEntity:Rv(e),headerEntity:Ov(e),startEntity:$v(e),mainEntity:Lv(e),endEntity:xv(e)}:null},Mv=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=t===De.py.file,d=[De.uk.list,De.uk.error],l=i&&d.includes(i);return!!(a&&o&&l)},Pv=()=>!0,Rv=()=>null,Ov=()=>null,$v=()=>null,Lv=({entity:e})=>e,xv=()=>null,Bv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsFilesPersonalSiteDetailsUserPreferenceStoreQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getPersonalSiteInfoFromUserPreferenceStore"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"siteUrl"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"listUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SharePointSiteInfo"}}},arguments:[]}]}}]},jv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsFilesRegisterTokenWarmingResourceMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"service"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"registerTokenWarmingResource"},arguments:[{kind:"Argument",name:{kind:"Name",value:"service"},value:{kind:"Variable",name:{kind:"Name",value:"service"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]}}]},Uv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsFilesPersonalSiteDetailsFromUploadQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getPersonalSiteInfoForUpload"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"siteUrl"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"listUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"SharePointSiteInfo"}},arguments:[]}]}}]},Vv=({context:{client:e,coreSettings:n,scenarioFactory:i}})=>[{id:"files-register-resources",runOncePerId:!0,job:()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,a,o,d;const l=i.newScenario(c.RG.FileSPOHomeSiteODTokenPrewarm);try{const{tenantSiteUrl:i}=n.get(s.J.Tenant),t=(null==i?void 0:i.webUrl)&&new URL(null==i?void 0:i.webUrl),a=t&&t.origin||void 0;a&&e.mutate({mutation:jv,variables:{service:"Files",resource:a}})}catch(e){l.mark("Home site domain token prewarm failed")}l.stop();const{environment:m}=n.get(s.J.Metadata);if(m===r.s.life)return;const u=i.newScenario(c.RG.FileSPOPersonalODTokenPrewarm);let p;try{const n=yield e.query({query:Bv,fetchPolicy:"cache-first"});p=null===(a=null===(t=null==n?void 0:n.data)||void 0===t?void 0:t.getPersonalSiteInfoFromUserPreferenceStore)||void 0===a?void 0:a.siteUrl}catch(e){u.mark("Preference Store fetch failed")}try{if(!p||""===p){u.mark("Falling back to upload query");const n=yield e.query({query:Uv,context:{scenario:u}});p=null===(d=null===(o=null==n?void 0:n.data)||void 0===o?void 0:o.getPersonalSiteInfoForUpload)||void 0===d?void 0:d.siteUrl}if(!p||""===p)return void u.fail({errorMessage:"Personal OD Token Prewarming failed due to invalid personal siteUrl"})}catch(e){u.fail({errorMessage:"upload query fetch failed"})}try{const n=new URL(p),i=n&&n.origin;u.mark("Starting Prewarm code"),e.mutate({mutation:jv,variables:{service:"PersonalFiles",resource:i}}),u.stop()}catch(e){u.fail({errorMessage:"Personal OD Token Prewarming failed"})}}))}],Wv={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsFileBrowserPreWarmAuthenticationTokenQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"acquireTokenOptions"},value:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}},__type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationToken"}}}]}}]},Hv=(e,n,i,a)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const t=new URL(n).origin,o=yield i({resource:t});if(o&&e){const i=e.document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","access_token"),i.setAttribute("value",o);const t=e.document.createElement("form");t.appendChild(i),t.setAttribute("action",n),t.setAttribute("method","POST"),e.document.body.appendChild(t),t.submit(),null==a||a.mark("Form Created and submitted")}else null==a||a.fail({errorMessage:"Token fetch failed"})})),Gv=(e,n,i)=>{let t;return new Promise(((a,o)=>{let d;const l=e=>{if(e.source&&n&&e.source===n){if("initialize"===e.data.type){d&&(clearInterval(d),d=void 0);const n=e.ports&&e.ports[0];if(n)return t=n,void a(t);o(t)}}};n?(d=setInterval((()=>{var a;t?(clearInterval(d),d=void 0):n.postMessage({type:"identify-parent",channelId:e},null===(a=i.document.location)||void 0===a?void 0:a.origin)}),100),i.addEventListener("message",l)):a(t)}))};var Jv=i(645534);const qv=(e,n,i,a)=>({close:()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){null==i||i.log("Close post meessage received"),null==a||a.mark(Jv.le.telemetry.markers.filebrowser_prewarm_close_post_message),yield n(!1)})),authenticate:n=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){null==i||i.log(`Authenticate post meessage received for ${n.resource}`),null==a||a.mark(Jv.le.telemetry.markers.filebrowser_prewarm_auth_post_message);const t=yield e({resource:n.resource});return t?{result:"token",scheme:"bearer",token:t}:(null==i||i.log("Not able to PreWarm the App"),null==a||a.mark(Jv.le.telemetry.markers.filebrowser_prewarm_auth_token_failed),{result:"error",error:{code:"NoTokenObtained",message:"Could not obtain a token for resource."}})}))}),zv=()=>({result:"success"}),Qv=(e,n)=>(n.error("Error executing command in filebrowser pre warm: ".concat(e.message)),{result:"error",error:{code:e.code||"unknown",message:e.message}}),Yv=e=>({result:"error",error:{code:"unsupportedCommand",message:e.command}}),Kv=e=>n=>{e(n.data)},Xv=(e,n,i)=>{const{close:a,authenticate:o}=n,d=(({sendAck:e,sendCommandResult:n,close:i,authenticate:a,logger:o})=>d=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){if("command"===d.type){e(d);const t=d.data;switch(t.command){case"close":i(t).then((()=>{n(d,zv())}),(e=>{n(d,Qv(e,o))}));break;case"authenticate":a(t).then((e=>{n(d,e)}),(e=>{n(d,Qv(e,o))}));break;default:n(d,Yv(t))}}})))({sendAck:n=>{e&&e.postMessage({type:"acknowledge",id:n.id})},sendCommandResult:(n,i)=>{e&&e.postMessage({type:"result",id:n.id,data:i})},close:a,authenticate:o,logger:i});((e,n)=>{const i=Kv(n);e&&(e.addEventListener("message",i),e.start(),e.postMessage({type:"activate"}))})(e,d)},Zv=e=>{const n=e.document.createElement("iframe");return n&&(n.setAttribute("id","filesAppIframe"),n.style.display="none",n.setAttribute("target","_self"),e.document.body.appendChild(n)),n&&n.contentWindow||null},ek=(e,n,i)=>{let t,a=12e3;e&&e>0&&(a=e),t=void 0,t=n.setTimeout((()=>{i(!0),n.clearTimeout(t)}),a)},nk=(e,n,i,t,a)=>{var o,d;return`${e}_layouts/15/${a?"prewarm.ashx":"filebrowser.aspx"}?app=TeamsFile&fileBrowser={"sdk":"8.0","messaging":{"origin":"${null!==(d=null===(o=null==n?void 0:n.location)||void 0===o?void 0:o.origin)&&void 0!==d?d:void 0}","channelId":"${i}"},"authentication":{},"entry":{"oneDrive":{"recent":{}}}}&scenario=OneDriveFiles&auth=none&locale=${t}&hostName=TeamsModern&preWarmFB=true`};function ik(e){const{loggerFactory:n,scenarioFactory:i,client:a,localStorage:o,windowProvider:d,coreSettings:l,networkState:r}=e;return{id:"files-app-pre-warm-job",job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var e,m,u,p,y;const v=i.newScenario(c.RG.FileBrowserPreWarm),k=n.newLogger("FilesAppPreWarmJob","apps-files");k.log("files_app_pre_warm_job triggered");try{if(!r.isOnline())return void v.incomplete({errorMessage:"No network, Terminating the Job"});let y;try{const n=yield a.query({query:Bv});y=null===(m=null===(e=null==n?void 0:n.data)||void 0===e?void 0:e.getPersonalSiteInfoFromUserPreferenceStore)||void 0===m?void 0:m.siteUrl}catch(e){v.mark("Preference Store fetch failed")}if(!y){v.mark("Reading from IndexDB");const e=yield a.query({query:Uv,context:{scenario:v}});y=null===(p=null===(u=null==e?void 0:e.data)||void 0===u?void 0:u.getPersonalSiteInfoForUpload)||void 0===p?void 0:p.siteUrl}y?(v.mark("Starting Prewarm code"),yield((e,n,i,a,o,d,l)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const r=i.newLogger("fileBrowserPreWarm","components-file-browser-pre-warm"),m=n.findScenario(c.RG.FileBrowserPreWarm),{fileBrowserHiddenIframeCloseInterval:u,enableDedicatedPrewarm:p}=d.get(s.J.Files),y=`${Math.random().toFixed(8)}`,v=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n,i,t;const{resource:o}=e,d=new URL(o).origin;r.log(`getAuthToken triggered for resource: ${o}`),null==m||m.mark(Jv.le.telemetry.markers.filebrowser_prewarm_auth_token_start);const l=null!==(t=null===(i=null===(n=(yield a.query({query:Wv,fetchPolicy:"cache-first",variables:{resource:d}})).data)||void 0===n?void 0:n.authenticationToken)||void 0===i?void 0:i.token)&&void 0!==t?t:"";return null==m||m.mark(Jv.le.telemetry.markers.filebrowser_prewarm_auth_token_end),Promise.resolve(l)})),k=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t;const a=i.newLogger("fileBrowserPreWarm","components-file-browser-pre-warm"),d=n.findScenario(c.RG.FileBrowserPreWarm);e||null==l||l.set("FileAppPreWarmTimeStamp",Date.now().toString(),"Files"),null===(t=o.document.getElementById("filesAppIframe"))||void 0===t||t.remove(),a.log("Removed Hidden Iframe"),null==d||d.mark(Jv.le.telemetry.markers.filebrowser_prewarm_window_removed,void 0,e?"timeout":"success"),null==d||d.stop(),Promise.resolve()})),g=Zv(o);g||(null==m||m.mark(Jv.le.telemetry.markers.filebrowser_prewarm_window_creation_failed),null==m||m.fail({errorMessage:"Failed to create iframe"}),Promise.resolve()),r.log("Created Hidden Iframe"),null==m||m.mark(Jv.le.telemetry.markers.filebrowser_prewarm_window_creation_successful);const{localeCode:N}=d.get(s.J.Platform),h=nk(e,o,y,null!=N?N:void 0,null!=p&&p);yield Hv(g,h,v,m),ek(u,o,k);const f=yield Gv(y,g,o),_=qv(v,k,r,m);Xv(f,_,r)})))(y,i,n,a,d,l,o)):v.incomplete({errorMessage:"Personal SiteInfo fetch failed"})}catch(e){const n=(null==e?void 0:e.errorCode)||(null==e?void 0:e.code),i=`Failed filesAppPreWarmJob with errorCode ${n}`;return null===(y=k.errorToTelemetry)||void 0===y||y.call(k,i,"files_app_pre_warm_job"),void v.fail({errorCode:n,message:null==e?void 0:e.message,errors:null==e?void 0:e.name,errorMessage:i})}}))}}const tk={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsFilesJoinedTeamsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamsOrder"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"JoinedTeamsOrderInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isSortingEnforced"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activitiesFromWorker"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"excludeHiddenAndArchivedTeams"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"joinedTeamsAndChannels"},arguments:[{kind:"Argument",name:{kind:"Name",value:"teamsOrder"},value:{kind:"Variable",name:{kind:"Name",value:"teamsOrder"}},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"JoinedTeamsOrderInput"}}}}},{kind:"Argument",name:{kind:"Name",value:"isSortingEnforced"},value:{kind:"Variable",name:{kind:"Name",value:"isSortingEnforced"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"Argument",name:{kind:"Name",value:"activitiesFromWorker"},value:{kind:"Variable",name:{kind:"Name",value:"activitiesFromWorker"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"Argument",name:{kind:"Name",value:"excludeHiddenAndArchivedTeams"},value:{kind:"Variable",name:{kind:"Name",value:"excludeHiddenAndArchivedTeams"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"joinedTeams"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"channelOnlyMember"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isDeleted"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"memberRole"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TeamMemberRole"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamSiteInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TeamSiteInformation"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isArchived"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"description"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isFavorite"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"membershipSummary"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"memberCount"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"botCount"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MembershipSummary"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"visibility"},__type:{kind:"NamedType",name:{kind:"Name",value:"TeamAccessType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"pictureETag"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamGuestSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createAndUpdateChannel"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"TeamSettings"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dynamicMembership"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isTenantWide"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamType"},__type:{kind:"NamedType",name:{kind:"Name",value:"TeamType"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamLockState"},__type:{kind:"NamedType",name:{kind:"Name",value:"TeamLockState"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createAndUpdateChannel"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TeamSettings"}}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Team"}}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"JoinedTeamsAndChannels"}}}}]}}]};var ak=i(921916),ok=i(398411);const dk={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsFilesChannelsInfoByGroupIdQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"groupId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activitiesFromWorker"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},defaultValue:{kind:"BooleanValue",value:!1}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamByGroupId"},arguments:[{kind:"Argument",name:{kind:"Name",value:"groupId"},value:{kind:"Variable",name:{kind:"Name",value:"groupId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonChannelListTeamFragment"}},{kind:"Field",name:{kind:"Name",value:"channels"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonChannelListChannelFragment"}},{kind:"Field",name:{kind:"Name",value:"description"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"hostTenantId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isShownByDefault"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"substrateGroupId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"lastMessageArrivalTime"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"defaultFileSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filesRelativePath"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"DefaultFileSettings"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Channel"}}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"tenantId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamSiteInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TeamSiteInformation"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Team"}}}}]}},...ak.Ke.definitions,...ok.yh.definitions]},lk=(e,n,i,t,a,o,d)=>{var l,r;const s=new URL(e).pathname;return`${e}/_layouts/15/${d?"prewarm.ashx":"filebrowser.aspx"}?fileBrowser={"sdk":"8.0","messaging":{"origin":"${null!==(r=null===(l=null==n?void 0:n.location)||void 0===l?void 0:l.origin)&&void 0!==r?r:void 0}"},"entry":{"sharePoint":{"byPath":{"web":"${s}","folder":"${a}"}}}}&app=teamsfile&teamId=${t}&channelId=${i}&scenario=ChannelFiles&auth=none&locale=${o}&hostName=TeamsModern&preWarmFB=true`};function rk(e){const{loggerFactory:n,scenarioFactory:i,client:a,localStorage:o,windowProvider:d,coreSettings:l,networkState:r}=e;return{id:"files-app-pre-warm-cft-job",job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var e,m,u,p,y,v,k,g,N,h,f,_,S,T,b;const C=i.newScenario(c.RG.FileBrowserPreWarmForCFT);n.newLogger("FilesAppPreWarmForCFTJob","apps-files").log("files_app_pre_warm_cft_job triggered");try{if(!r.isOnline())return void C.incomplete({errorMessage:"No network, Terminating the Job"});const w=yield a.query({query:tk,fetchPolicy:"cache-first",variables:{teamsOrder:[],isSortingEnforced:!1,activitiesFromWorker:!1,excludeHiddenAndArchivedTeams:!0}});if(null===(y=null===(p=null===(u=null===(m=null===(e=null==w?void 0:w.data)||void 0===e?void 0:e.joinedTeamsAndChannels)||void 0===m?void 0:m.joinedTeams)||void 0===u?void 0:u[0])||void 0===p?void 0:p.teamSiteInformation)||void 0===y?void 0:y.groupId){const e=yield a.query({query:dk,fetchPolicy:"cache-first",variables:{groupId:w.data.joinedTeamsAndChannels.joinedTeams[0].teamSiteInformation.groupId}}),r=null===(N=null===(g=null===(k=null===(v=e.data.teamByGroupId)||void 0===v?void 0:v.channels)||void 0===k?void 0:k[0])||void 0===g?void 0:g.defaultFileSettings)||void 0===N?void 0:N.filesRelativePath,m=null===(f=null===(h=e.data.teamByGroupId)||void 0===h?void 0:h.teamSiteInformation)||void 0===f?void 0:f.sharepointSiteUrl,u=null===(T=null===(S=null===(_=e.data.teamByGroupId)||void 0===_?void 0:_.channels)||void 0===S?void 0:S[0])||void 0===T?void 0:T.id,p=null===(b=e.data.teamByGroupId)||void 0===b?void 0:b.id;if(m&&p&&u&&r)yield((e,n,i,a,o,d,l,r,m,u)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const p=d.newLogger("fileBrowserPreWarmForCFT","components-file-browser-pre-warm"),y=o.findScenario(c.RG.FileBrowserPreWarmForCFT),{fileBrowserHiddenIframeCloseInterval:v,enableDedicatedPrewarm:k}=m.get(s.J.Files),g=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n,i,t;const{resource:a}=e,o=new URL(a).origin;p.log(`getAuthToken triggered for resource: ${a}`),null==y||y.mark(Jv.le.telemetry.markers.filebrowser_prewarm_auth_token_start);const d=null!==(t=null===(i=null===(n=(yield l.query({query:Wv,fetchPolicy:"cache-first",variables:{resource:o}})).data)||void 0===n?void 0:n.authenticationToken)||void 0===i?void 0:i.token)&&void 0!==t?t:"";return null==y||y.mark(Jv.le.telemetry.markers.filebrowser_prewarm_auth_token_end),Promise.resolve(d)})),N=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n;const i=d.newLogger("fileBrowserPreWarmForCFT","components-file-browser-pre-warm"),t=o.findScenario(c.RG.FileBrowserPreWarmForCFT);e||null==u||u.set("ChannelFilesTabPreWarmTimeStamp",Date.now().toString(),"Files"),null===(n=r.document.getElementById("filesAppIframe"))||void 0===n||n.remove(),i.log("Removed Hidden Iframe"),null==t||t.mark(Jv.le.telemetry.markers.filebrowser_prewarm_window_removed,void 0,e?"timeout":"success"),null==t||t.stop(),Promise.resolve()})),h=Zv(r);h||(null==y||y.mark(Jv.le.telemetry.markers.filebrowser_prewarm_window_creation_failed),null==y||y.fail({errorMessage:"Failed to create iframe"}),Promise.resolve()),p.log("Created Hidden Iframe"),null==y||y.mark(Jv.le.telemetry.markers.filebrowser_prewarm_window_creation_successful);const{localeCode:f}=m.get(s.J.Platform),_=lk(e,r,i,n,a,null!=f?f:void 0,null!=k&&k);yield Hv(h,_,g,y),ek(v,r,N);const S=yield Gv(i,h,r),T=qv(g,N,p,y);Xv(S,T,p)})))(m,p,u,r,i,n,a,d,l,o);else{const e=`Required information is missing ${m?"":"siteUrl"} ${p?"":"teamId"} ${u?"":"channelId"} ${r?"":"folderRelativePath"}`;C.incomplete({errorMessage:e})}}else C.incomplete({errorMessage:"JoinedTeamsAndChannels query does not return any team/site, possibly teamId or siteInformation is not available"})}catch(e){const n=(null==e?void 0:e.errorCode)||(null==e?void 0:e.code),i=`Failed filesAppPreWarmForCFTJob with errorCode ${n}`;return void C.fail({errorCode:n,message:(null==e?void 0:e.message)||i,errors:null==e?void 0:e.name})}}))}}const sk=864e5,mk=({context:{coreSettings:e,hostCommunicationService:n,loggerFactory:i,scenarioFactory:t,client:a,localStorage:o,windowProvider:d,platformService:l,networkState:m,entityCommanding:u,config:p,clientState:y,rebootService:v,userTrackingService:k}})=>{const g=[],{preWarmFileBrowser:N,fileBrowserRelaunchHiddenIframeInterval:h,preWarmFileBrowserForCFT:f}=e.get(s.J.Files),{environment:_}=e.get(s.J.Metadata),S=_===r.s.life,T=i.newLogger("FilesAppPreWarmJob","apps-files");if(N&&!S){const r=null==t?void 0:t.newScenario(c.RG.FileBrowserPreWarmIdleStateTrigger);null==T||T.log("Entered Idle Experience path");const s=null==o?void 0:o.get("FileAppPreWarmTimeStamp");let N=!0;if(s){const e=null!=h?h:sk,n=+s;N=Date.now()-n>e}N?(null==T||T.log("Push the Files App pre Warm Job"),null==r||r.stop({reason:"Job-pushed"}),g.push(ik({coreSettings:e,hostCommunicationService:n,loggerFactory:i,scenarioFactory:t,client:a,localStorage:o,windowProvider:d,platformService:l,networkState:m,entityCommanding:u,config:p,clientState:y,rebootService:v,userTrackingService:k}))):(null==T||T.log("Skip the Files App pre Warm Job"),null==r||r.stop({reason:"Job-Skipped"}))}if(f){const r=null==t?void 0:t.newScenario(c.RG.FileBrowserForCFTPreWarmIdleStateTrigger);null==T||T.log("Entered Idle Experience path for Iframe CFT");const s=null==o?void 0:o.get("ChannelFilesTabPreWarmTimeStamp");let N=!0;if(s){const e=null!=h?h:sk,n=+s;N=Date.now()-n>e}N?(null==T||T.log("Push the Channel Files Tab pre Warm Job"),null==r||r.stop({reason:"Job-pushed"}),g.push(rk({coreSettings:e,hostCommunicationService:n,loggerFactory:i,scenarioFactory:t,client:a,localStorage:o,windowProvider:d,platformService:l,networkState:m,entityCommanding:u,config:p,clientState:y,rebootService:v,userTrackingService:k}))):(null==T||T.log("Skip the Channel Files Tab pre Warm Job"),null==r||r.stop({reason:"Job-Skipped"}))}return g},ck={onEventReceived:({eventInput:e})=>{var n,i;if(e.event.type===Ze.uS.requestPersonMoreInfo){const t=null===(i=(n=e.event).data)||void 0===i?void 0:i.call(n);return Promise.resolve({command:on(t)})}return Promise.resolve(void 0)}},uk=()=>Promise.all([i.e(917388),i.e(590393),i.e(141603),i.e(892924),i.e(65477),i.e(976609),i.e(779478),i.e(250273),i.e(984256),i.e(450841),i.e(347761),i.e(409201),i.e(475063),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(26466),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(613692),i.e(403936),i.e(207856),i.e(450605),i.e(329712),i.e(673758),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(749021),i.e(761598),i.e(354250),i.e(626847),i.e(959139)]).then(i.bind(i,232922)),pk=()=>Promise.all([i.e(917388),i.e(590393),i.e(141603),i.e(892924),i.e(65477),i.e(976609),i.e(779478),i.e(250273),i.e(984256),i.e(450841),i.e(347761),i.e(409201),i.e(475063),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(26466),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(613692),i.e(403936),i.e(207856),i.e(450605),i.e(329712),i.e(673758),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(749021),i.e(761598),i.e(354250),i.e(626847),i.e(959139)]).then(i.bind(i,228183));function yk(){const e=()=>null,n="apps-files",i={chunkName:n};return{eventHandlers:ck,getAppPhases:Fv,getAppViewEntities:Ev,getCommandScenarioName:Dv,manifest:Av,render:({appRenderMode:a,coreSettings:o,onRenderEvent:d,scenarioFactory:l,entity:r})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(r.type===De.py.file&&(r.action===De.uk.list||r.action===De.uk.update)){d("ChunkLoadStarted",i);const{enableEntityMoreInfo:e}=o.get(s.J.Core),t=({children:e})=>(0,Ie.t)(Ae.Fragment,{children:e}),{P2PFilesListViewsRenderer:r}=yield(0,Pn.mT)(uk,n,l),{LPC:m}=e?{LPC:t}:yield(0,Pn.mT)(pk,n,l),c=e?t:Na.p3;return d("ChunkLoadSucceeded",i),(0,Ie.t)(m,{children:(0,Ie.t)(c,{children:(0,Ie.t)(r,{appRenderMode:a})})})}return(0,Ie.t)(e,{})})),onPreWarm:Vv,onExperienceLongIdle:mk}}const vk={id:"com.microsoft.teams.filesoneupviewer",name:"FilesoneupviewerApp",supportedEntities:[De.py.filesoneupviewer],supportedRenderModes:[Fe.S.HorizontalBar,Fe.S.Main]},kk=e=>{if(gk(e))return Nk(e)?{subNavEntity:hk(e),headerEntity:fk(e),startEntity:_k(e),mainEntity:Sk(e),endEntity:Tk(e)}:null},gk=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.filesoneupviewer].includes(t),d=[De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},Nk=()=>!0,hk=({entity:e,layoutMode:n})=>n===v.lO.focus?null:e,fk=({entity:e})=>e,_k=()=>null,Sk=({entity:e})=>e,Tk=({contextEntity:e})=>(null==e?void 0:e.type)===De.py.chats?e:null;var bk;!function(e){e.DeepLinkNotEnabled="deeplink-not-enabled-error",e.MissingFileId="missing-fileId-error"}(bk||(bk={}));const Ck=(e,n)=>{const{fileId:i,fileType:t,threadId:a,objectUrl:o,serviceName:d,shareUrl:l,context:r}=e;return Promise.resolve({entityCommand:{entity:{type:De.py.filesoneupviewer,id:i,action:n},command:{visibilityState:v.fe.show,stateTransition:v.su.flush},entityOptions:{fileId:i,fileType:t,threadId:a,objectUrl:o,serviceName:d,shareUrl:l,context:r}},metadata:{allowAnonymous:!1}})},wk=[{filter:"/l/file",execute:({deeplinkUrl:e,context:{coreSettings:n}})=>{if(!Ik(n))return Promise.reject({message:bk.DeepLinkNotEnabled});const{entityOptions:i}=(e=>{var n,i,t,a,o,d;const{pathname:l,searchParams:r}=e,s=l.split("/l/file/");return{entityOptions:{fileId:null!==(n=s[s.length-1])&&void 0!==n?n:"",fileType:null!==(i=r.get("fileType"))&&void 0!==i?i:"",threadId:null!==(t=r.get("threadId"))&&void 0!==t?t:"",objectUrl:null!==(a=r.get("objectUrl"))&&void 0!==a?a:"",serviceName:null!==(o=r.get("serviceName"))&&void 0!==o?o:"",shareUrl:null!==(d=r.get("emailHtmlLink"))&&void 0!==d?d:"",context:"bim"}}})(e);return i.fileId?Ck(i,De.uk.view):Promise.reject({message:bk.MissingFileId})}}],Ik=e=>!!(null==e?void 0:e.get(s.J.Outlook).enableDeepLinkFilesOneUpViewer),Ak=e=>{const{entity:n,command:i}=e;return(i.stateTransition===v.su.flush||i.stateTransition===v.su.new)&&n.type===De.py.filesoneupviewer&&n.action===De.uk.view&&i.visibilityState===v.fe.show?c.RG.FileOneUpViewer:void 0},Fk=({appRenderMode:e})=>{const n=new Ee.H,i=[];switch(e){case Fe.S.HorizontalBar:i.push(Me.G.ONEUP_HEADER_RENDERED);break;case Fe.S.Main:i.push(Me.G.ONEUP_RENDERED)}return n.registerAppPhase({phase:g.nh.CRITICAL,signals:i,timeout:12e4}),n.registerAppPhase({phase:g.nh.POST_CRITICAL,signals:[],timeout:1e4}),n.appPhases},Dk=()=>Promise.all([i.e(917388),i.e(590393),i.e(65477),i.e(493134),i.e(347761),i.e(409201),i.e(875549),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(756029),i.e(795037)]).then(i.bind(i,856177));function Ek(){return{getAppViewEntities:kk,getCommandScenarioName:Ak,getAppPhases:Fk,manifest:vk,render:({appRenderMode:e,onRenderEvent:n})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const i="files-viewer-oneup";n("ChunkLoadStarted",{chunkName:i});const[{FilesViewerOneupViewsRenderer:t}]=yield Promise.all([(0,Pn.mT)(Dk,i)]);return n("ChunkLoadSucceeded",{chunkName:i}),(0,Ie.t)(t,{appRenderMode:e})})),onBeforeDeeplinkParsed:wk}}const Mk={id:"com.microsoft.teams.floating-ufd",name:"FloatingUfdApp",supportedEntities:[De.py.floatingufd],supportedRenderModes:[Fe.S.Main],getDefaultCommand:()=>({action:De.uk.default,type:De.py.floatingufd}),windowFeatures:{width:300,height:200,top:0,left:0,additionalFeatures:{alwaysOnTop:"true",closable:"false",fullscreenable:"false",maximizable:"false",minimizable:"false",resizable:"false",movable:"false",hideWindowControl:"true",frame:"false",closeoverride:"true",transparent:"true",show:"false",excludeWindowFromScreenSharing:"true",contentprotection:"true"}}},Pk=e=>{if(Rk(e))return{subNavEntity:null,headerEntity:null,startEntity:null,mainEntity:Ok(e),endEntity:null}},Rk=({entity:e})=>{const{action:n=null,type:i}=Object.assign({},e),t=i===De.py.floatingufd,a=n===De.uk.view;return Boolean(t&&a)},Ok=({entity:e})=>e,$k=()=>({mainEntity:{[Fe.S.Main]:{disableNotificationsBanners:!0,forceDisableTitleBar:!0,isBackgroundTransparent:!0,disableBorderInHighContrast:!0}}}),Lk=()=>Promise.all([i.e(917388),i.e(590393),i.e(141603),i.e(481026),i.e(347761),i.e(127919),i.e(931123),i.e(297312),i.e(442766),i.e(799490),i.e(441838),i.e(782407)]).then(i.bind(i,180193)),xk=({coreServices:e})=>{const n=!!(null==e?void 0:e.coreSettings.get(s.J.Calling).disableContentprotection),i=(!n).toString(),t=Object.assign({},Mk.windowFeatures);return n&&(null==t?void 0:t.additionalFeatures)&&(t.additionalFeatures.excludeWindowFromScreenSharing=i,t.additionalFeatures.contentprotection=i),t};function Bk(){const e=()=>null;return{getAppViewEntities:Pk,getAppViewEntitiesProps:$k,getAppWindowFeatures:xk,manifest:Mk,render:({appRenderMode:n,entity:{type:i},scenarioFactory:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main&&i===De.py.floatingufd){const{FloatingUfd:e}=yield(0,Pn.mT)(Lk,"floating-ufd-app",a);return(0,Ie.t)(e,{})}return(0,Ie.t)(e,{})}))}}const jk={id:"com.microsoft.teams.flyout",name:"FlyoutApp",supportedEntities:[De.py.flyout,De.py.flyoutphonelink,De.py.flyoutwhatsnew],supportedRenderModes:[Fe.S.Main],getDefaultCommand:()=>({action:De.uk.default,type:De.py.flyout}),windowFeatures:{minWidth:378,maxWidth:378,width:378,minHeight:688,maxHeight:688,height:688,resizable:"false"}},Uk=e=>{if(Vk(e))return Wk(e)?{subNavEntity:Hk(e),headerEntity:Gk(e),startEntity:Jk(e),mainEntity:qk(e),endEntity:zk(e)}:null},Vk=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.flyout].includes(t),d=[De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},Wk=()=>!0,Hk=()=>null,Gk=()=>null,Jk=()=>null,qk=({entity:e})=>e,zk=()=>null,Qk=()=>({mainEntity:{[Fe.S.Main]:{forceDisableTitleBar:!0,isBackgroundTransparent:!0}}}),Yk=({type:e,action:n,appRenderMode:i,coreSettings:t})=>{const a=new Ee.H,{flyoutAppPhaseTimeouts:o}=t.get(s.J.Core),d=[],l=[];if(i===Fe.S.Main)Kk({type:e,action:n,criticalSignals:d,postCriticalSignals:l,featureFlags:{}});return a.registerAppPhase({phase:g.nh.CRITICAL,signals:d,timeout:(null==o?void 0:o.critical)||6e4}),a.registerAppPhase({phase:g.nh.POST_CRITICAL,signals:l,timeout:(null==o?void 0:o.postCritical)||1e4}),a.appPhases},Kk=({type:e,action:n,criticalSignals:i})=>{e===De.py.flyout&&n===De.uk.update?i.push(Me.G.CONNECT_WITH_ANYONE_SHOWN):i.push(Me.G.CHAT_LIST_ITEMS_RENDERED)},Xk=({context:{coreSettings:e,entityCommanding:n,loggerFactory:i}})=>{const t=i.newLogger("FlyoutPrewarmJob","apps-flyout"),{deviceInfo:a}=e.get(s.J.Platform);if(!a||!(0,xe.E)(a))return t.debug("FlyoutPreWarmJobDisabledOnNonWin11"),[];const{enableFlyoutPrewarm:o,enableFlyoutOnExperienceWarm:d,enableMinimodePrewarm:l,enableMinimodeWindow:r}=e.get(s.J.Core);return r&&l?(t.log("MinimodePreWarmJobEnabled"),[{id:"flyout-prewarm-job",runOncePerId:!0,job:()=>(t.log("MinimodePrewarmJobInvoked"),n.deepLink.prewarmMinimode(sn.D.MinimodePrewarmJob))}]):r||l?(t.log(`skipping flyout prewarm enableMinimodeWindow ${r} enableMinimodePrewarm ${l}`),[]):!o||d?(t.log("FlyoutPreWarmJobDisabled"),[]):(t.log("FlyoutPreWarmJobEnabled"),[{id:"flyout-prewarm-job",runOncePerId:!0,job:()=>(t.log("FlyoutPrewarmJobInvoked"),n.deepLink.prewarmFlyout(sn.D.FlyoutPrewarmJob))}])},Zk=({context:{coreSettings:e,entityCommanding:n,loggerFactory:i}})=>{const t=i.newLogger("FlyoutOnExperienceJob","apps-flyout"),{deviceInfo:a}=e.get(s.J.Platform);if(!a||!(0,xe.E)(a))return t.debug("FlyoutExperienceWarmJobDisabledOnNonWin11"),[];const{enableFlyoutOnExperienceWarm:o,enableMinimodeWindow:d}=e.get(s.J.Core);return d?(t.debug("enableMinimodeWindow - skipping flyout prewarm"),[]):o?(t.debug("FlyoutOnExperienceWarmJobEnabled"),[{id:"flyout-on-experience-warm-job",runOncePerId:!0,job:()=>(t.debug("FlyoutOnExperienceWarmJobInvoked"),n.deepLink.prewarmFlyout(sn.D.FlyoutOnExperienceWarmJob))}]):(t.debug("FlyoutOnExperienceWarmJobDisabled"),[])},eg=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(256045),i.e(65477),i.e(371935),i.e(976609),i.e(1053),i.e(133950),i.e(191673),i.e(105434),i.e(239234),i.e(332634),i.e(347761),i.e(9081),i.e(409201),i.e(215133),i.e(196348),i.e(269296),i.e(462317),i.e(51182),i.e(708472),i.e(84215),i.e(880261),i.e(735655),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(481020),i.e(842529),i.e(495500),i.e(722198),i.e(394413),i.e(477708),i.e(386201),i.e(769716),i.e(839180),i.e(788842),i.e(249903),i.e(863698),i.e(103246),i.e(998258),i.e(779792),i.e(651426),i.e(285317),i.e(159885),i.e(918143),i.e(212780),i.e(66082),i.e(405687),i.e(893559),i.e(989903)]).then(i.bind(i,887857)),ng=()=>jk.windowFeatures||{},ig=()=>c.RG.FlyoutLaunch;function tg(){return{getAppPhases:Yk,getAppViewEntities:Uk,getAppViewEntitiesProps:Qk,getAppWindowFeatures:ng,getCommandScenarioName:ig,manifest:jk,onExperienceWarm:Zk,onPreWarm:Xk,render:({appRenderMode:e,scenarioFactory:n,onRenderEvent:i})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t="flyout-app";i("ChunkLoadStarted",{chunkName:t});const{FlyoutViewsRenderer:a}=yield(0,Pn.mT)(eg,t,n);return i("ChunkLoadSucceeded",{chunkName:t}),(0,Ie.t)(a,{appRenderMode:e})}))}}const ag={id:"com.microsoft.teams.gallery",name:"GalleryApp",supportedEntities:[De.py.gallery],supportedRenderModes:[Fe.S.Main],getDefaultCommand:()=>({type:De.py.gallery,action:De.uk.view}),windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},og=e=>{if(dg(e))return lg(e)?{subNavEntity:rg(e),headerEntity:sg(e),startEntity:mg(e),mainEntity:cg(e),endEntity:ug(e)}:null},dg=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.gallery].includes(t),d=[De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},lg=()=>!0,rg=()=>null,sg=()=>null,mg=()=>null,cg=({entity:e})=>e,ug=()=>null,pg=()=>Promise.all([i.e(405309),i.e(761598),i.e(826148),i.e(129692),i.e(19753)]).then(i.bind(i,984776));function yg(){const e=()=>null;return{getAppViewEntities:og,manifest:ag,render:({appRenderMode:n,onRenderEvent:i,scenarioFactory:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main){const e="gallery-app";i("ChunkLoadStarted",{chunkName:e});const{Gallery:n}=yield(0,Pn.mT)(pg,e,a);return i("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(n,{})}return(0,Ie.t)(e,{})}))}}const vg=e=>{if(kg(e))return gg(e)?{subNavEntity:Ng(e),headerEntity:hg(e),startEntity:fg(e),mainEntity:_g(e),endEntity:Sg(e)}:null},kg=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=Boolean(De.py.help===t),d=[De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},gg=()=>!0,Ng=()=>null,hg=()=>null,fg=()=>null,_g=()=>null,Sg=()=>null,Tg="help",bg="viewHelpPersonalApp",Cg="viewHelpComponent",wg={id:"com.microsoft.teams.help",name:"HelpApp",actors:[Tg],supportedEntities:[De.py.help,De.py.whatsnewdialog],supportedRenderModes:[Fe.S.Modal,Fe.S.Main],windowFeatures:{minWidth:800,minHeight:600,width:800,height:600,offset:20,top:0,left:0}},Ig=({commandInput:e,requestContext:{executionContext:n,loggerFactory:i}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,a,o,d;const{command:{action:l,data:r}}=e,s=i.newLogger("HelpApp onCommandReceived","apps-help");if(e.command.actor!==Tg)return void(null===(t=s.errorToTelemetry)||void 0===t||t.call(s,`Command for actor '${e.command.actor}' cannot be handled by HelpApp.`,"help_on_command_received",void 0,!0));const{popOut:m,appId:c,tabEntityId:u,subEntityId:p}=r||{},y=m?v.su.new:v.su.flush;switch(l){case bg:let e;return e=p&&u?JSON.stringify({appId:c,tabEntityId:u,subEntityId:p}):u?JSON.stringify({appId:c,tabEntityId:u}):JSON.stringify({appId:c}),{entity:{id:e,action:De.uk.view,type:De.py.extensions,linkedEntity:{id:e,type:De.py.extensions}},command:{visibilityState:v.fe.show,stateTransition:y,correlation:{source:sn.D.Nova}}};case Cg:return{entity:{action:De.uk.default,type:De.py.help},command:{visibilityState:v.fe.show,stateTransition:y,correlation:{source:sn.D.Nova}},entityOptions:{contextType:null===(o=null===(a=null==n?void 0:n.viewEntities)||void 0===a?void 0:a.mainEntity)||void 0===o?void 0:o.type,helpId:u,helpSubId:p}};default:null===(d=s.errorToTelemetry)||void 0===d||d.call(s,`Command action '${l}' is not supported at HelpApp.`,"help_on_command_received",void 0,!0)}})),Ag=({appRenderMode:e})=>{const n=new Ee.H,i=[];if(e===Fe.S.Main)i.push(Me.G.HELP_APP_RENDERED);return n.registerAppPhase({phase:g.nh.CRITICAL,signals:i,timeout:25e3}),n.registerAppPhase({phase:g.nh.POST_CRITICAL,signals:[],timeout:1e4}),n.appPhases},Fg=()=>Promise.all([i.e(44922),i.e(270657),i.e(730980)]).then(i.bind(i,562682)),Dg=()=>i.e(524090).then(i.bind(i,97311)),Eg=()=>wg.windowFeatures||{},Mg=()=>c.RG.HelpAppLoaded;function Pg(){const e=()=>null;return{manifest:wg,onCommandReceived:Ig,render:({appRenderMode:n,onRenderEvent:i,scenarioFactory:a,loggerFactory:o})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Modal){const e="whats-new-modal",t=o.newLogger(e,"apps-help");try{i("ChunkLoadStarted",{chunkName:e});const{WhatsNewViewsRenderer:t}=yield(0,Pn.mT)(Fg,e,a);return i("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(t,{appRenderMode:n})}catch(e){t.error(`chunk load failed with ${e}`)}}if(n===Fe.S.Main){const e="help-app",t=o.newLogger(e,"apps-help");try{i("ChunkLoadStarted",{chunkName:e});const{HelpViewRenderer:t}=yield(0,Pn.mT)(Dg,e,a);return i("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(t,{appRenderMode:n})}catch(e){t.error(`chunk load failed with ${e}`)}}return(0,Ie.t)(e,{})})),getAppPhases:Ag,getAppViewEntities:vg,getAppWindowFeatures:Eg,getCommandScenarioName:Mg}}const Rg={shouldAddEntitiesToWindowHistory:e=>{var n;return(null===(n=null==e?void 0:e.mainEntity)||void 0===n?void 0:n.type)!==De.py.identity},shouldRestoreClientToEntities:e=>{var n;return(null===(n=null==e?void 0:e.mainEntity)||void 0===n?void 0:n.type)!==De.py.identity}},Og=e=>{if(Lg(e))return xg(e)?{subNavEntity:Bg(e),headerEntity:jg(e),startEntity:Ug(e),mainEntity:Vg(e),endEntity:Wg(e)}:null},$g=({entity:e})=>({mainEntity:{[Fe.S.Main]:{isBackgroundTransparent:"minimal"===(null==e?void 0:e.id)&&(null==e?void 0:e.action)===De.uk.signin}}}),Lg=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.chats,De.py.authrefreshdialog,De.py.authaccounttransfer].includes(t),d=[De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},xg=()=>!0,Bg=()=>null,jg=()=>null,Ug=()=>null,Vg=({entity:e})=>e,Wg=()=>null,Hg={id:"com.microsoft.teams.integrated-auth",name:"IntegratedAuthApp",actors:["identity"],supportedEntities:[De.py.identity,De.py.oauthcode,De.py.authrefreshdialog,De.py.accountselectiondialog,De.py.authaccounttransfer],supportedRenderModes:[Fe.S.Main,Fe.S.Modal],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},Gg={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"resolveThirdPartyOauthCode"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"code"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"state"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resolveThirdPartyOauthCode"},arguments:[{kind:"Argument",name:{kind:"Name",value:"code"},value:{kind:"Variable",name:{kind:"Name",value:"code"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"Argument",name:{kind:"Name",value:"state"},value:{kind:"Variable",name:{kind:"Name",value:"state"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]},Jg={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsIntegratedAuthGetActiveCallsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasActiveCalls"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]}]}}]},qg={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsIntegratedAuthAccountTransferMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"launchAccountTransfer"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]}}]},zg=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:n,entityCommand:{entity:{type:i,action:t},entityOptions:a},requestContext:{client:o,scenarioFactory:d}}=e;if(i===De.py.oauthcode&&t===De.uk.update)try{return yield o.mutate({mutation:Gg,variables:{code:(null==a?void 0:a.code)||null,state:(null==a?void 0:a.state)||null}}),{entity:{type:De.py.default,action:De.uk.default},command:{visibilityState:v.fe.show,stateTransition:v.su.none,correlation:n.command.correlation}}}catch(e){return}else if(i===De.py.authaccounttransfer&&t===De.uk.view){const e={entity:{type:De.py.authaccounttransfer,action:De.uk.error},command:{visibilityState:v.fe.show,stateTransition:v.su.extend,correlation:n.command.correlation}};let i=d.findScenario(c.RG.AuthWebAccountTransfer);i||(i=d.newScenario(c.RG.AuthWebAccountTransfer));try{const{data:n}=yield o.query({query:Jg,fetchPolicy:"network-only",nextFetchPolicy:"cache-first"});if(i.mark(c.ck.AuthAccountTransferGetActiveCalls),n.hasActiveCalls)return Object.assign(Object.assign({},e),{entityOptions:{hasActiveCalls:!0}})}catch(n){return i.fail({reason:`AuthAccountTransfer error in hasActiveCalls query. Error code: ${n.errorCode}`}),e}try{return void(yield o.mutate({mutation:qg}))}catch(n){return e}}return n}));var Qg;!function(e){e.GoogleAuthDisabled="google-auth-disabled"}(Qg||(Qg={}));const Yg=[{filter:"/l/auth/google",execute:({deeplinkUrl:e,context:{coreSettings:n}})=>{const{enableDesktopExternalBrowserGoogleAuth:i}=n.get(s.J.Auth);if(!i)return Promise.reject({message:Qg.GoogleAuthDisabled});const{state:t,code:a}=function(e){const n=e.search,i=new URLSearchParams(n),t=i.get("state");return{code:i.get("code"),state:t}}(e);return Promise.resolve({entityCommand:{entity:{type:De.py.oauthcode,action:De.uk.update,id:(0,et.v4)()},command:{visibilityState:v.fe.show,stateTransition:v.su.none,correlation:{id:(0,et.v4)(),startTimestamp:Date.now(),source:sn.D.GoogleAuthOnBeforeDeepLinkParsed}},entityOptions:{code:a,state:t}},metadata:{allowAnonymous:!1}})}}];var Kg=i(928665),Xg=i(403084);const Zg={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"initializeAccounts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"initializeAccounts"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]}}]},eN=({context:{authenticationService:e,client:n,coreSettings:i,entityCommanding:a}})=>{var o;const d={scenarioName:c.RG.AuthWebInitializeAccounts,source:"integrated-auth-app",id:(0,Kg.pW)()},[l,r]=(0,Xg.OU)({scenarioName:c.RG.AuthWebInitializeAccounts,subContext:"onExperienceWarm",source:"integrated-auth-app",options:{correlation:d}}),{enableLazyInitializeAccounts:m,enableCrossTabLogout:u}=i.get(s.J.Auth);if(!m)return r({message:"LazyInitializeAccountsJobDisabled"}),[];if(u&&e){const n=null===(o=e.getCrossTabCallbacks)||void 0===o?void 0:o.call(e);n&&n.contextChangeSubscribe(a)}return l.addScenarioMark(c.ck.AuthWebInitializeAccountsJobQueued),[{id:"lazy-initialize-accounts-job",runOncePerId:!0,job:()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){l.addScenarioMark(c.ck.AuthWebInitializeAccountsJobStart);try{n.mutate({mutation:Zg,context:{correlation:d}})}catch(e){r({error:e})}}))}]},nN={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticatedUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"allowAnon"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"loginHint"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"tenantId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticatedUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"allowAnon"},value:{kind:"Variable",name:{kind:"Name",value:"allowAnon"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"Argument",name:{kind:"Name",value:"loginHint"},value:{kind:"Variable",name:{kind:"Name",value:"loginHint"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"Argument",name:{kind:"Name",value:"tenantId"},value:{kind:"Variable",name:{kind:"Name",value:"tenantId"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"Argument",name:{kind:"Name",value:"userContextId"},value:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"tenantId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserProfile"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}}}]}}]};var iN=i(27149);const tN=(e,n)=>({overrideType:Km.U.OverrideIntent,intent:Object.assign(Object.assign({},n),{entityCommand:Object.assign(Object.assign({},n.entityCommand),{entity:{id:`${n.entityCommand.command.layoutMode}`,type:De.py.identity,action:De.uk.error},entityOptions:{error:e}})})}),aN={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsIntegratedAuthAuthenticateOrGetUserMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"allowAnon"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"loginHint"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"tenantId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"meetingDetails"}},type:{kind:"NamedType",name:{kind:"Name",value:"CrossCloudMeetingAuthDetails"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"deeplink"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticateOrGetUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"allowAnon"},value:{kind:"Variable",name:{kind:"Name",value:"allowAnon"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"Argument",name:{kind:"Name",value:"loginHint"},value:{kind:"Variable",name:{kind:"Name",value:"loginHint"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"Argument",name:{kind:"Name",value:"tenantId"},value:{kind:"Variable",name:{kind:"Name",value:"tenantId"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"Argument",name:{kind:"Name",value:"userContextId"},value:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"Argument",name:{kind:"Name",value:"meetingDetails"},value:{kind:"Variable",name:{kind:"Name",value:"meetingDetails"}},__type:{kind:"NamedType",name:{kind:"Name",value:"CrossCloudMeetingAuthDetails"}}},{kind:"Argument",name:{kind:"Name",value:"deeplink"},value:{kind:"Variable",name:{kind:"Name",value:"deeplink"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"tenantId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserProfile"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}}}]}}]},oN={filter:"*",execute:({intent:e,context:{client:n,coreSettings:i,scenarioFactory:a}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,o;const{authTelemetry:d,closeTelemetry:l}=((e,n)=>{var i,t,a,o;const{scenarioCorrelation:{correlation:d,clientLaunchId:l}}=n;let r,s,m;n.shouldRenderContent&&(r=n.entityCommand.command.layoutMode,s=n.entityCommand.entity.type,m=n.entityCommand.entity.action);const u={id:null!==(i=null==d?void 0:d.id)&&void 0!==i?i:(0,et.v4)(),source:null!==(t=null==d?void 0:d.source)&&void 0!==t?t:"onBeforeIntentAuth",scenarioName:null!==(a=null==d?void 0:d.scenarioName)&&void 0!==a?a:c.RG.AuthWebUser},p=u.scenarioName&&l&&e.findScenarioByNameAndId(u.scenarioName,l)||void 0,[y,v]=(0,Xg.F9)({correlation:u,subContext:"onBeforeIntentAuthenticated",scenario:p,eventData:[`layoutMode:${r}`,`entityType:${s}`,`action:${m}`,`isNRC:${n.shouldRenderContent}`,`intentMetadata:[anon:${+n.metadata.allowAnonymous},allowXTenantAccess:${null!==(o=n.metadata.allowXTenantAccess)&&void 0!==o?o:void 0},  tid: ${+!!n.metadata.tenantId}, uid: ${+!!n.metadata.userContextId}, loginHint:${+!!n.metadata.loginHint}]`]});return y.appendScenarioEventData({targetedUser:n.metadata.userContextId,target:n.metadata.tenantId,allowAnon:n.metadata.allowAnonymous,allowXTenantAccess:n.metadata.allowXTenantAccess}),y.addScenarioMark("auth_web_app_on_before_intent_auth_start"),{authTelemetry:y,closeTelemetry:v}})(a,e);if(!i.get(s.J.Auth).enableIntegratedAuthApp)return d.addScenarioMark("auth_web_app_on_before_intent_auth_stop",{message:"enableIntegratedAuthApp is disabled"}),l({reason:"enableIntegratedAuthApp is disabled"}),{overrideType:Km.U.NoOverride};const{enableAuthenticateOrGetUser:r,enableMAIntentHandling:m,enableCCM:u,isWebClientType:p,disableAllowXTenantAccessQSP:y}=i.get(s.J.Auth);let k;u&&(k=(e=>{if(e.shouldRenderContent&&"callingdeeplink"===e.entityCommand.entity.type){const n=e.entityCommand.entityOptions;return(0,oo.KH)(n)}})(e));const g=p?e.metadata.deepLink:void 0;let N;d.addEventData(["enableCCM:"+ +!!u,"meetingDetails:"+ +!!k,`allowXTenantAccess:${e.metadata.allowXTenantAccess}`]);const h={allowAnon:e.metadata.allowAnonymous,allowXTenantAccess:e.metadata.allowXTenantAccess,tenantId:e.metadata.allowXTenantAccess&&!y?void 0:e.metadata.tenantId,loginHint:e.metadata.loginHint,userContextId:e.metadata.userContextId,meetingDetails:k,deeplink:g},f={correlation:e.scenarioCorrelation.correlation};try{let i;if(r){const{data:{authenticateOrGetUser:e}}=yield n.mutate({mutation:aN,variables:h,context:f});i=e}else{const{data:{authenticatedUser:e}}=yield n.query({query:nN,variables:h,context:f,fetchPolicy:"no-cache"});i=e}if(null==i?void 0:i.isAuthenticated)return d.addEventData([`user:1,role:${i.role}`]),d.addScenarioMark("auth_web_app_on_before_intent_auth_stop",{targetedUser:e.metadata.userContextId,accountId:i.id,target:e.metadata.tenantId,tenantId:i.profile.tenantId,allowAnon:e.metadata.allowAnonymous,allowXTenantAccess:e.metadata.allowXTenantAccess,message:`user:${i.id},role:${i.role},type:${i.type}`}),i.role===Jy.w4.Anonymous&&d.recordAuthUserBiTelemetry(null==i?void 0:i.id,{scenario:iN.dX.authAnonLaunch}),{overrideType:Km.U.OverrideUserContext,userContextId:i.id}}catch(e){N=null===(o=null===(t=e.graphQLErrors)||void 0===t?void 0:t[0])||void 0===o?void 0:o.originalError,d.addScenarioMark("auth_web_app_user_query_fails",{error:Object.assign(Object.assign({},N),{correlationId:d.correlation.id,errorCode:(null==N?void 0:N.code)||e.code||"NoErrorCodeFoundInOnBeforeIntentAuthentication",message:(null==N?void 0:N.message)||e.message})})}return d.addEventData([`user:0,operationType:cold,isMAIntentHandlingEnabled:${m}`]),((e,n,i,t)=>{var a,o,d;if(t.addScenarioMark("auth_web_app_on_before_intent_auth_new_intent"),!e.shouldRenderContent)return{overrideType:Km.U.NoOverride};if(n&&!0===n.redirectToEndPage)return tN(n,e);let l,r=n,s=e.entityCommand.command,m=e.entityCommand.command.layoutMode===v.lO.minimal?De.uk.signin:De.uk.default;if(i&&e.metadata.tenantId){const i='Unexpected error value: { message: "Multiple users found in cache with same tenantId", errorCode: "MultipleUsersPresentWithSpecifiedIdentifier" }'===(null==n?void 0:n.message);l=i?e.metadata.tenantId:"",r=i?void 0:n,t.addEventData(["showAccountPicker:1","tenantIdFromOptions:"+ +!!l]),t.addScenarioMark("auth_web_app_on_before_intent_auth_show_account_picker",{tenantId:l}),s=Object.assign(Object.assign({},s),{visibilityState:v.fe.show,stateTransition:v.su.new,layoutMode:v.lO.focus}),m=De.uk.list}t.addScenarioMark("auth_web_app_on_before_intent_auth_stop");const c=null===(o=null===(a=null==e?void 0:e.entityCommand)||void 0===a?void 0:a.entity)||void 0===o?void 0:o.type;return{overrideType:Km.U.OverrideIntent,intent:Object.assign(Object.assign({},e),{entityCommand:Object.assign(Object.assign({},e.entityCommand),{command:s,entity:{id:`${e.entityCommand.command.layoutMode}`,type:De.py.identity,action:m,linkedEntity:e.entityCommand.command.layoutMode===v.lO.focus?{type:e.entityCommand.entity.type,action:e.entityCommand.entity.action,id:null!==(d=e.entityCommand.entity.id)&&void 0!==d?d:e.entityCommand.command.correlation.id}:void 0},entityOptions:{error:r,tenantId:l,hideTitleAndOptions:c===De.py.meetings||c===De.py.callingdeeplink||c===De.py.channels}})})}})(e,N,m,d)}))},dN=e=>{const{entity:n}=e;return n.type!==De.py.identity?c.RG.EntityCommand:c.RG.AuthLaunch},lN="identity",rN="signOut",sN="addNewAccount",mN="switchAccount",cN="switchTenants",uN="manageTenant",pN="openMeControl",yN=()=>({actor:lN,action:rN}),vN=e=>({actor:lN,action:mN,data:{targetAccountId:e}}),kN=e=>({actor:lN,action:cN,data:{targetTenantId:e}}),gN=()=>({actor:lN,action:pN}),NN={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsIntegratedAuthSwitchAccountMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"switchAccount"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userContextId"},value:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]}}]},hN=({commandInput:e,requestContext:{client:n,coreSettings:i}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,a,o,d,l,r,m;const{command:u}=e,p={scenarioName:c.RG.AuthCommandReceived,source:null!==(a=null===(t=u.data)||void 0===t?void 0:t.commandSource)&&void 0!==a?a:sn.D.AuthApp,id:(0,Kg.pW)()},y=(null===(o=u.data)||void 0===o?void 0:o.targetAccountId)||(null===(d=u.data)||void 0===d?void 0:d.targetTenantId),[k,g]=(0,Xg.OU)({scenarioName:c.RG.AuthCommandReceived,subContext:"auth-command",source:"integrated-auth-app",options:{correlation:p},eventData:[`command: ${u.action}`],scenarioEventData:{targetedUser:y}});let N;if(!(null===(l=Hg.actors)||void 0===l?void 0:l.includes(u.actor))){return void g({error:{name:"unsupported_target",message:"target is unsupport",correlationId:p.id,context:"on_command_received",subContext:"integrated_auth",errorCode:"unsupported_target"}})}const{enableModalForAddAccount:h,disableAddAccount:f}=i.get(s.J.Auth),_=h||f?De.py.identitydialog:De.py.identity,S=h||f?v.su.extend:v.su.new;switch(u.action){case mN:if(k.addScenarioMark("auth_switch_account_mutation"),!y){g({error:{name:"missing_parameter",message:"Account Id missing in switch account command",correlationId:p.id,context:"on_command_received",subContext:"integrated_auth",errorCode:"missing_parameter"}});break}return g(),void n.mutate({mutation:NN,variables:{userContextId:y},context:{correlation:p}});case cN:if(k.addScenarioMark("auth_switch_tenant_mutation"),!y){g({error:{name:"missing_parameter",message:"Account Id missing in switch tenant command",correlationId:p.id,context:"on_command_received",subContext:"integrated_auth",errorCode:"missing_parameter"}});break}return g(),void n.mutate({mutation:NN,variables:{userContextId:y},context:{correlation:p}});case uN:{k.addScenarioMark("auth_manage_org_mutation");const e={source:sn.D.AuthApp};return N={entity:{id:za.Y.Accounts,type:De.py.settingsstore,action:De.uk.view},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,correlation:e},entityOptions:{correlation:e}},g(),N}case sN:{k.addScenarioMark("auth_add_new_account_command");const e={source:null!==(m=null===(r=u.data)||void 0===r?void 0:r.commandSource)&&void 0!==m?m:sn.D.AuthApp};return N={entity:{type:_,action:De.uk.create},command:{visibilityState:v.fe.show,stateTransition:S,layoutMode:v.lO.focus,correlation:e},entityOptions:{correlation:e}},g(),N}case rN:return k.addScenarioMark("auth_sign_out_dialog_command"),N={entity:{type:De.py.signoutdialog,action:De.uk.view},command:{visibilityState:v.fe.show,stateTransition:v.su.extend,correlation:{source:sn.D.AuthApp}}},g(),N;case pN:return(0,Xg.OU)({scenarioName:c.RG.AuthWebMeControlRender,subContext:"auth-command",source:"integrated-auth-app",options:{correlation:{scenarioName:c.RG.AuthWebMeControlRender,source:"integrated-auth-app",id:(0,Kg.pW)()}}}),k.addScenarioMark("auth_open_mecontrol_command"),void g();default:g({error:{name:"invalid_command",message:`command is invalid ${u.action}`,correlationId:p.id,context:"on_command_recieved",subContext:"integrated_auth",errorCode:"invalid_command"}})}})),fN=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(256045),i.e(65477),i.e(371935),i.e(976609),i.e(1053),i.e(133950),i.e(191673),i.e(105434),i.e(239234),i.e(332634),i.e(347761),i.e(9081),i.e(409201),i.e(215133),i.e(196348),i.e(269296),i.e(462317),i.e(51182),i.e(708472),i.e(84215),i.e(880261),i.e(735655),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(481020),i.e(842529),i.e(495500),i.e(722198),i.e(394413),i.e(477708),i.e(386201),i.e(769716),i.e(839180),i.e(788842),i.e(249903),i.e(863698),i.e(103246),i.e(998258),i.e(779792),i.e(651426),i.e(285317),i.e(159885),i.e(918143),i.e(212780),i.e(66082),i.e(405687),i.e(893559),i.e(834091),i.e(696021)]).then(i.bind(i,4574));function _N(){return{getCommandScenarioName:dN,manifest:Hg,onBeforeDeeplinkParsed:Yg,onBeforeCommandHandled:zg,onBeforeAddToNavigation:Rg,onBeforeIntentAuthenticated:oN,onExperienceWarm:eN,render:({appRenderMode:e,onRenderEvent:n,scenarioFactory:i})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t="integrated-auth-app";n("ChunkLoadStarted",{chunkName:t});const{AuthViewsRenderer:a}=yield(0,Pn.mT)(fN,t,i);return n("ChunkLoadSucceeded",{chunkName:t}),(0,Ie.t)(a,{appRenderMode:e})})),getAppViewEntities:Og,getAppViewEntitiesProps:$g,getAppWindowFeatures:()=>{const{height:e,minHeight:n,minWidth:i,width:t}=Hg.windowFeatures||{};return{additionalFeatures:{minHeight:`${n}`,minWidth:`${i}`},height:e,minHeight:n,minWidth:i,width:t}},onCommandReceived:hN}}const SN="meet",TN="viewMeetApp",bN=()=>({actor:SN,action:TN}),CN={id:"com.microsoft.teams.meet",name:"MeetApp",actors:[SN],supportedEntities:[De.py.meet],supportedRenderModes:[Fe.S.Main,Fe.S.HorizontalBar]},wN=e=>{if(IN(e))return AN(e)?{subNavEntity:FN(e),headerEntity:DN(e),startEntity:EN(e),mainEntity:MN(e),endEntity:PN(e)}:null},IN=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.meet].includes(t),d=[De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},AN=()=>!0,FN=()=>null,DN=({entity:e,coreSettings:n})=>{const{enableHeaderSlotInMeet:i}=(null==n?void 0:n.get(s.J.Meet))||{};return i?e:null},EN=()=>null,MN=({entity:e})=>e,PN=({contextEntity:e})=>e&&e.action&&e.type===De.py.meetingcollaboration?e:null,RN=()=>({mainEntity:{[Fe.S.Main]:{isBackgroundTransparent:!0}}}),ON={onEventReceived:({eventInput:e})=>{var n,i;if(e.event.type===Ze.uS.requestPersonMoreInfo){const t=null===(i=(n=e.event).data)||void 0===i?void 0:i.call(n);return Promise.resolve({command:on(t)})}return Promise.resolve(void 0)}},$N=({commandInput:e,requestContext:{loggerFactory:n}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:i}}=e,t=n.newLogger("MeetApp onCommandReceived","apps-meet");if(e.command.actor===SN)return i===TN?{entity:{type:De.py.meet,action:De.uk.default},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,correlation:{source:sn.D.Unknown}}}:void t.error(`Command action '${i}' is not supported at MeetApp.`);t.error(`Command for actor '${e.command.actor}' cannot be handled by MeetApp.`)})),LN=({appRenderMode:e})=>{const n=new Ee.H;return e!==Fe.S.Main||n.registerAppPhase({phase:g.nh.CRITICAL,signals:[Me.G.MEET_APP_RENDERED],timeout:1e4}),n.appPhases},xN="a63f7012-8cc9-42d5-99c3-e35f526fab17",BN={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsMeetPinM365ApplicationMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PinM365ApplicationInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pinM365Application"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PinM365ApplicationInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsMeetPinM365ApplicationFragment"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"M365ApplicationPinStatusUpdateResult"}}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsMeetPinM365ApplicationFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"M365ApplicationPinStatusUpdateResult"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"M365ApplicationPinStatusUpdateResult"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"updatedM365Applications"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"platformType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"pinnedIndex"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"M365Application"}}}}},arguments:[]}]}}]}}]}.definitions]},jN={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsMeetTriggerFetchBeforeEnterMeetAppMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"triggerFetchBeforeEnterMeetApp"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]}]}}]},UN=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n,i,t,a;const{entityCommand:o,entityCommand:{entity:{type:d,action:l}},requestContext:r,requestContext:{client:m,userBiService:c,coreSettings:u}}=e,p=r.loggerFactory.newLogger("CallingOnBeforeCommandHandled","apps-meet");if(VN(d,l)&&((e,n)=>{const{enableFetchBeforeEnterMeetApp:i}=n.get(s.J.Meet);i&&e.mutate({mutation:jN})})(m,u),WN(d,l))try{const e=yield null==m?void 0:m.mutate({mutation:BN,variables:Object.assign(Object.assign({},o),{input:{applicationID:xN}}),fetchPolicy:"no-cache"});if(e){const a=null===(t=null===(i=null===(n=e.data)||void 0===n?void 0:n.pinM365Application)||void 0===i?void 0:i.updatedM365Applications)||void 0===t?void 0:t[0],{id:o,pinnedIndex:d=null}=a||{};o===xN&&null!==d&&d>=0&&HN(c,p)}}catch(e){return null===(a=null==p?void 0:p.errorToTelemetry)||void 0===a||a.call(p,"[MeetPinM365ApplicationMutation] failed","calling_deeplink_navigation",null==e?void 0:e.code),Promise.resolve(o)}return Promise.resolve(o)})),VN=(e,n)=>e===De.py.meet&&(n===De.uk.list||n===De.uk.default),WN=(e,n)=>e===De.py.meet&&n===De.uk.pin,HN=(e,n)=>{if(!(null==e?void 0:e.recordPanelAction))return;const i={appName:"MeetApp",panelType:ei.wh.pinMeet,panelRegion:ei.Ai.popover,moduleName:ei.rA.pinMeetCoachmarkCTA,moduleType:ei.PO.button,actionGesture:ei.uS.click,actionOutcome:ei.$K.submit,actionScenarioType:ei.Yu.pinMeet};e.recordPanelAction(i,n)},GN=()=>Promise.all([i.e(917388),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(976609),i.e(133950),i.e(779478),i.e(315215),i.e(680254),i.e(984256),i.e(555551),i.e(844369),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(26466),i.e(745659),i.e(462317),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(613692),i.e(403936),i.e(207856),i.e(450605),i.e(586146),i.e(329712),i.e(673758),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(788842),i.e(427163),i.e(749021),i.e(542511),i.e(232044),i.e(660340),i.e(988150),i.e(258171),i.e(658803),i.e(966573),i.e(868123)]).then(i.bind(i,702846)),JN=()=>Promise.all([i.e(917388),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(976609),i.e(133950),i.e(779478),i.e(315215),i.e(680254),i.e(984256),i.e(555551),i.e(844369),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(26466),i.e(745659),i.e(462317),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(613692),i.e(403936),i.e(207856),i.e(450605),i.e(586146),i.e(329712),i.e(673758),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(788842),i.e(427163),i.e(749021),i.e(542511),i.e(232044),i.e(660340),i.e(988150),i.e(258171),i.e(658803),i.e(966573),i.e(868123)]).then(i.bind(i,228183));function qN(){const e=()=>null;return{eventHandlers:ON,getAppPhases:LN,getAppViewEntities:wN,getAppViewEntitiesProps:RN,getPlatformAppIdForEntity:e=>e.type===De.py.meet?xN:void 0,manifest:CN,onCommandReceived:$N,render:({appRenderMode:n,coreSettings:i,onRenderEvent:a,scenarioFactory:o})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main||n===Fe.S.HorizontalBar){const e="meet-app";a("ChunkLoadStarted",{chunkName:e});const{enableEntityMoreInfo:t}=i.get(s.J.Core),d=({children:e})=>(0,Ie.t)(Ae.Fragment,{children:e});o.newScenario(c.RG.MeetAppRender),o.newScenario(c.RG.MeetAppUpcomingRender),o.newScenario(c.RG.MeetAppRecentRender);const{Meet:l}=yield(0,Pn.mT)(GN,e,o),{LPC:r}=t?{LPC:d}:yield(0,Pn.mT)(JN,e,o),m=t?d:Na.p3;return a("ChunkLoadSucceeded",{chunkName:e}),o.markStep(c.RG.MeetAppRender,c.ck.MeetAppRenderWebpackLoaded),o.markStep(c.RG.MeetAppUpcomingRender,c.ck.MeetAppUpcomingRenderWebpackLoaded),o.markStep(c.RG.MeetAppRecentRender,c.ck.MeetAppRecentRenderWebpackLoaded),(0,Ie.t)(r,{children:(0,Ie.t)(m,{children:(0,Ie.t)(l,{appRenderMode:n})})})}return(0,Ie.t)(e,{})})),getCommandScenarioName:zN,onBeforeCommandHandled:UN}}const zN=()=>c.RG.MeetAppLaunch,QN=e=>{if(YN(e))return KN(e)?{subNavEntity:XN(e),headerEntity:ZN(e),startEntity:eh(e),mainEntity:nh(e),endEntity:ih(e)}:null},YN=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.attendancereport,De.py.meetinganalytics].includes(t),d=[De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},KN=()=>!0,XN=()=>null,ZN=()=>null,eh=()=>null,nh=({entity:e})=>e,ih=()=>null,th={id:"com.microsoft.teams.meetinganalytics",name:"MeetingAnalytics",supportedEntities:[De.py.attendancereport,De.py.meetinganalytics],supportedRenderModes:[Fe.S.Main],getDefaultCommand:()=>({type:De.py.meetinganalytics,action:De.uk.view}),windowFeatures:{minWidth:1600,width:1600,minHeight:1e3,height:1e3,offset:20}},ah=()=>Promise.all([i.e(790026),i.e(140641),i.e(141603),i.e(371935),i.e(133950),i.e(755684),i.e(250273),i.e(999122),i.e(3855),i.e(215133),i.e(196348),i.e(917164),i.e(538533),i.e(586146),i.e(231772),i.e(84314),i.e(298368)]).then(i.bind(i,721499)),oh=()=>th.windowFeatures||{};function dh(){const e=()=>null;return{getAppViewEntities:QN,getAppWindowFeatures:oh,manifest:th,render:({appRenderMode:n,onRenderEvent:i,scenarioFactory:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main){const e="meeting-analytics-app";i("ChunkLoadStarted",{chunkName:e});const{MeetingAnalyticsRenderer:n}=yield(0,Pn.mT)(ah,e,a);return i("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(ri.f,Object.assign({namespaces:["meetingAnalytics"],loaderRenderer:null},{children:(0,Ie.t)(n,{})}))}return(0,Ie.t)(e,{})}))}}const lh=e=>{if(rh(e))return sh(e)?{subNavEntity:mh(e),headerEntity:ch(e),startEntity:uh(e),mainEntity:ph(e),endEntity:yh(e)}:null},rh=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.meetingrecap].includes(t),d=[De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},sh=()=>!0,mh=()=>null,ch=()=>null,uh=()=>null,ph=({entity:e})=>e,yh=()=>null,vh={id:"com.microsoft.teams.meeting-recap-chiclet",name:"MeetingRecapChiclet",supportedEntities:[De.py.meetingrecapchiclet],supportedRenderModes:[Fe.S.Main],getDefaultCommand:()=>({type:De.py.meetingrecapchiclet,action:De.uk.view}),windowFeatures:{minWidth:1600,width:1600,minHeight:1e3,height:1e3,offset:20}},kh=()=>Promise.all([i.e(917388),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(779478),i.e(315215),i.e(484566),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(26466),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(403936),i.e(450605),i.e(586146),i.e(329712),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(427163),i.e(750645),i.e(294226)]).then(i.bind(i,363774)),gh=()=>Promise.all([i.e(917388),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(779478),i.e(315215),i.e(484566),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(26466),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(403936),i.e(450605),i.e(586146),i.e(329712),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(427163),i.e(750645),i.e(294226)]).then(i.bind(i,228183)),Nh=()=>vh.windowFeatures||{};function hh(){const e=()=>null;return{getAppViewEntities:lh,getAppWindowFeatures:Nh,manifest:vh,render:({appRenderMode:n,onRenderEvent:i,scenarioFactory:a,coreSettings:o})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main){const{MeetingRecapChicletRenderer:e}=yield((e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const i="meeting-recap-chiclet-app";n("ChunkLoadStarted",{chunkName:i});const[{MeetingRecapChicletRenderer:t},{LPC:a}]=yield Promise.all([(0,Pn.mT)(kh,i,e),(0,Pn.mT)(gh,i,e)]);return n("ChunkLoadSucceeded",{chunkName:i}),{MeetingRecapChicletRenderer:t,LPC:a}})))(a,i),{enableEntityMoreInfo:n}=o.get(s.J.Core),d=({children:e})=>(0,Ie.t)(Ae.Fragment,{children:e}),{LPC:l}=n?{LPC:d}:yield(0,Pn.mT)(gh,"meeting-recap-chiclet-app",a),r=n?d:Na.p3;return(0,Ie.t)(ri.f,Object.assign({namespaces:["meetingRecap"],loaderRenderer:null},{children:(0,Ie.t)(l,{children:(0,Ie.t)(r,{children:(0,Ie.t)(e,{})})})}))}return(0,Ie.t)(e,{})}))}}const fh=e=>{if(_h(e))return Sh(e)?{subNavEntity:Th(e),headerEntity:bh(e),startEntity:Ch(e),mainEntity:wh(e),endEntity:Ih(e)}:null},_h=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.meetingrecap].includes(t),d=[De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},Sh=()=>!0,Th=()=>null,bh=({entity:e,coreSettings:n})=>{const{enableHeaderSlotInRecap:i}=(null==n?void 0:n.get(s.J.MeetingRecap))||{};return i?e:null},Ch=()=>null,wh=({entity:e})=>e,Ih=({contextEntity:e})=>e&&e.action&&e.type===De.py.meetingcollaboration?e:null,Ah={id:"com.microsoft.teams.meeting-recap",name:"MeetingRecap",supportedEntities:[De.py.meetingrecap,De.py.meetingrecaptab],supportedRenderModes:[Fe.S.Main,Fe.S.HorizontalBar],getDefaultCommand:()=>({type:De.py.meetingrecap,action:De.uk.view}),windowFeatures:{minWidth:1600,width:1600,minHeight:1e3,height:1e3,offset:20}},Fh="deep-link";var Dh,Eh,Mh,Ph;!function(e){e.recapMeeting="/l/meetingrecap"}(Dh||(Dh={})),function(e){e.FeatureNotEnabled="recap_on_before_deep_link_parsed_feature_not_enabled_error",e.InvalidContext="recap_on_before_deep_link_parsed_invalid_context_error"}(Eh||(Eh={})),function(e){e.FeatureNotEnabled="Feature for parsing recap deep links in T2.1 is not enabled",e.InvalidContext="Parsed recap deep link does not contain valid context query param"}(Mh||(Mh={})),function(e){e.ICalUid="iCalUid",e.ThreadId="threadId",e.timestamp="timestamp",e.defaultRightTab="defaultRightTab",e.organizerId="organizerId",e.tenantId="tenantId",e.meetingType="meetingType",e.recordingId="recordingId",e.subType="subType",e.defaultFocusArea="defaultFocusArea"}(Ph||(Ph={}));const Rh=({deeplinkUrl:e,parsedDeeplinkHash:n,preferredCommandInput:i,context:{loggerFactory:t}})=>{var a;const o=t.newLogger("MeetingRecapApp onBeforeDeeplinkParsed","apps-meeting-recap");if(null==n?void 0:n.search){const{pathname:e}=n,i=e.split("/")[2];return Promise.resolve({entityCommand:{entity:{type:De.py.meetingrecap,action:De.uk.view,id:i},command:{stateTransition:v.su.new,visibilityState:v.fe.show},entityOptions:{subType:Fh,threadId:i}},metadata:{allowAnonymous:!1}})}const{searchParams:d}=e,l=d.get(Ph.ThreadId)||"",r=d.get(Ph.ICalUid)||"",s=d.get(Ph.timestamp),m=d.get(Ph.defaultRightTab),c=d.get(Ph.organizerId),u=d.get(Ph.tenantId),p=d.get(Ph.meetingType),y=d.get(Ph.recordingId),k=d.get(Ph.subType)||"",g=d.get(Ph.defaultFocusArea);if(!Boolean(l&&r))throw null===(a=o.errorToTelemetry)||void 0===a||a.call(o,Mh.InvalidContext,Eh.InvalidContext),Error(Mh.InvalidContext);return Promise.resolve({entityCommand:{entity:{type:De.py.meetingrecap,action:De.uk.view,id:l},command:{stateTransition:v.su.new,visibilityState:v.fe.show},entityOptions:{subType:k?`${Fh}-${k}`:Fh,externalEntityKey:r,threadId:l,timestamp:s,defaultRightTab:m,organizerId:c,tenantId:u,meetingType:p,recordingId:y,defaultFocusArea:g}},metadata:{allowAnonymous:!1}})},Oh=[{filter:Dh.recapMeeting,execute:Rh},{filter:(e,n)=>Boolean(e.hash)&&((null==n?void 0:n.pathname)||"").startsWith("/meetingrecap/"),execute:Rh}],$h=()=>Promise.all([i.e(917388),i.e(790026),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(371935),i.e(976609),i.e(1053),i.e(133950),i.e(779478),i.e(315215),i.e(165186),i.e(139563),i.e(347761),i.e(409201),i.e(475063),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(26466),i.e(958163),i.e(745659),i.e(911758),i.e(609633),i.e(868838),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(403936),i.e(450605),i.e(586146),i.e(329712),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(427163),i.e(364315),i.e(746399),i.e(660340),i.e(988150),i.e(106845),i.e(957960)]).then(i.bind(i,181232)),Lh=()=>Promise.all([i.e(917388),i.e(790026),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(371935),i.e(976609),i.e(1053),i.e(133950),i.e(779478),i.e(315215),i.e(165186),i.e(139563),i.e(347761),i.e(409201),i.e(475063),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(26466),i.e(958163),i.e(745659),i.e(911758),i.e(609633),i.e(868838),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(403936),i.e(450605),i.e(586146),i.e(329712),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(427163),i.e(364315),i.e(746399),i.e(660340),i.e(988150),i.e(106845),i.e(957960)]).then(i.bind(i,228183)),xh=()=>Ah.windowFeatures||{};function Bh(){const e=()=>null;return{getAppViewEntities:fh,getAppWindowFeatures:xh,manifest:Ah,render:({appRenderMode:n,onRenderEvent:i,scenarioFactory:a,coreSettings:o})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){a.cancelExistingAndCreateScenario(c.RG.MrNavigateSkeleton,"abandon",1e4);const{enableHeaderSlotInRecap:d=!1}=o.get(s.J.MeetingRecap);if(n===Fe.S.Main||d&&n===Fe.S.HorizontalBar){const{MeetingRecapRenderer:e}=yield((e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const i="meeting-recap-app";n("ChunkLoadStarted",{chunkName:i});const[{MeetingRecapRenderer:t},{LPC:a}]=yield Promise.all([(0,Pn.mT)($h,i,e),(0,Pn.mT)(Lh,i,e)]);return n("ChunkLoadSucceeded",{chunkName:i}),{MeetingRecapRenderer:t,LPC:a}})))(a,i),{enableEntityMoreInfo:d}=o.get(s.J.Core),l=({children:e})=>(0,Ie.t)(Ae.Fragment,{children:e}),{LPC:r}=d?{LPC:l}:yield(0,Pn.mT)(Lh,"meeting-recap-app",a),m=d?l:Na.p3;return(0,Ie.t)(ri.f,Object.assign({namespaces:["meetingAnalytics","meetingRecap","premiumBenefits"],loaderRenderer:null},{children:(0,Ie.t)(r,{children:(0,Ie.t)(m,{children:(0,Ie.t)(e,{appRenderMode:n})})})}))}return(0,Ie.t)(e,{})})),onBeforeDeeplinkParsed:Oh}}const jh=e=>{if(Uh(e))return Vh(e)?{subNavEntity:Wh(e),headerEntity:Hh(e),startEntity:Gh(e),mainEntity:Jh(e),endEntity:qh(e)}:null},Uh=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.transcriptcontent].includes(t),d=[De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},Vh=()=>!0,Wh=()=>null,Hh=()=>null,Gh=()=>null,Jh=({entity:e})=>e,qh=()=>null,zh={id:"com.microsoft.teams.transcript-content",name:"TranscriptContentApp",supportedEntities:[De.py.transcriptcontent],supportedRenderModes:[Fe.S.Main],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},Qh="transcript-content-app",Yh=()=>Promise.all([i.e(917388),i.e(143528),i.e(347761),i.e(911758),i.e(609633),i.e(868838),i.e(364315),i.e(399286),i.e(403275)]).then(i.bind(i,584065)),Kh=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(892924),i.e(256045),i.e(241602),i.e(371935),i.e(779478),i.e(888171),i.e(901509),i.e(547652),i.e(435876),i.e(400010),i.e(242959),i.e(202477),i.e(465019),i.e(697672),i.e(160200),i.e(959180),i.e(687465),i.e(340690),i.e(890555),i.e(864770),i.e(745400),i.e(577907),i.e(357068),i.e(871090),i.e(816167),i.e(479335),i.e(846077),i.e(232236),i.e(914152),i.e(169080),i.e(269104),i.e(890473),i.e(25663),i.e(347761),i.e(9081),i.e(137706),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(26466),i.e(430209),i.e(911758),i.e(435216),i.e(667549),i.e(609633),i.e(469488),i.e(548536),i.e(868838),i.e(803124),i.e(242863),i.e(29311),i.e(321833),i.e(186443),i.e(472638),i.e(68688),i.e(912597),i.e(127919),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(495500),i.e(403936),i.e(450605),i.e(329712),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(816906),i.e(831470),i.e(417169),i.e(451185),i.e(666579),i.e(913486),i.e(369093),i.e(364315),i.e(781662),i.e(53443),i.e(478388),i.e(327116),i.e(713782),i.e(553856),i.e(801349),i.e(399286),i.e(764391),i.e(425523),i.e(336995),i.e(537680),i.e(520174),i.e(506412),i.e(25019),i.e(918607),i.e(673615),i.e(568740)]).then(i.bind(i,173029));function Xh(){const e=()=>null;return{getAppViewEntities:jh,manifest:zh,render:({appRenderMode:n,scenarioFactory:i})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main){const[{TranscriptContentViews:e},{CallsTabContextProvider:n}]=yield Promise.all([(0,Pn.mT)(Yh,Qh,i),(0,Pn.mT)(Kh,Qh,i)]);return(0,Ie.t)(ri.f,Object.assign({namespaces:["calling","meetingRecap"],loaderRenderer:null},{children:(0,Ie.t)(n,{children:(0,Ie.t)(e,{})})}))}return(0,Ie.t)(e,{})}))}}var Zh=i(325730),ef=i(433633);const nf="switchToPeople",tf=()=>i.e(559567).then(i.bind(i,742004)),af={onEventReceived:({eventInput:{event:e,source:n},requestContext:{coreSettings:i,scenarioFactory:a,client:o}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,d;if(e.type===nf)return Promise.resolve({command:Sc(),source:n});if(((0,Zh.z)(e)||(0,ef.w)(e))&&"pxNovaTelemetryEvent"===e.type){const t="px-nova-telemetry-service",{PXNovaTelemetryService:d}=yield(0,Pn.mT)(tf,t,a);return d.logEvent({event:e,coreSettings:i,sessionStartGesture:n.inputType,client:o}),Promise.resolve(void 0)}if((0,Cc.Pu)(e))return Promise.resolve({command:Nc(e.data())});if((0,Cc.O0)(e))return Promise.resolve(void 0);if((0,Zh.z)(e))switch(e.type){case"onDismiss":return Promise.resolve({command:hc()});case"onRenderComplete":{const n=e.data();return null===(t=a.findScenario(c.RG.LoadLivePersonaEditor))||void 0===t||t.stop({overrideTimestamp:n}),Promise.resolve(void 0)}case"onSaveContactSuccess":return Promise.resolve({command:rc({title:e.data().successMessage,intent:"Success",dismissOnAction:!0,duration:3e3})});case"onSaveContactFailure":if(["DuplicateFound","UnprocessableEntity"].includes(e.data().errorCode))return Promise.resolve({command:rc({title:e.data().errorMessage,intent:"Error",dismissOnAction:!0,duration:3e3})});default:return Promise.resolve(void 0)}if((0,ef.w)(e))switch(e.type){case"onEditContact":{const{personNodeID:n,placement:i}=e.data();return Promise.resolve({command:Nc({mri:"",personNodeID:n,isInSpeedDialMode:!1,isFederatedUser:!1,placement:i})})}case"onStartChat":{const{hostAppPersonaId:n}=e.data();return Promise.resolve({command:Om({mri:n,correlationSource:sn.D.PeopleApp})})}case"onStartAudioCall":{const{hostAppPersonaId:n}=e.data();return Promise.resolve({command:Gc({mri:n,correlationSource:sn.D.PeopleApp})})}case"onComposeEmail":{const{emailUrl:n}=e.data();return(0,Bi.J)().open(n,"_blank"),Promise.resolve(void 0)}case"onPhoneCall":{const{phoneUrl:n}=e.data();return(0,Bi.J)().open(n,"_blank"),Promise.resolve(void 0)}case"onNewContactClicked":return Promise.resolve({command:Tc(),source:n});case"onNavigationRequest":return Promise.resolve({command:fc(e.data())});case"onQueryChangeRequest":return Promise.resolve({command:_c(e.data())});case"showProfile":{const{personNodeId:i}=e.data(),t={eventType:"click",userId:"",personNodeId:i,left:0,top:0};return Promise.resolve({command:on(t),source:n})}case"showActionResult":{const{message:n,status:i}=e.data();return Promise.resolve({command:rc({title:n,dismissOnAction:!0,duration:3e3,intent:"success"===i?"Success":"Error"})})}case"onRenderComplete":{const n=e.data();return null===(d=a.findScenario(c.RG.PeopleAppSwitch))||void 0===d||d.stop({overrideTimestamp:n}),Promise.resolve(void 0)}}return Promise.resolve(void 0)}))},of={id:"com.microsoft.teams.people",name:"PeopleApp",getLocalizedName:e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("jana"),e.stringTranslate("jana","jana_app_name")})),actors:Object.keys(cc),supportedEntities:[De.py.livepersonaeditor,De.py.peopleapp,De.py.addcontactdialog],supportedRenderModes:[Fe.S.Modal,Fe.S.Main,Fe.S.Rail],windowFeatures:{minWidth:565,width:1241,minHeight:720,height:720},getDefaultCommand:e=>{const{enablePeopleApp:n}=e.get(s.J.People);if(n)return{action:De.uk.default,type:De.py.peopleapp}}},df=({commandInput:{command:e},requestContext:{loggerFactory:n,scenarioFactory:i}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,a,o,d,l,r,s;const m=n.newLogger("PeopleApp onCommandReceived","apps-people");return e.action===uc?(null===(t=m.infoToTelemetry)||void 0===t||t.call(m,"View People App command received","people_apps_people_command"),{entity:{type:De.py.peopleapp,action:De.uk.default},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,correlation:{source:sn.D.Nova}}}):(e=>e.action===pc)(e)?(null===(a=m.infoToTelemetry)||void 0===a||a.call(m,"Switch to contact tag command received","people_apps_people_command"),{entity:{type:De.py.peopleapp,action:De.uk.view,id:(0,et.v4)()},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,correlation:{source:sn.D.Nova}},entityOptions:e.data}):(e=>e.action===yc)(e)?(null===(o=m.infoToTelemetry)||void 0===o||o.call(m,"Change query args command received","people_apps_people_command"),{entity:{type:De.py.peopleapp,action:De.uk.view,id:(0,et.v4)()},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,correlation:{source:sn.D.Nova}},entityOptions:e.data}):(e=>e.action===gc)(e)?(null===(d=m.infoToTelemetry)||void 0===d||d.call(m,"Open Add Contact command received","people_apps_people_command"),{entity:{type:De.py.addcontactdialog,action:De.uk.view},command:{visibilityState:v.fe.show,stateTransition:v.su.extend,correlation:{source:sn.D.Nova}}}):(e=>e.action===vc)(e)?(i.newScenario(c.RG.LoadLivePersonaEditor),null===(l=m.infoToTelemetry)||void 0===l||l.call(m,"Open LPE command received","people_apps_people_command"),lf(De.py.livepersonaeditor,De.uk.view,e.data,v.fe.show)):(e=>e.action===kc)(e)?(null===(r=m.infoToTelemetry)||void 0===r||r.call(m,"Close LPE command received","people_apps_people_command"),lf(De.py.livepersonaeditor,De.uk.view,{mri:"",personNodeID:void 0,isInSpeedDialMode:!1,isFederatedUser:!1,placement:"center"},v.fe.hide)):void(null===(s=m.errorToTelemetry)||void 0===s||s.call(m,`Command action '${e.action}' is not supported by PeopleApp`,"people_apps_people_command"))})),lf=(e,n,i,t)=>({entity:{type:e,action:n},command:{visibilityState:t,stateTransition:v.su.extend,correlation:{source:sn.D.Nova}},entityOptions:i});var rf=i(303244);const sf=(e,n)=>{const a=Ae.useCallback((()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var a;const{LivePersonaEditorEntry:o}=yield((e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const t="live-persona-editor";n("ChunkLoadStarted",{chunkName:t});const a=yield(0,Pn.mT)((()=>Promise.all([i.e(122297),i.e(140641),i.e(141603),i.e(256045),i.e(976609),i.e(1053),i.e(296056),i.e(364037),i.e(273122),i.e(816561),i.e(9081),i.e(84215),i.e(100869),i.e(795491),i.e(946751),i.e(538997)]).then(i.bind(i,306577))),t,e);return n("ChunkLoadSucceeded",{chunkName:t}),a})))(e,n);return null===(a=e.findScenario(c.RG.LoadLivePersonaEditor))||void 0===a||a.mark(c.ck.LoadedLivePersonaEditorChunk),{default:o}}))),[e,n]),o=Ae.useCallback((()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{PeoplePickerDialog:a}=yield((e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const t="speed-dial-nova";n("ChunkLoadStarted",{chunkName:t});const a=yield(0,Pn.mT)((()=>Promise.all([i.e(790026),i.e(256045),i.e(296056),i.e(232236),i.e(882718),i.e(359232),i.e(68688),i.e(912597),i.e(495500),i.e(713782),i.e(553856),i.e(18723)]).then(i.bind(i,974838))),t,e);return n("ChunkLoadSucceeded",{chunkName:t}),a})))(e,n);return{default:a}}))),[e,n]),d=Ae.useCallback((()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var a;const{PeopleAppMainViewEntry:o}=yield((e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const t="people-app-main-view";n("ChunkLoadStarted",{chunkName:t});const a=yield(0,Pn.mT)((()=>Promise.all([i.e(122297),i.e(140641),i.e(256045),i.e(1053),i.e(755684),i.e(296056),i.e(671291),i.e(102207),i.e(273122),i.e(449237),i.e(119395),i.e(9081),i.e(215133),i.e(100869),i.e(795491),i.e(299962),i.e(423804)]).then(i.bind(i,218e3))),t,e);return n("ChunkLoadSucceeded",{chunkName:t}),a})))(e,n);return null===(a=e.findScenario(c.RG.PeopleAppSwitch))||void 0===a||a.mark(c.ck.LoadedPeopleAppMainViewChunk),{default:o}}))),[e,n]),l=Ae.useCallback((()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var a;const{PeopleAppLeftNavEntry:o}=yield((e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const t="people-app-nova";n("ChunkLoadStarted",{chunkName:t});const a=yield(0,Pn.mT)((()=>Promise.all([i.e(105434),i.e(449237),i.e(210537),i.e(100869),i.e(795491),i.e(11666),i.e(124636)]).then(i.bind(i,454254))),t,e);return n("ChunkLoadSucceeded",{chunkName:t}),a})))(e,n);return null===(a=e.findScenario(c.RG.PeopleAppSwitch))||void 0===a||a.mark(c.ck.LoadedPeopleAppLeftNavChunk),{default:o}}))),[e,n]);return{LivePersonaEditor:a,PeopleAppMainView:d,PeopleAppLeftNav:l,AddContactPickerDialog:o}};var mf=i(708702),cf=i(800611),uf=i(618757),pf=i(656627),yf=i(885053),vf=i(785365),kf=i(478365),gf=i(597293),Nf=i(663555);const hf=({appRenderMode:e,onRenderEvent:n,scenarioFactory:i,entity:t})=>{const{coreSettings:a}=(0,Cl.SE)(),o=(0,wl.dL)();Ae.useEffect((()=>{(e=>{const n=(0,mf.O)(e);if(n){const e=(0,uf.r)(n);cf.W.associateIngestionKeyWithAppNameIfNecessary(e,pf.i,[kf.pL])}})(a),(e=>{const n=(0,mf.O)(e);if(n){const e=(0,yf.r)(n);cf.W.associateIngestionKeyWithAppNameIfNecessary(e,vf.i,[kf.pL])}})(a)}),[a]);const{LivePersonaEditor:d,PeopleAppLeftNav:l,PeopleAppMainView:r,AddContactPickerDialog:s}=sf(i,n);if(e===Fe.S.Modal&&t.type===De.py.livepersonaeditor)return(0,Ie.t)(xn.o,{factory:d,props:{},fallback:!1});if(e===Fe.S.Main&&t.type===De.py.peopleapp)return(0,Ie.t)(xn.o,{factory:r,props:{},fallback:!1});if(e===Fe.S.Rail&&t.type===De.py.peopleapp)return(0,Ie.t)(xn.o,{factory:l,props:{},fallback:!1});if(e===Fe.S.Modal&&t.type===De.py.addcontactdialog){const e=gf.a.fromName(Nf.TS.addContacts),n=o.stringTranslate("jana","add_to_contacts"),i={moduleNameOnSelection:ei.rA.peopleAppAddContactPeoplePickerAdd,moduleNameOnInitiation:ei.rA.peopleAppAddContactPeoplePicker,panelType:ei.wh.SpeedDial,pickerUsageArea:"AddContactPeoplePickerDialog",moduleName:ei.rA.peopleAppAddContactDialog,subWorkLoad:ei.eD.addContact};return(0,Ie.t)(xn.o,{factory:s,props:{dialogTitle:n,isSpeedDialScenario:!1,peoplePickerFilters:e,openPickerDialog:!0,userBiTelemetryInfo:i,userActionLocation:rf.x9.PeopleApp}})}return null},ff=()=>Promise.all([i.e(917388),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(241602),i.e(976609),i.e(779478),i.e(780208),i.e(363327),i.e(375683),i.e(150328),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(269296),i.e(26466),i.e(462317),i.e(882280),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(613692),i.e(403936),i.e(271428),i.e(207856),i.e(386201),i.e(450605),i.e(769716),i.e(329712),i.e(673758),i.e(839180),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(788842),i.e(494306),i.e(762318),i.e(591822),i.e(931123),i.e(509115),i.e(435933),i.e(761598),i.e(449768),i.e(414875),i.e(927109),i.e(989092),i.e(770342),i.e(800766),i.e(103430),i.e(456904)]).then(i.bind(i,228183)),_f=e=>{const{enableEntityMoreInfo:n,children:i}=e,[a,o]=Ae.useState();return Ae.useEffect((()=>{n||function(){(0,t.__awaiter)(this,void 0,void 0,(function*(){const{LPC:e}=yield(0,Pn.mT)(ff,"people-app-lpc");o((()=>e))}))}()}),[n,o]),!n&&a?(0,Ie.t)(a,Object.assign({appName:"PeopleApp"},{children:(0,Ie.t)(Na.p3,{children:i})})):(0,Ie.t)(Ae.Fragment,{children:i})},Sf=Ae.memo((function({appRenderMode:e,scenarioFactory:n,onRenderEvent:i,entity:t}){return(0,Ie.t)(ri.f,Object.assign({namespaces:["livePersonaEditor","jana"],loaderRenderer:null},{children:(0,Ie.t)(hf,{appRenderMode:e,scenarioFactory:n,onRenderEvent:i,entity:t})}))})),Tf=({onRenderEvent:e,scenarioFactory:n,appRenderMode:i,entity:a,coreSettings:o})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{enableEntityMoreInfo:t}=o.get(s.J.Core);return n.findScenario(c.RG.PeopleAppSwitch)||n.newScenario(c.RG.PeopleAppSwitch),(0,Ie.t)(_f,Object.assign({enableEntityMoreInfo:!!t},{children:(0,Ie.t)(Sf,{onRenderEvent:e,scenarioFactory:n,appRenderMode:i,entity:a})}))})),bf=({appRenderMode:e})=>{const n=new Ee.H,i=[],t=[];switch(e){case Fe.S.Main:Cf({criticalSignals:i,postCriticalSignals:t,featureFlags:{}});case Fe.S.Rail:}return n.registerAppPhase({phase:g.nh.CRITICAL,signals:i,timeout:6e4}),n.appPhases},Cf=({criticalSignals:e})=>{e.push(Me.G.PEOPLE_APP_RENDERED)},wf=e=>{if(If(e))return{subNavEntity:Af(e),headerEntity:Ff(e),startEntity:Df(e),mainEntity:Ef(e),endEntity:Mf(e)}},If=({entity:e,layoutMode:n})=>{const{action:i=null,type:t}=Object.assign({},e),a=[v.lO.focus,v.lO.standard].includes(n),o=[De.py.peopleapp].includes(t),d=[De.uk.list,De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},Af=({entity:e,layoutMode:n})=>{if(n===v.lO.focus)return null;const{type:i,id:t,options:a,windowOptions:o}=e;return{action:De.uk.list,entityState:{flushableByLinkedEntity:!0},id:t,linkedEntity:null,type:i,windowOptions:o,options:a}},Ff=()=>null,Df=()=>null,Ef=({entity:e,contextEntity:n})=>{let i=De.uk.view;const{action:t=null}=Object.assign({},e),a=[De.uk.view,De.uk.default];return t&&a.includes(t)&&(i=t),n||Object.assign(Object.assign({},e),{action:i})},Mf=()=>null,Pf=({areEmptySlotsTransparent:e,coreSettings:n})=>{var i;const{isFlyoutChat:t}=null!==(i=null==n?void 0:n.get(s.J.Flyout))&&void 0!==i?i:{};return{subNavEntity:{[Fe.S.Rail]:{areSlotShadowsDisabled:e,isBackgroundTransparent:!!(null==n?void 0:n.get(s.J.Core).enableTransparentLeftRail)||e,isColorSchemeDefaultBackground3:!e}},mainEntity:{[Fe.S.Main]:{isBackgroundTransparent:!!t}}}},Rf=(e,n,i)=>{const{userPreferences:t,coreSettings:a,layoutMode:o}=n,d=e.mainEntity;if(d.action===De.uk.view)return wf({contextEntity:null,coreSettings:a,entity:{id:(0,et.v4)(),type:De.py.peopleapp,action:De.uk.list,options:d.options},layoutMode:o,userPreferences:t})},Of={id:"com.microsoft.teams.store.notifications.app",name:"TeamsStoreNotificationsApp",supportedEntities:[De.py.lobnotifications,De.py.onboardingnotifications,De.py.discoverappsnotifications,De.py.autoinstallnotification],supportedRenderModes:[Fe.S.Main,Fe.S.Rail]},$f="/l/autoinstallnotification",Lf=(e,n)=>{var i;const t=new RegExp(`${$f}/([a-zA-Z0-9,-]+)$`),a=e.pathname.match(t);if(a){const[,e]=a;if(!e.split(",").includes(""))return Promise.resolve({entityCommand:{entity:{type:De.py.autoinstallnotification,action:De.uk.view,id:e},entityOptions:{autoInstallAppIds:e.split(",")},command:{stateTransition:v.su.flow,visibilityState:v.fe.show}},metadata:{allowAnonymous:!1}})}return null===(i=n.warnNoPii)||void 0===i||i.call(n,`invalid path name ${e.pathname}`),Promise.reject("Auto install notification deeplink is invalid")},xf=e=>{if(Bf(e))return jf(e)?{subNavEntity:Uf(e),headerEntity:Vf(e),startEntity:Wf(e),mainEntity:Hf(e),endEntity:Gf(e)}:null},Bf=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.lobnotifications,De.py.onboardingnotifications,De.py.discoverappsnotifications,De.py.autoinstallnotification].includes(t),d=[De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},jf=()=>!0,Uf=({entity:e})=>e,Vf=()=>null,Wf=()=>null,Hf=({entity:e})=>e,Gf=()=>null,Jf=({appRenderMode:e})=>{const n=new Ee.H,i=[];if(e===Fe.S.Main)i.push(Me.G.LOB_NOTIFICATIONS_RENDERED);return n.registerAppPhase({phase:g.nh.CRITICAL,signals:i,timeout:3e4}),n.registerAppPhase({phase:g.nh.POST_CRITICAL,signals:[],timeout:1e4}),n.appPhases},qf="/l/lobnotifications",zf=(e,n,i)=>{var t;const a=new RegExp(`${qf}/([a-zA-Z0-9,-]+)$`),o=e.pathname.match(a);if(o){const[,e]=o;if(!e.split(",").includes(""))return Promise.resolve({entityCommand:{entity:{type:De.py.lobnotifications,action:De.uk.view,id:e},entityOptions:{headItem:e.split(",")[0],bodyItems:e.split(",").slice(1)},command:{stateTransition:(null==i?void 0:i.stateTransition)||v.su.flow,visibilityState:(null==i?void 0:i.visibilityState)||v.fe.show}},metadata:{allowAnonymous:!1}})}return null===(t=n.warnNoPii)||void 0===t||t.call(n,`invalid path name ${e.pathname}`),Promise.reject("Lob notification deeplink is invalid")},Qf=()=>Promise.all([i.e(713782),i.e(767770),i.e(704171)]).then(i.bind(i,6856)),Yf=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(892924),i.e(256045),i.e(241602),i.e(371935),i.e(779478),i.e(888171),i.e(901509),i.e(547652),i.e(435876),i.e(400010),i.e(242959),i.e(202477),i.e(465019),i.e(697672),i.e(160200),i.e(959180),i.e(687465),i.e(340690),i.e(890555),i.e(864770),i.e(745400),i.e(577907),i.e(357068),i.e(871090),i.e(816167),i.e(479335),i.e(846077),i.e(232236),i.e(914152),i.e(169080),i.e(269104),i.e(890473),i.e(25663),i.e(347761),i.e(9081),i.e(137706),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(26466),i.e(430209),i.e(911758),i.e(435216),i.e(667549),i.e(609633),i.e(469488),i.e(548536),i.e(868838),i.e(803124),i.e(242863),i.e(29311),i.e(321833),i.e(186443),i.e(472638),i.e(68688),i.e(912597),i.e(127919),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(495500),i.e(403936),i.e(450605),i.e(329712),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(816906),i.e(831470),i.e(417169),i.e(451185),i.e(666579),i.e(913486),i.e(369093),i.e(364315),i.e(781662),i.e(53443),i.e(478388),i.e(327116),i.e(713782),i.e(553856),i.e(801349),i.e(399286),i.e(764391),i.e(425523),i.e(336995),i.e(537680),i.e(520174),i.e(506412),i.e(25019),i.e(918607),i.e(673615),i.e(568740)]).then(i.bind(i,173029));function Kf(){const e=()=>null;return{getAppViewEntities:xf,manifest:Of,onBeforeDeeplinkParsed:[{filter:e=>!!e.pathname.startsWith("/l/lobnotifications"),execute:({deeplinkUrl:e,preferredCommandInput:n,context:i})=>{const t=i.loggerFactory.newLogger("ActivityApp","apps-activity");return t.log("Executing deep link for lob notifications"),((e,n,i,t)=>{const{pathname:a}=i;return a.startsWith(qf)?zf(i,n,t):Promise.reject("No DeeplinkPrefixType found for the specified deeplinkUrl")})(i.coreSettings,t,e,n)}},{filter:e=>!!e.pathname.startsWith("/l/autoinstallnotification"),execute:({deeplinkUrl:e,context:n})=>{const i=n.loggerFactory.newLogger("ActivityApp","apps-activity");return i.log("Executing deep link for Auto Install notifications"),((e,n,i)=>{var t,a;const{pathname:o}=i,{enableSendAutoInstallNotification:d}=e.get(s.J.Extensibility);if(o.startsWith($f)){const e="Send auto install notification is disabled for this experience";return d?Lf(i,n):(null===(t=n.errorToTelemetry)||void 0===t||t.call(n,e,"auto_install_notification_feature_not_enabled"),Promise.reject("Send auto install notification is disabled for this experience"))}const l="No DeeplinkPrefixType found for the specified deeplinkUrl";return null===(a=n.errorToTelemetry)||void 0===a||a.call(n,l,"auto_install_notification_deep_link_prefix_type_not_found"),Promise.reject(l)})(n.coreSettings,i,e)}}],render:({appRenderMode:n,onRenderEvent:i,scenarioFactory:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main){const e="teamsStoreNotifications";i("ChunkLoadStarted",{chunkName:e});const[{NotificationsEntry:n},{CallsTabContextProvider:t}]=yield Promise.all([(0,Pn.mT)(Qf,e,a),(0,Pn.mT)(Yf,e,a)]);return i("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(ri.f,Object.assign({namespace:"extensibility",loaderRenderer:null},{children:(0,Ie.t)(t,{children:(0,Ie.t)(n,{})})}))}return(0,Ie.t)(e,{})})),getAppPhases:Jf}}var Xf=i(369398),Zf=i(548996);const e_=new Set([De.py.chats,De.py.calls,De.py.taskmodule,De.py.hwctaskmodule,De.py.extensions]);var n_=i(554404),i_=i(849538),t_=i(941636);const a_="/l/stage",o_="No DeeplinkPrefixType found for the specified deeplinkUrl",d_=e=>{const{pathname:n,search:i}=e,t=new URLSearchParams(i).get("context"),a=t&&JSON.parse(t),o=n.split(/[/?&]/),d=o.indexOf("stage");return{appId:o[d+1],deeplinkContext:a}},l_={filter:e=>{if(!e.pathname.startsWith(a_))return!1;try{const{appId:n,deeplinkContext:i}=d_(e),{contentUrl:t}=i;return!!(n&&i&&t)}catch(e){return!1}},execute:({deeplinkUrl:e,context:{loggerFactory:n,scenarioFactory:i,coreSettings:a,getUserContexts:o},sourceViewEntity:d})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t;const l=n.newLogger("PlatformApp_parseStageDeeplink","apps-platform-app"),{enableReactStageModal:r,disablePlatformEntityIdDecoding:m}=a.get(s.J.Extensibility);if(!r)return Promise.reject("Stage modal feature flag is disabled");if(!e.pathname.startsWith(a_))return l.log(o_),Promise.reject(o_);if(!d){const e="No sourceViewEntity found";return l.log(e),Promise.reject(e)}const{chatId:c,parentMessageId:u,channelMeetingMessageId:p,replyChainId:y,channelId:v}=(0,t_.g)(d,l,!!m),{appId:k,deeplinkContext:g}=d_(e),{contentUrl:N,websiteUrl:h,title:f,sourceChatId:_,sourceChannelId:S,messageId:T,threadId:b,openMode:C}=g;let w=c,I=v,A=p||u;(_||S)&&(A=T),_&&(w=_),g.replyChainId&&(I=S);const F={appId:k,tabInfo:JSON.stringify({tabInfo:{contentUrl:N,websiteUrl:h,name:f}}),entryPoint:n_.mQ.deepLinkStageView,openMode:C,messageId:A,replyChainId:null!==(t=g.replyChainId)&&void 0!==t?t:y,convId:null!=I?I:w||"",channelId:I},D=yield o();if(!D||0===D.length)return Promise.reject("No user context found");const E=D.find((e=>e.userContextAccountType===Km.K.MainWindow));if(!E)return Promise.reject("No main window account found");const M=E.context.client;return(0,i_.A)(F,a,M,i,l,b).then((e=>Promise.resolve(e))).catch((e=>Promise.reject(e)))}))},r_={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ComponentsHostedWebContentSendExternalAuthDeeplinkMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"authId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"result"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendExternalAuthDeeplink"},arguments:[{kind:"Argument",name:{kind:"Name",value:"authId"},value:{kind:"Variable",name:{kind:"Name",value:"authId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"result"},value:{kind:"Variable",name:{kind:"Name",value:"result"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]},s_={reloadTrigger:!1},m_={id:""},c_="/l/entity",u_="/l/task",p_="No DeeplinkPrefixType found for the specified deeplinkUrl",y_={[c_]:ym.DL.PlatformExtension},v_=e=>{const{pathname:n,search:i}=e,t=new URLSearchParams(i),a=t.get("context"),o=t.get("tenantId");let d;try{d=a&&JSON.parse(a)}catch(e){}const l=null==d?void 0:d.channelId,r=null==d?void 0:d.chatId,s=null==n?void 0:n.split(/[/?&]/),m=null==s?void 0:s.indexOf("entity");return{tenantId:o,appId:null==s?void 0:s[m+1],entityId:decodeURIComponent((null==s?void 0:s[m+2])||""),channelId:l,chatId:r,deeplinkContext:d,pathname:n}},k_=new Set([c_]),g_=(e,n,i,t,a,o,d,l,r)=>{null==l||l.mark("create_deeplink_command"),a.log(`create_deeplink_command with appId: ${n} tabEntityId:${i} context: ${t}`);const s=JSON.stringify({appId:n,tabEntityId:i,subEntityId:null==t?void 0:t.subEntityId});o&&m_.id===s?s_.reloadTrigger=!s_.reloadTrigger:s_.reloadTrigger=!1,m_.id=s;const m=!(null==t?void 0:t.channelId)&&!(null==t?void 0:t.chatId)||o?(0,km.Pq)(n,!1,s_.reloadTrigger,o,sn.D.PlatformPersonalAppDeepLink,i,d,null==t?void 0:t.subEntityId,void 0,e,!0):(0,km.PO)(e,n,t.channelId||"",t.chatId||"",i,d,null==t?void 0:t.subEntityId),c={entityCommand:Object.assign({},m),metadata:{allowAnonymous:!1,tenantId:null!=r?r:void 0}};return null==l||l.mark("return_deeplink_command"),null==l||l.appendEventData({"PlatformTabDeeplink.generatedCommand":c.toString()}),Promise.resolve(c)},N_=()=>i.e(22463).then(i.bind(i,870586)),h_=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n;const{deeplinkUrl:i,preferredCommandInput:t,context:{coreSettings:a,loggerFactory:o,scenarioFactory:d}}=e,l=o.newLogger("platform-app","apps-platform-app"),{enablePlatformDeepLinkRouting:r,appIdList:m,disabledTabAppIds:u,isAllowedAppList:p}=a.get(s.J.Extensibility),y=m&&JSON.parse(m),{appId:v}=v_(i),k=(0,Zf.fk)(l,v,!1,u||[],y,p);if(r&&k)return Promise.reject(`App ${v} is not supported for deeplink navigation in T2.1`);const g=new URLSearchParams(i.search).get("context");let N;try{N=g&&JSON.parse(g)}catch(e){null===(n=l.errorToTelemetry)||void 0===n||n.call(l,"[parseAndExecuteDeeplink] could not parse deeplink context","platform_deeplink_context_parse_error")}return!r&&(null==N?void 0:N.channelId)&&(null==N?void 0:N.chatId)?Promise.reject("Feature for parsing teams and channels deep links in T2.1 is not enabled"):((e,n,i,t,a)=>{var o,d,l,r,s;const{appId:m,entityId:u,deeplinkContext:p,pathname:y,tenantId:v}=v_(e);n.log(`Parsing deepLink for platform app - appId: ${m}, pathname: ${y}`);const k=null===(o=null==a?void 0:a.correlation)||void 0===o?void 0:o.source,g=[sn.D.ActivityFeed,sn.D.ActivityFeedBellClick],N=!!k&&g.includes(k);let h,f;i&&(f=N?n_.mQ.activityFeed:(null==p?void 0:p.channelId)||(null==p?void 0:p.chatId)?p.channelId?n_.mQ.channelTab:p.chatId?n_.mQ.chatTab:"Unknown":n_.mQ.personalApp,null===(d=null==t?void 0:t.findScenario(c.RG.PlatformTabDeeplinkHandling))||void 0===d||d.cancel(),h=null==t?void 0:t.newScenario(c.RG.PlatformTabDeeplinkHandling),h&&(null===(l=null==t?void 0:t.hoistScenarioToCore)||void 0===l||l.call(t,h)),null==h||h.appendEventData({"PlatformTabDeeplink.pathname":e.pathname,"PlatformTabDeeplink.search":e.search}));for(const i of Array.from(k_))if(null==y?void 0:y.startsWith(i))return void 0===y_[i]?(null===(r=n.errorToTelemetry)||void 0===r||r.call(n,p_,"platform_deeplink_prefix_type"),Promise.reject(p_)):((0,Xf.ui)(t,m,`${f}Deeplink`,n,!1),g_(e,m,u,p,n,N,a,h,v));return null===(s=n.errorToTelemetry)||void 0===s||s.call(n,p_,"platform_deeplink_prefix_type"),Promise.reject(p_)})(i,l,!!r,d,t)})),f_={filter:u_,execute:({deeplinkUrl:e,context:{loggerFactory:n,scenarioFactory:i,coreSettings:t},sourceViewEntity:a})=>{const o=n.newLogger("PlatformApp_parseTaskModuleDeeplink","apps-platform-app");return __(e,t,o,i,a)}},__=(e,n,i,t,a)=>{if(e.pathname.startsWith(u_)){const o=t.newScenario(c.RG.ExtDeeplinkToTaskModule),{enableDeepLinkToTaskModule:d}=n.get(s.J.Extensibility);if(!d)return o.stop({reason:c.ck.ExtDeeplinkToTaskModuleFeatureFlagDisabled}),i.log("ext_deeplink_to_task_module_featureflag_disabled"),Promise.reject("Deeplink to task module feature flag is disabled");if(!a)return o.stop({reason:c.ck.ExtDeeplinkToTaskModuleNotSupported}),i.log("ext_deeplink_to_task_module_not_supported"),Promise.reject("Deeplink to task module is not supported");const l=(0,et.v4)();return Promise.resolve({entityCommand:{entity:{type:De.py.taskmodule,action:De.uk.create,id:l},command:{visibilityState:v.fe.show,stateTransition:v.su.extend,correlation:{source:sn.D.TaskModuleDeeplink}},entityOptions:{deeplinkSourceEntityInput:a,deeplinkUrl:e}},metadata:{allowAnonymous:!1,shouldTargetSourceWindow:!0}})}return i.log(p_),Promise.reject(p_)},S_=[{filter:e=>{if(!e.pathname.startsWith(c_))return!1;const{appId:n,chatId:i,entityId:t,deeplinkContext:a}=v_(e);return!(!(n&&i&&t&&a)||"chat"!==a.contextType&&"meeting"!==a.contextType)},execute:e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{context:{coreSettings:n}}=e,{enablePlatformDeepLinkRouting:i}=n.get(s.J.Extensibility);if(!(({deeplinkUrl:e,sourceViewEntity:n,context:{coreSettings:i}})=>{var t;if("false"===(null===(t=e.searchParams.get("openInMeeting"))||void 0===t?void 0:t.toLowerCase())||!i.get(s.J.Extensibility).handleDeepLinkToMeetingSidePanel||!n)return!1;const{type:a,action:o,linkedEntity:d}=n,l=n;return a===De.py.calls||!!l.options&&(a===De.py.extensions&&o===De.uk.view&&(null==d?void 0:d.type)===De.py.calls?!!d.id:e_.has(a)&&l.options.includes("teamsCallId"))})(e)){if(i)return h_(e);throw new Error("Groupchat/team scope tab deeplink disabled")}const{executeDeepLinkToGroupChatOrTeamTab:t}=yield(0,Pn.mT)(N_,"platform-app-execute-group-chat-or-team-scope-tab-deeplink");try{return yield t(e)}catch(n){if(i)return h_(e);throw n}}))},{filter:e=>{try{const{appId:n}=v_(e);return!!n}catch(e){return!1}},execute:h_},f_,l_,{filter:"/l/auth-callback",execute:e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n,i,t;const{context:{coreSettings:a}}=e,{enablePlatformExternalAuth:o}=a.get(s.J.Extensibility);if(!o)return Promise.reject("External auth feature is not enabled");{const{search:a}=e.deeplinkUrl,o=new URLSearchParams(a),d=o.get("authId"),l=o.get("result"),r=yield e.context.getUserContexts();null===(t=null===(i=null===(n=null==r?void 0:r[0])||void 0===n?void 0:n.context)||void 0===i?void 0:i.client)||void 0===t||t.mutate({mutation:r_,variables:{authId:d,result:l}})}return Promise.resolve(void 0)}))}];var T_=i(124498);const b_={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DataClientPlatformAppButtonMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"action"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateAppButtonSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"action"},value:{kind:"Variable",name:{kind:"Name",value:"action"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]}}]},C_="platform",w_="viewPlatformApp",I_="loadPlatformChunks",A_="openAppDetailsDialog",F_="openAboutDialog",D_="installPlatformApp",E_="uninstallPlatformApp",M_="blockUnblockBotChat",P_=(e,n)=>({actor:C_,action:w_,data:{appId:e,isMultiWindow:n}}),R_=()=>({actor:C_,action:I_}),O_=(e,n)=>({actor:C_,action:A_,data:{appId:e,scrollToSection:n}}),$_=e=>({actor:C_,action:D_,data:{appId:e}}),L_=(e,n,i)=>({actor:C_,action:E_,data:{appId:e,appName:n,isInUse:i}}),x_=e=>({actor:C_,action:F_,data:{appId:e}}),B_=e=>({actor:C_,action:M_,data:{appId:e}}),{getIsFirstFlyoutClickAfterAppLoad:j_,setIsFirstFlyoutClickAfterAppLoad:U_}=(()=>{let e=!0;return{getIsFirstFlyoutClickAfterAppLoad:()=>e,setIsFirstFlyoutClickAfterAppLoad:n=>{e=n}}})();var V_=i(598726);const W_={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ComponentsAppsPlatformQueriesBlockUnblockBotChatForAppMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"blockUnblockBotChatForApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]},H_=()=>Promise.all([i.e(917388),i.e(790026),i.e(590393),i.e(256045),i.e(65477),i.e(296056),i.e(250273),i.e(680254),i.e(70378),i.e(879601),i.e(347761),i.e(409201),i.e(26466),i.e(399094),i.e(671682),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(481020),i.e(842529),i.e(485984),i.e(722198),i.e(271428),i.e(394413),i.e(477708),i.e(964619),i.e(628109),i.e(762318),i.e(591822),i.e(677395),i.e(297312),i.e(74043),i.e(267871),i.e(542511),i.e(648907),i.e(358329),i.e(216439),i.e(56767),i.e(988602),i.e(730141),i.e(559067)]).then(i.bind(i,461161)),G_=({commandInput:e,requestContext:n})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var i,t;const{loggerFactory:a,scenarioFactory:o,client:d,coreSettings:l}=n,r=e.command,m=r.action,u=a.newLogger("PlatformApp onCommandReceived","apps-platform-app");if(e.command.actor===C_)switch(m){case w_:return J_(r,n,u);case I_:const{enablePrewarmPlatformChunk:e}=l.get(s.J.Extensibility);return void(e&&j_()&&(u.log("enablePrewarmPlatformChunk is enabled."),(0,Pn.mT)(H_,"platform-app",o),U_(!1)));case A_:return q_(r);case F_:const{appId:a}=r.data;return{entityOptions:{appId:a,entryPoint:T_.RE.PersonalAppAbout},entity:{id:a,type:De.py.platformapp,action:De.uk.create},command:{visibilityState:v.fe.show,stateTransition:v.su.extend,correlation:{source:sn.D.ExtensionCommanding}}};case D_:{const{appId:e}=r.data;if(null===(i=(yield(0,V_.yx)(d,e)).staticTabs)||void 0===i?void 0:i.some((e=>{var n;return null===(n=e.scopes)||void 0===n?void 0:n.some((e=>(null==e?void 0:e.toLowerCase())===Fd.qi.Personal.toLowerCase()))}))){const{enableAppsQueryOptimization:i}=l.get(s.J.Extensibility);return yield(0,V_.eI)(d,o,c.RG.PlatformAppFlyoutJITInstallApp,e,Fd.qi.Personal,u,!!i),J_(r,n,u)}return q_(r)}case E_:{const{appId:e,appName:n,isInUse:i}=r.data;return{entityOptions:{appId:e,appName:n,scope:Fd.qi.Personal,navigateToDefaultAppOnUninstall:i},entity:{id:e,type:De.py.manageapps,action:De.uk.delete},command:{visibilityState:v.fe.show,stateTransition:v.su.extend,correlation:{source:sn.D.ExtensionCommanding}}}}case M_:const p=null===(t=r.data)||void 0===t?void 0:t.appId;return p?void(yield d.mutate({mutation:W_,variables:{appId:p}})):void u.error("app id for block unblock was undefined.");default:u.error(`Command action '${m}' is not supported at PlatformApp.`)}else u.error(`Command for actor '${e.command.actor}' cannot be handled by PlatformApp.`)})),J_=(e,n,i)=>{const{scenarioFactory:a,executionContext:o,client:d}=n,{viewEntities:{mainEntity:l}}=o;if("object"!=typeof(r=e.data)||null===r||!("appId"in r))return void i.error(`Command for action '${e.action}' requires an appId.`);var r;const s=z_(null==l?void 0:l.id,null==l?void 0:l.type,e.data.appId,i);return s?((e,n,i,a)=>{(0,t.__awaiter)(void 0,void 0,void 0,(function*(){if(!n)return;const t={appId:n,action:i};yield e.mutate({mutation:b_,variables:t}).catch((()=>{var e;return null===(e=a.errorToTelemetry)||void 0===e?void 0:e.call(a,`[AppId: ${n}] Failed to register app button to cache`,"platform_personal_app_app_button_api",void 0,!0)}))}))})(d,e.data.appId,e.action,i):(0,Xf.ui)(a,e.data.appId,n_.mQ.personalApp,i,e.data.isMultiWindow),(0,km.Pq)(e.data.appId,e.data.isMultiWindow||!1,!0,!1,sn.D.AppBar,void 0,void 0,void 0,s)},q_=e=>{var n,i,t;const a=null!==(i=null===(n=e.data)||void 0===n?void 0:n.appId)&&void 0!==i?i:"",o=null===(t=e.data)||void 0===t?void 0:t.scrollToSection;return{entityOptions:{appId:a,entryPoint:T_.RE.PersonalFlyoutAppSuggestions,viewOptions:{scrollToSection:o}},entity:{id:a,type:De.py.platformapp,action:De.uk.create},command:{visibilityState:v.fe.show,stateTransition:v.su.extend,correlation:{source:sn.D.ExtensionCommanding}}}},z_=(e,n,i,t)=>{var a;try{if(n===De.py.extensions&&e){return JSON.parse(e).appId===i}return!1}catch(n){return null===(a=t.errorToTelemetry)||void 0===a||a.call(t,`failed to parse main entity id ${e}`,"platform_personal_app_main_entity_parse",void 0,!0),!1}},Q_={onEventReceived:({eventInput:e})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n,i,t,a;switch(e.event.type){case ad.uS.expandTab:{const t=null===(i=(n=e.event).data)||void 0===i?void 0:i.call(n);return Promise.resolve({command:od.CN.expandTab(t)})}case ad.uS.resetLayoutOverrides:return Promise.resolve({command:od.CN.resetLayoutOverrides()});case ad.uS.maximizeTab:return Promise.resolve({command:od.CN.maximizeTab()});case Ze.uS.requestPersonMoreInfo:const o=null===(a=(t=e.event).data)||void 0===a?void 0:a.call(t);return Promise.resolve({command:on(o)})}return Promise.resolve(void 0)}))},Y_=e=>{if(K_(e))return X_(e)?{subNavEntity:Z_(e),headerEntity:eS(e),startEntity:nS(e),mainEntity:iS(e),endEntity:tS(e)}:null},K_=({contextEntity:e,entity:n,coreSettings:i,layoutMode:t})=>{const{action:a=null,type:o}=Object.assign({},n);if(aS(n,e,i))return!1;const d=[v.lO.focus,v.lO.standard].includes(t),l=[De.py.platformapp,De.py.platformappdetails,De.py.incontextstore,De.py.platformapps,De.py.extensions,De.py.enableappdialog].includes(o),r=[De.uk.create,De.uk.default,De.uk.list,De.uk.view,De.uk.update,De.uk.manage],s=a&&r.includes(a),m=e&&e.action;return!(!d||!l||!s&&!m)},X_=()=>!0,Z_=()=>null,eS=({contextEntity:e,entity:n,coreSettings:i})=>{const t=null==i?void 0:i.get(s.J.Extensibility).enablePlatformHeaderEntry;if(e&&e.action){if(e.type===De.py.chats)return n;if(e.type===De.py.extensions&&t)return e}return t?n:null},nS=()=>null,iS=({entity:e,contextEntity:n})=>n&&n.action&&(n.type===De.py.chats||n.type===De.py.extensions)?n:e,tS=()=>null,aS=(e,n,i)=>{const t=null==i?void 0:i.get(s.J.Extensibility).enablePlatformHeaderEntry;return e.type===De.py.extensions&&(null==n?void 0:n.type)===De.py.extensions&&!t},oS=({coreSettings:e})=>{var n;return{headerEntity:{[Fe.S.HorizontalBar]:{slotHeightOverrides:(null===(n=null==e?void 0:e.get(s.J.Extensibility))||void 0===n?void 0:n.enablePlatformPersonalAppHeaderLayout)?"auto":void 0}}}},dS={id:"com.microsoft.teams.platform-app",name:"Platform App",actors:[C_],supportedEntities:[De.py.extensions,De.py.taskmodule,De.py.hwctaskmodule,De.py.platformapp,De.py.platformappdetails,De.py.platformappconsent,De.py.platformapps,De.py.platformsubscriptionplans,De.py.customapp,De.py.platformauthconsentdialog,De.py.workflows,De.py.selectMediaApi,De.py.viewImagesApi,De.py.platformtab,De.py.locationapi,De.py.selectpeoplepicker,De.py.platformappratingcoachmark,De.py.stagedapps,De.py.platformTabGallery,De.py.manageapps,De.py.manageappswebhook,De.py.incontextstore,De.py.platformappdevicepermissions,De.py.settingsdialog,De.py.platformstagemodal,De.py.enableappdialog],supportedRenderModes:[Fe.S.HorizontalBar,Fe.S.Main,Fe.S.Modal,Fe.S.Rail],windowFeatures:{width:800,height:600,minWidth:800,minHeight:600,offset:20}},lS=({appRenderMode:e,coreSettings:n})=>{const i=new Ee.H,{platformAppCriticalPhaseTimeout:t}=n.get(s.J.Extensibility);return"Main"===e&&i.registerAppPhase({phase:g.nh.CRITICAL,signals:[Me.G.PLATFORM_APP_CONTAINER_RENDERED,Me.G.PLATFORM_APP_FRAME_RENDERED,Me.G.PLATFORM_APP_FRAME_CONTENT_RENDERED],timeout:t||35e3}),i.appPhases},rS=({context:{coreSettings:e,scenarioFactory:n}})=>[{id:"prewarm-platform-app",runOncePerId:!0,job:()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{enablePostALTPrewarmPlatformChunk:t}=e.get(s.J.Extensibility);t&&(yield(0,Pn.mT)((()=>Promise.all([i.e(917388),i.e(790026),i.e(590393),i.e(256045),i.e(65477),i.e(296056),i.e(250273),i.e(680254),i.e(70378),i.e(879601),i.e(347761),i.e(409201),i.e(26466),i.e(399094),i.e(671682),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(481020),i.e(842529),i.e(485984),i.e(722198),i.e(271428),i.e(394413),i.e(477708),i.e(964619),i.e(628109),i.e(762318),i.e(591822),i.e(677395),i.e(297312),i.e(74043),i.e(267871),i.e(542511),i.e(648907),i.e(358329),i.e(216439),i.e(56767),i.e(988602),i.e(730141),i.e(559067)]).then(i.bind(i,461161))),"platform-app",n))}))}],sS=()=>Promise.all([i.e(917388),i.e(790026),i.e(140641),i.e(590393),i.e(65477),i.e(133950),i.e(70378),i.e(789249),i.e(347761),i.e(409201),i.e(399094),i.e(671682),i.e(745659),i.e(775887),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(842529),i.e(485984),i.e(722198),i.e(271428),i.e(394413),i.e(477708),i.e(905353),i.e(628109),i.e(677395),i.e(74043),i.e(165665),i.e(358329),i.e(458414),i.e(730141),i.e(360941)]).then(i.bind(i,440640)),mS=()=>Promise.all([i.e(917388),i.e(790026),i.e(590393),i.e(256045),i.e(65477),i.e(296056),i.e(250273),i.e(680254),i.e(70378),i.e(879601),i.e(347761),i.e(409201),i.e(26466),i.e(399094),i.e(671682),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(481020),i.e(842529),i.e(485984),i.e(722198),i.e(271428),i.e(394413),i.e(477708),i.e(964619),i.e(628109),i.e(762318),i.e(591822),i.e(677395),i.e(297312),i.e(74043),i.e(267871),i.e(542511),i.e(648907),i.e(358329),i.e(216439),i.e(56767),i.e(988602),i.e(730141),i.e(559067)]).then(i.bind(i,461161)),cS=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(256045),i.e(65477),i.e(241602),i.e(1053),i.e(133950),i.e(268372),i.e(775758),i.e(236315),i.e(529375),i.e(105434),i.e(680254),i.e(70378),i.e(545490),i.e(738693),i.e(390049),i.e(539586),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(215133),i.e(196348),i.e(269296),i.e(958163),i.e(399094),i.e(671682),i.e(511611),i.e(563370),i.e(989439),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(842529),i.e(485984),i.e(722198),i.e(271428),i.e(394413),i.e(477708),i.e(628109),i.e(494306),i.e(762318),i.e(591822),i.e(677395),i.e(74043),i.e(96495),i.e(267871),i.e(542511),i.e(989092),i.e(358329),i.e(746399),i.e(216439),i.e(56767),i.e(750078),i.e(218215),i.e(206166),i.e(51087),i.e(463353),i.e(311474),i.e(941916),i.e(802830),i.e(588919)]).then(i.bind(i,640091)),uS=({coreServices:e,host:n,screenState:i})=>{const{disablePlatformAppWindowFeatures:t,enablePlatformAppLargePopout:a}=(null==e?void 0:e.coreSettings.get(s.J.Extensibility))||{},o=null==n?void 0:n.screen;if(t||!o)return null;const{minHeight:d,minWidth:l,offset:r=1,height:m=0,width:c=0}=dS.windowFeatures||{};let u,p,y,v;const k=(((null==i?void 0:i.numOpenWindows)||1)-1)*r;if(a){const n=((e,n)=>{const{minHeight:i=0,minWidth:t=0}=dS.windowFeatures||{};let{width:a=t,height:o=i}=dS.windowFeatures||{};if(!n)return{height:o,width:a};const{orientation:{type:d}}=e,{landscapeScreenRatio:l,portraitScreenRatio:r,widthHeightRatio:m}=n.coreSettings.get(s.J.Calling);if(l&&r&&m)switch(d){case"landscape-primary":case"landscape-secondary":const n=l*e.availHeight;o=n>i?n:i,a=m*o;break;case"portrait-primary":case"portrait-secondary":const d=r*e.availWidth;a=d>t?d:t,o=1/m*a}return{height:o,width:a}})(o,e),i=((e,n,i)=>{var t;const a=(null===(t=dS.windowFeatures)||void 0===t?void 0:t.offset)||0,o="availLeft"in e&&e.availLeft||0,d="availTop"in e&&e.availTop||0,l=o+e.availWidth/2-n/2;let r;switch(e.orientation.type){case"landscape-primary":case"landscape-secondary":r=d+a;break;default:r=d+e.availHeight/2-i/2}return{left:l,top:r}})(o,n.width,n.height);u=n.height,p=n.width,y=i.left,v=i.top}else{const e={left:(null==n?void 0:n.screenX)||0,top:(null==n?void 0:n.screenY)||0};u=m,p=c,y=e.left,v=e.top}return{additionalFeatures:{minHeight:`${d}`,minWidth:`${l}`},left:y+k,top:v+k,minHeight:d,minWidth:l,height:u,width:p}};function pS(){const e=()=>null;return{getAppPhases:lS,getAppViewEntities:Y_,getAppWindowFeatures:uS,getPlatformAppIdForEntity:e=>{if(e.type===De.py.extensions){const{appId:n}=e.id&&JSON.parse(e.id);return n}},getAppViewEntitiesProps:oS,onBeforeDeeplinkParsed:S_,manifest:dS,onCommandReceived:G_,onRegister:e=>{e.registerTask(new Si.K)},render:({appRenderMode:n,scenarioFactory:i,onRenderEvent:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){switch(n){case Fe.S.Modal:{const e="platform-modal",{Modal:n}=yield(0,Pn.mT)(cS,e,i);return(0,Ie.t)(ri.f,Object.assign({namespace:"extensibility",loaderRenderer:null},{children:(0,Ie.t)(n,{})}))}case Fe.S.HorizontalBar:case Fe.S.Main:{const e="platform-app",t=null==i?void 0:i.findScenario(c.RG.PlatformTabFrameLoading);(null==t?void 0:t.currentStep)!==c.ck.PlatformTabRenderAfterChunkLoad&&(null==t||t.mark(c.ck.PlatformTabRenderBeforeChunkLoad),null==t||t.startStep(c.ck.PlatformTabRenderAfterChunkLoad)),a("ChunkLoadStarted",{chunkName:e});const{PlatformAppViewsEntryRenderer:o}=yield(0,Pn.mT)(mS,e,i);return a("ChunkLoadSucceeded",{chunkName:e}),(null==t?void 0:t.currentStep)===c.ck.PlatformTabRenderAfterChunkLoad&&(null==t||t.mark(c.ck.PlatformTabRenderAfterChunkLoad)),(0,Ie.t)(ri.f,Object.assign({namespace:"extensibility",loaderRenderer:null},{children:(0,Ie.t)(o,{appRenderMode:n})}))}case Fe.S.Rail:{const e="platform-app-rail",{PlatformTabPanel:n}=yield(0,Pn.mT)(sS,e,i);return(0,Ie.t)(ri.f,Object.assign({namespace:"extensibility",loaderRenderer:null},{children:(0,Ie.t)(n,{})}))}default:return(0,Ie.t)(e,{})}})),eventHandlers:Q_,onPreWarm:rS}}const yS={id:"com.microsoft.teams.presenter-toolbar",name:"PresenterToolbarApp",supportedEntities:[De.py.presentertoolbar],supportedRenderModes:[Fe.S.Main],windowFeatures:{height:59,width:480,offset:-2}},vS=e=>{if(kS(e))return{subNavEntity:null,headerEntity:null,startEntity:null,mainEntity:gS(e),endEntity:null}},kS=({entity:e})=>{const{action:n=null,type:i}=Object.assign({},e),t=i===De.py.presentertoolbar,a=n===De.uk.view;return Boolean(t&&a)},gS=({entity:e})=>e,NS=()=>({mainEntity:{[Fe.S.Main]:{disableNotificationsBanners:!0,forceDisableTitleBar:!0,isBackgroundTransparent:!0,disableBorderInHighContrast:!0}}}),hS=()=>Promise.all([i.e(882718),i.e(127919),i.e(816906),i.e(297312),i.e(263490),i.e(47437),i.e(471521)]).then(i.bind(i,213931)),fS=({host:e,coreServices:n})=>{var i,t,a;const o=null==e?void 0:e.screen;if(!o)return null;const d=(null===(i=yS.windowFeatures)||void 0===i?void 0:i.width)||480,l=(null===(t=yS.windowFeatures)||void 0===t?void 0:t.height)||60,r=(null===(a=yS.windowFeatures)||void 0===a?void 0:a.offset)||10,m=("availLeft"in o?o.availLeft:0)+o.availWidth/2-d/2,c=(!(null==n?void 0:n.coreSettings.get(s.J.Calling).disableContentprotection)).toString();return{additionalFeatures:{alwaysOnTop:"true",closable:"false",excludeWindowFromScreenSharing:c,fullscreenable:"false",maximizable:"false",minimizable:"false",resizable:"false",movable:"false",hideWindowControl:"true",frame:"false",closeoverride:"true",contentprotection:c,transparent:"true",show:"false"},top:r,left:m,width:d,height:l}};function _S(){const e=()=>null;return{getAppViewEntities:vS,getAppViewEntitiesProps:NS,getAppWindowFeatures:fS,manifest:yS,render:({appRenderMode:n,entity:{type:i},scenarioFactory:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main&&i===De.py.presentertoolbar){const{PresenterToolbar:e}=yield(0,Pn.mT)(hS,"presenter-toolbar-app",a);return(0,Ie.t)(e,{})}return(0,Ie.t)(e,{})}))}}const SS=({action:e,appRenderMode:n,coreSettings:i})=>{const t=new Ee.H,{queuesAppPhaseTimeouts:a}=i.get(s.J.Queues),o=[],d=[];switch(n){case Fe.S.Rail:bS({action:e,criticalSignals:o,postCriticalSignals:d,featureFlags:{}});break;case Fe.S.Main:CS({action:e,criticalSignals:o,postCriticalSignals:d,featureFlags:{}});break;case Fe.S.HorizontalBar:TS({action:e,criticalSignals:o,postCriticalSignals:d,featureFlags:{}})}return t.registerAppPhase({phase:g.nh.CRITICAL,signals:o,timeout:(null==a?void 0:a.critical)||6e4}),t.registerAppPhase({phase:g.nh.POST_CRITICAL,signals:d,timeout:(null==a?void 0:a.postCritical)||1e4}),t.appPhases},TS=({criticalSignals:e})=>{e.push(Me.G.QUEUES_APP_HEADER_RENDERED)},bS=({action:e,criticalSignals:n})=>{e===De.uk.view&&(n.push(Me.G.QUEUES_APP_QUEUE_MANAGEMENT_RENDERED),n.push(Me.G.QUEUES_APP_QUICK_ACCESS_RENDERED),n.push(Me.G.QUEUES_APP_DIALPAD_RENDERED))},CS=({criticalSignals:e})=>{e.push(Me.G.QUEUES_APP_REALTIME_PERFORMANCE_RENDERED),e.push(Me.G.QUEUES_APP_STATS_RENDERED),e.push(Me.G.QUEUES_APP_CENTER_RENDERED)},wS=e=>{if(AS(e))return FS(e)?{subNavEntity:DS(e),headerEntity:ES(e),startEntity:MS(e),mainEntity:PS(e),endEntity:RS(e)}:null},IS=()=>{const e=new Map([[k.Rd.IS_GREATER_THAN_0,"0"],[k.Rd.IS_AT_LEAST_947,"33rem"],[k.Rd.IS_AT_LEAST_1350,"37rem"],[k.Rd.IS_AT_LEAST_1500,"41rem"]]);return{startEntity:{[Fe.S.Rail]:{slotWidthOverrides:e}}}},AS=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.queuesanalyticsheadertab,De.py.queuesanalyticsrealtimenavigationitem,De.py.queuesanalyticshistoricalnavigationitem,De.py.queues,De.py.queueuser,De.py.callhistoryrow].includes(t),d=[De.uk.info,De.uk.default,De.uk.list,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},FS=()=>!0,DS=()=>null,ES=({entity:e})=>e,MS=({entity:e})=>e,PS=({entity:e})=>e,RS=()=>null,OS="queues",$S="viewDefaultQueuesApp",LS="viewQueuesApp",xS="switchToCallQueue",BS="selectQueueUser",jS="selectCallHistoryRow",US="switchToQueuesAnalytics",VS="selectRealTimeAnalyticsNavigationItem",WS="selectHistoricalAnalyticsNavigationItem",HS="selectCallQueueOverview",GS="navigateToChannel",JS=()=>({actor:OS,action:$S}),qS=()=>({actor:OS,action:US}),zS=e=>({actor:OS,action:VS,data:e}),QS=e=>({actor:OS,action:WS,data:e}),YS=e=>({actor:OS,action:xS,data:e}),KS=e=>({actor:OS,action:BS,data:e}),XS=e=>({actor:OS,action:jS,data:e}),ZS=e=>({actor:OS,action:HS,data:e}),eT=e=>({actor:OS,action:GS,data:e}),nT={id:"com.microsoft.teams.queues",name:"Queues",actors:[OS],supportedEntities:[De.py.queues,De.py.queueuser,De.py.queuesanalyticsheadertab,De.py.queuesanalyticsrealtimenavigationitem,De.py.queuesanalyticshistoricalnavigationitem,De.py.callhistoryrow],supportedRenderModes:[Fe.S.HorizontalBar,Fe.S.Rail,Fe.S.Main],windowFeatures:{minWidth:800,width:800,minHeight:670,height:600},getDefaultCommand:()=>({type:De.py.queues,action:De.uk.default})};var iT=i(519709);const tT=({commandInput:e,requestContext:{loggerFactory:n}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var i;const{command:{action:t,data:a}}=e,o=n.newLogger("QueuesApp onCommandReceived","apps-queues"),d=e=>{var n;null===(n=o.errorToTelemetry)||void 0===n||n.call(o,e,"cmd_queues_on_command_received",void 0,!0)};if(e.command.actor===OS)switch(t){case $S:return{entity:{type:De.py.queues,action:De.uk.default},command:Object.assign(Object.assign({},aT),{correlation:{source:sn.D.Unknown}})};case LS:return{entity:{type:De.py.queues,action:De.uk.view},command:Object.assign(Object.assign({},aT),{correlation:{source:sn.D.Unknown}})};case xS:if(!oT(a))return void d(`Command '${xS}' requires 'callQueueId' in data`);const e=a;return{entity:{type:De.py.queues,action:De.uk.view,id:JSON.stringify({callQueueId:e.callQueueId,itemType:iT.qG.Queue,isSupervisor:e.isSupervisor,isSupervisorAndAgent:e.isSupervisorAndAgent,channelId:e.channelId})},command:Object.assign(Object.assign({},aT),{correlation:{source:sn.D.QueuesAppHeader}})};case US:return{entity:{type:De.py.queuesanalyticsheadertab,action:De.uk.view},command:Object.assign(Object.assign({},aT),{correlation:{source:sn.D.QueuesAppHeader}})};case VS:return a&&a.realTimeAnalyticsSelectedItemId?{entity:{type:De.py.queuesanalyticsrealtimenavigationitem,action:De.uk.view,id:a.realTimeAnalyticsSelectedItemId},command:Object.assign(Object.assign({},aT),{correlation:{source:sn.D.QueuesAnalyticsLeftNavigation}})}:void d(`Command '${VS}' requires 'realTimeAnalyticsSelectedItemId' in data`);case WS:return a&&a.historicalAnalyticsSelectedItemId?{entity:{type:De.py.queuesanalyticshistoricalnavigationitem,action:De.uk.view,id:a.historicalAnalyticsSelectedItemId},command:Object.assign(Object.assign({},aT),{correlation:{source:sn.D.QueuesAnalyticsLeftNavigation}})}:void d(`Command '${WS}' requires 'historicalAnalyticsSelectedItemId' in data`);case BS:if(!dT(a))return void d(`Command '${BS}' requires 'userId' and 'callQueueId' in data`);const{callQueueId:n,userId:o,isSupervisor:l,itemType:r,showAnalyticsData:s}=a;return{entity:{type:De.py.queueuser,action:De.uk.view,id:JSON.stringify({callQueueId:n,userId:o,isSupervisor:l,showAnalyticsData:s,itemType:r})},command:Object.assign(Object.assign({},aT),{correlation:{source:sn.D.QueuesPeopleManagement}})};case jS:if(!a||!a.callQueueId||!a.row)return void d(`Command '${jS}' requires 'row' and 'callQueueId' in data`);const m=a;return{entity:{type:De.py.callhistoryrow,action:De.uk.view,id:JSON.stringify({callQueueId:m.callQueueId,messageId:null===(i=m.row)||void 0===i?void 0:i.messageId})},entityOptions:m,command:Object.assign(Object.assign({},aT),{correlation:{source:sn.D.CallHistory}})};case HS:if(!lT(a))return void d(`Command '${HS}' requires 'callQueueId' and 'itemType' in data`);const c=a;return{entity:{type:De.py.queues,action:De.uk.view,id:JSON.stringify({callQueueId:c.callQueueId,itemType:c.itemType,isSupervisor:c.isSupervisor,isSupervisorAndAgent:c.isSupervisorAndAgent,channelId:c.channelId})},command:Object.assign(Object.assign({},aT),{correlation:{source:sn.D.QueuesAppQuickAccess}})};case GS:if(!rT(a))return void d(`Command '${GS}' requires 'callQueueId' and 'channelId' in data`);const u=a;return{entity:{type:De.py.callablechannels,action:De.uk.list,id:u.callQueueId,linkedEntity:{id:u.channelId,type:De.py.channels}},command:Object.assign(Object.assign({},aT),{correlation:{source:sn.D.QueuesAnalyticsMain}})};default:d(`Command action '${t}' is not supported by QueuesApp`)}else d(`Command for actor '${e.command.actor}' cannot be handled by QueuesApp`)})),aT={visibilityState:v.fe.show,stateTransition:v.su.flush},oT=e=>{const{callQueueId:n}=e||{};return!!n},dT=e=>{const{userId:n,callQueueId:i}=e||{};return!!n&&!!i},lT=e=>{const{callQueueId:n,itemType:i}=e||{};return!!n&&!!i},rT=e=>{const{channelId:n,callQueueId:i}=e||{};return!!n&&!!i},sT=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(892924),i.e(256045),i.e(241602),i.e(371935),i.e(779478),i.e(400010),i.e(242959),i.e(105434),i.e(160200),i.e(479335),i.e(232236),i.e(169080),i.e(733411),i.e(347761),i.e(9081),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(26466),i.e(911758),i.e(917164),i.e(609633),i.e(868838),i.e(90181),i.e(186443),i.e(68688),i.e(912597),i.e(127919),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(495500),i.e(403936),i.e(450605),i.e(329712),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(451185),i.e(913486),i.e(364315),i.e(713782),i.e(553856),i.e(399286),i.e(425523),i.e(336995),i.e(800866)]).then(i.bind(i,227005)),mT=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(892924),i.e(256045),i.e(241602),i.e(371935),i.e(779478),i.e(400010),i.e(242959),i.e(105434),i.e(160200),i.e(479335),i.e(232236),i.e(169080),i.e(733411),i.e(347761),i.e(9081),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(26466),i.e(911758),i.e(917164),i.e(609633),i.e(868838),i.e(90181),i.e(186443),i.e(68688),i.e(912597),i.e(127919),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(495500),i.e(403936),i.e(450605),i.e(329712),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(451185),i.e(913486),i.e(364315),i.e(713782),i.e(553856),i.e(399286),i.e(425523),i.e(336995),i.e(800866)]).then(i.bind(i,228183)),cT={onEventReceived:({eventInput:{event:e},requestContext:{loggerFactory:n}})=>{const i=n.newLogger("QueuesApp eventHandlers","apps-queues"),{data:t}=e,a="function"==typeof t?t():{};if((0,iT.xt)(e)){const e=a;return!!e.callQueueId?Promise.resolve({command:YS(e)}):(i.error("No callQueueId in event data"),Promise.resolve(void 0))}if((0,iT.E3)(e)){const e=a;return!(!e.userId||!e.callQueueId)?Promise.resolve({command:KS(e)}):(i.error("No userId or callQueueId in event data"),Promise.resolve(void 0))}if((0,iT.gz)(e))return Promise.resolve({command:qS()});if((0,iT.zB)(e)){const e=a;return e.realTimeAnalyticsSelectedItemId?Promise.resolve({command:zS(e)}):(i.error("No queues app analytics tab left rail real time select item id"),Promise.resolve(void 0))}if((0,iT.iX)(e)){const e=a;return e.historicalAnalyticsSelectedItemId?Promise.resolve({command:QS(e)}):(i.error("No queues app analytics tab left rail real time select item id"),Promise.resolve(void 0))}if((0,iT.O8)(e)){const e=a;return!(!e.row||!e.callQueueId)?Promise.resolve({command:XS(e)}):(i.error("No call history row or callQueueId in event data"),Promise.resolve(void 0))}if((0,iT.xV)(e)){const e=a;return e.callQueueId?e.itemType?Promise.resolve({command:ZS(e)}):(i.error("No itemType in event data"),Promise.resolve(void 0)):(i.error("No callQueueId in event data"),Promise.resolve(void 0))}if((0,iT.ix)(e)){const e=a;return e.callQueueId&&e.channelId?Promise.resolve({command:eT(e)}):(i.error("No callQueueId or channelId in event data"),Promise.resolve(void 0))}return Promise.resolve(void 0)}},uT={shouldAddEntitiesToWindowHistory:()=>!0,shouldRestoreClientToEntities:()=>!0,shouldStoreLastVisitedInAppHistory:e=>e.type!==De.py.callhistoryrow},pT=()=>nT.windowFeatures||{},yT=()=>c.RG.QueuesAppSwitch;function vT(){return{eventHandlers:cT,getAppPhases:SS,getAppViewEntities:wS,getAppViewEntitiesProps:IS,getAppWindowFeatures:pT,getCommandScenarioName:yT,getPlatformAppIdForEntity:e=>{var n;return(null===(n=nT.supportedEntities)||void 0===n?void 0:n.includes(e.type))?"a02e4d17-af86-4ceb-9c97-4c2626eb3587":void 0},manifest:nT,onCommandReceived:tT,onBeforeAddToNavigation:uT,render:({appRenderMode:e,onRenderEvent:n,scenarioFactory:i})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const{QueuesAppViewsRenderer:a,LPC:o}=yield((e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const i="queues-app";n("ChunkLoadStarted",{chunkName:i});const[{QueuesAppViewsRenderer:t},{LPC:a}]=yield Promise.all([(0,Pn.mT)(sT,i,e),(0,Pn.mT)(mT,i,e)]);return n("ChunkLoadSucceeded",{chunkName:i}),{QueuesAppViewsRenderer:t,LPC:a}})))(i,n);return(0,Ie.t)(ri.f,Object.assign({namespaces:["queues"],loaderRenderer:null},{children:(0,Ie.t)(o,{children:(0,Ie.t)(Na.p3,{children:(0,Ie.t)(a,{appRenderMode:e})})})}))}))}}const kT={id:"com.microsoft.teams.public-preview",name:"PublicPreviewApp",supportedEntities:void 0,supportedRenderModes:[Fe.S.Main]};function gT(e,n){const{coreSettings:i}=n,{publicPreviewOfficeChannels:t}=i.get(s.J.Core,["publicPreviewOfficeChannels"]);return null==t?void 0:t.includes(e)}const NT=({context:{coreSettings:e,hostCommunicationService:n,loggerFactory:i,scenarioFactory:a,client:o,localStorage:d,windowProvider:l,platformService:r,networkState:m,entityCommanding:u,config:p,clientState:y,rebootService:v,userTrackingService:k}})=>{const g=[],{enablePublicPreviewTACSettings:N}=e.get(s.J.Core),{ring:h}=e.get(s.J.Metadata,["ring"]);return"ring3_6"===(null==h?void 0:h.id)&&r.ecsOverrides.isAssignedRing||N&&g.push(function(e){const{coreSettings:n,hostCommunicationService:i,scenarioFactory:a}=e;return{id:"public-preview-policy-job",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var t,o,d,l,r,m,u;const p=a.newScenario(c.RG.PublicPreviewPolicyJob);p.mark(c.RG.PublicPreviewPolicyJob);const y=yield i.loadModule("publicpreview");if(!y)return void p.fail({reason:"Could not get hostComms"});const{allowPublicPreview:v}=n.get(s.J.Core,["allowPublicPreview"]),{ring:k}=n.get(s.J.Metadata,["ring"]);switch(p.appendEventData({publicPreviewPolicy:null==v?void 0:v.toString(),ring:null===(t=null==k?void 0:k.id)||void 0===t?void 0:t.toString()}),v){case"Forced":if("general"===(null==k?void 0:k.id)){if(yield null===(o=y.setNextLaunchIsPublicPreview)||void 0===o?void 0:o.call(y,!0))return void p.stop({result:"public_preview set to true",reason:"Policy is Forced and ring is general"});p.fail({reason:"No result from setNextLaunchIsPublicPreview"})}else p.stop({result:"public_preview not modified",reason:"Policy is Forced, but ring is not general"});break;case"FollowOfficePreview":if("general"===(null==k?void 0:k.id)){const n=yield null===(d=y.getOfficePreviewChannel)||void 0===d?void 0:d.call(y);return p.appendEventData({officePreviewChannel:n}),n?gT(n,e)?(yield null===(l=y.setNextLaunchIsPublicPreview)||void 0===l?void 0:l.call(y,!0))?void p.stop({result:"public_preview set to true",reason:"Policy is FollowOfficePreview and officeChannel is a preview channel"}):void p.fail({reason:"No result from setNextLaunchIsPublicPreview"}):void p.stop({result:"public_preview not modified",reason:"Policy is FollowOfficePreview, ring is general, but officeChannel is not a preview channel"}):void p.fail({reason:"No result from getOfficePreviewChannel"})}if("ring3_6"===(null==k?void 0:k.id)){const n=yield null===(r=y.getOfficePreviewChannel)||void 0===r?void 0:r.call(y);return p.appendEventData({officePreviewChannel:n}),n?gT(n,e)?void p.stop({result:"public_preview not modified",reason:"Policy is FollowOfficePreview and officeChannel is a preview channel, but ring is already ring3_6"}):(yield null===(m=y.setNextLaunchIsPublicPreview)||void 0===m?void 0:m.call(y,!1))?void p.stop({result:"public_preview set to false",reason:"Policy is FollowOfficePreview and officeChannel is not a preview channel"}):void p.fail({reason:"No result from setNextLaunchIsPublicPreview"}):void p.fail({reason:"No result from getOfficePreviewChannel"})}p.stop({result:"public_preview not modified",reason:"Policy is FollowOfficePreview, but ring is not ring3_6 or general"});break;case"Enabled":p.stop({result:"public_preview not modified",reason:"Policy is Enabled, so public_preview can be set by the user via the UI element"});break;case"Disabled":if("ring3_6"===(null==k?void 0:k.id)){if(yield null===(u=y.setNextLaunchIsPublicPreview)||void 0===u?void 0:u.call(y,!1))return void p.stop({result:"public_preview set to false",reason:"Policy is Disabled, and user is in ring3_6"});p.fail({reason:"No result from setNextLaunchIsPublicPreview"})}else p.stop({result:"public_preview not modified",reason:"Policy is Disabled, but user is not in ring3_6"});break;default:p.stop({result:"public_preview not modified",reason:`allowPublicPreview value is an unknown value: ${v}`})}}))}}({coreSettings:e,hostCommunicationService:n,loggerFactory:i,scenarioFactory:a,client:o,localStorage:d,windowProvider:l,platformService:r,networkState:m,entityCommanding:u,config:p,clientState:y,rebootService:v,userTrackingService:k})),g};function hT(){return{manifest:kT,onExperienceLongIdle:NT,render:({appRenderMode:e})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){return(0,Ie.t)(fT,{appRenderMode:e})}))}}const fT=()=>null,_T={onEventReceived:({eventInput:e})=>{var n,i;if(e.event.type===Ze.uS.requestPersonMoreInfo){const t=null===(i=(n=e.event).data)||void 0===i?void 0:i.call(n);return Promise.resolve({command:on(t)})}return Promise.resolve(void 0)}},ST=()=>Promise.all([i.e(220358),i.e(154972),i.e(68443),i.e(293785),i.e(762498),i.e(609492),i.e(586060)]).then(i.bind(i,663281)),TT=e=>({id:"search-data-load",runOncePerId:!0,job:()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const n=e.newLogger("dataResolverSearchJob","apps-search");n.log("[dataResolversSearchJob] Initializing calling service");try{yield(0,Pn.mT)(ST,"search-data-resolvers")}catch(e){n.error("[dataResolversSearch] Error initializing bundle")}n.log("[dataResolversSearch] Calling service initialized")}))}),bT=({context:{loggerFactory:e}})=>[TT(e)];var CT=i(972300),wT=i(712208);const IT=()=>Promise.all([i.e(917388),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(241602),i.e(976609),i.e(779478),i.e(780208),i.e(363327),i.e(375683),i.e(150328),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(269296),i.e(26466),i.e(462317),i.e(882280),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(613692),i.e(403936),i.e(271428),i.e(207856),i.e(386201),i.e(450605),i.e(769716),i.e(329712),i.e(673758),i.e(839180),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(788842),i.e(494306),i.e(762318),i.e(591822),i.e(931123),i.e(509115),i.e(435933),i.e(761598),i.e(449768),i.e(414875),i.e(927109),i.e(989092),i.e(770342),i.e(800766),i.e(103430),i.e(456904)]).then(i.bind(i,197824)),AT=()=>Promise.all([i.e(762498),i.e(882800)]).then(i.bind(i,572693)),FT="backButton",DT="search-app",ET=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:n,entityCommand:{entity:{type:i,action:a},command:{stateTransition:o}},requestContext:d}=e,{client:l,coreSettings:r}=d,{enablePretriggerImprovement:m,enableAnswersV2:c}=null==r?void 0:r.get(s.J.Serp),u=n.entityOptions||{},p=u.loadBundle,y=u.substrateSearchWarmUpInExpRenderer;if(i===De.py.search&&a===De.uk.view&&p)return yield function(e,n){return(0,t.__awaiter)(this,void 0,void 0,(function*(){n?(0,Pn.mT)(wT.KL,"search-answer-v2"):(0,Pn.mT)(CT.tY,"search-answer"),MT(e)}))}(d,!!c),Promise.resolve(void 0);if(i===De.py.search&&a===De.uk.view&&y){const{enableSerpServiceWarmupOnPowerBarClick:e}=null==r?void 0:r.get(s.J.Serp);if(e)yield MT(d);else{const{searchWarmup:e}=yield(0,Pn.mT)(IT,DT);yield l.query({query:e,variables:{scenario:"powerbar",cvid:u.conversationId}})}return Promise.resolve(void 0)}if(m&&i===De.py.search&&a===De.uk.view&&"flush"===o&&u.searchQuery&&"TabSwitch"!==u.entrySource){const{searchQuery:e,logicalId:n,conversationId:i,entrySource:t,navLocationContext:a,currentTab:o,filterSet:d}=u,{enableNavLocationContext:m}=null==r?void 0:r.get(s.J.Serp),c=t===FT,{searchServiceCache:p,Tabs:y}=yield(0,Pn.mT)(AT,"services-io-search");p.clearAll(),m&&a&&p.setNavLocationContext(a);const v=(0,et.v4)(),k=(0,et.v4)();p.setUpstreamTelmetryIds(v,k);const{searchPreTriggerQuery:g,numberOfAllPageResults:N}=yield(0,Pn.mT)(IT,DT);yield l.query({query:g,variables:{searchTerm:e,noOfResults:N,pageNumber:0,correlationId:v,allFilters:d?d[y.All]:{},messageFilters:d?d[y.All]:{},searchStartCorrelationId:k,currentTab:o,isBackButton:c,conversationId:i,logicalId:n}})}return Promise.resolve(n)}));function MT(e){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const{client:n,coreSettings:i}=e,{enableSerpServiceToPrewarm:t}=null==i?void 0:i.get(s.J.Serp),{pingSearch:a}=yield(0,Pn.mT)(IT,DT);t&&(yield n.mutate({mutation:a,variables:{correlationId:(0,et.v4)()}}))}))}const PT=({appRenderMode:e})=>{const n=new Ee.H,i=[],t=[];if(e===Fe.S.Main)RT({featureFlags:{},criticalSignals:i,postCriticalSignals:t});return n.registerAppPhase({phase:g.nh.CRITICAL,signals:i,timeout:1e4}),n.registerAppPhase({phase:g.nh.POST_CRITICAL,signals:t,timeout:1e4}),n.appPhases},RT=({criticalSignals:e})=>{e.push(Me.G.SEARCH_RESULTS_RENDERED)},OT=e=>{if($T(e))return LT(e)?{subNavEntity:xT(e),headerEntity:BT(e),startEntity:jT(e),mainEntity:UT(e),endEntity:VT(e)}:null},$T=({contextEntity:e,entity:n,layoutMode:i})=>{const{action:t=null,type:a}=Object.assign({},n),o=[v.lO.focus,v.lO.standard].includes(i),d=[De.py.search,De.py.openfeedbackdialog].includes(a),l=[De.uk.default,De.uk.view],r=t&&l.includes(t),s=e&&e.action&&e.type===De.py.chats;return!(!o||!d||!r&&!s)},LT=()=>!0,xT=()=>null,BT=({contextEntity:e})=>e&&e.action&&e.type===De.py.chats?e:null,jT=()=>null,UT=({entity:e,contextEntity:n})=>n&&n.action&&n.type===De.py.chats?n:e,VT=()=>null,WT={id:"com.microsoft.teams.search",name:"Search",getLocalizedName:e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("search"),e.stringTranslate("search","search_app_name")})),supportedEntities:[De.py.search,De.py.openfeedbackdialog],supportedRenderModes:[Fe.S.Main,Fe.S.Modal],windowFeatures:{minWidth:1600,width:1600,minHeight:1e3,height:1e3}};var HT=i(47580);const GT={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsSearchFloodgateLogActivityMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activityName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"increment"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"floodgateLogActivity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activityName"},value:{kind:"Variable",name:{kind:"Name",value:"activityName"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"increment"},value:{kind:"Variable",name:{kind:"Name",value:"increment"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]};class JT extends HT.i{constructor(){super(gn.Yg.LogActivityTask,["client","hostCommunicationService","coreSettings","loggerFactory"])}execute(e){var n;return(0,t.__awaiter)(this,void 0,void 0,(function*(){const{client:i,hostCommunicationService:t,coreSettings:a,loggerFactory:o}=e,d=(null==a?void 0:a.get(s.J.Serp).enableAutosuggestFps)||!1,l=null==a?void 0:a.get(s.J.SurveyForm).enableCsatTaskRegistration;if(d&&!l){const e=yield null==t?void 0:t.loadModule("search"),a=o.newLogger("LogActivityTaskRegistered","apps-search");null===(n=null==e?void 0:e.registerForLogActivity)||void 0===n||n.call(e,(e=>{a.log(`activity ${e.activityName} and increment ${e.incrementValue}`),"teamsSearchFps"===e.activityName&&(e=>{e.mutate({mutation:GT,variables:{activityName:"teamsSearchFps",increment:1}})})(i)}))}}))}}var qT=i(77644);const zT=(e,n,i)=>{var t;const{userPreferences:a,coreSettings:o,layoutMode:d}=n,l=e.mainEntity;if(!(null===(t=null==o?void 0:o.get(s.J.Serp))||void 0===t?void 0:t.enableBackButtonFixForTabSwitch)||!l)return;qT.P.clear();const r=JSON.stringify(Object.assign(Object.assign({},JSON.parse(l.options||"{}")),{entrySource:FT}));return OT({contextEntity:null,coreSettings:o,entity:Object.assign(Object.assign({},l),{options:r}),layoutMode:d,userPreferences:a})},QT=()=>Promise.all([i.e(917388),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(241602),i.e(976609),i.e(779478),i.e(780208),i.e(363327),i.e(375683),i.e(150328),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(269296),i.e(26466),i.e(462317),i.e(882280),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(613692),i.e(403936),i.e(271428),i.e(207856),i.e(386201),i.e(450605),i.e(769716),i.e(329712),i.e(673758),i.e(839180),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(788842),i.e(494306),i.e(762318),i.e(591822),i.e(931123),i.e(509115),i.e(435933),i.e(761598),i.e(449768),i.e(414875),i.e(927109),i.e(989092),i.e(770342),i.e(800766),i.e(103430),i.e(456904)]).then(i.bind(i,197824)),YT=()=>Promise.all([i.e(917388),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(241602),i.e(976609),i.e(779478),i.e(780208),i.e(363327),i.e(375683),i.e(150328),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(269296),i.e(26466),i.e(462317),i.e(882280),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(613692),i.e(403936),i.e(271428),i.e(207856),i.e(386201),i.e(450605),i.e(769716),i.e(329712),i.e(673758),i.e(839180),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(788842),i.e(494306),i.e(762318),i.e(591822),i.e(931123),i.e(509115),i.e(435933),i.e(761598),i.e(449768),i.e(414875),i.e(927109),i.e(989092),i.e(770342),i.e(800766),i.e(103430),i.e(456904)]).then(i.bind(i,228183)),KT=()=>Promise.all([i.e(364037),i.e(769415)]).then(i.bind(i,194775)),XT=()=>WT.windowFeatures||{};function ZT(){const e=()=>null;return{eventHandlers:_T,getAppPhases:PT,onRegister:e=>{e.registerTask(new Si.K),e.registerTask(new JT)},getAppViewEntities:OT,getAppWindowFeatures:XT,manifest:WT,render:({appRenderMode:n,coreSettings:i,onRenderEvent:a,scenarioFactory:o,loggerFactory:d})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main){const e="search-app";a("ChunkLoadStarted",{chunkName:e});const{SearchViewsRenderer:n}=yield(0,Pn.mT)(QT,e),{enableEntityMoreInfo:t}=i.get(s.J.Core),o=({children:e})=>(0,Ie.t)(Ae.Fragment,{children:e}),{LPC:d}=t?{LPC:o}:yield(0,Pn.mT)(YT,e),l=t?o:Na.p3;a("ChunkLoadSucceeded",{chunkName:e});const r="search";return(0,Ie.t)(ri.f,Object.assign({namespace:"messaging",loaderRenderer:null},{children:(0,Ie.t)(d,Object.assign({appName:r},{children:(0,Ie.t)(l,{children:(0,Ie.t)(n,{})})}))}))}if(n===Fe.S.Modal){const e="feedback-renderer",n=d.newLogger(e,"apps-search");try{a("ChunkLoadStarted",{chunkName:e});const{FeedbackDialog:n}=yield(0,Pn.mT)(KT,e,o);return a("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(n,{})}catch(e){n.error(`chunk load failed with ${e}`)}}return(0,Ie.t)(e,{})})),onPreWarm:bT,onBeforeCommandHandled:ET,onBeforeNavigationFromHistory:zT}}const eb=e=>{if(nb(e))return ib(e)?{subNavEntity:tb(e),headerEntity:ab(e),startEntity:ob(e),mainEntity:db(e),endEntity:lb(e)}:null},nb=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.settingsstore,De.py.settingsstorecallqueue,De.py.settingsstoredelegator].includes(t),d=[De.uk.create,De.uk.default,De.uk.list,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},ib=()=>!0,tb=({entity:e})=>e,ab=({entity:e})=>e,ob=()=>null,db=({entity:e})=>e,lb=()=>null,rb=({areEmptySlotsTransparent:e,coreSettings:n})=>{const{enableMercuryDesign:i}=(null==n?void 0:n.get(s.J.MercuryDesign))||{};return!!(null==n?void 0:n.get(s.J.Core).enableTransparentLeftRail)||e||!(e=>{var n,i;const{leftRailDefaultBackgroundMicaDisabled:t}=null!==(n=null==e?void 0:e.get(s.J.Core))&&void 0!==n?n:{},{deviceInfo:a}=null!==(i=null==e?void 0:e.get(s.J.Platform))&&void 0!==i?i:{},o=a&&(0,xe.Y)(a);return!!t||!!o})(n)&&!!i},sb=({areEmptySlotsTransparent:e,coreSettings:n})=>({subNavEntity:{[Fe.S.Rail]:{areSlotShadowsDisabled:e,isBackgroundTransparent:rb({areEmptySlotsTransparent:e,coreSettings:n}),isColorSchemeDefaultBackground3:!e}}}),mb={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"connectedAccountStateEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectedAccountStateEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errorState"},__type:{kind:"NamedType",name:{kind:"Name",value:"ContactsSyncError"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"source"},__type:{kind:"NamedType",name:{kind:"Name",value:"ContactsSyncSource"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ConnectedAccountStateEvent"}},arguments:[]}]}}]};const cb="settings",ub="openScheduleOOF",pb="setStatusMessage",yb={id:"com.microsoft.teams.settings",name:"Settings",actors:[cb],supportedEntities:[De.py.settingsstore,De.py.settingsstorecallqueue,De.py.settingsstoredelegator],supportedRenderModes:[Fe.S.HorizontalBar,Fe.S.Main,Fe.S.Rail],getDefaultCommand:()=>({action:De.uk.default,type:De.py.settingsstore})};var vb=i(935915),kb=i(84642),gb=i(492963),Nb=i(921728),hb=i(250236),fb=i(326768);const _b="APPS_SETTINGS_ERROR_CLEANUP",Sb=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{client:n,coreSettings:i,scenarioFactory:t,loggerFactory:a}=e,{enableContactsSync:o}=i.get(s.J.People),d=t.newScenario(c.RG.ConnectedCalendarCleanup),l=a.newLogger("[ConnectedCalendar-Cleanup]","apps-settings"),r=yield Tb(n,l,d),m=null==r?void 0:r.find((e=>e.isSyncAllowed));if(m){const e=yield bb(n,!!o,l,d),{accountAddress:i,accountId:t,source:a}=m,r=yield wb(n,i,l,d);let s=!1;if(e){const i=[],t=e.find((e=>"Google"===e.source));if(t){const e=Object.assign(Object.assign({},t),{isSyncAllowed:!1});i.push(e),s=yield Ib(n,i,l,d)}}const c=yield Cb(n,t,i,a,l,d);return d.stop(),c&&r&&s}return d.fail({errors:`${_b} connected calendar information is not found `}),!1})),Tb=(e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){try{const{data:n}=yield e.query({query:fb.M,fetchPolicy:"network-only",variables:{callerInfo:_b}});return n.syncConnectedCalendarSettings}catch(e){n.log(`${_b} Sync Connected Calendar Settings: ${e}`),i.fail({errors:`${_b} Sync Connected Calendar Settings Failed! `})}})),bb=(e,n,i,a)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){try{const{data:i}=yield e.query({query:kb.uJ,fetchPolicy:"network-only",variables:{isContactsSyncEnabled:n,callerInfo:_b},notifyOnNetworkStatusChange:!0});return i.contactsSyncSettings}catch(e){return i.log(`${_b} Get Contacts Sync Settings: ${e}`),void a.fail({errors:`${_b} Get Contacts Sync Settings Failed! `})}})),Cb=(e,n,i,a,o,d)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){try{yield e.mutate({mutation:gb.P,fetchPolicy:"no-cache",variables:{accountId:n,callerInfo:_b,accountAddress:i,provider:a}})}catch(e){return o.log(`${_b} Hard Delete External Account: ${e}`),d.fail({errors:`${_b} Hard Delete External Account Failed! `}),!1}return!0})),wb=(e,n,i,a)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){try{e.mutate({mutation:Nb.i,fetchPolicy:"no-cache",variables:{mailboxAddress:n}})}catch(e){return i.log(`${_b} Delete Calendar Events Cache: ${e}`),a.fail({errors:`${_b} Delete Calendar Events Cache Failed! `}),!1}return!0})),Ib=(e,n,i,a)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){try{e.mutate({mutation:hb._I,fetchPolicy:"no-cache",variables:{callerInfo:_b,syncSettings:n}})}catch(e){return i.log(`${_b} Publish Contacts Sync Settings: ${e}`),a.fail({errors:`${_b} Publish Contacts Sync Settings Failed! `}),!1}return!0})),Ab=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{entityCommand:n,entityCommand:{entity:{id:i,type:t,action:a},command:{correlation:{source:o}}},requestContext:d}=e;if(o===sn.D.CalendarSyncBanner&&i===za.Y.Calendar&&t===De.py.settingsstore&&a===De.uk.view){const{client:e,coreSettings:i,scenarioFactory:t,loggerFactory:a}=d,o={client:e,coreSettings:i,scenarioFactory:t,loggerFactory:a};try{yield Sb(o)}catch(e){}const l=n.entityOptions||{};return l.callerInfo="CalendarSyncBanner",l.callerParam={isCalendarConnected:!1,source:vb.H$.Google,accountId:"",accountAddress:""},n.entityOptions=l,Promise.resolve(n)}return Promise.resolve(n)})),Fb={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"calendarSyncStateUpdates"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"eventNames"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CalendarSyncStatusEnum"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"calendarSyncStateUpdates"},arguments:[{kind:"Argument",name:{kind:"Name",value:"eventNames"},value:{kind:"Variable",name:{kind:"Name",value:"eventNames"}},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CalendarSyncStatusEnum"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"eventName"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"payload"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CalendarSyncPayload"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"endDate"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mailboxAddress"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConnectedCalendarSyncPayload"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"endDate"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mailboxAddress"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"error"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"message"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ConnectedCalendarSyncError"}},arguments:[]}]}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"CalendarSyncPayloads"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CalendarUpdateEvent"}}}}]}}]},Db=["CONNECTED_CALENDAR_SYNCING","CONNECTED_CALENDAR_SYNC_FAILED","CONNECTED_CALENDAR_UPTO_DATE"];var Eb=i(665388);const Mb={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsSettingsSyncUnifiedCalendarSyncStateSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"syncUnifiedCalendarSyncState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"syncState"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"payload"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"endDate"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"error"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"UnifiedCalendarSyncError"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"UnifiedCalendarSyncStateUpdatePayload"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UnifiedCalendarSyncStateUpdate"}}},arguments:[]}]}}]};const Pb={onEventReceived:({eventInput:e})=>{var n,i;if(e.event.type===Ze.uS.requestPersonMoreInfo){const t=null===(i=(n=e.event).data)||void 0===i?void 0:i.call(n);return Promise.resolve({command:on(t)})}return Promise.resolve(void 0)}};var Rb=i(3959);const Ob="settings_on_command_received",$b=({commandInput:e,requestContext:{loggerFactory:n}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var i,t;const{command:{action:a}}=e,o=n.newLogger("SettingsApp[onCommandReceived]","apps-settings");if(e.command.actor===cb)return a===ub?{entity:{type:De.py.settingsstore,action:De.uk.view,id:Rb.l.OOFSettingsPage},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,correlation:{source:sn.D.ScheduleOOFFromMeMenu}}}:void(null===(t=o.errorToTelemetry)||void 0===t||t.call(o,`Command action '${a}' is not supported by SettingsApp.`,Ob));null===(i=o.errorToTelemetry)||void 0===i||i.call(o,`Command for actor '${e.command.actor}' cannot be handled by SettingsApp.`,Ob)}));function Lb(e){const{coreSettings:n,hostCommunicationService:i,loggerFactory:a}=e;return{id:"m365-links-set-policy-value-job",job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var e,t,o,d;const l=a.newLogger("M365LinksPolicyJob","apps-settings"),{teamsLinkBrowserPreferencePolicy:r}=n.get(s.J.Files),m=yield i.loadModule("m365link");if(m)switch(r){case 0:l.log("Setting M365 links policy to default browser"),yield null===(t=m.setM365LinksPolicy)||void 0===t?void 0:t.call(m,0);break;case 1:l.log("Setting M365 links policy to Microsoft Edge"),yield null===(o=m.setM365LinksPolicy)||void 0===o?void 0:o.call(m,1);break;default:return l.log("No M365 links policy value. Setting M365 links policy to undefined"),void(yield null===(d=m.setM365LinksPolicy)||void 0===d?void 0:d.call(m,void 0))}else null===(e=l.errorToTelemetry)||void 0===e||e.call(l,"Could not get hostComms","settings_m365_links_policy_job")}))}}const xb=()=>Promise.all([i.e(917388),i.e(790026),i.e(590393),i.e(141603),i.e(256045),i.e(65477),i.e(371935),i.e(268372),i.e(755684),i.e(315215),i.e(191673),i.e(400010),i.e(239234),i.e(551830),i.e(600565),i.e(357142),i.e(272953),i.e(347761),i.e(409201),i.e(269296),i.e(116187),i.e(15931),i.e(560947),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(842529),i.e(495500),i.e(722198),i.e(394413),i.e(477708),i.e(816906),i.e(297312),i.e(165665),i.e(442766),i.e(863698),i.e(328135),i.e(103246),i.e(104683),i.e(707014),i.e(779792),i.e(159885),i.e(865381),i.e(231523),i.e(112665),i.e(125736),i.e(425523),i.e(347271),i.e(318355),i.e(149179),i.e(918607),i.e(778681),i.e(862690)]).then(i.bind(i,597569)),Bb=()=>Promise.all([i.e(917388),i.e(892924),i.e(779478),i.e(320794),i.e(475063),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(26466),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(403936),i.e(450605),i.e(329712),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(285883)]).then(i.bind(i,228183)),jb=({children:e})=>(0,Ie.t)(Ae.Fragment,{children:e});function Ub(){return{eventHandlers:Pb,getAppViewEntities:eb,getAppViewEntitiesProps:sb,onBeforeCommandHandled:Ab,manifest:yb,onCommandReceived:$b,onPreWarm:e=>{const{context:n}=e,i=n.coreSettings,{enableSyncStateBanner:a}=i.get(s.J.People),{enableCalendarSyncStateBanner:o,enableUnifiedCalendarEvents:d}=i.get(s.J.Calendar),l=[];if(a&&l.push(function(e,n){const{client:i,entityCommanding:a,i18n:o,loggerFactory:d,coreSettings:l}=e,r=d.newLogger("connected-account-state-subscription-job","apps-settings"),m=i,{enableGoogleContactSyncNotification:c}=l.get(s.J.Growth);let u;return{id:"connected-account-state-subscription",job:()=>{try{u=m.subscribe({query:mb}).filter((e=>{var n,i;return!!(null===(i=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.connectedAccountStateEvent)||void 0===i?void 0:i.errorState)})).subscribe((e=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const i=e.data.connectedAccountStateEvent;"ConnectedAccountsSyncError"===i.errorState?a.shell.showBanner({id:"connected-account-state-banner",source:sn.D.ContactsSyncBanner,cause:"ConnectedAccountError",intentLevel:"Neutral",text:o.stringTranslate("people","google_sign_in_required"),action:{text:o.stringTranslate("people","go_to_settings"),command:{entity:{type:"settingsstore",action:"view",id:"privacy_manage_contacts_sync"},command:{stateTransition:"flush",visibilityState:"show",correlation:{source:sn.D.ContactsSyncBanner}}},dismissOnAction:!0},dismissable:!0,duration:0,bannerScenario:"connected_account_sync_error"}):c&&"None"===i.errorState&&"Google"===i.source&&a.esp.displaySurface("contactSyncConfirmationNotification"),null==n||n()}))))}catch(e){const n=`Failed connectedAccountStateEventJob with error: ${e&&e.message}, errorCode ${e&&e.code}`;u.unsubscribe(),r.error(n)}}}}(n)),o){const e=d?function(e,n){const{client:i,entityCommanding:a,i18n:o,loggerFactory:d}=e,l=d.newLogger("unified-calendar-sync-state-job","apps-settings");let r;return{id:"unified-calendar-sync-state-job",job:()=>{try{r=i.subscribe({query:Mb,fetchPolicy:"no-cache"}).subscribe((i=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var t,d,l,r,s;const m=null===(d=null===(t=null==i?void 0:i.data)||void 0===t?void 0:t.syncUnifiedCalendarSyncState)||void 0===d?void 0:d.syncState,c=null===(r=null===(l=null==i?void 0:i.data)||void 0===l?void 0:l.syncUnifiedCalendarSyncState)||void 0===r?void 0:r.payload;if(m===Eb.N.UNIFIED_CALENDAR_SYNC_FAILED)switch(null===(s=null==c?void 0:c.error)||void 0===s?void 0:s.code){case gn.jK.ConnectedAccountNotFound:case gn.jK.ShadowMailboxDeleted:yield Sb(e);break;case gn.jK.Unauthorized:case gn.jK.UnauthorizedAccess:case gn.jK.ShadowTokenRevoked:case gn.jK.ShadowTokenExpired:case gn.jK.ShadowRefreshTokenExpired:a.shell.showBanner({id:"unified-calendar-sync-state-banner",source:sn.D.CalendarSyncBanner,cause:"ConnectedAccountError",intentLevel:"Severe",text:o.stringTranslate("calendar","tfl_cc_connect_external_account_banner_error",{provider:"Google"}),action:{text:o.stringTranslate("calendar","tfl_cc_banner_go_to_settings_button_text"),command:{entity:{type:"settingsstore",action:"view",id:za.Y.Calendar},command:{stateTransition:"flush",visibilityState:"show",correlation:{source:sn.D.CalendarSyncBanner}}},dismissOnAction:!0},dismissable:!0,duration:0,bannerScenario:"unified_calendar_sync_error"})}null==n||n()}))))}catch(e){const n=`Failed createUnifiedCalendarSyncStateJob with error: ${null==e?void 0:e.message}, errorCode ${null==e?void 0:e.code}`;r.unsubscribe(),l.error(n)}}}}(n):function(e,n){const{client:i,entityCommanding:a,i18n:o,loggerFactory:d}=e,l=d.newLogger("connected-calendar-sync-state-job","apps-settings"),r=i;let s;return{id:"connected-calendar-sync-state-job",job:()=>{try{s=r.subscribe({query:Fb,fetchPolicy:"no-cache",variables:{eventNames:Db}}).subscribe((i=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var t,d,l,r,s,m;const c=null===(d=null===(t=null==i?void 0:i.data)||void 0===t?void 0:t.calendarSyncStateUpdates)||void 0===d?void 0:d.eventName,u=null===(m=null===(s=null===(r=null===(l=null==i?void 0:i.data)||void 0===l?void 0:l.calendarSyncStateUpdates)||void 0===r?void 0:r.payload)||void 0===s?void 0:s.error)||void 0===m?void 0:m.code;if("CONNECTED_CALENDAR_SYNC_FAILED"===c)switch(u){case gn.jK.ConnectedAccountNotFound:case gn.jK.ShadowMailboxDeleted:yield Sb(e);break;case gn.jK.Unauthorized:case gn.jK.UnauthorizedAccess:case gn.jK.ShadowTokenRevoked:case gn.jK.ShadowTokenExpired:case gn.jK.ShadowRefreshTokenExpired:a.shell.showBanner({id:"connected-calendar-sync-state-banner",source:sn.D.CalendarSyncBanner,cause:"ConnectedAccountError",intentLevel:"Severe",text:o.stringTranslate("calendar","tfl_cc_connect_external_account_banner_error",{provider:"Google"}),action:{text:o.stringTranslate("calendar","tfl_cc_banner_go_to_settings_button_text"),command:{entity:{type:"settingsstore",action:"view",id:za.Y.Calendar},command:{stateTransition:"flush",visibilityState:"show",correlation:{source:sn.D.CalendarSyncBanner}}},dismissOnAction:!0},dismissable:!0,duration:0,bannerScenario:"connected_calendar_sync_error"})}null==n||n()}))))}catch(e){const n=`Failed createConnectedCalendarSyncStateJob with error: ${null==e?void 0:e.message}, errorCode ${null==e?void 0:e.code}`;s.unsubscribe(),l.error(n)}}}}(n);l.push(e)}return l},onUserWindowPreWarm:e=>{const{context:n}=e,i=n.coreSettings,{enableM365LinksSettings:t}=i.get(s.J.Host);return t?[Lb(n)]:[]},render:({appRenderMode:e,coreSettings:n,onRenderEvent:i,scenarioFactory:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t="settings-app";i("ChunkLoadStarted",{chunkName:t});const{SettingsViewsRenderer:o}=yield(0,Pn.mT)(xb,t,a),{enableEntityMoreInfo:d}=n.get(s.J.Core),{LPC:l}=d?{LPC:jb}:yield(0,Pn.mT)(Bb,t,a),r=d?jb:Na.p3;return i("ChunkLoadSucceeded",{chunkName:t}),(0,Ie.t)(l,{children:(0,Ie.t)(r,{children:(0,Ie.t)(o,{appRenderMode:e})})})}))}}const Vb={getDefaultCommand:()=>({type:De.py.email,action:De.uk.create}),id:"com.microsoft.teams.share-email",name:"ShareEmailApp",supportedEntities:[De.py.email],supportedRenderModes:[Fe.S.Main],windowFeatures:{minWidth:530,width:748,minHeight:490,height:691}},Wb=e=>{if(Hb(e))return Gb(e)?{subNavEntity:Jb(e),headerEntity:qb(e),startEntity:zb(e),mainEntity:Qb(e),endEntity:Yb(e)}:null},Hb=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.email].includes(t),d=[De.uk.default,De.uk.create],l=i&&d.includes(i);return!!(a&&o&&l)},Gb=()=>!0,Jb=()=>null,qb=()=>null,zb=()=>null,Qb=({entity:e})=>e,Yb=()=>null,Kb=({appRenderMode:e})=>{const n=new Ee.H,i=[];return e===Fe.S.Main&&i.push(Me.G.SHARE_PAGE_RENDERED),n.registerAppPhase({phase:g.nh.CRITICAL,signals:i,timeout:2e4}),n.appPhases},Xb={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsShareEmailSttoInstallMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shareToTeamsInstall"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]}]}}]},Zb="share_to_teams_installed",eC=({context:{coreSettings:e,localStorage:n,authenticationUser:i,client:a,loggerFactory:o,scenarioFactory:d}})=>{const{enableSttoInstall:l}=e.get(s.J.Outlook),r={id:"share-to-teams-outlook-install",runOncePerId:!0,job:()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){if(l){const t=function(e){return e.cancelExistingAndCreateScenario(c.RG.STTOInstall,"Share to teams Install")}(d),{isOnCloud:l,isMailboxDiscoverable:r}=e.get(s.J.Messaging),m=o.newLogger("ShareToTeamsApp Install","apps-share-email"),u=a,p=(null==n?void 0:n.get(Zb))||!1,y=(null==i?void 0:i.role)===Jy.w4.Guest;if(l&&r&&!y&&!p)try{const{data:e}=yield u.mutate({mutation:Xb});(null==e?void 0:e.shareToTeamsInstall)?(m.log("ShareToTeams install successful"),null==n||n.trySet(Zb,"true","Messaging"),t.stop()):(m.log("ShareToTeams install not successful"),t.fail({errors:"ShareToTeams install not successful"}))}catch(e){m.log("ShareToTeams install mutation unexpectedly failed"),t.fail({errors:"ShareToTeams install mutation unexpectedly failed"})}else m.log("Skipping ShareToTeams install"),t.cancel({reason:"Skipping ShareToTeams install"})}}))};return[r]};const nC=({context:{coreSettings:e,localStorage:n,loggerFactory:i}})=>{const{enableChannelLocalCache:a,enableClearTeamsListLocalStorage:o}=e.get(s.J.Search);return[{id:"share-to-teams-clear-teams-list-localstorage",runOncePerId:!0,job:()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){if(!a&&o){const e=i.newLogger("ShareToTeamsApp ClearTeamsListLocalStorage","apps-share-email");try{null==n||n.remove("teams-list")}catch(n){e.warn("Failed to clear teams list localstorage")}}}))}]};var iC;!function(e){e.DeepLinkNotEnabled="deeplink-not-enabled-error",e.MissingEmailRestId="missing-emailRestId-error"}(iC||(iC={}));const tC=e=>{try{return JSON.parse(`[${e}]`)}catch(e){return[]}},aC=(e,n,i)=>{const{emailRestId:t,attachmentSize:a,attachmentCount:o,fileTypes:d,from:l,toRecipients:r,ccRecipients:s,cloudAttachments:m,outlookTid:c,outlookUid:u,outlookSmtpAddress:p}=e;return Promise.resolve({entityCommand:{entity:{type:De.py.email,id:t,action:i},command:{visibilityState:v.fe.show,stateTransition:v.su.new,correlation:{id:n,startTimestamp:Date.now(),source:sn.D.ShareEmail}},entityOptions:{emailRestId:t,correlationId:n,attachmentSize:a,attachmentCount:o,fileTypes:d,from:l,toRecipients:r,ccRecipients:s,cloudAttachments:m,outlookTid:c,outlookUid:u,outlookSmtpAddress:p}},metadata:{allowAnonymous:!1}})},oC=[{filter:"/l/share-email",execute:({deeplinkUrl:e,context:{coreSettings:n}})=>{if(!dC(n))return Promise.reject({message:iC.DeepLinkNotEnabled});const{entityOptions:i,correlationId:t}=(e=>{var n,i,t,a,o,d,l,r,s,m,c,u;const{pathname:p,searchParams:y}=e,v=p.split("/"),k=v[v.length-1],g=Number(y.get("attachmentSize"))||0,N=Number(y.get("attachmentCount"))||0,h=null!==(i=null===(n=y.get("fileTypes"))||void 0===n?void 0:n.split(","))&&void 0!==i?i:[],f=null!==(t=y.get("from"))&&void 0!==t?t:"",_=null!==(o=null===(a=y.get("toRecipients"))||void 0===a?void 0:a.split(","))&&void 0!==o?o:[],S=null!==(l=null===(d=y.get("ccRecipients"))||void 0===d?void 0:d.split(","))&&void 0!==l?l:[],T=null!==(r=y.get("cloudAttachments"))&&void 0!==r?r:"";return{entityOptions:{emailRestId:k,attachmentSize:g,attachmentCount:N,fileTypes:h,from:f,toRecipients:_,ccRecipients:S,cloudAttachments:tC(T),outlookTid:null!==(s=y.get("tid"))&&void 0!==s?s:"",outlookUid:null!==(m=y.get("uid"))&&void 0!==m?m:"",outlookSmtpAddress:null!==(c=y.get("userEmail"))&&void 0!==c?c:""},correlationId:null!==(u=y.get("correlationId"))&&void 0!==u?u:""}})(e);return i.emailRestId?aC(i,t,De.uk.create):Promise.reject({message:iC.MissingEmailRestId})}}],dC=e=>!!(null==e?void 0:e.get(s.J.Outlook).enableDeepLinkShareEmail),lC=()=>Promise.all([i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(241602),i.e(976609),i.e(1053),i.e(365718),i.e(9081),i.e(150486),i.e(757343),i.e(37943),i.e(212947),i.e(68688),i.e(912597),i.e(718194),i.e(68792),i.e(481020),i.e(495500),i.e(839074),i.e(55587),i.e(827265),i.e(989430),i.e(463686)]).then(i.bind(i,738572)),rC=e=>{e.registerTask(new Si.K)},sC=({windowOptions:e})=>{var n,i,t,a;return e?{height:e.height,left:e.left,top:e.top,width:e.width}:{minHeight:null===(n=Vb.windowFeatures)||void 0===n?void 0:n.height,minWidth:null===(i=Vb.windowFeatures)||void 0===i?void 0:i.width,height:null===(t=Vb.windowFeatures)||void 0===t?void 0:t.height,width:null===(a=Vb.windowFeatures)||void 0===a?void 0:a.width}};function mC(){const e=()=>null;return{getAppPhases:Kb,getAppViewEntities:Wb,getAppWindowFeatures:sC,manifest:Vb,onBeforeDeeplinkParsed:oC,onRegister:rC,render:({appRenderMode:n,scenarioFactory:i})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main){const{ShareFormEmail:e}=yield(0,Pn.mT)(lC,"share-form-email-entry",i);return(0,Ie.t)(e,{})}return(0,Ie.t)(e,{})})),onPreWarm:eC,onExperienceLongIdle:nC}}const cC="/l/fileshare";const uC=[{filter:cC,execute:({deeplinkUrl:e,context:{coreSettings:n}})=>{if(!pC(n)){const e="share to files is not enabled";return Promise.reject(e)}const{pathname:i,search:t}=e;if(i.startsWith(cC)){const e=t.split(/[/?&=]/);if(e.length>0){const n=e[e.length-1];return Promise.resolve(function(e){return{entityCommand:{entity:{type:De.py.chats,action:De.uk.share,id:Er.FX},command:{stateTransition:v.su.new,visibilityState:v.fe.show,correlation:{id:(0,et.v4)(),startTimestamp:Date.now(),source:sn.D.OSFileShareEvent}},entityOptions:{inviteLinkType:ym.DL.FileShare,filesUrl:e}},metadata:{allowAnonymous:!1}}}(n))}}return Promise.reject("No deeplink type found for the specified prefixType")}}],pC=e=>!!(null==e?void 0:e.get(s.J.WindowsSignatureExperiences).enableShareFilesToTeams),yC={id:"com.microsoft.teams.share-to-chat",name:"ShareToChatApp",supportedRenderModes:[Fe.S.Main]};function vC(){const e=()=>null;return{manifest:yC,render:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){return(0,Ie.t)(e,{})})),onBeforeDeeplinkParsed:uC}}const kC=e=>{if(gC(e))return NC(e)?{subNavEntity:hC(e),headerEntity:fC(e),startEntity:_C(e),mainEntity:SC(e),endEntity:TC(e)}:null},gC=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.standard].includes(e),o={[De.py.brbfeedbackdialog]:[De.uk.default,De.uk.view],[De.py.tpndialog]:[De.uk.default,De.uk.view],[De.py.appswitcherdesktopactivecalldialog]:[De.uk.default,De.uk.view],[De.py.appswitchert1downloaddialog]:[De.uk.default,De.uk.view],[De.py.appswitcherwebactivecalldialog]:[De.uk.default,De.uk.view],[De.py.appswitcherwebmultipletabsdialog]:[De.uk.default,De.uk.view],[De.py.signoutdialog]:[De.uk.default,De.uk.view],[De.py.identitydialog]:[De.uk.create],[De.py.joinlinkdialog]:[De.uk.default,De.uk.view],[De.py.premiumtrialdialog]:[De.uk.default,De.uk.view],[De.py.bannerNotification]:[De.uk.create,De.uk.delete],[De.py.hybridplaceholder]:[De.uk.default,De.uk.view],[De.py.updatemsaprofileavatardialog]:[De.uk.default,De.uk.view],[De.py.updatemsaprofilenamedialog]:[De.uk.default,De.uk.view],[De.py.autobrbconfirmationdialog]:[De.uk.default,De.uk.view],[De.py.autobrbflowdialog]:[De.uk.default,De.uk.view],[De.py.pearnotdefaultapp]:[De.uk.view],[De.py.invitecoworkers]:[De.uk.view],[De.py.licenserequestdialog]:[De.uk.view],[De.py.vdirestartworkflow]:[De.uk.default,De.uk.view]},d=i&&(o[t]||[]).includes(i);return!(!a||!d)},NC=()=>!0,hC=({entity:e})=>e.type===De.py.pearnotdefaultapp?null:e,fC=({entity:e})=>e.type===De.py.pearnotdefaultapp?null:e,_C=({entity:e})=>e.type===De.py.pearnotdefaultapp?null:e,SC=({entity:e})=>e,TC=({entity:e})=>e.type===De.py.pearnotdefaultapp?null:e,bC=({areEmptySlotsTransparent:e,coreSettings:n})=>({subNavEntity:{[Fe.e.VerticalBar]:{areSlotShadowsDisabled:e,isBackgroundTransparent:e,isColorSchemeDefaultBackground6:!e},[Fe.e.Rail]:{areSlotShadowsDisabled:e,isBackgroundTransparent:!!(null==n?void 0:n.get(s.J.Core).enableTransparentLeftRail)||e,isColorSchemeDefaultBackground3:!e}},headerEntity:{[Fe.e.VerticalBar]:{areSlotShadowsDisabled:e,isBackgroundTransparent:e,isColorSchemeDefaultBackground6:!e}},startEntity:{[Fe.e.VerticalBar]:{areSlotShadowsDisabled:e,isBackgroundTransparent:e,isColorSchemeDefaultBackground6:!e}},mainEntity:{[Fe.e.ThinHorizontalBar]:{isBackgroundTransparent:e},[Fe.e.TitleBar]:{isBackgroundTransparent:!0},[Fe.e.VerticalBar]:{areSlotShadowsDisabled:e,isBackgroundTransparent:!!(null==n?void 0:n.get(s.J.Core).enableTransparentAppBar)||e,isColorSchemeDefaultBackground6:!e}},endEntity:{[Fe.e.Rail]:{isBackgroundTransparent:e}}});var CC=i(932098);const wC="14d6962d-6eeb-4f48-8890-de55454bb136",IC="86fcd49b-61a2-4701-b771-54728cd291fb",AC="ef56c0de-36fc-4ef8-b417-3d82ba9d073c",FC="2a84919f-59d8-4441-a975-2a8c2643b741",DC="3b64df9d-7e97-4d9c-ac5c-2e0a5d8e6f40",EC="20c3440d-c67e-4420-9f80-0e50c39693df",MC="5af6a76b-40fc-4ba1-af29-8f49b08e44fd",PC="957ed0e3-e5ca-4c82-9676-fd037185c4d8",RC="a63f7012-8cc9-42d5-99c3-e35f526fab17",OC="3b95919f-59d8-4441-a975-2a8c2643c852",$C="66aeee93-507d-479a-a3ef-8f494af43945",LC="ac40aa4a-fef1-4896-aea2-46d1c14dbfd5",xC="7133fca9-0853-4e7a-bb5d-32d4e5f6020a",BC="a02e4d17-af86-4ceb-9c97-4c2626eb3587",jC="7831feaf-c4c4-4669-ba64-ce4ea0b56d31",UC=({coreSettings:e,userPreferences:n})=>{var i,t,a,o,d;if(!(null===(i=null==e?void 0:e.get(s.J.TeamsAndChannels))||void 0===i?void 0:i.enableTeamLayoutSetting)&&!(null===(t=null==e?void 0:e.get(s.J.TeamsAndChannels))||void 0===t?void 0:t.enableTeamLayoutSettingOverride))return!1;if(null===(a=null==e?void 0:e.get(s.J.Edu))||void 0===a?void 0:a.enableDogfoodingInEduGridLayout)return!0;switch(null===(o=null==n?void 0:n.teamLayout)||void 0===o?void 0:o.currentLayout){case"grid":return!0;case"list":return!1;default:return null===(d=null==e?void 0:e.get(s.J.TeamsAndChannels))||void 0===d?void 0:d.defaultTeamLayoutSettingIsGrid}},VC=(e,n,i)=>{const t=sn.D.AppBar;switch(e.tileID){case wC:return{scenarioName:c.RG.ActivitySwitch,source:t};case AC:return{scenarioName:c.RG.CalendarSurfaceLoad,source:t};case FC:return UC({coreSettings:n,userPreferences:null==i?void 0:i.getAllPreferences()})?{scenarioName:c.RG.TeamsGridLoad,source:t}:{scenarioName:c.RG.ChannelSwitchL1,source:t};case IC:return{scenarioName:c.RG.ChatSwitch,source:t};case DC:return{scenarioName:c.RG.SimpleCollabSwitch,source:t};case EC:return{scenarioName:c.RG.CallsAppSwitch,source:t};case xC:return{scenarioName:c.RG.HomepageAppLoad,source:t};case BC:return{scenarioName:c.RG.QueuesAppSwitch,source:t};default:return{scenarioName:c.RG.EntityCommand,source:t}}},WC=(e,n,i,t)=>{const a=e.event;switch(a.originator){case CC.DQ:case CC.Ol:return((e,n,i,t)=>{var a;const o=null===(a=e.data)||void 0===a?void 0:a.call(e);switch(e.type){case CC.iC.launch:case CC.iC.install:case CC.iC.description:return e.data?VC(o,i,t):void n.error("Received a launch event without data!");default:return void n.warn(`Received an unhandled Launch tile event, type: ${e.type}`)}})(a,n,i,t)}},HC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsShellGetBannerNotificationQueueQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bannerNotificationQueue"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bannerId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"source"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"bannerScenario"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"intentLevel"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BannerNotificationIntentLevel"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"cause"},__type:{kind:"NamedType",name:{kind:"Name",value:"BannerNotificationCause"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"debugInfo"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"correlationId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"props"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"action"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"command"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dismissOnAction"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"NotificationAction"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BannerNotificationProperties"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"behavior"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dismissable"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dismissActionCommand"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"duration"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"BannerNotificationBehavior"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BannerNotification"}}}}},arguments:[]}]}}]},GC={MostSevere:0,Live:1,Severe:2,Positive:3,Neutral:4},JC=e=>{var n,i,t,a;const{bannerId:o,source:d,bannerScenario:l,intentLevel:r,cause:s,props:{text:m,action:c},behavior:u,debugInfo:p,correlationId:y}=e;return{__typename:"BannerNotification",bannerId:o,source:d,bannerScenario:null!=l?l:null,intentLevel:r,cause:null!=s?s:null,debugInfo:null!=p?p:null,correlationId:null!=y?y:null,props:{__typename:"BannerNotificationProperties",text:null!=m?m:null,action:c?{__typename:"NotificationAction",command:c.command,text:null!==(n=c.text)&&void 0!==n?n:null,dismissOnAction:c.dismissOnAction}:null},behavior:{__typename:"BannerNotificationBehavior",dismissable:null!==(i=null==u?void 0:u.dismissable)&&void 0!==i&&i,dismissActionCommand:null!==(t=null==u?void 0:u.dismissActionCommand)&&void 0!==t?t:null,duration:null!==(a=null==u?void 0:u.duration)&&void 0!==a?a:0}}},qC=(e,n)=>{var i,t;let a=[];try{a=null!==(t=null===(i=n.readQuery({query:HC}))||void 0===i?void 0:i.bannerNotificationQueue)&&void 0!==t?t:[]}catch(n){e.error("Failed to read banner queue from data client cache. ",n)}return a.map(JC)},zC=(e,n,i)=>{const t={bannerNotificationQueue:i.map(JC)};try{n.writeQuery({query:HC,data:t})}catch(n){e.error("Failed to write banner queue to data client cache. ",n)}},QC=(e,n,i)=>{let t=qC(e,n);t=t.filter((e=>e.bannerId!==i)),zC(e,n,t)},YC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsShellReauthenticateMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"reauthenticateUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ReauthenticateResponse"}},arguments:[]}]}}]},KC=(e,n)=>{var i;return null===(i=n.mutate({mutation:YC}))||void 0===i?void 0:i.then((e=>{var n,i;return null===(i=null===(n=e.data)||void 0===n?void 0:n.reauthenticateUser)||void 0===i?void 0:i.success})).catch((n=>(e.error("Failed to perform reauthentication. ",n),Promise.resolve(void 0))))},XC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsShellGetToastNotificationQueueQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastNotificationQueue"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"intent"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ToastIntent"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"body"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"action"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"text"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"command"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"dismissOnAction"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"NotificationAction"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ConfirmationToastProperties"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"duration"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"source"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ToastNotification"}}}}},arguments:[]}]}}]},ZC=e=>{return e?{__typename:"ConfirmationToastProperties",action:(n=e.action,n?{__typename:"NotificationAction",command:n.command,text:null!==(i=n.text)&&void 0!==i?i:null,dismissOnAction:n.dismissOnAction}:null)}:null;var n,i},ew=e=>{const{id:n,source:i,intent:t,title:a,body:o,duration:d}=e;return{__typename:"ToastNotification",id:n,intent:t,title:a,body:ZC(null!=o?o:void 0),duration:null!=d?d:0,source:i}},nw=(e,n)=>{var i,t;let a=[];try{a=null!==(t=null===(i=n.readQuery({query:XC}))||void 0===i?void 0:i.toastNotificationQueue)&&void 0!==t?t:[]}catch(n){e.error("Failed to read toasts queue from data client cache. ",n)}return a.map(ew)},iw=(e,n,i)=>{const t={toastNotificationQueue:i.map(ew)};try{n.writeQuery({query:XC,data:t})}catch(n){e.error("Failed to write toast notifications queue to data client cache. ",n)}},tw=(e,n)=>{if(!e)return;const i=e.toLowerCase();return i.includes("x86")?n.x86:i.includes("x64")||i.includes("amd64")||i.includes("intel64")?n.x64:i.includes("arm64")?n.arm64:void 0},aw="exploratory_banner_last_dismissed_at";function ow(e,n){return(n.getTime()-e.getTime())/864e5}function dw(e,n){const i=n.toISOString();e.localStorage.setItem(aw,i)}const lw={[De.uk.create]:(e,n)=>{const{command:{correlation:{source:i}},entityOptions:a,entity:{id:o}}=n,{client:d,loggerFactory:l}=e,r=l.newLogger("addBannerNotificationToQueue","apps-shell"),s=a;if(s){const{text:e,action:n,dismissable:a,dismissActionCommand:l,duration:m}=s,c=(0,t.__rest)(s,["text","action","dismissable","dismissActionCommand","duration"]);let u;n&&(u=Object.assign(Object.assign({},n),{command:JSON.stringify(n.command)})),((e,n,i)=>{let t=qC(e,n);t=t.filter((e=>e.bannerId!==i.bannerId)),t.unshift(i),t=t.sort(((e,n)=>GC[e.intentLevel]-GC[n.intentLevel])),zC(e,n,t)})(r,d,Object.assign(Object.assign({},c),{bannerId:o||"no-id",source:i,props:{text:e,action:u},behavior:{dismissable:a,dismissActionCommand:l?JSON.stringify(l):void 0,duration:m}}))}else r.error("entityOptions is missing IBannerNotificationOptions fields. ",a);return Promise.resolve(void 0)},[De.uk.delete]:(e,n)=>{const{entity:{id:i}}=n,{client:t,loggerFactory:a}=e,o=a.newLogger("removeBannerNotificationFromQueue","apps-shell");return i&&QC(o,t,i),Promise.resolve(void 0)},[De.uk.signin]:(e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{entityOptions:i}=n,{client:t,loggerFactory:a}=e,o=a.newLogger("handleSignInBannerActionCommand","apps-shell"),d=i;return(yield KC(o,t))&&(null==d?void 0:d.bannerId)&&QC(o,t,d.bannerId),Promise.resolve(void 0)}))},rw={[De.uk.create]:(e,n)=>{const{command:{correlation:{source:i}},entityOptions:a,entity:{id:o}}=n,{client:d,loggerFactory:l}=e,r=l.newLogger("addToastNotificationToQueue","apps-shell"),s=a;if(o&&s){const{body:e}=s,n=(0,t.__rest)(s,["body"]);let a;(null==e?void 0:e.action)&&(a=Object.assign(Object.assign({},null==e?void 0:e.action),{command:JSON.stringify(null==e?void 0:e.action.command)})),((e,n,i)=>{let t=nw(e,n);t=t.filter((e=>e.id!==i.id)),t.push(i),iw(e,n,t)})(r,d,Object.assign(Object.assign({},n),{id:o,source:i,body:{action:a}}))}else r.error("entityOptions is missing IToastNotificationParams fields. ",a);return Promise.resolve(void 0)},[De.uk.delete]:(e,n)=>{const{entity:{id:i}}=n,{client:t,loggerFactory:a}=e,o=a.newLogger("removeToastNotificationFromQueue","apps-shell");return i&&((e,n,i)=>{let t=nw(e,n);t=t.filter((e=>e.id!==i)),iw(e,n,t)})(o,t,i),Promise.resolve(void 0)},[De.uk.update]:(e,n)=>{const{command:{correlation:{source:i}},entityOptions:a,entity:{id:o}}=n,{client:d,loggerFactory:l}=e,r=l.newLogger("addToastNotificationToQueue","apps-shell"),s=a;if(o&&s){const{body:e}=s,n=(0,t.__rest)(s,["body"]);let a;(null==e?void 0:e.action)&&(a=Object.assign(Object.assign({},null==e?void 0:e.action),{command:JSON.stringify(null==e?void 0:e.action.command)})),((e,n,i)=>{const t=nw(e,n);let a=!1;for(let e=0;e<t.length;e++)if(t[e].id===i.id){t[e]=i,a=!0;break}a||t.push(i),iw(e,n,t)})(r,d,Object.assign(Object.assign({},n),{id:o,source:i,body:{action:a}}))}else r.error("entityOptions is missing IToastNotificationParams fields. ",a);return Promise.resolve(void 0)}},sw={[De.uk.view]:(e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){throw new Error("Method not implemented yet")}))},mw={[De.uk.info]:(e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{exploratoryExpiryBannerLearnMoreUrl:n}=e.coreSettings.get(s.J.Growth),i=(0,Bi.J)();return i.open(n,"_blank"),dw(i,new Date),Promise.resolve(void 0)})),[De.uk.delete]:(e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){return dw((0,Bi.J)(),new Date),Promise.resolve(void 0)}))},cw=e=>{const{entityCommand:n,entityCommand:{entity:{type:i,action:a}},requestContext:o,windowProvider:d}=e;if(i===De.py.bannerNotification){const e=lw[a];if(e)return e(o,n)}else if(i===De.py.inAppToast){const e=rw[a];if(e)return e(o,n)}else if(i===De.py.memenu){const e=sw[a];if(e)return e(o,n)}else{if(i===De.py.updatedesktopapp&&a===De.uk.confirm)return((e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t;const{coreSettings:a,loggerFactory:o,scenarioFactory:d}=e,l=o.newLogger("downloadAppInstaller","apps-shell"),{enableDesktopMinimumVersionBanner:r}=a.get(s.J.Core);if(!r)return l.log("Sedimentation banner disabled by feature flag"),Promise.resolve(n);const{desktopAppInstallerLinks:m}=a.get(s.J.Core),{deviceInfo:u}=a.get(s.J.Platform),p=(null==u?void 0:u.cpuArchitecture)||void 0,y=tw(p,m),v=null==d?void 0:d.newScenario(c.RG.MinimumVersionBannerClicked);if(y)try{l.log(`Downloading the msix file for ${p}`);const e=null==i?void 0:i.document.createElement("a");return e.setAttribute("href",y),e.setAttribute("download",""),e.click(),e.remove(),null==v||v.mark("minimum_version_banner_clicked"),null==v||v.stop(),Promise.resolve(void 0)}catch(e){const i=`Failed to download msix file, where setup values is enableDesktopMinimumVersionBanner: \n    ${r}, cpuarch: ${p}, desktopAppInstallerLink: ${y}; \n    ${e.message}`;return null===(t=l.errorToTelemetry)||void 0===t||t.call(l,i,"unsupported-version-banner-job",{errorCode:e.name},!0),null==v||v.fail({errorCode:e.name,reason:"download-msix-file-error"}),Promise.resolve(n)}return l.log("Failed to download msix file - desktopAppInstallerLink not defined."),null==v||v.cancel({reason:"undefined-desktop-app-installer-link-event"}),Promise.resolve(n)})))(o,n,d);if(i===De.py.exploratorylicensenotificationbanner){const e=mw[a];if(e)return e(o,n)}}return Promise.resolve(n)},uw=[{filter:"/notdefaultapp",execute:({context:{coreSettings:e,loggerFactory:n}})=>{const{enableAppSwitcher:i}=e.get(s.J.Core),t=n.newLogger("Shell:BeforeDeeplinkParsedCondition","apps-shell");return i?(t.log("execute command onBeforeDeeplinkParsed"),Promise.resolve({entityCommand:{entity:{type:De.py.pearnotdefaultapp,action:De.uk.view},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,layoutMode:v.lO.standard}},metadata:{allowAnonymous:!0}})):(t.log(`app switcher is not enabled, enableAppSwitcher value is ${i}`),Promise.reject({message:"app-switcher-not-enabled"}))}},{filter:e=>e.search.includes("officeWaffle"),execute:()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){return{entityCommand:{command:{visibilityState:v.fe.show,stateTransition:v.su.flush},entity:{type:De.py.default,action:De.uk.default}},metadata:{allowAnonymous:!0}}}))},{filter:"/l/teamsInsider",execute:({context:{coreSettings:e,loggerFactory:n}})=>{const{enableJoinInsidersTab:i}=e.get(s.J.Core),t=n.newLogger("Shell:BeforeDeeplinkParsedTeamsInsiderCondition","apps-shell");return i?(t.log("execute command onBeforeDeeplinkParsedTeamsInsiderCondition"),Promise.resolve({entityCommand:{entity:{type:De.py.settingsstore,action:De.uk.default,id:za.Y.Insiders},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,layoutMode:v.lO.standard}},metadata:{allowAnonymous:!1}})):(t.log(`teams insider is not enabled, enableJoinInsidersTab value is ${i}`),Promise.reject({message:"teams-insider-not-enabled"}))}}],pw={filter:new Set([De.py.pearnotdefaultapp]),execute:({intent:e})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){return{overrideType:Km.U.OverrideIntent,intent:e}}))};function yw(e){const{hostCommunicationService:n,loggerFactory:i}=e,a=i.newLogger("auth-notification-job","apps-shell");return{id:"auth-notification",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var e;const i=(0,et.v4)();try{a.debug(`Sending webAuthSucceeded notification start. CorrelationId: ${i}.`);const t=yield n.loadModule("auth");null===(e=null==t?void 0:t.webAuthSucceeded)||void 0===e||e.call(t,{correlationId:i}),a.debug(`Sending webAuthSucceeded notification complete. CorrelationId: ${i}.`)}catch(e){throw a.error(`Sending webAuthSucceeded notification failed. CorrelationId: ${i}. Error: ${(0,wo.u4)(e)}`),e}}))}}const vw={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"OnAuthenticationStateChanged"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationStateChanged"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"state"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationState"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"customError"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errorCode"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"message"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"context"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isExpected"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"correlationId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"subContext"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"CustomError"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationStateData"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationStateChangedEvent"}}},arguments:[]}]}}]},kw={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"tenantId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserProfile"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}}}}},arguments:[]}]}}]},gw={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsShellAuthEndPagesDataQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isMRU"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userEndPageData"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userContextId"},value:{kind:"Variable",name:{kind:"Name",value:"userContextId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"isMRU"},value:{kind:"Variable",name:{kind:"Name",value:"isMRU"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"email"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"pictureBlob"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"customError"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"context"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"correlationId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"message"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"subContext"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"CustomError"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"UserEndPageData"}}}]}}]};var Nw=i(932289);const hw=({errorCode:e,message:n,isExpected:i,context:t,subContext:a})=>`errorCode: [${e}], message: [${n}], isExpected: [${+!!i}], context: [${t}::${a}]`;function fw(e,n){const{client:i,entityCommanding:a,i18n:o,loggerFactory:d,authenticationUser:l,coreSettings:r}=e,m=d.newLogger("auth-state-job","apps-shell"),c=i,u="auth-banner";let p=!0;return{id:"auth-state-subscription",job:()=>{c.subscribe({query:vw}).filter((e=>{var n,i;return!!(null===(i=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.authenticationStateChanged)||void 0===i?void 0:i.authenticationState)})).subscribe((e=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var i,d,y,v;const k=yield c.query({query:kw});if(0===(null===(d=null===(i=null==k?void 0:k.data)||void 0===i?void 0:i.authenticationUsers)||void 0===d?void 0:d.length))return void m.warn("No authenticated user found, not displaying auth-banner.");const g=null===(v=null===(y=null==e?void 0:e.data)||void 0===y?void 0:y.authenticationStateChanged)||void 0===v?void 0:v.authenticationState;switch(null==g?void 0:g.state){case"AADReconnecting":case"SkypeReconnecting":!function(e,n,i,t){var a;let o="",d="";"AADReconnecting"===n.state?(o=i.stringTranslate("auth","aad_reconnecting_text"),d="auth_aad_reconnecting"):"SkypeReconnecting"===n.state&&(o=i.stringTranslate("auth","skype_reconnecting_text"),d="auth_skype_reconnecting");t.shell.showBanner({id:e,source:sn.D.ShellAuthState,intentLevel:"AADReconnecting"===n.state?"Positive":"Neutral",text:o,dismissable:!0,duration:0,bannerScenario:d,correlationId:(null===(a=n.customError)||void 0===a?void 0:a.correlationId)||"",debugInfo:hw(n.customError||{})})}(u,g,o,a);break;case"InteractionRequired":!function(e,n,i,t){var a;i.shell.showBanner({id:e,source:sn.D.ShellAuthState,bannerScenario:"auth_sign_in_required",intentLevel:"MostSevere",cause:"AuthError",text:n.stringTranslate("auth","sign_in_required_text"),action:{text:n.stringTranslate("auth","sign_in_required_cta_text"),command:{entity:{type:"bannerNotification",action:"signin"}},dismissOnAction:!1},dismissable:!1,duration:0,correlationId:(null===(a=t.customError)||void 0===a?void 0:a.correlationId)||"",debugInfo:hw(t.customError||{})})}(u,o,a,g);break;case"LicenseError":case"SignInRestriction":yield function(e,n,i,a,o){return(0,t.__awaiter)(this,void 0,void 0,(function*(){if(!function(e,n,i){const{enableAuthEndPagesLicenseWarm:t,disableAuthEndPagesSigninRestrictionWarm:a}=(null==n?void 0:n.get(s.J.Auth))||{};if(!e)return!1;switch(i){case"LicenseError":return t;case"SignInRestriction":return!a;default:return!1}}(i,a,o))return;const t=(null==i?void 0:i.id)||"",d=yield n.query({query:gw,variables:{userContextId:t,isMRU:!0}});if(!d.data.userEndPageData)return;const l=d.data.userEndPageData;e.authentication.showAuthEndPage(sn.D.ShellAuthState,{error:(0,Nw.fj)(l,o,t)})}))}(a,c,l,r,g.state);break;default:!p&&a.shell.dismissBanner(u,sn.D.ShellAuthState)}n&&n(),p=!1}))))}}}var _w=i(109062);const Sw={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsShellCdlServicesStateSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appServiceStateChanged"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appService"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"previousState"},__type:{kind:"NamedType",name:{kind:"Name",value:"AppServiceState"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"currentStateChangeTimestamp"},__type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"currentStateChangeReason"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"currentStateChangeCode"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"currentState"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppServiceState"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CDLServiceStateChangedEvent"}}},arguments:[]}]}}]};function Tw(e,n){const{client:i,entityCommanding:t,i18n:a,loggerFactory:o,coreSettings:d,networkState:l}=e,r=i,m="cdl-services-state-banner",c=o.newLogger("cdl-services-state-job","apps-shell");let u=!1,p=0,y=0,v=!0;return{id:"cdl-services-state-subscription",job:()=>{var e;const i=d.get(s.J.CdlWorker).disableTrouterDisconnectedBannerT2,o=!!d.get(s.J.CdlWorker).enableCdlAppStateService;if(i||!o)return void(null===(e=c.logNoPii)||void 0===e||e.call(c,"disableTrouterDisconnectedBanner killswitch is enabled or enableCdlAppStateService is disabled; not listening to app service state change events"));const k=r.subscribe({query:Sw}).subscribe((e=>{var i;if(!(null==e?void 0:e.data))return void(n&&n());const o=null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.appServiceStateChanged,{appService:d,currentState:r}=o,s=l.getState();if("ChatSync"===d)u||"OFFLINE"!==r||s!==_w.G.Online?!v&&p>0&&"ONLINE"===r&&((e,n,i,t,a,o)=>{u=!1,y++,i.infoToTelemetry&&i.infoToTelemetry("ChatSync app service is back up; dismissing existing disconnected banner "+(void 0!==o?`(networkState=${o.toString()})`:""),"cdl_app_state_chatsync_disconnected_banner_dismiss",bw(n,p,y),!0),t.shell.dismissBanner(e,sn.D.ShellCDLServicesState),a&&a(!1)})(m,o,c,t,n,s):((e,n,i,t,a,o)=>{u=!0,p++,t.infoToTelemetry&&t.infoToTelemetry("ChatSync app service is OFFLINE; displaying new disconnected banner","cdl_app_state_chatsync_disconnected_banner_show",bw(n,p,y),!0),a.shell.showBanner({id:e,source:sn.D.ShellCDLServicesState,intentLevel:"Neutral",text:i.stringTranslate("errors","chatsync_app_service_disconnected"),dismissable:!0,duration:0,bannerScenario:"cdl-service-state-disconnected-banner"}),o&&o(!0)})(m,o,a,c,t,n),v=!1}));return()=>{k.unsubscribe()}}}}function bw(e,n,i){const{appService:t,currentState:a,currentStateChangeReason:o,currentStateChangeCode:d,previousState:l}=e;return{appService:t,currentState:a.toString(),currentStateChangeReason:o,currentStateChangeCode:d,previousState:null==l?void 0:l.toString(),bannerShownCount:n,bannerDismissCount:i}}const Cw={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsShellIsApplianceModeQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isApplianceMode"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]}]}}]},ww="offline banner",Iw="offline branch survivability banner";function Aw(e){const{coreSettings:n,entityCommanding:i,i18n:a,loggerFactory:o,networkState:d,client:l}=e,r=o.newLogger("network-state-subscription-logger","apps-shell"),m=l;let c=!0,u=!1;return{id:"network-state-subscription",job:()=>{if(!n.get(s.J.Core).enableNetworkStateBannerSubscription)return void r.log("network state banner subscription is disabled");const e=n.get(s.J.Calling).enableSurvivabilityT21,o=d.observe().subscribe((n=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var t;const o=yield m.query({query:Cw,fetchPolicy:"no-cache"});n===_w.G.Offline?e&&(null===(t=o.data)||void 0===t?void 0:t.isApplianceMode)?(r.debug("showing branch survivability banner"),u=!0,i.shell.showBanner({id:Iw,source:sn.D.ShellNetworkState,bannerScenario:"framework_branch_survivability_offline_banner",intentLevel:"Severe",cause:"Offline",text:a.stringTranslate("calling","offline_banner_message_branch_survivability_v2"),dismissable:!1,duration:0})):(r.debug("showing offline banner"),i.shell.showBanner({id:ww,source:sn.D.ShellNetworkState,bannerScenario:"framework_offline_banner",intentLevel:"Severe",cause:"Offline",text:a.stringTranslate("framework","offline_banner_message"),dismissable:!1,duration:0})):c||(r.debug("dismissing offline banner"),i.shell.dismissBanner(u?Iw:ww,sn.D.ShellNetworkState),u=!1),c=!1}))));return()=>{o.unsubscribe()}}}}const Fw={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"notifyWorkerSyncCanStart"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"notifyWorkerSyncCanStart"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]}}]};const Dw={id:"com.microsoft.teams.shell",name:"Shell",actors:[ac],supportedEntities:[De.py.appswitcherdesktopactivecalldialog,De.py.appswitchert1downloaddialog,De.py.appswitcherwebactivecalldialog,De.py.appswitcherwebmultipletabsdialog,De.py.bannerNotification,De.py.brbfeedbackdialog,De.py.hybridplaceholder,De.py.identitydialog,De.py.pearnotdefaultapp,De.py.signoutdialog,De.py.inAppToast,De.py.tpndialog,De.py.unsupporteddeeplinkdialog,De.py.updatemsaprofileavatardialog,De.py.updatemsaprofilenamedialog,De.py.joinlinkdialog,De.py.autobrbconfirmationdialog,De.py.autobrbflowdialog,De.py.framework,De.py.officeintegrationfredialog,De.py.memenu,De.py.premiumtrialdialog,De.py.updatedesktopapp,De.py.invitecoworkers,De.py.licenserequestdialog,De.py.switchaccountdialog,De.py.exploratorylicensenotificationbanner,De.py.vdirestartworkflow],supportedRenderModes:[Fe.e.Main,Fe.e.Modal,Fe.e.Rail,Fe.e.ThinHorizontalBar,Fe.e.TitleBar,Fe.e.VerticalBar],windowFeatures:{minWidth:602,width:602,minHeight:520,height:520,offset:20}},Ew="store",Mw="viewStoreApp",Pw=()=>({actor:Ew,action:Mw});var Rw=i(227085),Ow=i(248965);const $w="teamsandchannels",Lw="viewTeamsAndChannelsApp",xw="switchToChannel",Bw="loadUserOnboardingToTeamPage",jw="getLinkToChannel",Uw="viewChannelEmail",Vw="manageChannelMembers",Ww="manageTeam",Hw="leaveChannel",Gw="manageChannel",Jw="channelAddMembers",qw="shareChannelWithUser",zw="shareChannelWithTeam",Qw="channelNotificationSettings",Yw=()=>({actor:$w,action:Lw}),Kw=e=>({actor:$w,action:xw,data:e}),Xw=e=>({actor:$w,action:Bw,data:e}),Zw=e=>({actor:$w,action:jw,data:e}),eI=e=>({actor:$w,action:Uw,data:e}),nI=e=>({actor:$w,action:Vw,data:e}),iI=e=>({actor:$w,action:Ww,data:e}),tI=e=>({actor:$w,action:Hw,data:e}),aI=e=>({actor:$w,action:Gw,data:e}),oI=e=>({actor:$w,action:Jw,data:e}),dI=e=>({actor:$w,action:qw,data:e}),lI=e=>({actor:$w,action:zw,data:e}),rI=e=>({actor:$w,action:Qw,data:e}),sI="simplecollab",mI="viewSimpleCollabApp",cI="switchToChat",uI="switchToChannel",pI="channelNotificationSettings",yI="channelWorkflows",vI="deleteChannel",kI="editChannel",gI="getLinkToChannel",NI="manageChannel",hI="manageChannelTags",fI="manageChannelMembers",_I="viewChannelEmail",SI="manageTeam",TI="manageTags",bI="getLinkToTeam",CI="leaveTeam",wI="teamAddMember",II="teamAddChannel",AI="deleteTeam",FI="channelAddMembers",DI="leaveChannel",EI="shareChannelWithUser",MI="shareChannelWithTeam",PI="shareChannelWithTeamYouOwn",RI="viewDiscover",OI="createConversationFolder",$I="removeConversationFolder",LI="renameConversationFolder",xI="chatManageApps",BI="leaveChat",jI="viewTeamSeeAllChannels",UI="joinTeam",VI="createChannel",WI="createTeam",HI="manageTeams",GI=()=>({actor:sI,action:mI}),JI=e=>({actor:sI,action:cI,data:e}),qI=e=>({actor:sI,action:uI,data:e}),zI=e=>({actor:sI,action:pI,data:e}),QI=e=>({actor:sI,action:yI,data:e}),YI=e=>({actor:sI,action:vI,data:e}),KI=e=>({actor:sI,action:kI,data:e}),XI=e=>({actor:sI,action:gI,data:e}),ZI=e=>({actor:sI,action:NI,data:e}),eA=e=>({actor:sI,action:fI,data:e}),nA=e=>({actor:sI,action:hI,data:e}),iA=e=>({actor:sI,action:_I,data:e}),tA=e=>({actor:sI,action:FI,data:e}),aA=e=>({actor:sI,action:DI,data:e}),oA=e=>({actor:sI,action:EI,data:e}),dA=e=>({actor:sI,action:MI,data:e}),lA=e=>({actor:sI,action:PI,data:e}),rA=e=>({actor:sI,action:SI,data:e}),sA=e=>({actor:sI,action:TI,data:e}),mA=e=>({actor:sI,action:bI,data:e}),cA=e=>({actor:sI,action:CI,data:e}),uA=e=>({actor:sI,action:wI,data:e}),pA=e=>({actor:sI,action:II,data:e}),yA=e=>({actor:sI,action:AI,data:e}),vA=e=>({actor:sI,action:xI,data:e}),kA=e=>({actor:sI,action:BI,data:e}),gA=()=>({actor:sI,action:RI}),NA=e=>({actor:sI,action:OI,data:e}),hA=e=>({actor:sI,action:$I,data:e}),fA=e=>({actor:sI,action:LI,data:e}),_A=e=>({actor:sI,action:jI,data:e}),SA=e=>({actor:sI,action:UI,data:e}),TA=e=>({actor:sI,action:VI,data:e}),bA=e=>({actor:sI,action:WI,data:e}),CA=e=>({actor:sI,action:HI,data:e}),wA=(e,n,i,t)=>{var a,o;if(!e.data)return void n.error(`Received an event without data! Event type: ${e.type}`);const d=Ow.Mv.personal.toString(),l=Ow.Ky.na.toString();switch(e.type){case CC.iC.launch:const r=e.data(),s=((e,n)=>{if("platform"===e.platformType)return{appName:"platformApp",appViewCommand:{command:P_(e.tileID,e.launchOut||!1)}};switch(e.tileID){case LC:return{appName:"store",appViewCommand:{command:Pw()}};case wC:return{appName:"activity",appViewCommand:{command:$e()},focusOnLeftRailItem:!0};case AC:return{appName:"calendar",appViewCommand:{command:kt()}};case EC:return{appName:"callsmain",appViewCommand:{command:Wc()}};case FC:return{appName:"channel",appViewCommand:{command:Yw()},focusOnLeftRailItem:!0};case DC:return{appName:"simpleCollab",appViewCommand:{command:GI()},focusOnLeftRailItem:!0};case IC:return{appName:"chat",appViewCommand:{command:Rm()},focusOnLeftRailItem:!0};case OC:return{appName:"communities",appViewCommand:{command:Tu()},focusOnLeftRailItem:!0};case PC:case RC:return{appName:"meet",appViewCommand:{command:bN()}};case $C:return{appName:"assignments",appViewCommand:{command:P_($C,e.launchOut||!1)}};case xC:return{appName:"homepage",appViewCommand:{command:qp()}};case BC:return{appName:"queues",appViewCommand:{command:JS()}};case jC:return{appName:"peopleApp",appViewCommand:{command:Sc()}};default:return void n.error(`Received an unknown core app id. Cannot launch app with id ${e.tileID}.`)}})(r,n),m=(e=>{switch(e.tileID){case FC:return ei.wh.teams;case IC:return ei.wh.chat;case AC:return ei.wh.calendar;case EC:return ei.wh.calls;case MC:return ei.wh.files;default:return ei.wh.AppBar}})(r);(null==s?void 0:s.focusOnLeftRailItem)&&(null==t||t());const c=r.tileID,u=null===(a=i.createDatabag)||void 0===a?void 0:a.call(i);return u&&(u.launchTileId=c,u.launchTilePosition=r.tilePosition,u.launchTileEventType=null===(o=r.reactEvent)||void 0===o?void 0:o.type,u.launchTileAppName=null==s?void 0:s.appName,u.launchOut=r.launchOut,u.tileHostContext=r.tileHostContext),i.recordPanelAction({actionScenario:ei.Tk.openApp,appId:c,appScenarioCapability:l,appScope:d,actionGesture:ei.uS.click,actionOutcome:ei.$K.nav,actionScenarioType:ei.Yu.nav,moduleType:ei.PO.nav,moduleName:ei.rA.appBarItem,panelType:m,panelRegion:ei.Ai.main,dataBag:u},n),null==u||u.dispose(),null==s?void 0:s.appViewCommand;case Rw.St.PlatformEvents.markAllAsRead:{const t=((e,n)=>{if(e===EC)return{appName:"callsmain",markAsReadCommand:{command:Hc()}};n.error(`Received an unknown or unsupported core app id. Cannot use markAllAsRead command on app with id ${e}.`)})(e.data(),n);return i.recordPanelAction({actionGesture:ei.uS.click,actionOutcome:ei.$K.submit,actionScenario:ei.Tk.markAllAsRead,actionScenarioType:ei.Yu.appBar,moduleType:ei.PO.button,moduleName:ei.rA.novaAppBar,panelType:ei.wh.AppBar,panelRegion:ei.Ai.left},n),null==t?void 0:t.markAsReadCommand}case CC.iC.uninstall:const p=e.data();return i.recordPanelAction({actionGesture:ei.uS.click,actionOutcome:ei.$K.submit,actionScenario:ei.Tk.uninstallAppOnAppBarAndPersonalAppsFlyout,actionScenarioType:ei.Yu.appBar,moduleType:ei.PO.button,moduleName:ei.rA.novaAppBar,panelType:ei.wh.AppBar,panelRegion:ei.Ai.left},n),{command:L_(p.tileID,p.appName,p.isInUse)};case Rw.St.PlatformEvents.about:{const t=e.data();return i.recordPanelAction({actionGesture:ei.uS.click,actionOutcome:ei.$K.submit,actionScenario:ei.Tk.personalAppAbout,actionScenarioType:ei.Yu.appBar,moduleType:ei.PO.button,moduleName:ei.rA.novaAppBar,panelType:ei.wh.AppBar,panelRegion:ei.Ai.left},n),{command:x_(t)}}case Rw.St.PlatformEvents.blockUnblockBotChat:{const t=e.data();return i.recordPanelAction({actionGesture:ei.uS.click,actionOutcome:ei.$K.submit,actionScenario:ei.Tk.blockUnblockBotChatInPersonalAppsFlyout,actionScenarioType:ei.Yu.appBar,moduleType:ei.PO.button,moduleName:ei.rA.novaAppBar,panelType:ei.wh.AppBar,panelRegion:ei.Ai.left},n),{command:B_(t)}}case Rw.St.PlatformEvents.newChat:return i.recordPanelAction({actionGesture:ei.uS.click,actionOutcome:ei.$K.submit,actionScenario:ei.Tk.newChatCreation,actionScenarioType:ei.Yu.appBar,moduleType:ei.PO.button,moduleName:ei.rA.novaAppBar,panelType:ei.wh.AppBar,panelRegion:ei.Ai.left},n),{command:$m()};case Rw.St.PlatformEvents.popNewChat:return i.recordPanelAction({actionGesture:ei.uS.click,actionOutcome:ei.$K.submit,actionScenario:ei.Tk.newChatCreation,actionScenarioType:ei.Yu.appBar,moduleType:ei.PO.button,moduleName:ei.rA.novaAppBar,panelType:ei.wh.AppBar,panelRegion:ei.Ai.left},n),{command:Lm()};default:return void n.warn(`Received an unhandled tile event, type: ${e.type}`)}};var IA=i(948533);const AA=({userBiService:e,actionScenario:n,actionOutcome:i,moduleName:t,moduleType:a,actionScenarioType:o,logger:d,actionGesture:l=ei.uS.click,panelType:r=ei.wh.meControl,panelRegion:s=ei.Ai.main,dataBag:m})=>{e.recordPanelAction({actionOutcome:i,actionGesture:l,actionScenarioType:o,panelRegion:s,panelType:r,actionScenario:n,moduleName:t,moduleType:a,dataBag:m},d),null==m||m.dispose()},FA={OneHour:"settings_note_expiry_hour",HalfHour:"settings_expiry_status_half_hour",TwoHours:"settings_note_expiry_hours_two",FourHours:"settings_note_expiry_hours_four",Today:"settings_note_expiry_today",ThisWeek:"settings_note_expiry_this_week",Custom:"settings_note_expiry_custom",Never:"settings_note_expiry_never"},DA={Home:"Remote",Remote:"Remote",Office:"Office",TimeOff:"TimeOff",Unknown:null},EA=(e,n,i)=>{var t,a,o,d,l,r,s,m;switch(e.type){case IA.BR.updateDisplayName:return{command:mc()};case IA.BR.updateProfilePicture:return{command:sc()};case IA.BR.scheduleOOF:return AA({userBiService:n,actionScenario:ei.Tk.oofSettingsOpen,actionOutcome:ei.$K.navigateToPanel,moduleName:ei.rA.oofSettingsOpenLink,moduleType:ei.PO.link,actionScenarioType:ei.Yu.oofSettings,logger:i}),{command:{actor:cb,action:ub}};case IA.BR.openProfileCard:const{presenceIdMRI:c,eventType:u,position:p}=null===(a=(t=e).data)||void 0===a?void 0:a.call(t);return function(e,n,i){if(!e)return;switch(n){case"mouseenter":case"mouseleave":case"click":case"keydown":return{command:on({eventType:n,userId:e,left:i.left,top:i.top,width:i.width,height:i.height,useNewEventObserver:!0})};default:return}}(c,u,p);case IA.BR.setStatusMessageSubmitted:{const t=null===(o=e.data)||void 0===o?void 0:o.call(e),a=null===(d=n.createDatabag)||void 0===d?void 0:d.call(n);if(t&&a){const{pinStatusToChat:e,isOutOfOffice:n,expiry:i}=t.statusNoteRequest;a.pinnedStatusMessage=e,a.oof=n,a.expiryDate=(null==i?void 0:i.preDefined)?FA[t.statusNoteRequest.expiry.preDefined]:null}return AA({userBiService:n,actionScenario:ei.Tk.setStatusMessage,actionOutcome:ei.$K.submit,moduleName:ei.rA.statusMessageForm,moduleType:ei.PO.button,actionScenarioType:ei.Yu.statusMessage,logger:i,dataBag:a}),{command:{actor:cb,action:pb}}}case IA.BR.setAvailabilitySubmitted:{const t=null===(l=e.data)||void 0===l?void 0:l.call(e),a=null===(r=n.createDatabag)||void 0===r?void 0:r.call(n);if(t&&a){const{category:e,presetDuration:n,customExpiry:i}=t;a.expiryStatusOverridden=!(!n&&!i),a.expiryDate=n?FA[n]:void 0,a.selectedStatus=e}return void AA({userBiService:n,actionScenario:ei.Tk.setPresence,actionOutcome:ei.$K.select,moduleName:ei.rA.availabilityDropdown,moduleType:ei.PO.dropdown,actionScenarioType:ei.Yu.availability,logger:i,dataBag:a})}case IA.BR.setWorkLocationSubmitted:{const t=null===(s=e.data)||void 0===s?void 0:s.call(e),a=null===(m=n.createDatabag)||void 0===m?void 0:m.call(n);if(t&&a){const{workLocationId:e}=t;a.workLocation=DA[e||"Unknown"]}return void AA({userBiService:n,actionScenario:ei.Tk.setWorkLocation,actionOutcome:ei.$K.select,moduleName:ei.rA.workLocationDropdown,moduleType:ei.PO.dropdown,actionScenarioType:ei.Yu.hybridPresence,logger:i,dataBag:a})}default:return}};var MA=i(8397);var PA=i(936733);const RA={onEventReceived:e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n;const i=e.requestContext.loggerFactory.newLogger("apps-shell-event-handler","apps-shell"),t=e.requestContext.userBiService,a=e.requestContext.scenarioFactory,o=e.eventInput.event;switch(o.originator){case PA.k:if(o.type===PA.u.openContextualSearch){const e=null===(n=o.data)||void 0===n?void 0:n.call(o);return{command:Vm(e)}}break;case CC.DQ:const l=()=>{var n;const i=null===(n=e.requestContext.client)||void 0===n?void 0:n.ctx;i&&e.requestContext.shortcutExecutionService.executeCommand(i.windowId,"FocusOnLeftRailItem")};return wA(o,i,t,l);case CC.ib:return((e,n,i)=>{e.type!==CC.iC.userSearch?n.warn(`Received an unhandled Launch tile event, type: ${e.type}`):i.recordPanelAction({actionGesture:ei.uS.keypress,actionOutcome:ei.$K.show,actionScenario:ei.Tk.userSearchFromPersonalFlyout,actionScenarioType:ei.Yu.appBar,moduleName:ei.rA.novaAppBar,panelRegion:ei.Ai.left},n)})(o,i,t);case CC.Ol:return((e,n,i)=>{var t;if(!e.data)return void n.error("Received a launch event without data!");const a=null===(t=i.createDatabag)||void 0===t?void 0:t.call(i),o=(0,Bi.J)(),d=Ow.Mv.personal.toString(),l=Ow.Ky.na.toString();switch(e.type){case CC.iC.install:{const t=e.data();return a&&(a.launchTileId=t.tileID),i.recordPanelAction({actionGesture:ei.uS.click,actionOutcome:ei.$K.nav,actionScenario:ei.Tk.clickAddFromPersonalFlyoutSuggestions,actionScenarioType:ei.Yu.appBar,moduleName:ei.rA.novaAppBar,panelRegion:ei.Ai.left,dataBag:a},n),null==a||a.dispose(),{command:$_(t.tileID)}}case CC.iC.description:{const t=e.data();return a&&(a.launchTileId=t.tileID),i.recordPanelAction({appId:t.tileID,appScenarioCapability:l,appScope:d,actionGesture:ei.uS.click,actionOutcome:ei.$K.nav,actionScenario:ei.Tk.flyoutAppItemClicked,actionScenarioType:ei.Yu.appBar,moduleType:ei.PO.nav,moduleName:ei.rA.novaAppBar,panelType:ei.wh.AppBar,panelRegion:ei.Ai.left,dataBag:a},n),null==a||a.dispose(),{command:O_(t.tileID)}}case CC.iC.privacy:{const t=e.data();return a&&(a.launchTileId=t.tileID),i.recordPanelAction({appId:t.tileID,appScenarioCapability:l,appScope:d,actionGesture:ei.uS.click,actionOutcome:ei.$K.nav,actionScenario:ei.Tk.personalFlyoutPrivacyLink,actionScenarioType:ei.Yu.appBar,moduleType:ei.PO.button,moduleName:ei.rA.novaAppBar,panelType:ei.wh.AppBar,panelRegion:ei.Ai.left,dataBag:a},n),null==a||a.dispose(),void o.open(t.privacyUrl)}case CC.iC.termsOfUse:{const t=e.data();return a&&(a.launchTileId=t.tileID),i.recordPanelAction({appId:t.tileID,appScenarioCapability:l,appScope:d,actionGesture:ei.uS.click,actionOutcome:ei.$K.nav,actionScenario:ei.Tk.personalFlyoutTermsOfUseLink,actionScenarioType:ei.Yu.appBar,moduleType:ei.PO.button,moduleName:ei.rA.novaAppBar,panelType:ei.wh.AppBar,panelRegion:ei.Ai.left,dataBag:a},n),null==a||a.dispose(),void o.open(t.termsOfUseUrl)}case CC.iC.permissions:{const t=e.data();return a&&(a.launchTileId=t.tileID),i.recordPanelAction({appId:t.tileID,appScenarioCapability:l,appScope:d,actionGesture:ei.uS.click,actionOutcome:ei.$K.nav,actionScenario:ei.Tk.personalFlyoutItemPermissions,actionScenarioType:ei.Yu.appBar,moduleType:ei.PO.button,moduleName:ei.rA.novaAppBar,panelType:ei.wh.AppBar,panelRegion:ei.Ai.left,dataBag:a},n),null==a||a.dispose(),{command:O_(t.tileID,"permissions")}}default:return void n.warn(`Received an unhandled Launch tile event, type: ${e.type}`)}})(o,i,t);case MA.s.SimpleCollabSwitcher:return(d=o).type===MA.$.SwitchOnSimpleCollab?{command:GI()}:d.type===MA.$.SwitchOffSimpleCollab?{command:Rm()}:void 0;case CC.tL:return{command:Pw()};case CC.Ug:return((e,n,i,t)=>{var a;switch(e.type){case CC.iC.appBarImpression:return void i.stopScenarioIfActive(c.RG.AppBarLoad);case CC.iC.renderError:{let t;e.data&&(t=e.data()),n.errorToTelemetry&&n.errorToTelemetry("AppBar render failed!","webclient_framework_shell_appbar_render_failure_event"),n.error("AppBar Render Error:",null==t?void 0:t.error),n.error("AppBar React Error Info:",null==t?void 0:t.errorInfo);const a=i.findScenario(c.RG.AppBarLoad);return void(a&&a.fail())}case CC.iC.flyoutOpened:return t.recordPanelAction({actionGesture:ei.uS.click,actionOutcome:ei.$K.show,actionScenario:ei.Tk.launchPersonalFlyout,actionScenarioType:ei.Yu.appMgmt,moduleType:ei.PO.nav,moduleName:ei.rA.novaAppBar,panelType:ei.wh.appsFlyoutPopover,panelRegion:ei.Ai.popover},n),{command:R_()};case CC.iC.flyoutRendered:{if(!e.data)return void n.error("Received a launch event without data!");const i=e.data(),o=null===(a=t.createDatabag)||void 0===a?void 0:a.call(t);return o&&(o.overflowCount=i.overflowCount),t.recordPanelAction({actionGesture:ei.uS.click,actionOutcome:ei.$K.show,actionScenario:ei.Tk.appsFlyoutOpen,actionScenarioType:ei.Yu.appBar,moduleType:ei.PO.button,moduleName:ei.rA.novaAppBar,panelType:ei.wh.appsFlyoutPopover,panelRegion:ei.Ai.popover,dataBag:o},n),void(null==o||o.dispose())}default:return void n.warn(`Received an unhandled Launch tile event, type: ${e.type}`)}})(o,i,a,t)}var d;return o.originator===IA.CB?((e,n)=>{switch(e.type){case IA.BR.addNewAccount:return{command:{actor:lN,action:sN,data:{commandSource:sn.D.AddAccountFromMeMenu}}};case IA.BR.switchTenant:const i=e.data?e.data().tenantId:void 0;return i?{command:kN(i)}:void(n.errorToTelemetry&&n.errorToTelemetry("Me Control Switch Tenant called without tenant id.","webclient_framework_shell_event_handler_error"));case IA.BR.switchAccount:const t=e.data?e.data().accountId:void 0;return t?{command:vN(t)}:void(n.errorToTelemetry&&n.errorToTelemetry("Me Control Switch account called without account id.","webclient_framework_shell_event_handler_error"));default:return}})(o,i):o.originator===IA.D_?(e=>{switch(e.type){case IA.BR.openMeControl:return{command:gN()};case IA.BR.signOut:return{command:yN()};default:return}})(o):o.originator===IA.ls?EA(o,t,i):Promise.resolve(void 0)}))},OA=({commandInput:{command:e},requestContext:{loggerFactory:n}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var i;const t=e.action,a=n.newLogger("ShellApp onCommandReceived","apps-shell");return t===oc?"object"==typeof(o=e.data)&&null!==o&&"title"in o&&"intent"in o&&"dismissOnAction"in o?{command:{correlation:{source:sn.D.Nova},stateTransition:v.su.none,visibilityState:v.fe.show},entity:{type:De.py.inAppToast,action:De.uk.create,id:(0,et.v4)()},entityOptions:e.data}:void(null===(i=a.errorNoPii)||void 0===i||i.call(a,`Command for action '${e.action}' requires title, intent and dismissOnAction.`)):t===dc?{command:{correlation:{source:sn.D.Nova},stateTransition:v.su.extend,visibilityState:v.fe.show},entity:{type:De.py.updatemsaprofileavatardialog,action:De.uk.view}}:t===lc?{command:{correlation:{source:sn.D.Nova},stateTransition:v.su.extend,visibilityState:v.fe.show},entity:{type:De.py.updatemsaprofilenamedialog,action:De.uk.view}}:void 0;var o})),$A=({type:e,appRenderMode:n})=>{const i=new Ee.H,t=[];return e===De.py.pearnotdefaultapp&&n===Fe.S.Main&&t.push(Me.G.APP_SWITCHER_CONFIRMATION_RENDERED),i.registerAppPhase({phase:g.nh.CRITICAL,signals:t,timeout:5e3}),i.appPhases},LA=(e,n)=>-1===e.localeCompare(n,void 0,{numeric:!0,sensitivity:"base"});function xA(e){const{coreSettings:n,i18n:i,entityCommanding:a,loggerFactory:o,scenarioFactory:d}=e,l=o.newLogger("DesktopUnsupportedVersionCheckJob","apps-shell"),{enableDesktopMinimumVersionBanner:r}=n.get(s.J.Core),m=d.newScenario(c.RG.MinimumVersionBannerShown);return r?{id:"desktop-minimum-version-check-job",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){l.log("Checking unsupported desktop client versions...");const e=function(e,n){const{minimumDesktopVersion:i}=n.get(s.J.Core),{desktopVersion:t}=n.get(s.J.Host),{deviceInfo:a}=n.get(s.J.Platform),o=(null==a?void 0:a.cpuArchitecture)||void 0,d=(null==a?void 0:a.osName)||void 0,l=function(e,n,i,t){var a;if(n&&e){if(e.includes("macos"))return i.macOS;if(e.includes("windows"))switch(!0){case n.includes("x64")||n.includes("amd64")||n.includes("intel64"):return i.x64;case n.includes("x86"):return i.x86;case n.includes("arm64"):return i.arm64;default:null===(a=t.errorToTelemetry)||void 0===a||a.call(t,`Unknown cpuarch: ${n}`,"unsupported-version-banner-job",{},!0)}}}(null==d?void 0:d.toLowerCase(),null==o?void 0:o.toLowerCase(),i,e);if(e.log(`Desktop client version is ${t}, minimum supported version is ${l}`),l&&t)return!!LA(t,l)&&(e.log("Unsupported desktop version detected."),!0);e.log("Desktop client versions not found. Desktop version check skipped.")}(l,n);e&&(!function(e,n,i,t,a,o){n.shell.showBanner({id:e,source:sn.D.ShellVersionCheck,bannerScenario:a,intentLevel:"Severe",cause:"UnsupportedAppVersionDetected",text:i.stringTranslate("framework",a),action:{text:i.stringTranslate("framework",o),command:{entity:{type:De.py.updatedesktopapp,action:De.uk.confirm,id:za.Y.Notifications}},dismissOnAction:!0},dismissable:!0,duration:0}),t.log("Desktop sedimentation banner displayed")}("DesktopSedimentationBanner",a,i,l,"desktopapp_version_unsupported_generic_banner","more_options_menu_initiate_update"),null==m||m.mark("minimum_version_banner_shown")),null==m||m.stop()}))}:(l.log("Sedimentation banner disabled by feature flag"),void m.stop({reason:"enableDesktopMinimumVersionBanner disabled"}))}var BA=i(897564),jA=i(435332),UA=i(873883);const VA={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsShellMeQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"me"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mri"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"User"}},arguments:[]}]}}]};var WA=i(938052);const HA="presence-donotdisturb-banner",GA="presence-statusmessage-banner",JA="Unknown";function qA(e){const{i18n:n,entityCommanding:i,loggerFactory:a,authenticationUser:o,client:d,coreSettings:l,userBiService:r}=e,m=a.newLogger("presence-state-subscription-logger","apps-shell"),c=d;return{id:"presence-prewarm-job",job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var e;const{enablePresenceTopBanner:t}=l.get(s.J.Presence);if(!t)return void m.log("presence state banner subscription is disabled");const a=yield c.query({query:VA});let d;const u=c.subscribe({query:jA.z,variables:{userId:null===(e=a.data.me)||void 0===e?void 0:e.mri,source:"ups"}}).subscribe((({data:e})=>{var t,a,l,s,c,u,p,y,k;const{presenceUpdateEvent:g}=e||{};var N,h;(null==g?void 0:g.availability)!==(null==d?void 0:d.availability)&&((null==g?void 0:g.availability)===BA.a.DoNotDisturb?function(e,n){const i=e.stringTranslate("presence","dnd_info_banner_message"),t=e.stringTranslate("presence","presence_info_banner_change_settings"),a={source:sn.D.ShellPresenceState},o={text:t,command:{entity:{type:De.py.settingsstore,action:De.uk.view,id:za.Y.Privacy},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,correlation:a},entityOptions:{correlation:a}},dismissOnAction:!1};YA(HA,n,"PresenceDoNotDisturb",i,o)}(n,i):QA(HA,i)),N=null==g?void 0:g.statusNote,h=null==d?void 0:d.statusNote,((null==N?void 0:N.message)!==(null==h?void 0:h.message)||(null==N?void 0:N.expiry)!==(null==h?void 0:h.expiry))&&((null==g?void 0:g.statusNote)&&zA(g.statusNote)?function(e,n,i){let t;t=new Date(null!=i?i:WA.f1).getFullYear()>=WA.cO||!i?e.stringTranslate("presence","status_note_expirynever_info_banner_message"):e.stringTranslate("presence","status_note_info_banner_message",{expiryTime:e.formatDateTime(new Date(i),UA.uF)});YA(GA,n,"PresencePinnedStatusNote",t)}(n,i,null===(t=null==g?void 0:g.statusNote)||void 0===t?void 0:t.expiry):QA(GA,i));const f=(null===(a=null==g?void 0:g.workLocation)||void 0===a?void 0:a.location)!==(null===(l=null==d?void 0:d.workLocation)||void 0===l?void 0:l.location)||(null===(s=null==g?void 0:g.workLocation)||void 0===s?void 0:s.locationSource)!==(null===(c=null==d?void 0:d.workLocation)||void 0===c?void 0:c.locationSource);if((null===(u=null==g?void 0:g.workLocation)||void 0===u?void 0:u.location)&&r&&f){const e=null===(p=r.createDatabag)||void 0===p?void 0:p.call(r);e&&(e.workLocation=null!==(y=g.workLocation.location)&&void 0!==y?y:JA,e.locationSource=null!==(k=g.workLocation.locationSource)&&void 0!==k?k:JA),AA({userBiService:r,actionScenario:ei.Tk.readWorkLocation,actionOutcome:ei.$K.read,moduleName:ei.rA.presenceUpdateEventRead,moduleType:ei.PO.event,actionScenarioType:ei.Yu.hybridPresence,actionGesture:ei.uS.asyncStateChange,logger:m,dataBag:e})}d=g,m.log(`[Presence State Subscription] ID: ${null==o?void 0:o.id}`)}));return()=>{u.unsubscribe(),m.log("[Presence] unsubscribing ...")}}))}}const zA=e=>{var n;return null===(n=e.message)||void 0===n?void 0:n.includes("<pinnednote></pinnednote>")};function QA(e,n){n.shell.dismissBanner(e,sn.D.ShellPresenceState)}function YA(e,n,i,t,a,o){n.shell.showBanner({id:e,source:sn.D.ShellPresenceState,intentLevel:"Neutral",cause:i,text:t,action:a,dismissable:!0,duration:0,dismissActionCommand:o})}const KA="downloading_weblogs";function XA(e){const{coreSettings:n,entityCommanding:i,i18n:t,loggerFactory:a,logsCollectorService:o}=e,d=a.newLogger("download-log-subscription-logger","apps-shell");return{id:"download-log-subscription",job:()=>{if(!o)return void d.log("logsCollectorService is invalid");if(n.get(s.J.Core).disableDownloadLogStatusSubscription)return void d.log("download log banner subscription is disabled");const e=o.observeDownloadLogStatus().subscribe((e=>{e?(d.debug("showing download log banner"),i.shell.showBanner({id:KA,source:sn.D.LogsDownloading,bannerScenario:"downloading_Weblogs",intentLevel:"Neutral",duration:0,text:t.stringTranslate("framework","downloading_weblogs")})):(d.debug("dismissing download log banner"),i.shell.dismissBanner(KA,sn.D.LogsDownloading))}));return()=>{e.unsubscribe()}}}}const ZA={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsShellUserLicenseDetailsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userLicenseDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isTrial"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"trialLicenseEndDate"},__type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"UserLicenseDetails"}},arguments:[]}]}}]};function eF(e){const{client:n,entityCommanding:i,loggerFactory:a,coreSettings:o,i18n:d}=e,l=a.newLogger("exploratory-upgrade-banner-job","apps-shell"),r=n,m="smb_web_and_desktop_growth_exploratory_upgrade_banner";return{id:"exploratory-upgrade-banner-job",job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var n,t,a,c,u,p,y;const{enableExploratoryExpiryBanner:k,exploratoryExpirySevereBannerDaysBeforeExpiryThreshold:g}=o.get(s.J.Growth);if(!k)return;const N=performance.now();try{let y;try{y=yield r.query({query:ZA})}catch(e){return void(null===(n=l.errorToTelemetry)||void 0===n||n.call(l,"Failed to get user license details",m))}const{isTrial:k,trialLicenseEndDate:h}=(null===(t=null==y?void 0:y.data)||void 0===t?void 0:t.userLicenseDetails)||{};if(!k)return void(null===(a=l.infoToTelemetry)||void 0===a||a.call(l,"Skip because user is not trial",m));if(!h)return void(null===(c=l.errorToTelemetry)||void 0===c||c.call(l,"trialLicenseEndDate is not present in the trial user's license details",m));const f=function(e){const n=e.localStorage.getItem(aw);if(!n)return null;const i=new Date(n);return isNaN(i.getTime())?null:i}(e.windowProvider),_=function(e){return ow(new Date,e)}(h);if(!function(e,n,i){const{exploratoryExpiryBannerDaysBeforeExpiryThreshold:t,exploratoryExpiryBannerNoCooldownThreshold:a,exploratoryExpiryBannerCooldownInDays:o}=i.get(s.J.Growth),d=o||0;return e<(t||0)&&(e<(a||0)||null===n||ow(n,new Date)>d)}(_,f,o)){const e=performance.now()-N;return void(null===(u=l.infoToTelemetry)||void 0===u||u.call(l,"Trial user not eligible for banner",m,{totalRequestTime:e}))}const S=_<(g||0)?"Severe":"Neutral",T=d.formatDateTime(h,UA.WG),b=d.stringTranslate("growth","exploratory_expiry_banner_text",{expiryDate:T}),C=d.stringTranslate("growth","exploratory_expiry_banner_action");i.shell.showBanner({id:"exploratoryExpirationBanner",source:sn.D.ExploratoryUpgradeBannerJob,intentLevel:S,dismissable:!0,text:b,action:{dismissOnAction:!0,text:C,command:{entity:{type:De.py.exploratorylicensenotificationbanner,action:De.uk.info},command:{stateTransition:v.su.flush,visibilityState:v.fe.show,correlation:{source:sn.D.ExploratoryUpgradeBannerJob}}}},dismissActionCommand:{entity:{type:De.py.exploratorylicensenotificationbanner,action:De.uk.delete}},duration:0,bannerScenario:"exploratory_expiration_banner"});const w=performance.now()-N;null===(p=l.infoToTelemetry)||void 0===p||p.call(l,`Queued banner with severity ${S}`,m,{totalRequestTime:w})}catch(e){const n=performance.now()-N;null===(y=l.errorToTelemetry)||void 0===y||y.call(l,"Failed to show exploratory product banner",m,{totalRequestTime:n})}}))}}const nF=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(256045),i.e(241602),i.e(371935),i.e(976609),i.e(1053),i.e(755684),i.e(671291),i.e(277599),i.e(191673),i.e(102207),i.e(273122),i.e(729816),i.e(239234),i.e(449237),i.e(744816),i.e(357142),i.e(57224),i.e(347761),i.e(9081),i.e(269296),i.e(757343),i.e(37943),i.e(418218),i.e(100869),i.e(668575),i.e(560947),i.e(259649),i.e(68688),i.e(912597),i.e(127919),i.e(953275),i.e(718194),i.e(481020),i.e(495500),i.e(839180),i.e(418133),i.e(827265),i.e(863698),i.e(779792),i.e(66082),i.e(311119),i.e(41464),i.e(834091),i.e(303523),i.e(305271)]).then(i.bind(i,842614)),iF=()=>Promise.all([i.e(917388),i.e(590393),i.e(241602),i.e(475240),i.e(347761),i.e(418218),i.e(668575),i.e(953275),i.e(839180),i.e(311119),i.e(41464),i.e(897526)]).then(i.bind(i,919173)),tF=({host:e,screenState:n,isResize:i})=>{if(i){if(!Dw.windowFeatures)return null;const e=Dw.windowFeatures,{offset:n}=e;return(0,t.__rest)(e,["offset"])}const{height:a,minHeight:o,minWidth:d,offset:l,width:r}=Dw.windowFeatures||{},s={left:(null==e?void 0:e.screenX)||0,top:(null==e?void 0:e.screenY)||0},m=((null==n?void 0:n.numOpenWindows)||1)*(l||1);return{additionalFeatures:{minHeight:`${o}`,minWidth:`${d}`},height:a,left:(null==s?void 0:s.left)+m,minHeight:o,minWidth:d,top:(null==s?void 0:s.top)+m,width:r}};function aF(e){const n=null==e?void 0:e.isMainWindow;var i,a;n&&(null===(i=Dw.supportedRenderModes)||void 0===i||i.push(Fe.e.PartialOverlay),null===(a=Dw.supportedRenderModes)||void 0===a||a.push(Fe.e.OverlayThinHorizontalBar));return{getAppPhases:$A,getAppViewEntities:kC,getAppViewEntitiesProps:bC,getAppWindowFeatures:tF,getEventScenarioData:WC,manifest:Dw,render:({appRenderMode:e,onRenderEvent:i,scenarioFactory:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){let t;if(n){const e="shell-app";i("ChunkLoadStarted",{chunkName:e}),t=(yield(0,Pn.mT)(nF,e,a)).T2ShellViewsRenderer,i("ChunkLoadSucceeded",{chunkName:e})}else{const e="mw-shell-app";i("ChunkLoadStarted",{chunkName:e}),t=(yield(0,Pn.mT)(iF,e,a)).T1ShellViewsRenderer,i("ChunkLoadSucceeded",{chunkName:e})}return(0,Ie.t)(t,{appRenderMode:e})})),onIdle:({context:e})=>[yw(e)],onPreWarm:e=>{const{context:n}=e,i=[fw(n),Tw(n),Aw(n),qA(n),XA(n),eF(n)],t=function(e){const{client:n,coreSettings:i}=e,t=n;if(i.get(s.J.CdlWorker).enableStartupDeferral)return{id:"worker-start-sync",runOncePerId:!0,job:()=>{t.mutate({mutation:Fw,fetchPolicy:"no-cache",variables:{}})}}}(n);t&&i.push(t);const a=xA(n);return a&&i.push(a),i},onBeforeDeeplinkParsed:uw,eventHandlers:RA,onBeforeIntentAuthenticated:pw,onBeforeCommandHandled:cw,onCommandReceived:OA}}const oF={StoreDevices:"StoreDevices",StoreCartCheckout:"StoreCartCheckout",StoreCart:"StoreCart"},dF="viewStoreCartCheckout",lF="viewDeviceDetails",rF="viewStoreCart",sF="closeStoreCartCheckout",mF=e=>({actor:oF.StoreDevices,action:lF,data:e}),cF=()=>({actor:oF.StoreCart,action:rF}),uF=e=>({actor:oF.StoreCartCheckout,action:dF,data:e}),pF=()=>({actor:oF.StoreCartCheckout,action:sF}),yF=({commandInput:e,requestContext:{loggerFactory:n}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:i}}=e,t=n.newLogger("StoreApp onCommandReceived","apps-store");if(e.command.actor===Ew||e.command.actor===oF.StoreDevices||e.command.actor===oF.StoreCartCheckout||e.command.actor===oF.StoreCart)switch(i){case Mw:return{entity:{type:De.py.store,action:De.uk.view},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,correlation:{source:sn.D.Unknown}}};case lF:return{entity:{type:De.py.devicedetails,action:De.uk.view},command:{visibilityState:v.fe.show,stateTransition:v.su.extend,correlation:{source:sn.D.Store}},entityOptions:e.command.data};case rF:return{entity:{type:De.py.storecart,action:De.uk.view},command:{visibilityState:v.fe.show,stateTransition:v.su.extend,correlation:{source:sn.D.Store}}};case dF:return{entity:{type:De.py.storecartcheckout,action:De.uk.view},command:{visibilityState:v.fe.show,stateTransition:v.su.extend,correlation:{source:sn.D.Store}},entityOptions:e.command.data};case sF:return{entity:{type:De.py.storecartcheckout,action:De.uk.view},command:{visibilityState:v.fe.hide,stateTransition:v.su.flush,correlation:{source:sn.D.Store}}};default:t.error(`Command action '${i}' is not supported by StoreApp.`)}else t.error(`Command for actor '${e.command.actor}' cannot be handled by StoreApp.`)})),vF=e=>{if(kF(e))return gF(e)?{subNavEntity:NF(e),headerEntity:hF(e),startEntity:fF(e),mainEntity:_F(e),endEntity:SF(e)}:null},kF=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.store].includes(t),d=[De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},gF=()=>!0,NF=()=>null,hF=()=>null,fF=()=>null,_F=({entity:e})=>e,SF=()=>null,TF={id:"com.microsoft.teams.store",name:"StoreApp",actors:[Ew,...Object.keys(oF)],getLocalizedName:e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("extensibility"),e.stringTranslate("extensibility","extensibility_apps_label")})),supportedEntities:[De.py.store,De.py.storefre,De.py.devicedetails,De.py.storecart,De.py.storecartcheckout],supportedRenderModes:[Fe.S.Main,Fe.S.Modal],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},bF=[{filter:(e,n)=>Boolean(e.hash)&&((null==n?void 0:n.pathname)||"").startsWith("/subscriptionmanagement"),execute:({context:{coreSettings:e,loggerFactory:n}})=>{const{enableSubscriptionManagementInStore:i}=e.get(s.J.Extensibility),t=n.newLogger("Store:BeforeDeeplinkParsedCondition","apps-store");return i?(t.log("execute command handleSubscriptionManagementDeeplink"),Promise.resolve({entityCommand:{entity:{type:De.py.store,action:De.uk.manage},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,layoutMode:v.lO.standard},entityOptions:{tabType:"Subscriptions"}},metadata:{allowAnonymous:!1}})):(t.log(`Teams app subscription management is not enabled, enableSubscriptionManagementInStore value is ${i}`),Promise.reject({message:"teams-app-subscription-management-not-enabled"}))}},{filter:e=>{var n;return null===(n=e.pathname)||void 0===n?void 0:n.startsWith("/l/store")},execute:({deeplinkUrl:e})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n;const i=null!==(n=e.searchParams.get("id"))&&void 0!==n?n:"";return Promise.resolve({entityCommand:{entity:{id:i,type:De.py.store,action:De.uk.view},command:{stateTransition:v.su.flush,visibilityState:v.fe.show}},metadata:{allowAnonymous:!1}})}))},{filter:e=>{var n;return null===(n=e.pathname)||void 0===n?void 0:n.startsWith("/l/manageApps")},execute:({deeplinkUrl:e})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n,i;const t=null!==(n=e.searchParams.get("id"))&&void 0!==n?n:"",a=null!==(i=e.searchParams.get("scope"))&&void 0!==i?i:"",o=a===Fd.qi.Team;return Promise.resolve({entityCommand:{entity:{type:o?De.py.teammanageapps:De.py.chatManageApps,action:o?De.uk.view:De.uk.manage,id:t,linkedEntity:{type:o?De.py.channels:De.py.chats,id:t}},command:{stateTransition:v.su.forceFlush,visibilityState:v.fe.show,targetWindow:v.PH.main},entityOptions:{id:t,scope:a}},metadata:{allowAnonymous:!1}})}))},{filter:e=>{if(!e.pathname.startsWith("/l/app"))return!1;const{pathname:n}=e,i=null==n?void 0:n.split(/[/?&]/),t=null==i?void 0:i.indexOf("app");return!!(null==i?void 0:i[t+1])},execute:({deeplinkUrl:e,context:{loggerFactory:n}})=>{const i=n.newLogger("Store_handleAppInstallDeeplink","apps-store"),{pathname:t,search:a}=e,o=new URLSearchParams(a),d=o.get("source"),l=o.get("viewState"),r=o.get("templateInstanceId"),s=o.get("environment"),m=o.get("installAppPackage"),c=o.get("appTenantId"),u=null==t?void 0:t.split(/[/?&]/),p=null==u?void 0:u.indexOf("app"),y=null==u?void 0:u[p+1];let k;try{if("string"!=typeof l||l!==T_.v0.PostReview&&l!==T_.v0.ViewReviews){const e=l&&JSON.parse(l);"object"==typeof e&&"name"in e&&e.name in T_.v0&&(k=e)}else k={name:l}}catch(e){}const g={appId:y,deepLinkSource:d||"unknown",templateInstanceId:r||void 0,environment:s||void 0,installAppPackage:!!m,appTenantId:c||void 0,entryPoint:T_.RE.DeepLink,viewOptions:{defaultViewState:k}};return i.log("execute command handleAppInstallDeeplink"),Promise.resolve({entityCommand:{entityOptions:g,entity:{id:y,type:De.py.platformapp,action:De.uk.create},command:{visibilityState:v.fe.show,stateTransition:v.su.extend,correlation:{source:sn.D.StageViewDeeplink}}},metadata:{allowAnonymous:!1}})}}];var CF=i(840424);const wF={onEventReceived:({eventInput:{event:e,source:n}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){return(0,CF.Q0)(e)?Promise.resolve({command:mF(e.data()),source:n}):(0,CF.m3)(e)?Promise.resolve({command:cF(),source:n}):(0,CF.Is)(e)?Promise.resolve({command:uF(e.data()),source:n}):(0,CF.Bz)(e)?Promise.resolve({command:pF(),source:n}):Promise.resolve(void 0)}))},IF=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(256045),i.e(65477),i.e(241602),i.e(133950),i.e(268372),i.e(775758),i.e(236315),i.e(529375),i.e(105434),i.e(680254),i.e(545490),i.e(738693),i.e(834285),i.e(744700),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(215133),i.e(196348),i.e(269296),i.e(958163),i.e(399094),i.e(671682),i.e(511611),i.e(563370),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(842529),i.e(485984),i.e(722198),i.e(271428),i.e(394413),i.e(477708),i.e(628109),i.e(677395),i.e(249903),i.e(74043),i.e(542511),i.e(358329),i.e(216439),i.e(750078),i.e(218215),i.e(206166),i.e(714153),i.e(311474),i.e(625262),i.e(497130)]).then(i.bind(i,844910)),AF=()=>Promise.all([i.e(917388),i.e(790026),i.e(256045),i.e(65477),i.e(371935),i.e(755684),i.e(296056),i.e(277599),i.e(102207),i.e(729816),i.e(834285),i.e(942697),i.e(347761),i.e(409201),i.e(399094),i.e(671682),i.e(563370),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(842529),i.e(485984),i.e(722198),i.e(271428),i.e(394413),i.e(477708),i.e(628109),i.e(677395),i.e(74043),i.e(358329),i.e(270657),i.e(625262),i.e(822099)]).then(i.bind(i,530585)),FF=()=>Promise.all([i.e(413592),i.e(425270)]).then(i.bind(i,595105)),DF=()=>Promise.all([i.e(220097),i.e(158036),i.e(923870),i.e(659098)]).then(i.bind(i,913181));function EF(){const e=()=>null;return{getPlatformAppIdForEntity:e=>e.type===De.py.store?"ac40aa4a-fef1-4896-aea2-46d1c14dbfd5":void 0,onCommandReceived:yF,getAppViewEntities:vF,manifest:TF,render:({appRenderMode:n,onRenderEvent:i,scenarioFactory:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main){const e="store-app";i("ChunkLoadStarted",{chunkName:e});const[{StoreEntryRenderer:n}]=yield Promise.all([(0,Pn.mT)(IF,e,a),(0,Pn.mT)(FF,e,a),(0,Pn.mT)(DF,e,a)]);return i("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(ri.f,Object.assign({namespace:"extensibility",loaderRenderer:null},{children:(0,Ie.t)(n,{})}))}if(n===Fe.S.Modal){const e="store-fre-modal";i("ChunkLoadStarted",{chunkName:e});const{Modal:n}=yield(0,Pn.mT)(AF,e,a);return i("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(ri.f,Object.assign({namespace:"extensibility",loaderRenderer:null},{children:(0,Ie.t)(n,{})}))}return(0,Ie.t)(e,{})})),onBeforeDeeplinkParsed:bF,eventHandlers:wF}}const MF={id:"com.microsoft.teams.survey-form",name:"SurveyFormApp",supportedEntities:[De.py.survey,De.py.givefeedbackchoices],supportedRenderModes:[Fe.S.Main,Fe.S.Modal],windowFeatures:{[De.py.survey]:{minWidth:600,width:800,minHeight:400,height:640,offset:20},[De.py.givefeedbackchoices]:{minWidth:602,width:602,minHeight:500,height:500,offset:20}}},PF=e=>{if(RF(e))return OF(e)?{subNavEntity:$F(e),headerEntity:LF(e),startEntity:xF(e),mainEntity:BF(e),endEntity:jF(e)}:null},RF=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o={[De.py.givefeedbackchoices]:[De.uk.default,De.uk.view],[De.py.survey]:[De.uk.default,De.uk.view]},d=i&&(o[t]||[]).includes(i);return!(!a||!d)},OF=()=>!0,$F=()=>null,LF=()=>null,xF=()=>null,BF=({entity:e})=>e,jF=()=>null,UF={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"bootstrapFloodgate"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"firstLoginInformation"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userSurveyNotificationEnabled"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"bootstrapFloodgate"},arguments:[{kind:"Argument",name:{kind:"Name",value:"firstLoginInformation"},value:{kind:"Variable",name:{kind:"Name",value:"firstLoginInformation"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"userSurveyNotificationEnabled"},value:{kind:"Variable",name:{kind:"Name",value:"userSurveyNotificationEnabled"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]},VF={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"onSurveySend"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"onSurveySend"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"coachmarkId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FloodgatePrompt"}}},arguments:[]}]}}]},WF={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsSurveyFormGetUserPreferencesForCategorySubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"category"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategory"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferencesChangedEventForCategory"},arguments:[{kind:"Argument",name:{kind:"Name",value:"category"},value:{kind:"Variable",name:{kind:"Name",value:"category"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategory"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userEnableSurveysNotification"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferences"}}}]}}]},HF={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsSurveyFormFloodgateUpdateUserSurveyNotificationEnabledMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userSurveyNotificationEnabled"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"floodgateUpdateUserSurveyNotificationEnabled"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userSurveyNotificationEnabled"},value:{kind:"Variable",name:{kind:"Name",value:"userSurveyNotificationEnabled"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]},GF={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"firstLoginInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"firstLoginInfo"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformation"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferences"}}},arguments:[]}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"firstLoginInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Web"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]}.definitions]},JF={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsSurveyFormGetUserPreferencesForCategoryQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"category"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategory"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferencesForCategory"},arguments:[{kind:"Argument",name:{kind:"Name",value:"category"},value:{kind:"Variable",name:{kind:"Name",value:"category"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategory"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformationValue"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"firstLoginInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsSurveyFormGetUserPreferencesForCategoryFragment"}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformation"}},arguments:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UserEnableSurveysNotificationValue"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userEnableSurveysNotification"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserPreferencesCategoryValue"}}}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsSurveyFormGetUserPreferencesForCategoryFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FirstLoginInformation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Web"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"WebNorthStar"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"maglev"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"electron"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]}.definitions]},qF=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n,i;const t=yield e.query({query:JF,variables:{category:"firstLoginInformation"}});return"FirstLoginInformationValue"===(null===(n=t.data)||void 0===n?void 0:n.userPreferencesForCategory.__typename)?null===(i=t.data)||void 0===i?void 0:i.userPreferencesForCategory.firstLoginInformation:null})),zF="telemetry_instrumentation_feedback_platform_app_job_setup_floodgate",QF=(e,n,i,a,o)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var d;let l=null,r=null;if(a){const n=yield qF(e),i=o?[null==n?void 0:n.maglev,null==n?void 0:n.WebNorthStar]:[null==n?void 0:n.electron,null==n?void 0:n.Web];l=i.every((e=>!e||isNaN(Date.parse(e)))),r=i.map((e=>e&&!isNaN(Date.parse(e))?new Date(e):new Date)).reduce(((e,n)=>e<n?e:n),new Date).toISOString()}else{let n=null;n=i?yield qF(e):yield(s=e,(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var e,n;return null===(n=null===(e=(yield s.query({query:GF})).data)||void 0===e?void 0:e.userPreferences)||void 0===n?void 0:n.firstLoginInformation}))),r=(null==n?void 0:n.Web)||"",l=!r}var s;return l&&(null===(d=n.errorToTelemetry)||void 0===d||d.call(n,`First login information is not available! with enableUserPreferencesForCategoryQuery : ${i?"enabled":"disabled"} enableClientBasedFirstLoginInformation : ${a?"enabled":"disabled"} isReactWebClient : ${o?"yes":"no"}`,zF)),r})),YF=(e,n,i,a,o,d=!1,l=!1,r=!1)=>({id:"bootstrap-floodgate",runOncePerId:!0,job:()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var s;const m=i.newLogger("getBootstrapFloodgateJob","apps-suvey-form");m.log(`[getBootstrapFloodgateJob] Initializing floodgate [isAnonymousUser=${r}]`);try{const i=(new Date).toISOString(),s=r?i:yield QF(e,m,o,d,l),p=r?null:yield(u=e,(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var e,n;const i=yield u.query({query:JF,variables:{category:"userEnableSurveysNotification"}});return"UserEnableSurveysNotificationValue"===(null===(e=i.data)||void 0===e?void 0:e.userPreferencesForCategory.__typename)?null===(n=i.data)||void 0===n?void 0:n.userPreferencesForCategory.userEnableSurveysNotification:null}))),y=yield e.subscribe({query:VF,fetchPolicy:"no-cache"}).subscribe((({data:e,errors:i})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,o,d;if(i){null===(t=m.errorToTelemetry)||void 0===t||t.call(m,"[getBootstrapFloodgateJob] Error subscribing to floodgate. Stopping the subscription",zF);try{y.unsubscribe()}catch(e){null===(o=m.errorToTelemetry)||void 0===o||o.call(m,"[getBootstrapFloodgateJob] Error stopping floodgate",zF)}}null===(d=m.log)||void 0===d||d.call(m,`Activated survey: ${null==e?void 0:e.onSurveySend.id} with coachmark ${null==e?void 0:e.onSurveySend.coachmarkId}`,zF),(null==e?void 0:e.onSurveySend.coachmarkId)&&(yield n.esp.displaySurface(e.onSurveySend.coachmarkId),a.newScenario(c.RG.FloodgateSurvey).stop({context:JSON.stringify({surveyId:null==e?void 0:e.onSurveySend.id,coachmarkId:null==e?void 0:e.onSurveySend.coachmarkId})}))}))));yield e.mutate({mutation:UF,variables:{firstLoginInformation:s,userSurveyNotificationEnabled:p}});const v=yield e.subscribe({query:WF,variables:{category:"userEnableSurveysNotification"},fetchPolicy:"no-cache"}).subscribe((({data:n,errors:i})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,a,o;if(i){null===(t=m.errorToTelemetry)||void 0===t||t.call(m,"[getBootstrapFloodgateJob] Error subscribing to userSettings. Stopping the subscription",zF);try{v.unsubscribe()}catch(e){null===(a=m.errorToTelemetry)||void 0===a||a.call(m,"[getBootstrapFloodgateJob] Error stopping userSurveyNotificationEnabledSubscription",zF)}}const d=null===(o=null==n?void 0:n.userPreferencesChangedEventForCategory)||void 0===o?void 0:o.userEnableSurveysNotification;null!=d&&(yield e.mutate({mutation:HF,variables:{userSurveyNotificationEnabled:d}}))}))))}catch(e){null===(s=m.errorToTelemetry)||void 0===s||s.call(m,`[getBootstrapFloodgateJob] Error initializing floodgate [error.name=${null==e?void 0:e.name}] [isAnonymousUser=${r}]`,zF)}var u;m.log("[getBootstrapFloodgateJob] Floodgate initialized")}))}),KF=({context:{client:e,coreSettings:n,loggerFactory:i,entityCommanding:t,scenarioFactory:a,authenticationUser:o}})=>{const{enableFloodgateService:d,enableUserPreferencesForCategoryQuery:l,enableFloodgateServiceOnExperienceIdle:r,enableClientBasedFirstLoginInformation:m,enableAnonMeetingEndNpsSurvey:c}=n.get(s.J.Feedback),{isReactWebClient:u}=n.get(s.J.Extensibility),p=[],y=e,v=(null==o?void 0:o.type)===Jy.Ch.Anonymous;return!d||r&&!(v&&c)||p.push(YF(y,t,i,a,l,m,u,v)),p},XF={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsSurveyFormFloodgateLogActivityMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activityName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"increment"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"floodgateLogActivity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activityName"},value:{kind:"Variable",name:{kind:"Name",value:"activityName"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"increment"},value:{kind:"Variable",name:{kind:"Name",value:"increment"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]};class ZF extends HT.i{constructor(){super(gn.Yg.GeneralizedLogActivityTask,["client","hostCommunicationService","coreSettings","loggerFactory"])}execute(e){var n,i;return(0,t.__awaiter)(this,void 0,void 0,(function*(){const{client:t,hostCommunicationService:a,coreSettings:o,loggerFactory:d}=e,l=d.newLogger("generalizedLogActivityTask","apps-suvey-form");if(null==o?void 0:o.get(s.J.SurveyForm).enableCsatTaskRegistration){if(!a)return;try{const e=yield a.loadModule("surveyform"),i=null===(n=null==e?void 0:e.registerForLogActivity)||void 0===n?void 0:n.call(e,(e=>{((e,n,i)=>{e.mutate({mutation:XF,variables:{activityName:n,increment:i}})})(t.client,e.activityName,e.incrementValue)}));return()=>{i&&i()}}catch(e){return void(null===(i=l.errorToTelemetry)||void 0===i||i.call(l,`Loading module surveyform failed with errorCode: ${e.errorCode}`,"generalized_log_activity_task"))}}}))}}const eD=({context:{client:e,coreSettings:n,loggerFactory:i,entityCommanding:t,scenarioFactory:a}})=>{const{enableFloodgateService:o,enableUserPreferencesForCategoryQuery:d,enableFloodgateServiceOnExperienceIdle:l,enableClientBasedFirstLoginInformation:r}=n.get(s.J.Feedback),{isReactWebClient:m}=n.get(s.J.Extensibility),c=[],u=e;return o&&l&&c.push(YF(u,t,i,a,d,r,m,false)),c},nD=()=>Promise.all([i.e(917388),i.e(241602),i.e(5038),i.e(347761),i.e(418218),i.e(668575),i.e(839180),i.e(311119),i.e(211286)]).then(i.bind(i,91115)),iD=({host:e,entityType:n})=>{if(!e)return null;const{windowFeatures:i}=MF,t=n&&i&&i[n]?i[n]:null!=i?i:void 0,{height:a=1,width:o=1,minHeight:d,minWidth:l}=t||{},r={left:e.screenX,top:e.screenY};if(e.screen){return{left:Math.max((e.screen.availWidth-o)/2,0),top:Math.max((e.screen.availHeight-a)/2,0),additionalFeatures:{minHeight:`${d}`,minWidth:`${l}`},minHeight:d,minWidth:l,height:Math.min(a,e.screen.availHeight),width:Math.min(o,e.screen.availWidth)}}return{left:Math.max(r.left,0),top:Math.max(r.top,0),additionalFeatures:{minHeight:`${d}`,minWidth:`${l}`},minHeight:d,minWidth:l,height:a,width:o}};function tD(){return{getAppViewEntities:PF,getAppWindowFeatures:iD,manifest:MF,render:({appRenderMode:e,onRenderEvent:n,scenarioFactory:i})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t="survey-form-entry";n("ChunkLoadStarted",{chunkName:t});const a=(yield(0,Pn.mT)(nD,t,i)).SurveyAppViewsRenderer;return n("ChunkLoadSucceeded",{chunkName:t}),(0,Ie.t)(ri.f,Object.assign({namespace:"survey",loaderRenderer:null},{children:(0,Ie.t)(a,{appRenderMode:e})}))})),onPreWarm:KF,onRegister:e=>{e.registerTask(new ZF)},onExperienceLongIdle:eD}}var aD=i(560169),oD=i(431447);const dD=e=>{if(lD(e))return{subNavEntity:rD(e),headerEntity:sD(e),startEntity:mD(e),mainEntity:cD(e),endEntity:uD(e)}},lD=({entity:e,layoutMode:n})=>{const{action:i=null,type:t}=Object.assign({},e),a=["focus","standard"].includes(n),o=[De.py.simplecollab,De.py.simplecollabcreateconversationfolder,De.py.simplecollabremoveconversationfolder,De.py.teamseeallchannels,De.py.simplecollabrenameconversationfolder].includes(t),d=[De.uk.create,De.uk.default,De.uk.info,De.uk.list,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},rD=({entity:e,layoutMode:n})=>{if("focus"===n)return null;const{type:i,id:t,options:a,windowOptions:o}=e;return{action:De.uk.list,entityState:{flushableByLinkedEntity:!0},id:t,linkedEntity:null,type:i,windowOptions:o,options:a}},sD=({entity:e,contextEntity:n})=>{if(n&&n.action===De.uk.view)switch(n.type){case De.py.channels:case De.py.teamseeallchannels:return n}let i=e.type;if(e.id)try{const n=JSON.parse(e.id);(null==n?void 0:n.channelId)&&(i=De.py.channels)}catch(e){i=De.py.chats}return Object.assign(Object.assign({},e),{type:i})},mD=()=>null,cD=({entity:e,contextEntity:n})=>{let i=De.uk.view;const{action:t=null}=Object.assign({},e),a=[De.uk.view,De.uk.default];t&&a.includes(t)&&(i=t);let o=e.type;if(e.id)try{const n=JSON.parse(e.id);(null==n?void 0:n.channelId)&&(o=De.py.channels)}catch(e){o=De.py.chats}return n||Object.assign(Object.assign({},e),{action:i,type:o})},uD=({entity:e,contextEntity:n,coreSettings:i,layoutMode:t,userPreferences:a})=>{var o,d,l,r;const m=(null==n?void 0:n.id)||e.id,c=(null==n?void 0:n.type)||e.type,u=null!==(o=null==n?void 0:n.options)&&void 0!==o?o:e.options,p=JSON.parse(null!=u?u:"{}"),y=(null===(d=null==a?void 0:a.infoPane)||void 0===d?void 0:d.channels)?"closed"===a.infoPane.channels:!!(null===(l=null==i?void 0:i.get(s.J.Channels))||void 0===l?void 0:l.disableChannelInfoPaneOpenByDefault);if(!kD(m,c,n,i,t,y,p.source)&&!p.channelCopilotOpen)return null;const{enableChannelInfoPaneSearch:v}=null!==(r=null==i?void 0:i.get(s.J.Channels))&&void 0!==r?r:{};if(p.source===sn.D.ChannelContextualSearch)return{id:m,action:De.uk.info,type:De.py.channelcontextualsearch};if((null==n?void 0:n.type)===De.py.channelcopilot||p.channelCopilotOpen)return{id:m,action:De.uk.info,type:De.py.channelcopilot};const{replyChainId:k}=(0,oD.kO)(null!=m?m:"");if(k&&(!v||(null==n?void 0:n.type)!==De.py.channelcontextualsearch))return null;if(n){const{action:e,type:i}=n;if(e===De.uk.info&&gD(i,!!v))return n;if(i!==De.py.channels)return null}const{channelId:g}=(0,Eu.jd)(null!=m?m:"");return{id:(0,wo.u4)({channelId:g}),action:De.uk.info,type:De.py.channels}},pD=({areEmptySlotsTransparent:e})=>({mainEntity:{[Fe.S.Main]:{isBackgroundTransparent:e}},headerEntity:{[Fe.S.HorizontalBar]:{isBackgroundTransparent:e}},subNavEntity:{[Fe.S.Rail]:{areSlotShadowsDisabled:!1,isBackgroundTransparent:e}}}),yD=[De.py.channels,De.py.channelcopilot,De.py.channelcontextualsearch,De.py.channelsPinnedPost,De.py.channelsSystemMessage],vD=["standard","focus"],kD=(e,n,i,t,a,o,d)=>{var l,r;const{enableChannelInfoPaneSearch:m,enableChannelInfoPane:c=!1,enableChannelCopilotInL2Header:u=!1}=null!==(l=null==t?void 0:t.get(s.J.Channels))&&void 0!==l?l:{},{enableInfoPaneAsResponsiveMenu:p=!1}=null!==(r=null==t?void 0:t.get(s.J.Core))&&void 0!==r?r:{};return!!(e&&vD.includes(a)&&yD.includes(n))&&(!(!m||d!==sn.D.ChannelContextualSearch&&(null==i?void 0:i.type)!==De.py.channelcontextualsearch)||(!(!u||(null==i?void 0:i.type)!==De.py.channelcopilot)||!(o||!c||!p)))},gD=(e,n)=>{switch(e){case De.py.channelsPinnedPost:case De.py.channelsSystemMessage:return!0;case De.py.channelcontextualsearch:return n;default:return!1}};var ND=i(574229);const hD={id:ND.Bh,actors:[sI],name:"SimpleCollabApp",getLocalizedName:e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("simpleCollab"),e.stringTranslate("simpleCollab","simple_collab_app_name")})),supportedEntities:[De.py.simplecollab,De.py.simplecollabcreateconversationfolder,De.py.simplecollabremoveconversationfolder,De.py.teamseeallchannels,De.py.simplecollabrenameconversationfolder],supportedRenderModes:[Fe.S.HorizontalBar,Fe.S.Main,Fe.S.Rail,Fe.S.Modal],getDefaultCommand:()=>({type:De.py.simplecollab,action:De.uk.default}),windowFeatures:{minWidth:602,width:602,minHeight:500,height:500,offset:20,widthToScreenWidthRatio:.3,heightToWidthRatio:1.125}},fD={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsSimpleCollabDefaultChatIdQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"defaultChatId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]};var _D=i(717390);const SD=({commandInput:e,requestContext:n})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:i,data:a}}=e,{client:o,loggerFactory:d}=n;if(e.command.actor===sI)switch(i){case mI:return function(e,n){return(0,t.__awaiter)(this,void 0,void 0,(function*(){let i={};const a=_D.simpleCollabStore.get(_D.selectedConversationIdAtom),o=_D.simpleCollabStore.get(_D.selectedTeamIdAtom);i={type:De.py.simplecollab,action:De.uk.default};let d={};const l={id:a,type:De.py.simplecollab,action:De.uk.default};if(a&&!o)i={action:De.uk.view,id:a,type:De.py.chats,linkedEntity:l},d={isViewFromSimpleCollab:!0};else if(a){const e=JSON.stringify({channelId:a,teamId:o});i={action:De.uk.view,id:e,type:De.py.channels,linkedEntity:l},d={isViewFromSimpleCollab:!0},l.id=e}else{const a=yield function(e,n){return(0,t.__awaiter)(this,void 0,void 0,(function*(){let i=null;try{const{data:n}=yield e.query({query:fD});i=n.defaultChatId}catch(e){n.newLogger("SimpleCollabApp defaultChatId","app-on-command-received").error("Failed to get defaultChatId for simple collab app")}return i}))}(e,n);a&&(l.id=a,d={isViewFromSimpleCollab:!0},i={action:De.uk.view,id:a,type:De.py.chats,linkedEntity:l})}return{entity:i,entityOptions:d,command:{visibilityState:v.fe.show,stateTransition:v.su.flush,correlation:{source:sn.D.Unknown}}}}))}(o,d);case cI:return function(e){const{id:n,openInPopout:i,correlationId:t,commandSource:a}=e,o={action:De.uk.view,id:n,type:De.py.chats};return{command:{stateTransition:i?v.su.new:v.su.flow,visibilityState:v.fe.show,correlation:{id:t,source:a||sn.D.SimpleCollabChatListItem,startTimestamp:Date.now()}},entity:o,entityOptions:{isViewFromSimpleCollab:!0}}}(a);case uI:return function(e){const{channelId:n,teamId:i,replyChainId:t,deepLinkId:a,correlationId:o,commandSource:d,back:l,stateTransition:r,linkedEntity:s}=e,m=JSON.stringify({channelId:n,teamId:i,replyChainId:t}),c={action:De.uk.view,id:m,type:De.py.channels,linkedEntity:s};return{command:{stateTransition:null!=r?r:v.su.flow,visibilityState:v.fe.show,correlation:{id:o,source:d||sn.D.SimpleCollabChannelListItem}},entity:c,entityOptions:{isViewFromSimpleCollab:!0,deepLinkId:a,back:!!l}}}(a);case pI:return function(e){const{channelId:n,channelName:i,teamName:t,commandSource:a}=e,o={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:a||sn.D.ChannelListItem}},d={id:n,action:De.uk.view,type:De.py.channelnotificationsettings},l={isViewFromSimpleCollab:!0,commandSource:a||sn.D.ChannelListItem,teamName:t,channelName:i};return{command:o,entity:d,entityOptions:l}}(a);case yI:return function(e){const{teamId:n,channelId:i,teamName:t,channelName:a,correlationIdOverride:o}=e,d={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:sn.D.ChannelListItem,id:o||(0,et.v4)()}},l={id:i,action:De.uk.view,type:De.py.channelworkflows},r={isViewFromSimpleCollab:!0,commandSource:sn.D.ChannelListItem,teamName:t,channelName:a,teamId:n,conversationId:i};return{command:d,entity:l,entityOptions:r}}(a);case vI:return function(e){const{channelId:n,channelName:i,channelType:t,filesUrl:a,teamId:o,teamName:d,channelSubstrateGroupId:l,channelOnlyMember:r,isGeneral:s,isShown:m,groupId:c,teamTenantId:u}=e,p={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:sn.D.TeamChannels}},y={action:De.uk.view,type:De.py.deletechannelreactdialog};return{command:p,entity:y,entityOptions:{isViewFromSimpleCollab:!0,channelName:i,teamName:d,channelType:t,filesUrl:a,channelId:n,teamId:o,channelSubstrateGroupId:l,channelOnlyMember:r,isGeneral:s,isShown:m,groupId:c,teamTenantId:u}}}(a);case kI:return function(e){const{teamId:n,channelId:i}=e,t={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:sn.D.ExtensionCommanding}},a={action:De.uk.view,type:De.py.createchanneldialog};return{command:t,entity:a,entityOptions:{isViewFromSimpleCollab:!0,channelId:i,teamId:n}}}(a);case gI:return function(e){const{teamId:n,channelId:i,channelName:t,displayName:a,groupId:o,teamName:d,channelResourceTenantId:l,commandSource:r}=e,s={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:r||sn.D.GetLinkToChannelMenuButton}},m={action:De.uk.view,type:De.py.getlinktoteamorchanneldialog};return{command:s,entity:m,entityOptions:{isViewFromSimpleCollab:!0,selectedChannelId:i,linkType:"Channel",teamId:n,groupId:o,displayName:a,teamName:d,channelName:t,channelResourceTenantId:l}}}(a);case NI:return function(e){const{channelId:n,teamId:i,commandSource:t}=e,a={stateTransition:v.su.flow,visibilityState:v.fe.show,correlation:{source:t||sn.D.SimpleCollabChannelListItem}},o={id:n,action:De.uk.view,type:De.py.channelmanage,linkedEntity:{id:n,type:De.py.channels,action:De.uk.list}};return{command:a,entity:o,entityOptions:{isViewFromSimpleCollab:!0,parentTeamId:i}}}(a);case fI:return function(e){const{channelId:n,teamId:i,commandSource:t}=e,a={stateTransition:v.su.flow,visibilityState:v.fe.show,correlation:{source:t||sn.D.SimpleCollabChannelListItem}},o={id:n,action:De.uk.view,type:De.py.channelmembers,linkedEntity:{id:n,type:De.py.channels,action:De.uk.list}};return{command:a,entity:o,entityOptions:{isViewFromSimpleCollab:!0,parentTeamId:i}}}(a);case hI:return function(e){const{channelId:n,teamId:i,tagId:t}=e,a={stateTransition:v.su.flow,visibilityState:v.fe.show,correlation:{source:sn.D.ChannelListItem}},o={id:n,action:De.uk.view,type:De.py.channeltags,linkedEntity:{id:n,type:De.py.channels,action:De.uk.list}};return{command:a,entity:o,entityOptions:{isViewFromSimpleCollab:!0,parentTeamId:i,tagId:t}}}(a);case _I:return function(e){const{channelId:n,commandSource:i}=e,t={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:i||sn.D.ChannelEmail}},a={id:n,action:De.uk.view,type:De.py.channelemailv2};return{command:t,entity:a,entityOptions:{isViewFromSimpleCollab:!0,channelId:n}}}(a);case FI:return function(e){const{teamId:n,channelId:i,commandSource:t}=e,a={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:t||sn.D.ExtensionCommanding}},o={id:i,action:De.uk.view,type:De.py.addmembertoprivatechanneldialog};return{command:a,entity:o,entityOptions:{isViewFromSimpleCollab:!0,parentTeamId:n}}}(a);case DI:return function(e){const{teamId:n,channelId:i,teamName:t,channelName:a,isLastOwner:o,groupId:d,channelOnlyMember:l,commandSource:r}=e,s=o?De.py.leavechannellastownerdialog:De.py.leavechanneldialog,m={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:r||sn.D.ChannelLeaveContextMenuButton}},c={action:De.uk.view,type:s};return{command:m,entity:c,entityOptions:{isViewFromSimpleCollab:!0,channelName:a,channelId:i,teamId:n,teamName:t,isLastOwner:o,groupId:d,channelOnlyMember:l}}}(a);case EI:return function(e){const{channelId:n,commandSource:i}=e,t={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:i||sn.D.ExtensionCommanding}},a={id:n,action:De.uk.view,type:De.py.sharechannelwithuserdialog};return{command:t,entity:a,entityOptions:{isViewFromSimpleCollab:!0}}}(a);case MI:return function(e){const{channelId:n,teamId:i,commandSource:t}=e,a={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:t||sn.D.ExtensionCommanding}},o={id:n,action:De.uk.view,type:De.py.sharedchannelcreateinvitationsdialog,linkedEntity:{id:n,type:De.py.channels,action:De.uk.list}};return{command:a,entity:o,entityOptions:{isViewFromSimpleCollab:!0,channelId:n,teamId:i}}}(a);case PI:return function(e){const{channelId:n,teamId:i}=e,t={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:sn.D.ExtensionCommanding}},a={id:n,action:De.uk.view,type:De.py.sharewithteamyouowndialog};return{command:t,entity:a,entityOptions:{isViewFromSimpleCollab:!0,channelId:n,teamId:i}}}(a);case SI:return function(e){const{teamId:n,commandSource:i}=e,t={id:n,action:De.uk.view,type:De.py.teammanage,linkedEntity:{id:n||"",type:De.py.channels,action:De.uk.list}};return{command:{stateTransition:v.su.flow,visibilityState:v.fe.show,correlation:{source:i||sn.D.SimpleCollabChatListItem}},entity:t,entityOptions:{isViewFromSimpleCollab:!0}}}(a);case TI:return function(e){const{teamId:n,commandSource:i}=e,t={stateTransition:v.su.flow,visibilityState:v.fe.show,correlation:{source:i||sn.D.SimpleCollabChannelListItem}},a={id:n,action:De.uk.view,type:De.py.teammanagetags};return{command:t,entity:a,entityOptions:{isViewFromSimpleCollab:!0}}}(a);case bI:return function(e){const{teamId:n,displayName:i,groupId:t,teamName:a,channelResourceTenantId:o}=e,d={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:sn.D.GetLinkToTeamMenuButton}},l={action:De.uk.view,type:De.py.getlinktoteamorchanneldialog};return{command:d,entity:l,entityOptions:{isViewFromSimpleCollab:!0,selectedChannelId:n,linkType:"Team",teamId:n,groupId:t,displayName:i,teamName:a,channelResourceTenantId:o}}}(a);case CI:return function(e){const{teamId:n,groupId:i,teamName:t}=e,a={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:sn.D.SimpleCollabChannelListItem}},o={id:n,action:De.uk.view,type:De.py.leaveteam};return{command:a,entity:o,entityOptions:{isViewFromSimpleCollab:!0,teamName:t,groupId:i,teamThreadId:n}}}(a);case wI:return function(e){const{teamId:n}=e,i={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:sn.D.ExtensionCommanding}},t={id:n,action:De.uk.view,type:De.py.addmembertoteamdialog};return{command:i,entity:t,entityOptions:{isViewFromSimpleCollab:!0}}}(a);case II:return function(e){const{teamId:n,groupId:i}=e,t={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:sn.D.ExtensionCommanding}},a={action:De.uk.view,type:De.py.createchanneldialog};return{command:t,entity:a,entityOptions:{isViewFromSimpleCollab:!0,teamId:n,groupId:i,entryPoint:"TeamContextMenu"}}}(a);case AI:return function(e){const{teamId:n,teamName:i,groupId:t}=e,a={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:sn.D.SimpleCollabChannelListItem}},o={id:n,action:De.uk.view,type:De.py.deleteteam};return{command:a,entity:o,entityOptions:{teamName:i,groupId:t,threadId:n,isViewFromSimpleCollab:!0}}}(a);case xI:return function(e){const{id:n}=e,i={id:n,action:De.uk.manage,type:De.py.chatManageApps,linkedEntity:{id:n,type:De.py.chats}};return{command:{stateTransition:v.su.flow,visibilityState:v.fe.show,correlation:{source:sn.D.SimpleCollabChatListItem}},entity:i,entityOptions:{isViewFromSimpleCollab:!0}}}(a);case BI:return function(e){const{id:n,isGuardianChat:i}=e,t={id:n,action:De.uk.delete,type:De.py.leavechat};return{command:{stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:sn.D.SimpleCollabChatListItem}},entity:t,entityOptions:{isViewFromSimpleCollab:!0,convId:n,isGuardianChat:i}}}(a);case OI:return function(e){const{conversationId:n}=e,i={action:De.uk.view,type:De.py.simplecollabcreateconversationfolder};return{command:{stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:sn.D.SimpleCollabConversationFolder}},entity:i,entityOptions:{isViewFromSimpleCollab:!0,conversationId:n}}}(a);case $I:return function(e){const{conversationFolderName:n,folderId:i,conversationFoldersConnectionId:t,commandSource:a}=e,o={action:De.uk.view,type:De.py.simplecollabremoveconversationfolder};return{command:{stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:a||sn.D.SimpleCollabConversationFolder}},entity:o,entityOptions:{isViewFromSimpleCollab:!0,conversationFolderName:n,folderId:i,conversationFoldersConnectionId:t}}}(a);case LI:return function(e){const{conversationFolderName:n,folderId:i}=e,t={action:De.uk.view,type:De.py.simplecollabrenameconversationfolder};return{command:{stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:sn.D.SimpleCollabConversationFolder}},entity:t,entityOptions:{isViewFromSimpleCollab:!0,conversationFolderName:n,folderId:i}}}(a);case RI:return{entity:{type:De.py.discoversurface,action:De.uk.view},command:{stateTransition:v.su.flow,visibilityState:v.fe.show,correlation:{source:sn.D.DiscoverSurfaceEntry}}};case jI:return function(e){const{teamId:n,commandSource:i,hideSlotHeader:t}=e,a={stateTransition:v.su.flow,visibilityState:v.fe.show,correlation:{source:i||sn.D.UserOnboardingTeam}},o={id:n,action:De.uk.view,type:De.py.teamseeallchannels,linkedEntity:{id:n,action:De.uk.view,type:De.py.teamseeallchannels}};return{command:a,entity:o,entityOptions:{hideSlotHeader:t,isViewFromSimpleCollab:!0}}}(a);case UI:return function(e){const{commandSource:n}=e,i={type:De.py.teamsgallery,action:De.uk.view};return{command:{stateTransition:v.su.flush,visibilityState:v.fe.show,correlation:{source:n||sn.D.TeamsGallery}},entity:i,entityOptions:{isViewFromSimpleCollab:!0}}}(a);case VI:return function(e){const{commandSource:n}=e,i={type:De.py.createchannelleftraildialog,action:De.uk.view};return{command:{stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:n||sn.D.ExtensionCommanding}},entity:i,entityOptions:{isViewFromSimpleCollab:!0,entryPoint:"ChannelListHeaderContextMenu"}}}(a);case WI:return function(e){const{commandSource:n}=e,i={type:De.py.teamcreatedialog,action:De.uk.view};return{command:{stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:n||sn.D.ExtensionCommanding}},entity:i,entityOptions:{isViewFromSimpleCollab:!0}}}(a);case HI:return function(e){const{commandSource:n}=e,i={type:De.py.teamslist,action:De.uk.view};return{command:{stateTransition:v.su.flow,visibilityState:v.fe.show,correlation:{source:n||sn.D.ChannelList}},entity:i,entityOptions:{isViewFromSimpleCollab:!0}}}(a);default:return}}));var TD=i(705852);const bD="unifiedApp",CD={actionGesture:ei.uS.click,actionOutcome:ei.$K.select,actionOutcomeNew:ei.$K.nav},wD={panelRegion:ei.Ai.left,panelRegionNew:ei.Ai.left,panelType:ei.wh.teamChannelList,panelTypeNew:ei.wh.teamChannelList,panelUri:"app.conversation"},ID=(e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,a,o,d,l,r,s;const{data:m,type:c}=e,u=n.newLogger("SimpleCollabTeamContextMenuEvent","simple-collab-context-menu"),{recordPanelAction:p,createDatabag:y}=i;switch(c){case TD._H.manageTeam:{const e="function"==typeof m?m():{};return null===(t=u.infoToTelemetry)||void 0===t||t.call(u,`manageTeam: teamId: ${e.teamId}`,"simple_collab_team_context_menu_manage_team"),((e,n,i)=>{const t=null==i?void 0:i();t&&(t.isChannelsV2=!0),n(Object.assign(Object.assign(Object.assign(Object.assign({},CD),{appName:bD,actionScenario:ei.Tk.teamNav,actionScenarioType:ei.Yu.openteam,actionSubworkload:ei.eD.teamManagement,actionWorkload:ei.sz.teamChannelManagement,eventIdentifier:ei.b6.listItem_menuItem_click_teamNav,moduleName:ei.rA.listItem,moduleNameNew:ei.rA.manageTeamMenuItem,moduleType:ei.PO.menuItem,moduleTypeNew:ei.PO.teamListOverflowMenu}),wD),{dataBag:t}),e),null==t||t.dispose()})(u,p,y),Promise.resolve({command:rA(e)})}case TD._H.manageTags:{const e="function"==typeof m?m():{};return null===(a=u.infoToTelemetry)||void 0===a||a.call(u,`manageTags: teamId: ${e.teamId}`,"simple_collab_team_context_menu_manage_tags"),((e,n,i)=>{const t=null==i?void 0:i();t&&(t.isChannelsV2=!0),n(Object.assign(Object.assign(Object.assign(Object.assign({},CD),{appName:bD,actionScenario:ei.Tk.openManageTagsDialog,actionScenarioType:ei.Yu.openDialog,actionSubworkload:ei.eD.tagManagement,actionWorkload:ei.sz.teamChannelManagement,eventIdentifier:ei.b6.button_click_openManageTagsDialog,moduleNameNew:ei.rA.manageTeamTags,moduleType:ei.PO.button,moduleTypeNew:ei.PO.teamListOverflowMenu}),wD),{dataBag:t}),e),null==t||t.dispose()})(u,p,y),Promise.resolve({command:sA(e)})}case TD._H.getLinkToTeam:{const e="function"==typeof m?m():{};return null===(o=u.infoToTelemetry)||void 0===o||o.call(u,`getLinkToTeam: teamId: ${e.teamId}, groupId: ${e.groupId}`,"simple_collab_team_context_menu_get_link_to_team"),((e,n,i)=>{const t=null==i?void 0:i();t&&(t.isChannelsV2=!0),n(Object.assign(Object.assign(Object.assign(Object.assign({},CD),{appName:bD,actionScenario:ei.Tk.getTeamDeeplink,actionScenarioType:ei.Yu.openDialog,actionSubworkload:ei.eD.teamManagement,actionWorkload:ei.sz.teamChannelManagement,eventIdentifier:ei.b6.listItem_menuItem_click_getTeamDeeplink,moduleName:ei.rA.listItem,moduleNameNew:ei.rA.getTeamLinkMenuItem,moduleType:ei.PO.menuItem,moduleTypeNew:ei.PO.teamListOverflowMenu}),wD),{dataBag:t}),e),null==t||t.dispose()})(u,p,y),Promise.resolve({command:mA(e)})}case TD._H.leaveTeam:{const e="function"==typeof m?m():{};return null===(d=u.infoToTelemetry)||void 0===d||d.call(u,`getLinkToTeam: teamId: ${e.teamId}, groupId: ${e.groupId}`,"simple_collab_team_context_menu_leave_team"),((e,n,i)=>{const t=null==i?void 0:i();t&&(t.isChannelsV2=!0),n(Object.assign(Object.assign(Object.assign(Object.assign({},CD),{appName:bD,actionScenario:ei.Tk.leaveTeam,actionScenarioType:ei.Yu.admin,actionSubworkload:ei.eD.leaveTeam,actionWorkload:ei.sz.teamChannelManagement,eventIdentifier:ei.b6.listItem_menuItem_click_leaveTeam,moduleName:ei.rA.listItem,moduleNameNew:ei.rA.leaveTeamMenuItem,moduleType:ei.PO.menuItem,moduleTypeNew:ei.PO.teamListOverflowMenu}),wD),{dataBag:t}),e),null==t||t.dispose()})(u,p,y),Promise.resolve({command:cA(e)})}case TD._H.teamAddMember:{const e="function"==typeof m?m():{};return null===(l=u.infoToTelemetry)||void 0===l||l.call(u,`teamAddMember: teamId: ${e.teamId}`,"simple_collab_team_context_menu_team_add_member"),((e,n,i)=>{const t=null==i?void 0:i();t&&(t.isChannelsV2=!0),n(Object.assign(Object.assign(Object.assign(Object.assign({},CD),{appName:bD,actionScenario:ei.Tk.addMember,actionScenarioType:ei.Yu.openDialog,actionSubworkload:ei.eD.addMember,actionWorkload:ei.sz.teamChannelManagement,eventIdentifier:ei.b6.addMember_menuItem_click_addMember,moduleName:ei.rA.addMember,moduleNameNew:ei.rA.addMemberMenuItem,moduleType:ei.PO.menuItem,moduleTypeNew:ei.PO.teamListOverflowMenu}),wD),{dataBag:t}),e),null==t||t.dispose()})(u,p,y),Promise.resolve({command:uA(e)})}case TD._H.teamAddChannel:{const e="function"==typeof m?m():{};return null===(r=u.infoToTelemetry)||void 0===r||r.call(u,`teamAddChannel: teamId: ${e.teamId}`,"simple_collab_team_context_menu_team_add_channel"),((e,n,i)=>{const t=null==i?void 0:i();t&&(t.isChannelsV2=!0),n(Object.assign(Object.assign(Object.assign(Object.assign({},CD),{appName:bD,actionScenario:ei.Tk.addChannel,actionScenarioType:ei.Yu.openDialog,actionSubworkload:ei.eD.addChannel,actionWorkload:ei.sz.teamChannelManagement,eventIdentifier:ei.b6.addChannel_teamActionMenu_click_addChannel,moduleName:ei.rA.addChannel,moduleNameNew:ei.rA.addChannelMenuItem,moduleType:ei.PO.teamActionMenu,moduleTypeNew:ei.PO.teamListOverflowMenu}),wD),{dataBag:t}),e),null==t||t.dispose()})(u,p,y),Promise.resolve({command:pA(e)})}case TD._H.deleteTeam:{const e="function"==typeof m?m():{};return null===(s=u.infoToTelemetry)||void 0===s||s.call(u,`deleteTeam: teamId: ${e.teamId}, groupId: ${e.groupId}`,"simple_collab_team_context_menu_delete_team"),((e,n,i)=>{const t=null==i?void 0:i();t&&(t.isChannelsV2=!0),n(Object.assign(Object.assign(Object.assign(Object.assign({},CD),{appName:bD,actionScenario:ei.Tk.deleteTeam,actionScenarioType:ei.Yu.openDialog,actionSubworkload:ei.eD.teamManagement,actionWorkload:ei.sz.teamChannelManagement,eventIdentifier:ei.b6.manageTagsDialog_teamActionMenu_click_deleteTeam,moduleName:ei.rA.manageTagsDialog,moduleNameNew:ei.rA.deleteTeamMenuItem,moduleType:ei.PO.teamActionMenu,moduleTypeNew:ei.PO.teamListOverflowMenu}),wD),{dataBag:t}),e),null==t||t.dispose()})(u,p,y),Promise.resolve({command:yA(e)})}default:return}})),AD=({logger:e,i18n:n})=>{var i;return null===(i=e.infoToTelemetry)||void 0===i||i.call(e,"Create conversation folder succeeded.","simple_collab_create_conversation_folder"),Promise.resolve({command:rc({intent:"Success",title:n.stringTranslate("simpleCollab","simple_collab_toast_create_folder_success"),dismissOnAction:!0})})},FD=({data:e,logger:n,i18n:i})=>{var t;const a="function"==typeof e?e():{};return null===(t=n.errorToTelemetry)||void 0===t||t.call(n,`Create conversation folder failed. errorCode: ${a.errorCode}, errorDetail: ${a.errorDetail}`,"simple_collab_create_conversation_folder"),Promise.resolve({command:rc({intent:"Error",title:i.stringTranslate("simpleCollab","simple_collab_toast_create_folder_failed"),dismissOnAction:!0})})},DD=({logger:e,i18n:n})=>{var i;return null===(i=e.infoToTelemetry)||void 0===i||i.call(e,"Rename conversation folder succeeded.","simple_collab_rename_conversation_folder"),Promise.resolve({command:rc({intent:"Success",title:n.stringTranslate("simpleCollab","simple_collab_toast_rename_folder_success"),dismissOnAction:!0})})},ED=({data:e,logger:n,i18n:i})=>{var t;const a="function"==typeof e?e():{};return null===(t=n.errorToTelemetry)||void 0===t||t.call(n,`Rename conversation folder failed. errorDetail: ${a.errorDetail}`,"simple_collab_rename_conversation_folder"),Promise.resolve({command:rc({intent:"Error",title:i.stringTranslate("simpleCollab","simple_collab_toast_rename_folder_failed"),dismissOnAction:!0})})},MD=({logger:e,i18n:n})=>{var i;return null===(i=e.infoToTelemetry)||void 0===i||i.call(e,"Remove conversation folder succeeded.","simple_collab_remove_conversation_folder"),Promise.resolve({command:rc({intent:"Success",title:n.stringTranslate("simpleCollab","simple_collab_toast_remove_folder_success"),dismissOnAction:!0})})},PD=({logger:e,i18n:n})=>{var i;return null===(i=e.errorToTelemetry)||void 0===i||i.call(e,"Remove conversation folder failed.","simple_collab_remove_conversation_folder"),Promise.resolve({command:rc({intent:"Error",title:n.stringTranslate("simpleCollab","simple_collab_toast_remove_folder_failed"),dismissOnAction:!0})})},RD=({logger:e,i18n:n})=>{var i;return null===(i=e.infoToTelemetry)||void 0===i||i.call(e,"Remove conversation from folder succeeded.","simple_collab_remove_from_folder"),Promise.resolve({command:rc({intent:"Success",title:n.stringTranslate("simpleCollab","simple_collab_toast_remove_conv_from_folder_success"),dismissOnAction:!0})})},OD=({data:e,logger:n,i18n:i})=>{var t;const a="function"==typeof e?e():{};return null===(t=n.errorToTelemetry)||void 0===t||t.call(n,`Remove from folder failed. errorCode: ${a.errorCode}`,"simple_collab_remove_from_folder"),Promise.resolve({command:rc({intent:"Error",title:i.stringTranslate("simpleCollab","simple_collab_toast_remove_conv_from_folder_failed"),dismissOnAction:!0})})},$D=({data:e,logger:n,i18n:i})=>{var t;const a="function"==typeof e?e():{};null===(t=n.infoToTelemetry)||void 0===t||t.call(n,"Move conversation to folder succeeded.","simple_collab_move_conversation_to_folder");const{isChannel:o,isLoadedFromTeamsHierarchy:d,toFolderName:l}=a,r=d?"simple_collab_toast_show_in_folder_success":o?"simple_collab_toast_move_channel_to_folder_success":"simple_collab_toast_move_chat_to_folder_success";return Promise.resolve({command:rc({intent:"Success",title:i.stringTranslate("simpleCollab",r,{folderName:l}),dismissOnAction:!0})})},LD=({data:e,logger:n,i18n:i})=>{var t;const a="function"==typeof e?e():{};null===(t=n.errorToTelemetry)||void 0===t||t.call(n,`Move conversation to folder failed. errorCode: ${a.errorCode}, errorDetail: ${a.errorDetail}`,"simple_collab_move_conversation_to_folder");const{isChannel:o,isLoadedFromTeamsHierarchy:d,toFolderName:l}=a,r=d?"simple_collab_toast_show_in_folder_failed":o?"simple_collab_toast_move_channel_to_folder_failed":"simple_collab_toast_move_chat_to_folder_failed";return Promise.resolve({command:rc({intent:"Error",title:i.stringTranslate("simpleCollab",r,{folderName:l}),dismissOnAction:!0})})},xD=({logger:e})=>{var n;null===(n=e.infoToTelemetry)||void 0===n||n.call(e,"Set conversation folder expanded state succeeded.","simple_collab_set_conversation_expanded_state")},BD=({data:e,logger:n})=>{var i;const t="function"==typeof e?e():{};null===(i=n.errorToTelemetry)||void 0===i||i.call(n,`Set conversation folder expanded state failed. errorCode: ${t.errorCode}, errorDetail: ${t.errorDetail}`,"simple_collab_set_conversation_expanded_state")},jD=({logger:e})=>{var n;null===(n=e.infoToTelemetry)||void 0===n||n.call(e,"Reorder conversation folders succeeded.","simple_collab_reorder_conversation_folders")},UD=({data:e,logger:n,i18n:i})=>{var t;const a="function"==typeof e?e():{};return null===(t=n.errorToTelemetry)||void 0===t||t.call(n,`Reorder conversation folders failed. errorCode: ${a.errorCode}, errorDetail: ${a.errorDetail}`,"simple_collab_reorder_conversation_folders"),Promise.resolve({command:rc({intent:"Error",title:i.stringTranslate("simpleCollab","simple_collab_toast_reorder_folders_failed"),dismissOnAction:!0})})},VD=({logger:e})=>{var n;null===(n=e.infoToTelemetry)||void 0===n||n.call(e,"Reorder conversation folder items succeeded.","simple_collab_reorder_conversation_folder_items")},WD=({data:e,logger:n,i18n:i})=>{var t;const a="function"==typeof e?e():{};return null===(t=n.errorToTelemetry)||void 0===t||t.call(n,`Reorder conversation folder items failed. errorCode: ${a.errorCode}, errorDetail: ${a.errorDetail}`,"simple_collab_reorder_conversation_folder_items"),Promise.resolve({command:rc({intent:"Error",title:i.stringTranslate("simpleCollab","simple_collab_toast_reorder_item_in_folder_failed"),dismissOnAction:!0})})},HD=({logger:e})=>{var n;null===(n=e.infoToTelemetry)||void 0===n||n.call(e,"Drag and drop item to conversation folder succeeded.","simple_collab_dnd_item_to_conversation_folder")},GD=({data:e,logger:n,i18n:i})=>{var t;const a="function"==typeof e?e():{};return null===(t=n.errorToTelemetry)||void 0===t||t.call(n,`Drag and drop item to conversation folder failed. errorCode: ${a.errorCode}, errorDetail: ${a.errorDetail}`,"simple_collab_dnd_item_to_conversation_folder"),Promise.resolve({command:rc({intent:"Error",title:i.stringTranslate("simpleCollab","simple_collab_toast_reorder_item_in_folder_failed"),dismissOnAction:!0})})};var JD=i(664278);const qD=JD.Bx.ChannelCard;var zD=i(307153);const QD=zD.kn,YD={onEventReceived:({eventInput:e,requestContext:n})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{event:i}=e,{type:a,originator:o}=i,{loggerFactory:d,scenarioFactory:l,i18n:r,userBiService:s,phaseStateMachine:m}=n;if(o===qD)return((e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var i,t,a,o,d,l,r,s,m,c;const{data:u,type:p}=e,y=n.newLogger("SimpleCollabChannelCardEvent","simple-collab-channel-card");switch(p){case JD.nJ.manageTeam:{const e="function"==typeof u?u():{};return null===(i=y.infoToTelemetry)||void 0===i||i.call(y,`manageTeam: teamId: ${e.teamId}, commandSource: ${e.commandSource}`,"simple_collab_channel_card_manage_team"),Promise.resolve({command:rA(e)})}case JD.nJ.manageChannelMembers:{const e="function"==typeof u?u():{};return _D.simpleCollabStore.set(_D.selectedConversationIdAtom,JSON.stringify({id:e.channelId,teamId:e.teamId})),null===(t=y.infoToTelemetry)||void 0===t||t.call(y,`manageChannelMembers: channelId: ${e.channelId}, teamId: ${e.teamId}, commandSource: ${e.commandSource}`,"simple_collab_channel_card_manage_channel_members"),Promise.resolve({command:eA(e)})}case JD.nJ.getLinkToChannel:{const e="function"==typeof u?u():{};return null===(a=y.infoToTelemetry)||void 0===a||a.call(y,`getLinkToChannel: channelId: ${e.channelId}, groupId: ${e.groupId}, teamId: ${e.teamId}, channelResourceTenantId: ${e.channelResourceTenantId}, commandSource: ${e.commandSource}`,"simple_collab_channel_card_get_link_to_channel"),Promise.resolve({command:XI(e)})}case JD.nJ.viewChannelEmail:{const e="function"==typeof u?u():{};return null===(o=y.infoToTelemetry)||void 0===o||o.call(y,`viewChannelEmail: channelId: ${e.channelId}, commandSource: ${e.commandSource}`,"simple_collab_channel_card_view_channel_email"),Promise.resolve({command:iA(e)})}case JD.nJ.leaveChannel:{const e="function"==typeof u?u():{};return null===(d=y.infoToTelemetry)||void 0===d||d.call(y,`leaveChannel: channelId: ${e.channelId}, teamId: ${e.teamId}, isLastOwner: ${e.isLastOwner}, groupId: ${e.groupId}, channelOnlyMember: ${e.channelOnlyMember}, commandSource: ${e.commandSource}`,"simple_collab_channel_card_leave_channel"),Promise.resolve({command:aA(e)})}case JD.nJ.manageChannel:{const e="function"==typeof u?u():{};return _D.simpleCollabStore.set(_D.selectedConversationIdAtom,JSON.stringify({id:e.channelId,teamId:e.teamId})),null===(l=y.infoToTelemetry)||void 0===l||l.call(y,`manageChannel: channelId: ${e.channelId}, teamId: ${e.teamId}, commandSource: ${e.commandSource}`,"simple_collab_channel_card_manage_channel"),Promise.resolve({command:ZI(e)})}case JD.nJ.channelAddMembers:{const e="function"==typeof u?u():{};return null===(r=y.infoToTelemetry)||void 0===r||r.call(y,`channelAddMembers: channelId: ${e.channelId}, teamId: ${e.teamId}, commandSource: ${e.commandSource}`,"simple_collab_channel_card_channel_add_members"),Promise.resolve({command:tA(e)})}case JD.nJ.shareChannelWithUser:{const e="function"==typeof u?u():{};return null===(s=y.infoToTelemetry)||void 0===s||s.call(y,`shareChannelWithUser: channelId: ${e.channelId}, commandSource: ${e.commandSource}`,"simple_collab_channel_card_share_channel_with_user"),Promise.resolve({command:oA(e)})}case JD.nJ.shareChannelWithTeam:{const e="function"==typeof u?u():{};return null===(m=y.infoToTelemetry)||void 0===m||m.call(y,`shareChannelWithTeam: channelId: ${e.channelId}, teamId: ${e.teamId}, commandSource: ${e.commandSource}`,"simple_collab_channel_card_share_channel_with_team"),Promise.resolve({command:dA(e)})}case JD.nJ.channelNotificationSettings:{const e="function"==typeof u?u():{};return null===(c=y.infoToTelemetry)||void 0===c||c.call(y,`channelNotificationSettings: channelId: ${e.channelId}, commandSource: ${e.commandSource}`,"simple_collab_channel_card_channel_notification_settings"),Promise.resolve({command:zI(e)})}default:return}})))(i,d);if(o===QD)return((e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{type:i}=e;switch(i){case zD.pd.seeAllChannelsLoadMoreRenderStart:return void n.newScenario(c.RG.UserOnboardingToTeamLoadNext);case zD.pd.seeAllChannelsLoadMoreRenderFail:{const e=c.RG.UserOnboardingToTeamLoadNext,i=n.findScenario(e);return void(i&&i.fail())}case zD.pd.seeAllChannelsLoadMoreRenderComplete:{const e=c.RG.UserOnboardingToTeamLoadNext;return void(n.findScenario(e)&&(n.startStep(e,c.ck.UserOnboardingToTeamLoadNextComplete),n.stopScenarioIfActive(e)))}default:return}})))(i,l);const u=iE(a);return u===nE.ChatContextMenuEvent?((e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var i,t;const{data:a,type:o}=e,d=n.newLogger("SimpleCollabChatContextMenuEvent","simple-collab-context-menu");switch(o){case TD._H.chatManageApps:{const e="function"==typeof a?a():{};return null===(i=d.infoToTelemetry)||void 0===i||i.call(d,`chatManageApps: chatId: ${e.id}`,"simple_collab_chat_context_menu_chat_manage_apps"),Promise.resolve({command:vA(e)})}case TD._H.leaveChat:{const e="function"==typeof a?a():{};return null===(t=d.infoToTelemetry)||void 0===t||t.call(d,`chatManageApps: chatId: ${e.id}, isGuardianChat: ${e.isGuardianChat}`,"simple_collab_chat_context_menu_leave_chat"),Promise.resolve({command:kA(e)})}default:return}})))(i,d):u===nE.ChannelContextMenuEvent?((e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var i,t,a,o,d,l,r,s,m,c,u,p,y;const{data:v,type:k}=e,g=n.newLogger("SimpleCollabChannelContextMenuEvent","simple-collab-context-menu");switch(k){case TD._H.channelNotificationSettings:{const e="function"==typeof v?v():{};return null===(i=g.infoToTelemetry)||void 0===i||i.call(g,`channelNotificationSettings: channelId: ${e.channelId}`,"simple_collab_channel_context_menu_channel_notification"),Promise.resolve({command:zI(e)})}case TD._H.channelWorkflows:{const e="function"==typeof v?v():{};return null===(t=g.infoToTelemetry)||void 0===t||t.call(g,`channelWorkflows: channelId: ${e.channelId}, teamId: ${e.teamId}`,"simple_collab_channel_context_menu_channel_workflow"),Promise.resolve({command:QI(e)})}case TD._H.editChannel:{const e="function"==typeof v?v():{};return null===(a=g.infoToTelemetry)||void 0===a||a.call(g,`editChannel: channelId: ${e.channelId}, teamId: ${e.teamId}`,"simple_collab_channel_context_menu_edit_channel"),Promise.resolve({command:KI(e)})}case TD._H.deleteChannel:{const e="function"==typeof v?v():{};return null===(o=g.infoToTelemetry)||void 0===o||o.call(g,`deleteChannel: channelId: ${e.channelId}, channelType: ${e.channelType}, filesUrl: ${e.filesUrl}, teamId: ${e.teamId}, channelSubstrateGroupId: ${e.channelSubstrateGroupId}, channelOnlyMember: ${e.channelOnlyMember}, isGeneral: ${e.isGeneral}, isShown: ${e.isShown}, groupId: ${e.groupId}, teamTenantId: ${e.teamTenantId}`,"simple_collab_channel_context_menu_delete_channel"),Promise.resolve({command:YI(e)})}case TD._H.getLinkToChannel:{const e="function"==typeof v?v():{};return null===(d=g.infoToTelemetry)||void 0===d||d.call(g,`getLinkToChannel: channelId: ${e.channelId}, groupId: ${e.groupId}, teamId: ${e.teamId}, channelResourceTenantId: ${e.channelResourceTenantId}`,"simple_collab_channel_context_menu_get_link_to_channel"),Promise.resolve({command:XI(e)})}case TD._H.manageChannel:{const e="function"==typeof v?v():{};return null===(l=g.infoToTelemetry)||void 0===l||l.call(g,`manageChannel: channelId: ${e.channelId}, teamId: ${e.teamId}`,"simple_collab_channel_context_menu_manage_channel"),_D.simpleCollabStore.set(_D.selectedConversationIdAtom,JSON.stringify({id:e.channelId,teamId:e.teamId})),Promise.resolve({command:ZI(e)})}case TD._H.manageChannelTags:{const e="function"==typeof v?v():{};return null===(r=g.infoToTelemetry)||void 0===r||r.call(g,`manageChannelTags: channelId: ${e.channelId}, teamId: ${e.teamId}`,"simple_collab_channel_context_menu_manage_channel_tags"),Promise.resolve({command:nA(e)})}case TD._H.viewChannelEmail:{const e="function"==typeof v?v():{};return null===(s=g.infoToTelemetry)||void 0===s||s.call(g,`viewChannelEmail: channelId: ${e.channelId}`,"simple_collab_channel_context_menu_view_channel_email"),Promise.resolve({command:iA(e)})}case TD._H.channelAddMembers:{const e="function"==typeof v?v():{};return null===(m=g.infoToTelemetry)||void 0===m||m.call(g,`channelAddMembers: channelId: ${e.channelId}, teamId: ${e.teamId}`,"simple_collab_channel_context_menu_add_members"),Promise.resolve({command:tA(e)})}case TD._H.leaveChannel:{const e="function"==typeof v?v():{};return null===(c=g.infoToTelemetry)||void 0===c||c.call(g,`leaveChannel: channelId: ${e.channelId}, teamId: ${e.teamId}, isLastOwner: ${e.isLastOwner}, groupId: ${e.groupId}, channelOnlyMember: ${e.channelOnlyMember}`,"simple_collab_channel_context_menu_leave_channel"),Promise.resolve({command:aA(e)})}case TD._H.shareChannelWithUser:{const e="function"==typeof v?v():{};return null===(u=g.infoToTelemetry)||void 0===u||u.call(g,`shareChannelWithUser: channelId: ${e.channelId}`,"simple_collab_channel_context_menu_share_channel_with_user"),Promise.resolve({command:oA(e)})}case TD._H.shareChannelWithTeam:{const e="function"==typeof v?v():{};return null===(p=g.infoToTelemetry)||void 0===p||p.call(g,`shareChannelWithTeam: channelId: ${e.channelId}, teamId: ${e.teamId}`,"simple_collab_channel_context_menu_share_channel_with_team"),Promise.resolve({command:dA(e)})}case TD._H.shareChannelWithTeamYouOwn:{const e="function"==typeof v?v():{};return null===(y=g.infoToTelemetry)||void 0===y||y.call(g,`shareChannelWithTeamYouOwn: channelId: ${e.channelId}, teamId: ${e.teamId}`,"simple_collab_channel_context_menu_share_channel_with_team_you_own"),Promise.resolve({command:lA(e)})}default:return}})))(i,d):u===nE.TeamContextMenuEvent?ID(i,d,s):u===nE.LeftRailHeaderContextMenuEvent?((e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var i,t,a,o;const{data:d,type:l}=e,r=n.newLogger("SimpleCollabLeftRailHeaderContextMenuEvent","simple-collab-left-rail-header-context-menu");switch(l){case TD._H.joinTeam:{null===(i=r.infoToTelemetry)||void 0===i||i.call(r,"Join Team","simple_collab_left_rail_header_context_menu_join_team");const e="function"==typeof d?d():{};return Promise.resolve({command:SA(e)})}case TD._H.createChannel:{null===(t=r.infoToTelemetry)||void 0===t||t.call(r,"Create Channel","simple_collab_left_rail_header_context_menu_create_channel");const e="function"==typeof d?d():{};return Promise.resolve({command:TA(e)})}case TD._H.createTeam:{null===(a=r.infoToTelemetry)||void 0===a||a.call(r,"Create Team","simple_collab_left_rail_header_context_menu_create_team");const e="function"==typeof d?d():{};return Promise.resolve({command:bA(e)})}case TD._H.manageTeams:{null===(o=r.infoToTelemetry)||void 0===o||o.call(r,"Manage Teams","simple_collab_left_rail_header_context_menu_manage_teams");const e="function"==typeof d?d():{};return Promise.resolve({command:CA(e)})}default:return}})))(i,d):u===nE.FolderActionCompletionEvent?((e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{data:t,type:a}=e,o=n.newLogger("SimpleCollabFolderActionCompletionEvents","folder-action-completion");switch(a){case TD.xs.createConversationFolderSucceeded:return AD({logger:o,i18n:i});case TD.xs.createConversationFolderFailed:return FD({data:t,logger:o,i18n:i});case TD.xs.renameConversationFolderSucceeded:return DD({logger:o,i18n:i});case TD.xs.renameConversationFolderFailed:return ED({data:t,logger:o,i18n:i});case TD.xs.removeConversationFolderSucceeded:return MD({logger:o,i18n:i});case TD.xs.removeConversationFolderFailed:return PD({logger:o,i18n:i});case TD.xs.removeFromFolderSucceeded:return RD({logger:o,i18n:i});case TD.xs.removeFromFolderFailed:return OD({data:t,logger:o,i18n:i});case TD.xs.moveConversationToFolderSucceeded:return $D({data:t,logger:o,i18n:i});case TD.xs.moveConversationToFolderFailed:return LD({data:t,logger:o,i18n:i});case TD.xs.setConversationFolderExpandedStateSucceeded:return xD({logger:o});case TD.xs.setConversationFolderExpandedStateFailed:return BD({data:t,logger:o});case TD.xs.reorderConversationFoldersSucceeded:return jD({logger:o});case TD.xs.reorderConversationFoldersFailed:return UD({data:t,logger:o,i18n:i});case TD.xs.reorderConversationFolderItemsSucceeded:return VD({logger:o});case TD.xs.reorderConversationFolderItemsFailed:return WD({data:t,logger:o,i18n:i});case TD.xs.dndItemToConversationFolderSucceeded:return HD({logger:o});case TD.xs.dndItemToConversationFolderFailed:return GD({data:t,logger:o,i18n:i});default:return}})))(i,d,r):function(e,n,i){const{data:t,type:a}=e;switch(a){case TD._H.switchToChat:{const e="function"==typeof t?t():{},n=e.internalId;return _D.simpleCollabStore.set(_D.selectedConversationIdAtom,JSON.stringify({id:n})),Promise.resolve({command:JI({id:n,openInPopout:e.openInPopout,commandSource:e.commandSource,correlationId:e.correlationId})})}case TD._H.switchToChannel:{const e="function"==typeof t?t():{};return _D.simpleCollabStore.set(_D.selectedConversationIdAtom,JSON.stringify({id:e.channelId,teamId:e.teamId})),Promise.resolve({command:qI(e)})}case TD._H.filterLeftRail:return XD(t,n);case TD._H.filterLeftRailComplete:return void KD(n);case TD.cn.createConversationFolder:{const e="function"==typeof t?t():{};return Promise.resolve({command:NA(e)})}case TD.cn.removeConversationFolder:{const e="function"==typeof t?t():{};return Promise.resolve({command:hA(e)})}case TD.cn.renameConversationFolder:{const e="function"==typeof t?t():{};return Promise.resolve({command:fA(e)})}case TD._H.viewDiscover:return _D.simpleCollabStore.set(_D.isDiscoverSurfaceSelectedAtom,!0),Promise.resolve({command:gA()});case TD._H.leftRailRenderStart:return void n.newScenario(c.RG.SimpleCollabRenderLeftRail);case TD._H.leftRailRenderComplete:{_D.simpleCollabStore.set(_D.leftRailFilterAtom,{});const e=c.RG.SimpleCollabRenderLeftRail;return n.findScenario(e)&&(n.startStep(e,c.ck.SimpleCollabLeftRailRenderComplete),n.stopScenarioIfActive(e)),void(null==i||i.fireSignals({signals:[Me.G.SIMPLE_COLLAB_ADAPTIVE_LEFT_RAIL_LOADED]}))}case TD._H.seeMoreRenderStart:return void n.newScenario(c.RG.SimpleCollabLeftRailSeeMore);case TD._H.seeMoreRenderComplete:return void ZD(n);case TD._H.seeMoreRenderFail:return void eE(n);case TD._H.viewTeamSeeAllChannels:{const e="function"==typeof t?t():{};return Promise.resolve({command:_A(e)})}default:return}}(i,l,m)}))};const KD=e=>{const n=c.RG.SimpleCollabLeftRailFilter;e.findScenario(n)&&(e.startStep(n,c.ck.SimpleCollabLeftRailFilterComplete),e.stopScenarioIfActive(n))},XD=(e,n)=>{n.cancelExistingAndCreateScenario(c.RG.SimpleCollabLeftRailFilter,"abandon");const i="function"==typeof e?e():{};return _D.simpleCollabStore.set(_D.leftRailFilterAtom,{text:i.text,tags:i.tags}),Promise.resolve(void 0)},ZD=e=>{const n=c.RG.SimpleCollabLeftRailSeeMore;e.findScenario(n)&&(e.startStep(n,c.ck.SimpleCollabSeeMoreRenderComplete),e.stopScenarioIfActive(n))},eE=e=>{const n=c.RG.SimpleCollabLeftRailSeeMore,i=e.findScenario(n);i&&i.fail()};var nE;!function(e){e[e.ChatContextMenuEvent=0]="ChatContextMenuEvent",e[e.ChannelContextMenuEvent=1]="ChannelContextMenuEvent",e[e.TeamContextMenuEvent=2]="TeamContextMenuEvent",e[e.Default=3]="Default",e[e.FolderActionCompletionEvent=4]="FolderActionCompletionEvent",e[e.LeftRailHeaderContextMenuEvent=5]="LeftRailHeaderContextMenuEvent"}(nE||(nE={}));const iE=e=>{switch(e){case TD._H.chatManageApps:case TD._H.leaveChat:return nE.ChatContextMenuEvent;case TD._H.channelNotificationSettings:case TD._H.channelWorkflows:case TD._H.editChannel:case TD._H.deleteChannel:case TD._H.getLinkToChannel:case TD._H.manageChannel:case TD._H.manageChannelTags:case TD._H.viewChannelEmail:case TD._H.channelAddMembers:case TD._H.leaveChannel:case TD._H.shareChannelWithUser:case TD._H.shareChannelWithTeam:case TD._H.shareChannelWithTeamYouOwn:return nE.ChannelContextMenuEvent;case TD._H.manageTeam:case TD._H.manageTags:case TD._H.getLinkToTeam:case TD._H.leaveTeam:case TD._H.teamAddMember:case TD._H.teamAddChannel:case TD._H.deleteTeam:return nE.TeamContextMenuEvent;case TD._H.joinTeam:case TD._H.createChannel:case TD._H.createTeam:case TD._H.manageTeams:return nE.LeftRailHeaderContextMenuEvent;case TD.xs.createConversationFolderSucceeded:case TD.xs.createConversationFolderFailed:case TD.xs.renameConversationFolderSucceeded:case TD.xs.renameConversationFolderFailed:case TD.xs.removeConversationFolderSucceeded:case TD.xs.removeConversationFolderFailed:case TD.xs.removeFromFolderSucceeded:case TD.xs.removeFromFolderFailed:case TD.xs.moveConversationToFolderSucceeded:case TD.xs.moveConversationToFolderFailed:case TD.xs.setConversationFolderExpandedStateSucceeded:case TD.xs.setConversationFolderExpandedStateFailed:case TD.xs.reorderConversationFoldersSucceeded:case TD.xs.reorderConversationFoldersFailed:case TD.xs.reorderConversationFolderItemsSucceeded:case TD.xs.reorderConversationFolderItemsFailed:case TD.xs.dndItemToConversationFolderSucceeded:case TD.xs.dndItemToConversationFolderFailed:return nE.FolderActionCompletionEvent;default:return nE.Default}},tE=({appRenderMode:e,type:n})=>{const i=new Ee.H,t=[],a=[];switch(e){case Fe.S.HorizontalBar:dE({type:n,criticalSignals:t,featureFlags:{},postCriticalSignals:a});break;case Fe.S.Main:aE({type:n,criticalSignals:t,featureFlags:{},postCriticalSignals:a});break;case Fe.S.Rail:oE({type:n,criticalSignals:t,featureFlags:{},postCriticalSignals:a})}return i.registerAppPhase({phase:g.nh.CRITICAL,signals:t,timeout:25e3}),i.appPhases},aE=({criticalSignals:e,type:n})=>{n===De.py.teamseeallchannels?e.push(Me.G.USER_ONBOARDING_TO_TEAM_VIEW_RENDERED):(e.push(Me.G.MESSAGES_RENDERED),e.push(Me.G.COMPOSE_LOADED))},oE=({criticalSignals:e})=>{e.push(Me.G.SIMPLE_COLLAB_ADAPTIVE_LEFT_RAIL_LOADED)},dE=({criticalSignals:e,type:n})=>{n===De.py.teamseeallchannels&&e.push(Me.G.USER_ONBOARDING_HEADER_RENDERED)},lE=()=>Promise.all([i.e(141603),i.e(256045),i.e(976609),i.e(1053),i.e(296056),i.e(105434),i.e(124818),i.e(269296),i.e(141550),i.e(829990),i.e(953275),i.e(449768),i.e(396253),i.e(931290)]).then(i.bind(i,653454)),rE=({coreServices:e,host:n,screenState:i,windowOptions:t})=>{const{height:a,minHeight:o,minWidth:d,offset:l,width:r}=hD.windowFeatures||{},m={left:(null==n?void 0:n.screenX)||0,top:(null==n?void 0:n.screenY)||0},c=((null==i?void 0:i.numOpenWindows)||1)*(l||1);return Object.assign(Object.assign(Object.assign({additionalFeatures:{minHeight:`${o}`,minWidth:`${d}`},height:a,left:(null==m?void 0:m.left)+c,minHeight:o,minWidth:d,top:(null==m?void 0:m.top)+c,width:r},hD.windowFeatures),(null==e?void 0:e.coreSettings.get(s.J.Core).enableRatioToScreenBasedSizing)&&function(e,n){const{widthToScreenWidthRatio:i,heightToWidthRatio:t}=n||{};if(!e||!t||!i)return{};const a=i*e.screen.availWidth;return{height:a*t,width:a}}(n,hD.windowFeatures)),t)};function sE(e=_D){return{eventHandlers:YD,getAppPhases:tE,getAppViewEntities:dD,getAppViewEntitiesProps:pD,getAppWindowFeatures:rE,manifest:hD,onCommandReceived:SD,getPlatformAppIdForEntity:e=>e.type===De.py.simplecollab?"3b64df9d-7e97-4d9c-ac5c-2e0a5d8e6f40":void 0,render({appRenderMode:n,coreSettings:i,onRenderEvent:a,scenarioFactory:o}){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const t="simple-collab-app";a("ChunkLoadStarted",{chunkName:t});const{SimpleCollabEntry:d}=yield(0,Pn.mT)(lE,t,o);return a("ChunkLoadSucceeded",{chunkName:t}),(0,Ie.t)(ri.f,Object.assign({namespaces:["simpleCollab"],loaderRenderer:null},{children:(0,Ie.t)(aD.zt,Object.assign({store:e.simpleCollabStore},{children:(0,Ie.t)(d,{appRenderMode:n,coreSettings:i,appState:e})}))}))}))},onViewUpdateCommandResolved({availableEntities:n}){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const i=n.mainEntity;if((null==i?void 0:i.action)===De.uk.view&&i.id)if(i.type===De.py.chats)e.simpleCollabStore.set(e.selectedConversationIdAtom,JSON.stringify({id:i.id}));else if(i.type===De.py.channels){let n;try{n=JSON.parse(i.id)}catch(e){n={}}"object"==typeof n&&n.channelId&&n.teamId&&e.simpleCollabStore.set(e.selectedConversationIdAtom,JSON.stringify({id:n.channelId,teamId:n.teamId}))}}))},getEventScenarioData(e){let n;switch(e.event.type){case"switchToChat":case"switchToChannel":n=c.RG.SimpleCollabSwitch;break;case"viewTeamSeeAllChannels":n=c.RG.SimpleCollabSeeAllChannelsSwitch;break;default:return}return{scenarioName:n}}}}const mE={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsTeamsAndChannelsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"tenantId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"substrateGroupId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}}}]}}]},cE=JD.Bx.ChannelCard,uE={onEventReceived:({eventInput:e,requestContext:{client:n,viewEntity:i,loggerFactory:a,scenarioFactory:o}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var d,l,r,s,m,u;if(e.event.originator===cE)return((e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var i,t,a,o,d,l,r,s,m,c;const{data:u,type:p}=e,y=n.newLogger("TeamsAndChannelsAppChannelCardEvent","apps-teams-and-channels-channel-card");switch(p){case JD.nJ.manageTeam:{const e="function"==typeof u?u():{};return null===(i=y.infoToTelemetry)||void 0===i||i.call(y,`manageTeam: teamId: ${e.teamId}, commandSource: ${e.commandSource}`,"apps_teams_and_channels_channel_card_manage_team"),Promise.resolve({command:iI(e)})}case JD.nJ.manageChannelMembers:{const e="function"==typeof u?u():{};return null===(t=y.infoToTelemetry)||void 0===t||t.call(y,`manageChannelMembers: channelId: ${e.channelId}, teamId: ${e.teamId}, commandSource: ${e.commandSource}`,"apps_teams_and_channels_channel_card_manage_channel_members"),Promise.resolve({command:nI(e)})}case JD.nJ.getLinkToChannel:{const e="function"==typeof u?u():{};return null===(a=y.infoToTelemetry)||void 0===a||a.call(y,`getLinkToChannel: channelId: ${e.channelId}, groupId: ${e.groupId}, teamId: ${e.teamId}, channelResourceTenantId: ${e.channelResourceTenantId}, commandSource: ${e.commandSource}`,"apps_teams_and_channels_channel_card_get_link_to_channel"),Promise.resolve({command:Zw(e)})}case JD.nJ.viewChannelEmail:{const e="function"==typeof u?u():{};return null===(o=y.infoToTelemetry)||void 0===o||o.call(y,`viewChannelEmail: channelId: ${e.channelId}, commandSource: ${e.commandSource}`,"apps_teams_and_channels_channel_card_view_channel_email"),Promise.resolve({command:eI(e)})}case JD.nJ.leaveChannel:{const e="function"==typeof u?u():{};return null===(d=y.infoToTelemetry)||void 0===d||d.call(y,`leaveChannel: channelId: ${e.channelId}, teamId: ${e.teamId}, isLastOwner: ${e.isLastOwner}, groupId: ${e.groupId}, channelOnlyMember: ${e.channelOnlyMember}, commandSource: ${e.commandSource}`,"apps_teams_and_channels_channel_card_leave_channel"),Promise.resolve({command:tI(e)})}case JD.nJ.manageChannel:{const e="function"==typeof u?u():{};return null===(l=y.infoToTelemetry)||void 0===l||l.call(y,`manageChannel: channelId: ${e.channelId}, teamId: ${e.teamId}, commandSource: ${e.commandSource}`,"apps_teams_and_channels_channel_card_manage_channel"),Promise.resolve({command:aI(e)})}case JD.nJ.channelAddMembers:{const e="function"==typeof u?u():{};return null===(r=y.infoToTelemetry)||void 0===r||r.call(y,`channelAddMembers: channelId: ${e.channelId}, teamId: ${e.teamId}, commandSource: ${e.commandSource}`,"apps_teams_and_channels_channel_card_channel_add_members"),Promise.resolve({command:oI(e)})}case JD.nJ.shareChannelWithUser:{const e="function"==typeof u?u():{};return null===(s=y.infoToTelemetry)||void 0===s||s.call(y,`shareChannelWithUser: channelId: ${e.channelId}, commandSource: ${e.commandSource}`,"apps_teams_and_channels_channel_card_share_channel_with_user"),Promise.resolve({command:dI(e)})}case JD.nJ.shareChannelWithTeam:{const e="function"==typeof u?u():{};return null===(m=y.infoToTelemetry)||void 0===m||m.call(y,`shareChannelWithTeam: channelId: ${e.channelId}, teamId: ${e.teamId}, commandSource: ${e.commandSource}`,"apps_teams_and_channels_channel_card_share_channel_with_team"),Promise.resolve({command:lI(e)})}case JD.nJ.channelNotificationSettings:{const e="function"==typeof u?u():{};return null===(c=y.infoToTelemetry)||void 0===c||c.call(y,`channelNotificationSettings: channelId: ${e.channelId}, commandSource: ${e.commandSource}`,"apps_teams_and_channels_channel_card_channel_notification_settings"),Promise.resolve({command:rI(e)})}default:return}})))(e.event,a);switch(e.event.type){case ad.uS.expandTab:{const n=null===(l=(d=e.event).data)||void 0===l?void 0:l.call(d);return Promise.resolve({command:od.CN.expandTab(n)})}case ad.uS.resetLayoutOverrides:return Promise.resolve({command:od.CN.resetLayoutOverrides()});case Ze.uS.requestPersonMoreInfo:{const t=null===(s=(r=e.event).data)||void 0===s?void 0:s.call(r);let a=!1,o="";if(null==i?void 0:i.id){const{data:{chat:e}}=yield n.query({query:mE,variables:{convId:null==i?void 0:i.id},context:{callerInfo:"apps-teams-and-channels-event-handler"}});a=!!(null==e?void 0:e.substrateGroupId),o=(null==e?void 0:e.tenantId)||""}const d=on(Object.assign(Object.assign(Object.assign(Object.assign({},t),o&&{tenantId:o}),(null==i?void 0:i.id)&&{conversationId:null==i?void 0:i.id}),{isSharedChannel:a}));return Promise.resolve({command:d})}case Ze.uS.requestTopicMoreInfo:{const n=null===(u=(m=e.event).data)||void 0===u?void 0:u.call(m);return Promise.resolve({command:ln(Object.assign({},n))})}case zD.pd.switchToChannel:{const n=e.event.data,i="function"==typeof n?n():{};return Promise.resolve({command:Kw(i)})}case zD.pd.loadUserOnboardingToTeamPage:{const n=e.event.data,i="function"==typeof n?n():{};return Promise.resolve({command:Xw(i)})}case zD.pd.seeAllChannelsLoadMoreRenderStart:return void o.newScenario(c.RG.UserOnboardingToTeamLoadNext);case zD.pd.seeAllChannelsLoadMoreRenderFail:{const e=c.RG.UserOnboardingToTeamLoadNext,n=o.findScenario(e);return void(n&&n.fail())}case zD.pd.seeAllChannelsLoadMoreRenderComplete:{const e=c.RG.UserOnboardingToTeamLoadNext;return void(o.findScenario(e)&&(o.startStep(e,c.ck.UserOnboardingToTeamLoadNextComplete),o.stopScenarioIfActive(e)))}}return Promise.resolve(void 0)}))};var pE,yE,vE,kE,gE,NE=i(725811);!function(e){e.teamDashboard="/l/team-dashboard",e.channelDashboard="/l/channel-dashboard",e.pendingInvites="/l/manage-teams/myinvites",e.channel="/l/channel",e.replyChain="/l/message",e.team="/l/team",e.teamsPremiumTrial="/l/trial/teamsPremiumTrial",e.teamsPremiumLicenseRequest="/l/trial/teamsPremiumLicenseRequest"}(pE||(pE={})),function(e){e.FeatureNotEnabled="Feature for parsing T1 teams and channels deep links in T2.1 is not enabled",e.NoChannelId="Parsed teams and channels deep link does not contain the channel id",e.NoThreadId="Parsed teams and channels deep link does not contain the thread id",e.InvalidDeeplinkType="Parsed teams and channels deep link does not contain a valid deeplink type",e.NoTabId="Parsed teams and channels deep link does not contain the tab id",e.MalformedContext="Parsed teams and channels deep link contains malformed search context"}(yE||(yE={})),function(e){e.FeatureNotEnabled="channel_on_before_deep_link_parsed_feature_not_enabled_error",e.NoChannelId="channel_on_before_deep_link_parsed_no_channel_id_error",e.NoThreadId="channel_on_before_deep_link_parsed_no_thread_id_error",e.InvalidDeeplinkType="channel_on_before_deep_link_parsed_invalid_deeplink_type_error",e.NoTabId="channel_on_before_deep_link_parsed_no_tab_id_error",e.MalformedContext="channel_on_before_deep_link_parsed_malformed_search_context_error"}(vE||(vE={})),function(e){e.TeamDashboard="team-dashboard",e.ChannelDashboard="channel-dashboard",e.TeamsDashboard="manage-teams"}(kE||(kE={})),function(e){e.MembersId="td.members",e.SettingsId="td.settings",e.AppsId="td.apps",e.PendingRequestsId="td.joinRequests",e.ChannelsId="td.channels",e.AnalyticsId="td.analytics",e.SharedChannelPendingRequestsId="sharedChannelPendingRequests",e.TagsId="td.tags"}(gE||(gE={}));const hE=({deeplinkUrl:e,parsedDeeplinkHash:n,preferredCommandInput:i,context:{coreSettings:t,loggerFactory:a,scenarioFactory:o}})=>{var d,l;const r=a.newLogger("TeamsAndChannelsApp onBeforeDeeplinkParsed","apps-teams-and-channels"),{enablePlatformDeepLinkRouting:m}=t.get(s.J.Extensibility),{enableParseT1TeamsAndChannelsDeeplinks:c}=t.get(s.J.Channels);if(!c)throw null===(d=r.errorToTelemetry)||void 0===d||d.call(r,yE.FeatureNotEnabled,vE.FeatureNotEnabled),Error(yE.FeatureNotEnabled);let u,p,y,v,k,g,N,h,f,_={};if(null==n?void 0:n.search){const{search:e}=n;r.log(`Parsing parsedDeeplinkHash - channelId: ${e.threadId}, replyChainId: ${e.replyChainId}, messageId: ${e.messageId}, tenantId: ${e.tenantId}, allowXTenantAccess: ${e.allowXTenantAccess}, nextGenerationChannel: ${e.nextGenerationChannel}`),u=e.threadId,p=e.replyChainId,y=e.messageId,v=e.tenantId,g=e.groupId,h=e.channelName,f=fE(e.nextGenerationChannel),N=fE(e.allowXTenantAccess)}else{const{pathname:n,search:i}=e;r.log(`Parsing deeplinkUrl - pathname: ${n}, search: ${i}`);const t=decodeURIComponent(n),a=t.split("/"),o=null==t?void 0:t.split(/[/?&]/),d=null==o?void 0:o.indexOf("channel");k=null==o?void 0:o[d+km.ei];const l=a.findIndex((e=>e.startsWith(jr.at.SkypeSpacesThread)));u=a[l];const s=new URLSearchParams(i),m=s.get("context");_=SE(r,m),p=s.get("parentMessageId")||void 0,y=l+1<a.length&&(0,ts.kz)(a[l+1])?a[l+1]:void 0,v=s.get("tenantId")||void 0,g=s.get("groupId")||void 0,N=fE(s.get("allowXTenantAccess")||void 0),f=fE(s.get("ngc")||void 0),h=s.get("channelName")||_E(n,a,l+1)}return u?m&&(null==k?void 0:k.includes(km.pQ))?(r.log(`toPlatformTabNavigationIntent - tabId: ${k} channelId: ${u}, deeplinkContext: ${_}, tenantId: ${v}`),(0,km.Jj)(u,"",e,v,_,k,o)):(r.log(`toNavigationIntent - channelId: ${u}, replyChainId: ${p}, messageId: ${y}, tenantId: ${v}`),bE(u,p,y,v,g,N,h,f,i)):(null===(l=r.errorToTelemetry)||void 0===l||l.call(r,yE.NoChannelId,vE.NoChannelId),Promise.resolve(void 0))},fE=e=>"true"===(null==e?void 0:e.toLowerCase()),_E=(e,n,i)=>{if(e.startsWith(pE.channel)&&!(i>=n.length))return n[i]},SE=(e,n)=>{var i;try{return n&&JSON.parse(n)}catch(n){return null===(i=e.errorToTelemetry)||void 0===i||i.call(e,"[handleTeamsAndChannelsDeeplink] could not parse deeplink context","platform_deeplink_context_parse_error"),{}}},TE=({deeplinkUrl:e,preferredCommandInput:n,context:{loggerFactory:i}})=>{var t,a,o,d,l,r;const s=i.newLogger("TeamsAndChannelsApp onBeforeDeeplinkParsed","apps-teams-and-channels"),{pathname:m}=e;s.log(`Parsing deeplinkUrl - pathname: ${m}`);const c=m.split("/"),u=c[2];let p;switch(u){case kE.TeamsDashboard:return s.log(`toNavigationTeamsDashboard - deeplinkType: ${u}`),AE(n);case kE.TeamDashboard:case kE.ChannelDashboard:const i=c.findIndex((e=>e.startsWith(jr.at.SkypeSpacesThread))),m=c[i];if(!m)return null===(t=s.errorToTelemetry)||void 0===t||t.call(s,yE.NoThreadId,vE.NoThreadId),Promise.resolve(void 0);if(p=c[4],!p)return null===(a=s.errorToTelemetry)||void 0===a||a.call(s,yE.NoTabId,vE.NoTabId),Promise.resolve(void 0);let y;if(p===gE.TagsId){const n=null===(o=null==e?void 0:e.searchParams)||void 0===o?void 0:o.get("context");try{y=n?null===(d=JSON.parse(n))||void 0===d?void 0:d.tagId:void 0}catch(e){null===(l=s.errorToTelemetry)||void 0===l||l.call(s,yE.MalformedContext,vE.MalformedContext)}}return s.log(`toNavigationThreadDashboard - deeplinkType: ${u}, threadId: ${m}, tab: ${p}`),CE(u,m,p,n,y);default:return null===(r=s.errorToTelemetry)||void 0===r||r.call(s,yE.InvalidDeeplinkType,vE.InvalidDeeplinkType),Promise.resolve(void 0)}},bE=(e,n,i,t,a,o,d,l,r)=>{var s,m;return Promise.resolve({entityCommand:{entity:{type:De.py.channels,action:De.uk.view,id:JSON.stringify({channelId:e,replyChainId:n})},command:{stateTransition:null!==(s=null==r?void 0:r.stateTransition)&&void 0!==s?s:v.su.flush,visibilityState:null!==(m=null==r?void 0:r.visibilityState)&&void 0!==m?m:v.fe.show},entityOptions:{deepLinkId:i,groupId:a,nextGenerationChannel:l,channelName:d}},metadata:{allowAnonymous:!1,allowXTenantAccess:o,tenantId:t}})},CE=(e,n,i,t,a)=>{var o,d;const l=e===kE.TeamDashboard?wE(i):IE(i);return Promise.resolve({entityCommand:{entity:{type:l,action:De.uk.view,id:n},command:{stateTransition:null!==(o=null==t?void 0:t.stateTransition)&&void 0!==o?o:v.su.flush,visibilityState:null!==(d=null==t?void 0:t.visibilityState)&&void 0!==d?d:v.fe.show},entityOptions:{tagId:a}},metadata:{allowAnonymous:!1}})},wE=e=>{switch(e){case gE.AnalyticsId:return De.py.teamanalytics;case gE.ChannelsId:return De.py.teamchannels;case gE.SettingsId:return De.py.teamsettings;case gE.AppsId:return De.py.teammanageapps;case gE.PendingRequestsId:return De.py.teampendingrequests;case gE.TagsId:return De.py.teammanagetags;default:return De.py.teammanage}},IE=e=>{switch(e){case gE.AnalyticsId:return De.py.channelanalytics;case gE.SettingsId:return De.py.channelsettings;case gE.SharedChannelPendingRequestsId:return De.py.channelinvitations;case gE.MembersId:return De.py.channelmembers;case gE.TagsId:return De.py.channeltags;default:return De.py.channelmanage}},AE=e=>{var n,i,t;return Promise.resolve({entityCommand:{entity:{type:De.py.sharedchannelspendinginvites,action:De.uk.view},command:{stateTransition:null!==(n=null==e?void 0:e.stateTransition)&&void 0!==n?n:v.su.flush,visibilityState:null!==(i=null==e?void 0:e.visibilityState)&&void 0!==i?i:v.fe.show},entityOptions:{uniqueId:null===(t=null==e?void 0:e.correlation)||void 0===t?void 0:t.startTimestamp}},metadata:{allowAnonymous:!1}})},FE=[{filter:pE.teamDashboard,execute:TE},{filter:pE.channelDashboard,execute:TE},{filter:pE.pendingInvites,execute:TE},{filter:pE.channel,execute:hE},{filter:pE.replyChain,execute:hE},{filter:pE.team,execute:hE},{filter:(e,n)=>{var i;return!!e.hash&&"channel"===(null===(i=null==n?void 0:n.search)||void 0===i?void 0:i.ctx)},execute:hE},{filter:pE.teamsPremiumTrial,execute:({deeplinkUrl:e,context:{coreSettings:n,loggerFactory:i}})=>{var t;const{enableTeamsPremiumTrialDeeplink:a}=n.get(s.J.Premium),o=i.newLogger("TeamsAndChannelsApp:BeforeDeeplinkParsedCondition:teamsPremiumTrial","apps-teams-and-channels");if(!a)return o.log(`Teams Premium Trial Deeplink is not enabled, enableTeamsPremiumTrialDeeplink value is ${a}`),Promise.reject({message:"teams-premium-trial-deeplink-not-enabled"});o.log("execute command executeTeamsPremiumTrialDialogDeeplinkUrl");const d=(null!==(t=new URLSearchParams(e.search).get("source"))&&void 0!==t?t:"").toLocaleLowerCase();return Promise.resolve({entityCommand:{entity:{type:De.py.premiumtrialdialog,action:De.uk.view},entityOptions:{entryPoint:d},command:{stateTransition:v.su.extend,visibilityState:v.fe.show}},metadata:{allowAnonymous:!1}})}},{filter:pE.teamsPremiumLicenseRequest,execute:({context:{coreSettings:e,loggerFactory:n}})=>{const{enableTeamsPremiumLicenseRequestDeeplink:i}=e.get(s.J.Premium),t=n.newLogger("TeamsAndChannelsApp:BeforeDeeplinkParsedCondition:teamsPremiumLicenseRequest","apps-teams-and-channels");return i?(t.log("execute command executeTeamsPremiumLicenseRequestDialogDeeplinkUrl"),Promise.resolve({entityCommand:{entity:{type:De.py.licenserequestdialog,action:De.uk.view},entityOptions:{licenseType:NE.X.TeamsPremium},command:{stateTransition:v.su.extend,visibilityState:v.fe.show}},metadata:{allowAnonymous:!1}})):(t.log(`Teams Premium License Request Deeplink is not enabled, enableTeamsPremiumLicenseRequestDeeplink value is ${i}`),Promise.reject({message:"teams-premium-license-request-deeplink-not-enabled"}))}}],DE={shouldAddEntitiesToWindowHistory:()=>!0,shouldRestoreClientToEntities:()=>!0,shouldStoreLastVisitedInAppHistory:e=>{if((null==e?void 0:e.type)===De.py.schoolteams)return!0;if((null==e?void 0:e.type)===De.py.discoversurface)return!0;if((null==e?void 0:e.type)!==De.py.channels)return!1;const{replyChainId:n}=(0,Eu.jd)((null==e?void 0:e.id)||"");return!n}},EE={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsTeamsAndChannelsChannelAccessByIdQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelAccessByID"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canAccess"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"errorType"},__type:{kind:"NamedType",name:{kind:"Name",value:"ChannelAccessResultError"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ChannelAccessResult"}}}}]}}]},ME=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n;const{entityCommand:i,entityCommand:{entity:t,entityOptions:a},requestContext:{client:o,coreSettings:d,loggerFactory:l}}=e,{enableTeamJoinDialog:r}=d.get(s.J.TeamsAndChannels),m=l.newLogger("TeamsAndChannels CallingOnBeforeCommandHandled","apps-teams-and-channels");if(r&&BE(i.command.correlation.source)){let e;try{e=JSON.parse((null==t?void 0:t.id)||"{}")}catch(n){e={}}const{channelId:d,replyChainId:l}=e,r=a,s=null==r?void 0:r.groupId,c=(null==r?void 0:r.nextGenerationChannel)||!1,u=null==r?void 0:r.channelName,p=xE(null===(n=null==i?void 0:i.metadata)||void 0===n?void 0:n.deepLink);if(d)try{const{data:e,error:n}=yield o.query({query:EE,fetchPolicy:"network-only",nextFetchPolicy:"cache-first",variables:{conversationId:d}});if(n)return LE(m,`Error getting channel join information for ${d}`),Promise.resolve(OE(i,s,d,l,void 0,!0));if(e&&"ChannelDeleted"===e.channelAccessByID.errorType)return LE(m,`Channel ${d} has been deleted.`),Promise.resolve($E(i,ym.pm.ChannelDeleted,u));if(e&&!e.channelAccessByID.canAccess)return Promise.resolve(RE(c,i,s,d,l,p,u))}catch(e){return LE(m,`Error getting channel join information for ${d}`),Promise.resolve(OE(i,s,d,l,p,!0))}}const c=yield(0,Or.z)(o,d.get(s.J.SimpleCollab));if(PE(i,c)){return Object.assign(Object.assign({},i),{entity:Object.assign(Object.assign({},i.entity),{type:De.py.simplecollab})})}return i})),PE=(e,n)=>{var i;return!(e.entity.type===De.py.simplecollab||!n||["flow","none","new","extend"].includes(e.command.stateTransition)||e.entity.linkedEntity&&(null===(i=e.entity.linkedEntity)||void 0===i?void 0:i.type)===De.py.simplecollab)},RE=(e,n,i,t,a,o,d)=>e?$E(n,ym.pm.NoAccessToChannel,d):OE(n,i,t,a,o,!1),OE=(e,n,i,t,a,o)=>Object.assign(Object.assign({},e),{entity:{type:De.py.teamjoindialog,action:De.uk.view},command:{stateTransition:"extend",visibilityState:v.fe.show,correlation:e.command.correlation},entityOptions:{groupId:n,channelId:i,messageId:t,linkType:a,isError:o}}),$E=(e,n,i)=>Object.assign(Object.assign({},e),{entity:{type:De.py.defaultchannelnavdialog,action:De.uk.view},command:{stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:e.command.correlation},entityOptions:{error:n,channelName:i}}),LE=(e,n)=>{(null==e?void 0:e.errorToTelemetry)&&e.errorToTelemetry(n,"teams_and_channels_on_before_command_handled_error",void 0,!0)},xE=e=>{const n=null==e?void 0:e.match(/\/(team|channel|message)\//i);return n&&n.length>1?n[1]:void 0},BE=e=>{switch(e){case sn.D.AuthApp:case sn.D.ExternalCommand:case sn.D.InternalDeeplink:return!0;default:return!1}},jE=e=>{if(UE(e))return VE(e)?{subNavEntity:HE(e),headerEntity:QE(e),startEntity:YE(e),mainEntity:KE(e),endEntity:eM(e)}:null},UE=({layoutMode:e,contextEntity:n,entity:i})=>{const{action:t=null,type:a}=Object.assign({},i),{type:o,action:d}=n||{},l=[v.lO.standard,v.lO.focus].includes(e),r=[De.py.acceptsharedchannelinvitationdialog,De.py.archiveteam,De.py.archivechannel,De.py.callablechannels,De.py.channelapps,De.py.channelanalytics,De.py.channelcalendar,De.py.channelconnectors,De.py.channelcopilot,De.py.channelworkflows,De.py.channelemailerror,De.py.channelemailv2,De.py.channelmanage,De.py.channelmembers,De.py.channels,De.py.channelsPinnedPost,De.py.channelsSystemMessage,De.py.channelsettings,De.py.channelinvitations,De.py.channeltags,De.py.channelcontextualsearch,De.py.createchanneldialog,De.py.crosspostchannelselectiondialog,De.py.crosspostchannelselectiondialogV2,De.py.deleteteam,De.py.filesoneupviewer,De.py.removechannelemail,De.py.restoreteam,De.py.schoolteams,De.py.sharedchanneldenyinvitation,De.py.sharewithteamyouowndialog,De.py.sharedchannelcreateinvitationsdialog,De.py.sharedchannelspendinginvites,De.py.showformemberdialogv2,De.py.staleteamsdialog,De.py.staleteamsdismiss,De.py.leaveteam,De.py.crossteamanalytics,De.py.teamslist,De.py.teamanalytics,De.py.teamchannels,De.py.teamjoindialog,De.py.teamdiscover,De.py.teammanage,De.py.teammanageapps,De.py.teammanagetags,De.py.teampendingrequests,De.py.teamserrordialog,De.py.teamsettings,De.py.useronboardingteam,De.py.changeteampicture,De.py.wiki].includes(a),s=[De.uk.create,De.uk.default,De.uk.info,De.uk.list,De.uk.view],m=t&&s.includes(t),c=[De.py.extensions,De.py.guardians,De.py.channelcalendar,De.py.callablechannels,De.py.filesoneupviewer,De.py.wiki],u=o&&c.includes(o),p=[De.uk.view,De.uk.list],y=d&&p.includes(d);return!(!l||!r||!m&&!(y&&u))},VE=()=>!0,WE=e=>({action:De.uk.list,type:De.py.schoolteams,entityState:{flushableByLinkedEntity:!0},id:null,linkedEntity:null,options:e.options,windowOptions:null}),HE=({layoutMode:e,entity:n,coreSettings:i,userPreferences:t,contextEntity:a})=>{var o,d,l,r,m;if(e===v.lO.focus)return null;if(n.type===De.py.teams&&n.action===De.uk.create)return n;if(n.type===De.py.schoolteams&&(n.action===De.uk.list||n.action===De.uk.join))return null;if(!(null===(o=null==i?void 0:i.get(s.J.Host))||void 0===o?void 0:o.msgEnableChannelsV2))return null;const c=GE(n,a);if(UC({coreSettings:i,userPreferences:t})||(null===(d=null==i?void 0:i.get(s.J.Host))||void 0===d?void 0:d.isGridNavigationLayoutActive)){if(n.action===De.uk.default)return null;const e=[De.py.teamslist,De.py.sharedchannelspendinginvites,De.py.crossteamanalytics];if(a&&e.includes(a.type)&&a.action===De.uk.view)return null;const i=null!==(r=null!==(l=zE(a))&&void 0!==l?l:zE(n))&&void 0!==r?r:c,t=null!==(m=qE(a))&&void 0!==m?m:qE(n),o=t&&t!==i?(0,wo.u4)({teamId:t,channelId:i}):i;return{action:De.uk.view,type:De.py.schoolteams,entityState:{flushableByLinkedEntity:!0},id:o,linkedEntity:null,options:n.options,windowOptions:null}}return{action:De.uk.list,entityState:{flushableByLinkedEntity:!0},id:c,linkedEntity:null,options:n.options,type:De.py.channels,windowOptions:null}},GE=(e,n)=>{var i;if(n&&n.action===De.uk.view)switch(n.type){case De.py.channelmanage:case De.py.teammanage:case De.py.teammanageapps:case De.py.teamsettings:case De.py.teamanalytics:case De.py.teampendingrequests:case De.py.teamchannels:case De.py.channelapps:case De.py.channelmembers:case De.py.channelsettings:case De.py.channelanalytics:case De.py.channeltags:case De.py.teamslist:case De.py.crossteamanalytics:case De.py.sharedchannelspendinginvites:case De.py.extensions:return e.id;case De.py.teammanagetags:return(null===(i=e.id)||void 0===i?void 0:i.trim())?e.id:sessionStorage.manageTagsTargetThreadId}const t=e.type===De.py.channels&&e.action===De.uk.view?e.id:null;if(!t)return null;const{channelId:a}=(0,Eu.jd)(t);return a},JE=[De.py.teamanalytics,De.py.teammanage,De.py.teammanagetags,De.py.teammanageapps,De.py.teampendingrequests,De.py.teamsettings,De.py.teamchannels],qE=e=>{if(!e)return;if(JE.includes(e.type))return e.id;if(e.hasOwnProperty("options")&&null!==e.options){return JSON.parse(e.options).parentTeamId}},zE=e=>{if(e&&e.id)try{const{channelId:n}=(0,Eu.jd)(e.id);return n}catch(e){return}},QE=({contextEntity:e,entity:n,coreSettings:i,userPreferences:t})=>{if(e&&e.action===De.uk.view)switch(e.type){case De.py.channelmanage:case De.py.teammanage:case De.py.teammanagetags:case De.py.teammanageapps:case De.py.teamsettings:case De.py.teamanalytics:case De.py.teampendingrequests:case De.py.teamchannels:case De.py.channelapps:case De.py.channelmembers:case De.py.channelsettings:case De.py.channelanalytics:case De.py.channeltags:case De.py.teamslist:case De.py.crossteamanalytics:case De.py.sharedchannelspendinginvites:case De.py.useronboardingteam:return e}if(e&&n.type===De.py.schoolteams){const n=[De.py.guardians];return e.type&&n.includes(e.type)?Object.assign(Object.assign({},e),{action:De.uk.view,type:De.py.extensions}):e}const a=(null==e?void 0:e.options)&&(0,Wt.D)(e.options);if((null==e?void 0:e.type)===De.py.extensions&&e.action===De.uk.view&&(null==a?void 0:a.source)===sn.D.PlatformTabDeepLink&&(null==a?void 0:a.isAppTeamLevelApp)&&UC({coreSettings:i,userPreferences:t}))return e;if(n.type===De.py.channels&&n.action===De.uk.default&&UC({coreSettings:i,userPreferences:t}))return WE(n);if(n.type===De.py.useronboardingteam){if((e=>e.hasOwnProperty("options"))(n)&&null!==n.options){if(((null==n?void 0:n.options)&&(0,Wt.D)(n.options)).hideSlotHeader)return null}}return n},YE=()=>null,KE=({contextEntity:e,entity:n,coreSettings:i,userPreferences:t})=>{var a;const o=[De.py.archiveteam,De.py.archivechannel,De.py.deleteteam,De.py.leaveteam,De.py.restoreteam,De.py.extensions,De.py.guardians,De.py.callablechannels,De.py.channelcalendar,De.py.channelconnectors,De.py.channelworkflows,De.py.filesoneupviewer,De.py.wiki,De.py.teammanage,De.py.teammanagetags,De.py.teammanageapps,De.py.teamsettings,De.py.teamanalytics,De.py.teampendingrequests,De.py.teamchannels,De.py.channelemailv2,De.py.sharewithteamyouowndialog,De.py.changeteampicture,De.py.channelapps,De.py.channelmembers,De.py.channelmanage,De.py.channelsettings,De.py.channeltags,De.py.channelanalytics,De.py.removechannelemail,De.py.teamslist,De.py.teamserrordialog,De.py.crossteamanalytics,De.py.sharedchannelspendinginvites,De.py.unarchivechannel,De.py.useronboardingteam];return(null==e?void 0:e.type)&&o.includes(e.type)?e:n.type===De.py.channels&&n.action===De.uk.view?(null===(a=null==i?void 0:i.get(s.J.Host))||void 0===a?void 0:a.msgEnableChannelsV2)?n:null:n.type===De.py.channels&&n.action===De.uk.default&&UC({coreSettings:i,userPreferences:t})?WE(n):n},XE=[De.py.channels,De.py.channelcopilot,De.py.channelcontextualsearch,De.py.channelsPinnedPost,De.py.channelsSystemMessage],ZE=["standard","focus"],eM=({entity:e,contextEntity:n,coreSettings:i,layoutMode:t,userPreferences:a})=>{var o,d,l,r;const m=(null==n?void 0:n.id)||e.id,c=(null==n?void 0:n.type)||e.type,u=null!==(o=null==n?void 0:n.options)&&void 0!==o?o:e.options,p=JSON.parse(null!=u?u:"{}"),y=(null===(d=null==a?void 0:a.infoPane)||void 0===d?void 0:d.channels)?"closed"===a.infoPane.channels:!!(null===(l=null==i?void 0:i.get(s.J.Channels))||void 0===l?void 0:l.disableChannelInfoPaneOpenByDefault);if(!((e,n,i,t,a,o,d)=>{var l,r;const{enableChannelInfoPaneSearch:m,enableChannelInfoPane:c=!1,enableChannelCopilotInL2Header:u=!1}=null!==(l=null==t?void 0:t.get(s.J.Channels))&&void 0!==l?l:{},{enableInfoPaneAsResponsiveMenu:p=!1}=null!==(r=null==t?void 0:t.get(s.J.Core))&&void 0!==r?r:{};return!(!(e&&ZE.includes(a)&&XE.includes(n))||(!m||d!==sn.D.ChannelContextualSearch&&(null==i?void 0:i.type)!==De.py.channelcontextualsearch)&&(!u||(null==i?void 0:i.type)!==De.py.channelcopilot)&&(o||!c||!p))})(m,c,n,i,t,y,p.source)&&!p.channelCopilotOpen)return null;const{enableChannelInfoPaneSearch:v}=null!==(r=null==i?void 0:i.get(s.J.Channels))&&void 0!==r?r:{};if(p.source===sn.D.ChannelContextualSearch)return{id:m,action:De.uk.info,type:De.py.channelcontextualsearch};if((null==n?void 0:n.type)===De.py.channelcopilot||p.channelCopilotOpen)return{id:m,action:De.uk.info,type:De.py.channelcopilot};const{replyChainId:k}=(0,oD.kO)(null!=m?m:"");if(k&&(!v||(null==n?void 0:n.type)!==De.py.channelcontextualsearch))return null;if(n){const{action:e,type:i}=n;if(e===De.uk.info&&nM(i,!!v))return n;if(i!==De.py.channels)return null}const{channelId:g}=(0,Eu.jd)(null!=m?m:"");return{id:(0,wo.u4)({channelId:g}),action:De.uk.info,type:De.py.channels}},nM=(e,n)=>{switch(e){case De.py.channelsPinnedPost:case De.py.channelsSystemMessage:return!0;case De.py.channelcontextualsearch:return n;default:return!1}},iM=({areEmptySlotsTransparent:e,coreSettings:n,entity:i})=>({endEntity:{[Fe.S.Rail]:{isHideInfoPaneDisabled:(null==i?void 0:i.type)===De.py.channelcontextualsearch}},mainEntity:{[Fe.S.Main]:{isBackgroundTransparent:!!(null==n?void 0:n.get(s.J.Channels).enableMicaBackgroundForChannelPane)||e}},headerEntity:{[Fe.S.HorizontalBar]:{isBackgroundTransparent:!!(null==n?void 0:n.get(s.J.Channels).enableMicaBackgroundForChannelPane)||e,isColorSchemeDefaultBackground4:!e}},subNavEntity:{[Fe.S.Rail]:{areSlotShadowsDisabled:!1,isBackgroundTransparent:!!(null==n?void 0:n.get(s.J.Core).enableTransparentLeftRail)||e}}}),tM=(e,n,i)=>{const{userPreferences:t,coreSettings:a,layoutMode:o}=n;if(!i)return;const d=i.mainEntity;if(d&&"options"in d&&d.options&&d.id)try{const e=JSON.parse(d.options),{channelId:n,replyChainId:i}=(0,Eu.jd)(d.id);if(e&&i&&n&&e.source===sn.D.ChannelPostMessage)return jE({contextEntity:null,coreSettings:a,entity:{id:n,type:De.py.channels,action:De.uk.view,options:JSON.stringify({deepLinkId:i,source:sn.D.ChannelL2NavigateViaHistory})},layoutMode:o,userPreferences:t})}catch(e){return}},aM=[De.py.teammanage,De.py.teamchannels,De.py.teampendingrequests,De.py.teammanagetags],oM=[De.py.channelapps,De.py.channelmanage,De.py.channelmembers,De.py.channelinvitations],dM=[De.py.sharedchannelspendinginvites],lM=({action:e,appRenderMode:n,coreSettings:i,type:t,logger:a})=>{const o=new Ee.H,{enableComposeCriticalPhaseLoad:d=!1,enableComposeCriticalPhaseLoadForPopout:l=!1,enableComposeCriticalPhaseLoadSecondaryViewport:r=!1,enableComposeCriticalPhaseLoadSecondaryViewportGate:m=!1}=i.get(s.J.Messaging),{enableHybridChannelList:c=!1,msgEnableChannelsV2:u=!1,msgEnableChannelsV2Header:p=!1}=i.get(s.J.Host),{channelPhaseTimeoutSettings:y}=i.get(s.J.TeamsAndChannels),v=[],k=[];switch(n){case Fe.S.HorizontalBar:rM({action:e,type:t,logger:a,criticalSignals:v,featureFlags:{msgEnableChannelsV2Header:p,msgEnableChannelsV2:u},postCriticalSignals:k});break;case Fe.S.Main:sM({action:e,type:t,logger:a,criticalSignals:v,featureFlags:{enableComposeCriticalPhaseLoad:d,enableComposeCriticalPhaseLoadForPopout:l,enableComposeCriticalPhaseLoadSecondaryViewport:r,enableComposeCriticalPhaseLoadSecondaryViewportGate:m,msgEnableChannelsV2:u},postCriticalSignals:k});break;case Fe.S.Rail:mM({action:e,criticalSignals:v,featureFlags:{enableHybridChannelList:c},postCriticalSignals:k,type:t})}return o.registerAppPhase({phase:g.nh.CRITICAL,signals:v,timeout:(null==y?void 0:y.critical)||25e3}),o.registerAppPhase({phase:g.nh.POST_CRITICAL,signals:k,timeout:(null==y?void 0:y.postCritical)||1e4}),o.appPhases},rM=({action:e,criticalSignals:n,featureFlags:{msgEnableChannelsV2Header:i,msgEnableChannelsV2:t},type:a,logger:o})=>{a===De.py.schoolteams&&e===De.uk.list?n.push(Me.G.TEAMS_GRID_VIEW_HEADER_RENDERED):t&&i&&a===De.py.channels&&(e===De.uk.default||e===De.uk.view)?n.push(Me.G.CHANNEL_HEADER_RENDERED):a&&aM.includes(a)?n.push(Me.G.TEAM_DASHBOARD_HEADER_RENDERED):a&&oM.includes(a)?n.push(Me.G.CHANNEL_DASHBOARD_HEADER_RENDERED):a&&dM.includes(a)?n.push(Me.G.TEAMS_DASHBOARD_HEADER_RENDERED):a===De.py.useronboardingteam?n.push(Me.G.USER_ONBOARDING_HEADER_RENDERED):null==o||o.log(`Not adding header slot phase signals for action: ${e}, type: ${a}, msgEnableChannelsV2: ${t}, msgEnableChannelsV2Header: ${i}`)},sM=({action:e,criticalSignals:n,featureFlags:{enableComposeCriticalPhaseLoad:i,enableComposeCriticalPhaseLoadForPopout:t,enableComposeCriticalPhaseLoadSecondaryViewport:a,enableComposeCriticalPhaseLoadSecondaryViewportGate:o,msgEnableChannelsV2:d},postCriticalSignals:l,type:r,logger:s})=>{if(r===De.py.schoolteams&&e===De.uk.list)n.push(Me.G.TEAMS_GRID_VIEW_RENDERED);else if(!d||r!==De.py.channels||e!==De.uk.default&&e!==De.uk.view)r&&aM.includes(r)?n.push(Me.G.TEAM_DASHBOARD_VIEW_RENDERED):r&&oM.includes(r)?n.push(Me.G.CHANNEL_DASHBOARD_VIEW_RENDERED):r&&dM.includes(r)?n.push(Me.G.TEAMS_DASHBOARD_VIEW_RENDERED):r===De.py.useronboardingteam?n.push(Me.G.USER_ONBOARDING_TO_TEAM_VIEW_RENDERED):null==s||s.log(`Not adding main slot phase signals for action: ${e}, type: ${r}, msgEnableChannelsV2: ${d}`);else{n.push(Me.G.MESSAGES_RENDERED);i||t&&o&&a?n.push(Me.G.COMPOSE_LOADED):l.push(Me.G.COMPOSE_LOADED),l.push(Me.G.MESSAGE_REACTIONS_RENDERED,Me.G.PRESENCES_RENDERED,Me.G.VIRTUAL_LIST_RENDER_BUFFER_FILLED)}},mM=({action:e,criticalSignals:n,featureFlags:{enableHybridChannelList:i},type:t})=>{t===De.py.channels&&e===De.uk.list?i&&n.push(Me.G.CHANNEL_LIST_ITEMS_RENDERED):t===De.py.schoolteams&&e===De.uk.view&&n.push(Me.G.SINGLE_TEAM_VIEW_LEFT_RAIL_LOADED)},cM={id:ND.Hm,name:"TeamsAndChannelsApp",getLocalizedName:e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){return yield e.waitForNamespace("teamsAndChannels"),e.stringTranslate("teamsAndChannels","teams_and_channels_app_name")})),actors:[$w],supportedEntities:[De.py.acceptsharedchannelinvitationdialog,De.py.addmembertoprivatechanneldialog,De.py.addmembertoteamdialog,De.py.archiveteam,De.py.archivechannel,De.py.channelapps,De.py.channelanalytics,De.py.channelconnectors,De.py.channelcopilot,De.py.channelworkflows,De.py.channelemailerror,De.py.channelemailv2,De.py.channelmanage,De.py.channelmembers,De.py.channels,De.py.channelsPinnedPost,De.py.channelsSystemMessage,De.py.channelcontextualsearch,De.py.channelsettings,De.py.channelinvitations,De.py.channeltags,De.py.connectorinstanceconfiguration,De.py.createchanneldialog,De.py.createchannelleftraildialog,De.py.crosspostchannelselectiondialog,De.py.crosspostchannelselectiondialogV2,De.py.crosspostdeletedialog,De.py.defaultchannelnavdialog,De.py.deletechannelreactdialog,De.py.deleteteam,De.py.leaveteam,De.py.showhidegeneralchannelwarningdialog,De.py.restoreteam,De.py.leavechanneldialog,De.py.leavechannellastownerdialog,De.py.pinunpinpost,De.py.getlinktoteamorchanneldialog,De.py.removechannelemail,De.py.restorechannelreactdialog,De.py.schoolteams,De.py.sharedchanneldenyinvitation,De.py.sharewithteamyouowndialog,De.py.sharedchannelcreateinvitationsdialog,De.py.sharedchannelspendinginvites,De.py.sharechannelwithuserdialog,De.py.showformemberdialogv2,De.py.stopsharingchannelwithteamreactdialog,De.py.showchannelownersreactdialog,De.py.crossteamanalytics,De.py.teamchannels,De.py.teamcreatedialog,De.py.teamdiscover,De.py.teamjoindialog,De.py.teammanage,De.py.teammanageapps,De.py.teammanagetags,De.py.teampendingrequests,De.py.teamserrordialog,De.py.teamsettings,De.py.changeteampicture,De.py.teamanalytics,De.py.teamslist,De.py.channelnotificationsettings,De.py.staleteamsdialog,De.py.staleteamsdismiss,De.py.unarchivechannel,De.py.useronboardingteam],supportedRenderModes:[Fe.S.HorizontalBar,Fe.S.Main,Fe.S.Rail,Fe.S.Modal],getDefaultCommand:e=>{const{enableHybridChannelList:n,msgEnableChannelsV2:i}=e.get(s.J.Host);if(n&&i)return{type:De.py.channels,action:De.uk.default}},windowFeatures:{minWidth:602,width:602,minHeight:500,height:500,offset:20,widthToScreenWidthRatio:.3,heightToWidthRatio:1.125},infoPaneStateMapping:{[De.py.channelsSystemMessage]:De.py.channels,[De.py.channelsPinnedPost]:De.py.channels},getAllowUserWindowingPreference:({coreSettings:e})=>!!e.get(s.J.Channels).enableChannelDeeplinkWindowUserPreference},uM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEventSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelToastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attributionText"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"channelName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"conversationId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"correlationId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"discardDuringMeetingsAndCalls"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"messageId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"reaction"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"senderDisplayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"senderGivenName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"senderMri"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"subtype"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"text"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"startTimestamp"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"type"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"replyChainId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ChannelToastEvent"}}},arguments:[]}]}}]};var pM,yM;!function(e){e.Follow="Follow",e.Mention="Mention",e.Reaction="Reaction",e.Reply="Reply",e.ReplyToReply="ReplyToReply",e.TeamMembershipChange="TeamMembershipChange",e.DLP="DLP"}(pM||(pM={})),function(e){e.Person="Person",e.Team="Team",e.AddedToSharedChannel="AddedToSharedChannel",e.TeamShareTeamOwnerNotify="TeamShareTeamOwnerNotify",e.PromotedToSharedChannelOwner="PromotedToSharedChannelOwner",e.ChannelOwnerUnshareTeamOwnerNotify="ChannelOwnerUnshareTeamOwnerNotify",e.TeamOwnerUnshareChannelOwnerNotify="TeamOwnerUnshareChannelOwnerNotify",e.NotifySender="NotifySender"}(yM||(yM={}));const vM="toastNotifications",kM={channelPost:"new_channel_post_toast_header",reaction:"channel_reaction_toast_header",reply:"channel_reply_toast_header",replyToReply:"channel_reply_to_reply_toast_header",mentionTeam:"channel_mention_team_toast_header",mentionPerson:"channel_mention_person_toast_header",addedToSharedChannel:"shared_channel_shared_with_a_user_header",channelOwnerUnshareTeamOwnerNotify:"shared_channel_sharing_stopped_by_owner_header",teamShareTeamOwnerNotify:"shared_channel_shared_with_a_team_header",teamOwnerUnshareChannelOwnerNotify:"shared_channel_sharing_stopped_by_team_owner_header",promotedToSharedChannelOwner:"shared_channel_role_promotion_header",dlpNotifySender:"dlp_notify_sender_header"},gM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsTeamsAndChannelsMsaUserProfilePictureQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]}}]},NM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsTeamsAndChannelsToastImageAsDataUriQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]}}]};function hM(e,n,i,a){return(0,t.__awaiter)(this,void 0,void 0,(function*(){try{const o=yield function(e,n,i){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const{data:t}=yield e.query({query:gM,variables:{userId:n,displayName:i,profilePictureSize:Sp.$D.Small}});return t.msaUserProfilePicture}))}(e,i,a);if(!o)return void n.error(io.f.ImageUrlGenerationFailed);const d=yield e.query({query:NM,variables:{url:o}});return(null==d?void 0:d.data.toastImageAsDataUri)||void 0}catch(e){return void n.error(io.f.ImageFetchFailed)}}))}const fM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEmoticonQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoryId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"searchEmoticons"},arguments:[{kind:"Argument",name:{kind:"Name",value:"searchFilter"},value:{kind:"Variable",name:{kind:"Name",value:"searchFilter"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"exactMatch"},value:{kind:"Variable",name:{kind:"Name",value:"exactMatch"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"Argument",name:{kind:"Name",value:"includeShortCuts"},value:{kind:"Variable",name:{kind:"Name",value:"includeShortCuts"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"Argument",name:{kind:"Name",value:"includeKeywords"},value:{kind:"Variable",name:{kind:"Name",value:"includeKeywords"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"Argument",name:{kind:"Name",value:"maxResultCount"},value:{kind:"Variable",name:{kind:"Name",value:"maxResultCount"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"Argument",name:{kind:"Name",value:"categoryId"},value:{kind:"Variable",name:{kind:"Name",value:"categoryId"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEmoticonFragment"}}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Emoticon"}}}}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEmoticonFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Emoticon"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"description"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"unicode"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"animation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEmoticonFragment_animation"}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EmoticonAnimation"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"etag"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"diverse"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"shortcuts"},__type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"searchMatch"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AppsTeamsAndChannelsToastEmoticonFragment_animation"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EmoticonAnimation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fps"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"framesCount"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"firstFrame"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]}]}}]}.definitions]}.definitions]};function _M({reaction:e,channelName:n,teamName:i,type:a,subtype:o,senderDisplayName:d,senderGivenName:l},r,s,m){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const c=d||l;if(!c&&a!==pM.DLP)return"";if(a===pM.Mention&&!o)return"";if(a===pM.Reaction&&!e)return"";const u={channelName:n,senderDisplayName:c,teamName:i};switch(a){case pM.Follow:return SM(kM.channelPost,u,r);case pM.Reply:return SM(kM.reply,u,r);case pM.ReplyToReply:return SM(kM.replyToReply,u,r);case pM.Mention:return o===yM.Person?SM(kM.mentionPerson,u,r):SM(kM.mentionTeam,u,r);case pM.Reaction:const n=yield function(e,n,i){return(0,t.__awaiter)(this,void 0,void 0,(function*(){try{const{id:n}=(0,_s.Mc)(null==i?void 0:i.toLocaleLowerCase().trim());if(!n)return;const{data:t}=yield e.query({query:fM,variables:{searchFilter:n,exactMatch:!0}});return((null==t?void 0:t.searchEmoticons)||[])[0]}catch(e){return void n.error(io.f.ChannelToastEmoticonsQueryFailed)}}))}(s,m,e),i=(null==n?void 0:n.unicode)||void 0;return SM(kM.reaction,Object.assign(Object.assign({},u),{emoji:i}),r);case pM.TeamMembershipChange:return function(e,n,i){switch(e){case yM.AddedToSharedChannel:return SM(kM.addedToSharedChannel,n,i);case yM.ChannelOwnerUnshareTeamOwnerNotify:return SM(kM.channelOwnerUnshareTeamOwnerNotify,n,i);case yM.PromotedToSharedChannelOwner:return SM(kM.promotedToSharedChannelOwner,n,i);case yM.TeamOwnerUnshareChannelOwnerNotify:return SM(kM.teamOwnerUnshareChannelOwnerNotify,n,i);case yM.TeamShareTeamOwnerNotify:return SM(kM.teamShareTeamOwnerNotify,n,i);default:return""}}(o,u,r);case pM.DLP:return SM(kM.dlpNotifySender,u,r);default:return""}}))}function SM(e,{emoji:n,channelName:i,teamName:t,senderDisplayName:a},o){return o.stringTranslate(vM,e,{channelName:i,emoji:n,senderDisplayName:a,teamName:t})}function TM(e,n,i,a){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const{conversationId:t,messageId:o,startTimestamp:d,replyChainId:l,teamName:r,channelName:s,senderMri:m,senderDisplayName:c,text:u}=e,p=e.type===pM.DLP?fs.Uw:yield hM(i,a,m,c||""),y=yield _M(e,n,i,a),v=u||function(e,n,i,t){switch(e.subtype){case yM.ChannelOwnerUnshareTeamOwnerNotify:return t.stringTranslate("toastNotifications","shared_channel_owner_unshare_team_owner_notify_text",{teamName:n});case yM.TeamOwnerUnshareChannelOwnerNotify:return t.stringTranslate("toastNotifications","shared_channel_team_owner_unshare_channel_owner_notify_text",{channelName:i});case yM.NotifySender:return t.stringTranslate("toastNotifications","dlp_notification_notify_sender_text",{teamName:n,channelName:i});default:return t.stringTranslate("toastNotifications","channel_toasts_text",{teamName:n,channelName:i})}}(e,r,s,n);return{conversationId:t,quickReply:!1,discardDuringMeetingsAndCalls:!!e.discardDuringMeetingsAndCalls,messageId:o,time:new Date(+d),replyChainId:l||"",text:v,title:y,mainImage:p?{alt:"",src:p}:void 0}}))}function bM(e,n){const i=e.newScenario(c.RG.CrossClientToastView);i.appendEventData({mainEntityType:De.py.channels}),i.fail(n)}function CM(e,n,i,a,o,d,l,r){const{enableCommandToHostCommService:m}=n.get(s.J.Core,["enableCommandToHostCommService"]),{enableChannelsNotifications:u,enableBrowserToasts:p,enableInAppNotifications:y,enableInAppNotificationsForChatsAndChannels:v}=n.get(s.J.Notifications,["enableChannelsNotifications","enableBrowserToasts","enableInAppNotifications","enableInAppNotificationsForChatsAndChannels"]);return{id:"channel-toast-event-subscription",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const k=a.newLogger("ChannelToastEventSubscription","apps-teams-and-channels");m||p||y&&v?u?(k.log(`${io.f.Subscribing}: subscribing to channel toasts resolver`),i.subscribe({query:uM,fetchPolicy:"no-cache"}).subscribe(function(e,n,i,a,o,d,l,r){const{enableToastCollections:m}=n.get(s.J.Notifications);return n=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var t,s;if(n.errors){const e=(0,wo.u4)(n.errors.map((e=>e.message)).join());return i.error(`${io.f.SubscriptionFailed} ${e}`),void bM(a,{errorCode:io.f.SubscriptionFailed,errors:e})}const u=null===(t=n.data)||void 0===t?void 0:t.channelToastEvent;if(!u)return i.error(io.f.EmptyEvent),void bM(a,{errorCode:io.f.EmptyEvent});const p=a.newScenario(c.RG.CrossClientToastView,{startTime:+u.startTimestamp});p.clientId=u.correlationId,p.appendEventData({mainEntityType:De.py.channels,mainEntitySubtype:u.type});const y=yield TM(u,o,l,i);if(!y.title)return i.error(`${io.f.UnhandledType}: Dropping channel toast with type ${u.type}`),void p.incomplete({reason:io.f.UnhandledType});m&&(y.collectionId=lo(e,r,i)),null===(s=a.hoistScenarioToCore)||void 0===s||s.call(a,p),d.toasts.showChannelsNotification(u.correlationId,y),p.mark(c.ck.CrossClientEntityCommandTriggered),i.log(`${io.f.ToastCommandSent} type:${u.type} correlationId:${u.correlationId}`)}))}(e,n,k,o,d,l,i,r))):k.log(`${io.f.NotEnabled}: channel notifications are off`):k.log(io.f.NotEnabled)}))}}const wM=({context:{authenticationUser:e,client:n,coreSettings:i,loggerFactory:t,scenarioFactory:a,i18n:o,entityCommanding:d,userTrackingService:l}})=>[CM(e,i,n,t,a,o,d,l)],IM=({commandInput:e,requestContext:{clientPreferences:n,coreSettings:i,executionContext:a,loggerFactory:o}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{command:{action:t,data:d}}=e,l=o.newLogger("TeamsAndChannelsApp onCommandReceived","apps-teams-and-channels");if(e.command.actor===$w)switch(t){case Lw:return a.isHandlingAppActiveApp&&UC({coreSettings:i,userPreferences:n})?{entity:{type:De.py.schoolteams,action:De.uk.list},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,correlation:{source:sn.D.SchoolTeams}}}:{entity:{type:De.py.channels,action:De.uk.default},command:{visibilityState:v.fe.show,stateTransition:v.su.flush,correlation:{source:sn.D.Unknown}}};case xw:{const{channelId:e,teamId:n,commandSource:i,back:t,isHidden:a}=d;return{command:{stateTransition:v.su.flush,visibilityState:v.fe.show,correlation:{source:i||sn.D.UserOnboardingTeam}},entity:{id:e,action:De.uk.view,type:De.py.channels},entityOptions:{back:!!t,hiddenChannel:a,parentTeamId:n}}}case Bw:{const{teamId:e,commandSource:n,selectedItemId:i,hideSlotHeader:t,pinned:a}=d;return{command:{stateTransition:v.su.flush,visibilityState:v.fe.show,correlation:{source:n||sn.D.UserOnboardingTeam}},entity:{id:e,action:De.uk.view,type:De.py.useronboardingteam},entityOptions:{selectedItemId:i,parentTeamId:(null==e?void 0:e.endsWith("#"))?e.slice(0,-1):e,hideSlotHeader:t,pinned:a}}}case jw:return function(e){const{teamId:n,channelId:i,channelName:t,displayName:a,groupId:o,teamName:d,channelResourceTenantId:l,commandSource:r}=e,s={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:r||sn.D.ChannelActions}},m={action:De.uk.view,type:De.py.getlinktoteamorchanneldialog};return{command:s,entity:m,entityOptions:{selectedChannelId:i,linkType:"Channel",teamId:n,groupId:o,displayName:a,teamName:d,channelName:t,channelResourceTenantId:l}}}(d);case Uw:return function(e){const{channelId:n,commandSource:i}=e,t={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:i||sn.D.ChannelActions}},a={id:n,action:De.uk.view,type:De.py.channelemailv2};return{command:t,entity:a,entityOptions:{isViewFromSimpleCollab:!0,channelId:n}}}(d);case Vw:return function(e){const{channelId:n,teamId:i,commandSource:t}=e,a={stateTransition:v.su.flush,visibilityState:v.fe.show,correlation:{source:t||sn.D.ChannelActions}},o={id:n,action:De.uk.view,type:De.py.channelmembers,linkedEntity:{id:n,type:De.py.channels,action:De.uk.list}};return{command:a,entity:o,entityOptions:{parentTeamId:i}}}(d);case Ww:return function(e){const{teamId:n,commandSource:i}=e,t={id:n,action:De.uk.view,type:De.py.teammanage,linkedEntity:{id:n||"",type:De.py.channels,action:De.uk.list}};return{command:{stateTransition:v.su.flush,visibilityState:v.fe.show,correlation:{source:i||sn.D.ChannelActions}},entity:t,entityOptions:{parentTeamId:n}}}(d);case Hw:return function(e){const{teamId:n,channelId:i,teamName:t,channelName:a,isLastOwner:o,groupId:d,channelOnlyMember:l,commandSource:r}=e,s=o?De.py.leavechannellastownerdialog:De.py.leavechanneldialog,m={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:r||sn.D.ChannelActions}},c={action:De.uk.view,type:s};return{command:m,entity:c,entityOptions:{isViewFromSimpleCollab:!0,channelName:a,channelId:i,teamId:n,teamName:t,isLastOwner:o,groupId:d,channelOnlyMember:l}}}(d);case Gw:return function(e){const{channelId:n,teamId:i,commandSource:t}=e,a={stateTransition:v.su.flush,visibilityState:v.fe.show,correlation:{source:t||sn.D.ChannelActions}},o={id:n,action:De.uk.view,type:De.py.channelmanage,linkedEntity:{id:n,type:De.py.channels,action:De.uk.list}};return{command:a,entity:o,entityOptions:{isViewFromSimpleCollab:!0,parentTeamId:i}}}(d);case Jw:return function(e){const{teamId:n,channelId:i,commandSource:t}=e,a={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:t||sn.D.ChannelActions}},o={id:i,action:De.uk.view,type:De.py.addmembertoprivatechanneldialog};return{command:a,entity:o,entityOptions:{isViewFromSimpleCollab:!0,parentTeamId:n}}}(d);case qw:return function(e){const{channelId:n,commandSource:i}=e,t={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:i||sn.D.ChannelActions}},a={id:n,action:De.uk.view,type:De.py.sharechannelwithuserdialog};return{command:t,entity:a,entityOptions:{isViewFromSimpleCollab:!0}}}(d);case zw:return function(e){const{channelId:n,teamId:i,commandSource:t}=e,a={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:t||sn.D.ChannelActions}},o={id:n,action:De.uk.view,type:De.py.sharedchannelcreateinvitationsdialog,linkedEntity:{id:n,type:De.py.channels,action:De.uk.list}};return{command:a,entity:o,entityOptions:{channelId:n,teamId:i}}}(d);case Qw:return function(e){const{channelId:n,channelName:i,teamName:t,commandSource:a}=e,o={stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:a||sn.D.ChannelActions}},d={id:n,action:De.uk.view,type:De.py.channelnotificationsettings},l={isViewFromSimpleCollab:!0,commandSource:a||sn.D.ChannelActions,teamName:t,channelName:i};return{command:o,entity:d,entityOptions:l}}(d);default:l.error(`Command action '${t}' is not supported at TeamsAndChannelsApp.`)}else l.error(`Command for actor '${e.command.actor}' cannot be handled by TeamsAndChannelsApp.`)}));const AM=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(241602),i.e(976609),i.e(133950),i.e(779478),i.e(775758),i.e(780208),i.e(242959),i.e(160200),i.e(363327),i.e(384342),i.e(704079),i.e(595506),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(269296),i.e(26466),i.e(405309),i.e(591300),i.e(51182),i.e(589993),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(495500),i.e(756029),i.e(613692),i.e(403936),i.e(271428),i.e(207856),i.e(386201),i.e(450605),i.e(769716),i.e(329712),i.e(673758),i.e(839180),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(628109),i.e(788842),i.e(494306),i.e(762318),i.e(816906),i.e(591822),i.e(931123),i.e(509115),i.e(435933),i.e(449768),i.e(414875),i.e(249903),i.e(927109),i.e(623295),i.e(696028),i.e(362036),i.e(826227),i.e(597930),i.e(550425),i.e(203459),i.e(96495),i.e(714478),i.e(839074),i.e(267871),i.e(55587),i.e(9447),i.e(516532),i.e(989092),i.e(648907),i.e(998258),i.e(3150),i.e(420565),i.e(749157),i.e(56767),i.e(143168),i.e(860599),i.e(383789),i.e(541936),i.e(221368),i.e(165174),i.e(689945),i.e(531521),i.e(15722),i.e(462030)]).then(i.bind(i,346244)),FM=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(241602),i.e(976609),i.e(133950),i.e(779478),i.e(775758),i.e(780208),i.e(242959),i.e(160200),i.e(363327),i.e(384342),i.e(704079),i.e(595506),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(196348),i.e(269296),i.e(26466),i.e(405309),i.e(591300),i.e(51182),i.e(589993),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(495500),i.e(756029),i.e(613692),i.e(403936),i.e(271428),i.e(207856),i.e(386201),i.e(450605),i.e(769716),i.e(329712),i.e(673758),i.e(839180),i.e(905353),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(759500),i.e(628109),i.e(788842),i.e(494306),i.e(762318),i.e(816906),i.e(591822),i.e(931123),i.e(509115),i.e(435933),i.e(449768),i.e(414875),i.e(249903),i.e(927109),i.e(623295),i.e(696028),i.e(362036),i.e(826227),i.e(597930),i.e(550425),i.e(203459),i.e(96495),i.e(714478),i.e(839074),i.e(267871),i.e(55587),i.e(9447),i.e(516532),i.e(989092),i.e(648907),i.e(998258),i.e(3150),i.e(420565),i.e(749157),i.e(56767),i.e(143168),i.e(860599),i.e(383789),i.e(541936),i.e(221368),i.e(165174),i.e(689945),i.e(531521),i.e(15722),i.e(462030)]).then(i.bind(i,228183)),DM=({coreServices:e,host:n,screenState:i,windowOptions:t})=>{const{height:a,minHeight:o,minWidth:d,offset:l,width:r}=cM.windowFeatures||{},m={left:(null==n?void 0:n.screenX)||0,top:(null==n?void 0:n.screenY)||0},c=((null==i?void 0:i.numOpenWindows)||1)*(l||1);return Object.assign(Object.assign(Object.assign({additionalFeatures:{minHeight:`${o}`,minWidth:`${d}`},height:a,left:(null==m?void 0:m.left)+c,minHeight:o,minWidth:d,top:(null==m?void 0:m.top)+c,width:r},cM.windowFeatures),(null==e?void 0:e.coreSettings.get(s.J.Core).enableRatioToScreenBasedSizing)&&function(e,n){const{widthToScreenWidthRatio:i,heightToWidthRatio:t}=n||{};if(!e||!t||!i)return{};const a=i*e.screen.availWidth;return{height:a*t,width:a}}(n,cM.windowFeatures)),t)};function EM(){return{eventHandlers:uE,getAppPhases:lM,getAppViewEntities:jE,getAppViewEntitiesProps:iM,getAppWindowFeatures:DM,getCommandScenarioName:(e,n,i,t)=>{const{entity:a,command:o}=e,d=UC({coreSettings:i,userPreferences:null==t?void 0:t.getAllPreferences()});if(a.type===De.py.channels&&(a.action===De.uk.view||a.action===De.uk.default)&&o.visibilityState===v.fe.show&&(e=>e.stateTransition===v.su.flush||e.stateTransition===v.su.forceFlush||e.stateTransition===v.su.new)(o)){const e=a.id?(0,Eu.jd)(a.id,n):void 0;if(e)return o.stateTransition===v.su.new?e.replyChainId?d?c.RG.SingleTeamViewChannelSwitchL2Popout:c.RG.ChannelSwitchL2Popout:void 0:d?e.replyChainId?c.RG.SingleTeamViewChannelSwitchL2:c.RG.SingleTeamViewChannelSwitchL1:e.replyChainId?c.RG.ChannelSwitchL2:c.RG.ChannelSwitchL1;if(a.action===De.uk.default)return d?c.RG.TeamsGridLoad:c.RG.ChannelSwitchL1}return a.type===De.py.schoolteams&&a.action===De.uk.list?c.RG.TeamsGridLoad:a.type===De.py.channelcontextualsearch&&a.action===De.uk.info&&o.visibilityState!==v.fe.hide?c.RG.ContextualSearchStart:void 0},getPlatformAppIdForEntity:e=>e.type===De.py.channels||e.type===De.py.schoolteams?"2a84919f-59d8-4441-a975-2a8c2643b741":void 0,onBeforeAddToNavigation:DE,onBeforeCommandHandled:ME,onBeforeNavigationFromHistory:tM,manifest:cM,onBeforeDeeplinkParsed:FE,render:({appRenderMode:e,coreSettings:n,onRenderEvent:i,scenarioFactory:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t="teams-and-channels-app";i("ChunkLoadStarted",{chunkName:t});const{enableEntityMoreInfo:o}=n.get(s.J.Core),d=({children:e})=>(0,Ie.t)(Ae.Fragment,{children:e}),l=o?d:Na.p3,{TeamsAndChannelsViewsRenderer:r}=yield(0,Pn.mT)(AM,t,a),{LPC:m}=o?{LPC:d}:yield(0,Pn.mT)(FM,t,a);return i("ChunkLoadSucceeded",{chunkName:t}),(0,Ie.t)(m,{children:(0,Ie.t)(l,{children:(0,Ie.t)(fy.l8,{children:(0,Ie.t)(r,{appRenderMode:e,coreSettings:n})})})})})),onCommandReceived:IM,onPreWarm:wM}}const MM={id:"com.microsoft.teams.tfl-consent",name:"TFLConsentApp",supportedEntities:[De.py.tflfre],supportedRenderModes:[Fe.S.Main,Fe.S.Modal],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}};var PM=i(532658);const RM={shouldAddEntitiesToWindowHistory:e=>{var n;return(null===(n=null==e?void 0:e.mainEntity)||void 0===n?void 0:n.type)!==De.py.tflfre},shouldRestoreClientToEntities:e=>{var n;return(null===(n=null==e?void 0:e.mainEntity)||void 0===n?void 0:n.type)!==De.py.tflfre}};var OM=i(100329);const $M=e=>{if(LM(e))return xM(e)?{subNavEntity:BM(e),headerEntity:jM(e),startEntity:UM(e),mainEntity:VM(e),endEntity:WM(e)}:null},LM=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.tflfre].includes(t),d=[De.uk.default,De.uk.view,De.uk.update],l=i&&d.includes(i);return!!(a&&o&&l)},xM=()=>!0,BM=()=>null,jM=()=>null,UM=()=>null,VM=({entity:e})=>e,WM=()=>null,HM=({entity:e})=>({mainEntity:{[Fe.S.Main]:{isBackgroundTransparent:"minimal"===(null==e?void 0:e.id)}}});var GM=i(218551);const JM={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsTflConsentSetTflUserMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setCurrentUserIsTFLUser"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]}}]},qM=()=>Promise.all([i.e(917388),i.e(807691),i.e(347761),i.e(462317),i.e(212780),i.e(96473)]).then(i.bind(i,947400)),zM=()=>null,QM="TflSignInFlyoutDisplayed",YM=()=>c.RG.TFLConsentLaunch,KM=(e,n,i)=>({overrideType:Km.U.OverrideIntent,intent:Object.assign(Object.assign({},e),{entityCommand:Object.assign(Object.assign({},e.entityCommand),{entity:{id:e.entityCommand.command.layoutMode,type:n,action:i}})})});function XM(){return{getCommandScenarioName:YM,manifest:MM,onAfterIntentAuthenticated:{filter:"*",execute:({intent:e,context:{client:n,authenticatedUser:i,localStorage:a,coreSettings:o,experienceChangeReportingService:d}})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const{enableIsTflUserApiCall:t}=o.get(s.J.Growth),{enableDelayedConsent:l}=o.get(s.J.Flyout);return t&&(0,OM.$l)(i)&&i.type===Jy.Ch.MsaLife&&n.mutate({mutation:JM}),e.shouldRenderContent?(0,OM.N2)(i,o,a)?(d.report({correlationId:e.entityCommand.command.correlation.id,type:GM.yU.UserConsentedToConsumeResources,userContextId:(0,oo.b4)(i),context:{target:"core-tasks-signal-core-lifecycle-changes-task"}}),{overrideType:Km.U.NoOverride}):((e,n)=>"true"!==e.get(QM)&&n.entityCommand.command.layoutMode===v.lO.minimal)(a,e)?KM(e,De.py.identity,De.uk.signin):((e=>{e.set(QM,"true","Growth")})(a),l?e.entityCommand.command.layoutMode===v.lO.minimal||e.entityCommand.command.layoutMode===v.lO.minimode?KM(e,De.py.flyout,De.uk.update):((e,n,i)=>({overrideType:Km.U.OverrideIntent,intent:Object.assign(Object.assign({},e),{entityCommand:Object.assign(Object.assign({},e.entityCommand),{command:Object.assign(Object.assign({},e.entityCommand.command),{stateTransition:v.su.extend,visibilityState:v.fe.show}),entity:{id:e.entityCommand.command.layoutMode,type:n,action:i}})})}))(e,De.py.tflfre,De.uk.default):KM(e,De.py.tflfre,De.uk.default)):{overrideType:Km.U.NoOverride}}))},onBeforeAddToNavigation:RM,render:({appRenderMode:e,loggerFactory:n,onRenderEvent:i,scenarioFactory:a,entity:o,coreSettings:d})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(e===Fe.S.Main||e===Fe.S.Modal){const e=n.newLogger("TflConsentApp","apps-tfl-consent"),t="tfl-consent-app",{id:l,action:r,type:s}=o,m=o.type===De.py.flyout||"minimal"===l||"minimode"===l||false,c=r===De.uk.update||!m;e.log(`entitiy action:${r} id:${l} type:${s}`),e.log("coreSettings type "+typeof d),i("ChunkLoadStarted",{chunkName:t});const{TflFreUserProfile:u}=yield(0,Pn.mT)(qM,t,a);return i("ChunkLoadSucceeded",{chunkName:t}),e.log("render: loading tfl consent app"),(0,Ie.t)(PM.f,Object.assign({namespace:"tflOnboarding"},{children:(0,Ie.t)(u,{isFlyout:m,coreSettings:d,scenarioFactory:a,allowEdit:c})}))}return(0,Ie.t)(zM,{})})),getAppViewEntities:$M,getAppViewEntitiesProps:HM}}const ZM={id:"com.microsoft.teams.virtual-events",name:"VirtualEventsApp",supportedEntities:[De.py.virtualevents],supportedRenderModes:[Fe.S.Main,Fe.S.Modal,Fe.S.HorizontalBar],windowFeatures:{minWidth:1241,width:1241,minHeight:720,height:720}},eP=e=>{if(nP(e))return iP(e)?{subNavEntity:tP(e),headerEntity:aP(e),startEntity:oP(e),mainEntity:dP(e),endEntity:lP(e)}:null},nP=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.virtualevents].includes(t),d=[De.uk.default,De.uk.view,De.uk.create,De.uk.list],l=i&&d.includes(i);return!!(a&&o&&l)},iP=()=>!0,tP=()=>null,aP=({entity:e})=>e,oP=()=>null,dP=({entity:e})=>e,lP=()=>null,rP=()=>({headerEntity:{[Fe.S.HorizontalBar]:{slotHeightOverrides:"6.1rem"}}});var sP;!function(e){e.Webinar="Webinar",e.Townhall="Townhall",e.Conference="Conference"}(sP||(sP={}));var mP;!function(e){e.virtualEventCreate="/l/virtualevent/new",e.virtualEvent="/l/virtualevent"}(mP||(mP={}));const cP={Conference:sP.Conference,Townhall:sP.Townhall,Webinar:sP.Webinar},uP=[{filter:mP.virtualEventCreate,execute:({deeplinkUrl:e,context:{loggerFactory:n}})=>{const i=n.newLogger("VirtualEventsApp onBeforeDeeplinkParsed","apps-virtual-events"),{pathname:t,search:a}=e;i.log(`Parsing deeplinkUrl - pathname: ${t}, search: ${a}`);const o=new URLSearchParams(a),d=o.get("eventType"),l=o.get("source");return d&&cP[d]?Promise.resolve({entityCommand:{entity:{type:De.py.virtualevents,action:De.uk.create},command:{stateTransition:v.su.new,visibilityState:v.fe.show,correlation:{source:sn.D.VirtualEventsOnBeforeDeeplinkParsed}},entityOptions:{eventType:cP[d],source:null!=l?l:"Teams"}},metadata:{allowAnonymous:!1}}):Promise.resolve(void 0)}},{filter:mP.virtualEvent,execute:({deeplinkUrl:e,context:{loggerFactory:n}})=>{const i=n.newLogger("VirtualEventsApp onBeforeDeeplinkParsed","apps-virtual-events"),{pathname:t}=e;i.log(`Parsing deeplinkUrl - pathname: ${t}`);const a=t.split("/")[3];return Promise.resolve({entityCommand:{entity:{type:De.py.virtualevents,action:De.uk.view,id:a},command:{visibilityState:v.fe.show,stateTransition:v.su.new,correlation:{source:sn.D.VirtualEventsOnBeforeDeeplinkParsed}}},metadata:{allowAnonymous:!1}})}}],pP=({prevEntityType:e})=>e===De.py.virtualevents?null:ZM.windowFeatures,yP=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(241602),i.e(371935),i.e(133950),i.e(779478),i.e(268372),i.e(755684),i.e(277599),i.e(881612),i.e(513623),i.e(545490),i.e(738693),i.e(600565),i.e(3855),i.e(992495),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(794535),i.e(309953),i.e(196348),i.e(757343),i.e(917164),i.e(37943),i.e(258923),i.e(460817),i.e(68688),i.e(912597),i.e(127919),i.e(953275),i.e(718194),i.e(68792),i.e(12921),i.e(495500),i.e(586146),i.e(451185),i.e(231772),i.e(615942),i.e(827265),i.e(471768),i.e(480288),i.e(277075),i.e(402002),i.e(206166),i.e(606043),i.e(84314),i.e(905108)]).then(i.bind(i,379744));function vP(){return{getAppViewEntities:eP,getAppViewEntitiesProps:rP,getAppWindowFeatures:pP,manifest:ZM,render:({appRenderMode:e,onRenderEvent:n,scenarioFactory:i})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t="virtual-events-app";n("ChunkLoadStarted",{chunkName:t});const{VirtualEventsViewsRenderer:a}=yield(0,Pn.mT)(yP,t,i);return n("ChunkLoadSucceeded",{chunkName:t}),(0,Ie.t)(ri.f,Object.assign({namespaces:["virtualEvents","webinar","messaging","meetingAnalytics","compose","calendar","extensibility","meetingOptions"],loaderRenderer:null},{children:(0,Ie.t)(a,{appRenderMode:e})}))})),onRegister:e=>{e.registerTask(new Si.K)},onBeforeDeeplinkParsed:uP}}const kP={id:"com.microsoft.teams.virtual-consumer-events",name:"VirtualConsumerEventsApp",actors:[Iu],supportedEntities:[De.py.virtualconsumerevents,De.py.virtualconsumereventscreateevent],supportedRenderModes:[Fe.S.Main,Fe.S.Modal]},gP={eventHandlers:{onEventReceived:()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){}))},getCommandScenarioName:e=>{const{entity:n}=e;if(n.type===De.py.virtualconsumereventscreateevent&&n.action===De.uk.view)return c.RG.VirtualConsumerEventsCreateEvent},onCommandReceived:({requestContext:{loggerFactory:e},commandInput:{command:{actor:n,action:i,data:a}}})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const t=e.newLogger("onCommandReceived","apps-virtual-consumer-events-on-command-received");if(n===Iu)return i===Au?(e=>"object"==typeof e&&!!e&&"communityId"in e)(a)?{entity:{type:De.py.virtualconsumereventscreateevent,action:De.uk.view,id:a.communityId},command:{stateTransition:v.su.extend,visibilityState:v.fe.show,correlation:{source:sn.D.VirtualConsumerEvents}},entityOptions:{communityId:a.communityId}}:void t.error(`Command data is invalid for command '${i}'.`):void t.error(`Command action '${i}' is not supported by VirtualConsumerEventsApp.`);t.error(`Command for actor '${n}' cannot be handled by VirtualConsumerEventsApp.`)}))},NP=()=>i.e(53163).then(i.bind(i,358331));function hP(){return Object.assign({manifest:kP,render:({appRenderMode:e,onRenderEvent:n,scenarioFactory:i})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t="virtual-consumer-events-app";n("ChunkLoadStarted",{chunkName:t});const{VirtualConsumerEventsViewsRenderer:a}=yield(0,Pn.mT)(NP,t,i);return n("ChunkLoadSucceeded",{chunkName:t}),(0,Ie.t)(ri.f,Object.assign({namespaces:["virtualConsumerEvents"],loaderRenderer:null},{children:(0,Ie.t)(a,{appRenderMode:e})}))}))},gP)}const fP=e=>{if(_P(e))return SP(e)?{subNavEntity:TP(e),headerEntity:bP(e),startEntity:CP(e),mainEntity:wP(e),endEntity:IP(e)}:null},_P=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.registration].includes(t),d=[De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},SP=()=>!0,TP=()=>null,bP=()=>null,CP=()=>null,wP=({entity:e})=>e,IP=()=>null,AP={getDefaultCommand:()=>({type:De.py.registration,action:De.uk.view}),id:"com.microsoft.teams.webinar-registration",name:"WebinarRegistrationApp",supportedRenderModes:[Fe.S.Main],supportedEntities:[De.py.registration],windowFeatures:{minWidth:1140,width:1140,minHeight:720,height:720}},FP=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(241602),i.e(133950),i.e(779478),i.e(268372),i.e(775758),i.e(277599),i.e(236315),i.e(529375),i.e(881612),i.e(513623),i.e(503493),i.e(9081),i.e(475063),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(757343),i.e(511611),i.e(37943),i.e(876435),i.e(127919),i.e(953275),i.e(718194),i.e(68792),i.e(12921),i.e(586146),i.e(827265),i.e(480288),i.e(854937)]).then(i.bind(i,298966)),DP=()=>AP.windowFeatures||{};function EP(){const e=()=>null;return{getAppViewEntities:fP,getAppWindowFeatures:DP,manifest:AP,render:({appRenderMode:n})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main){const e="webinar-registration-app",{WebinarRegistrationViewsRenderer:n}=yield(0,Pn.mT)(FP,e);return(0,Ie.t)(ri.f,Object.assign({namespaces:["compose","webinar"],loaderRenderer:null},{children:(0,Ie.t)(n,{})}))}return(0,Ie.t)(e,{})}))}}const MP={id:"com.microsoft.teams.guardians",name:"GuardiansApp",supportedEntities:[De.py.guardians,De.py.guardiansapprovalrequest,De.py.guardianssendapprovalsuccess,De.py.guardianssendapprovalerror],supportedRenderModes:[Fe.S.HorizontalBar,Fe.S.Main,Fe.S.Rail,Fe.S.Modal],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},PP=e=>{if(RP(e))return OP(e)?{subNavEntity:$P(e),headerEntity:LP(e),startEntity:xP(e),mainEntity:BP(e),endEntity:jP(e)}:null},RP=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.guardians].includes(t),d=[De.uk.list],l=i&&d.includes(i);return!!(a&&o&&l)},OP=()=>!0,$P=({entity:e,layoutMode:n})=>n===v.lO.focus?null:e,LP=({entity:e})=>e,xP=()=>null,BP=({entity:e})=>e,jP=()=>null,UP={onEventReceived:({eventInput:e})=>{var n,i;if(e.event.type===Ze.uS.requestPersonMoreInfo){const t=null===(i=(n=e.event).data)||void 0===i?void 0:i.call(n);return Promise.resolve({command:on(t)})}return Promise.resolve(void 0)}},VP=({appRenderMode:e})=>{const n=new Ee.H,i=[],t=[];switch(e){case Fe.S.Main:WP({criticalSignals:i,postCriticalSignals:t,featureFlags:{}});case Fe.S.HorizontalBar:case Fe.S.Rail:}return n.registerAppPhase({phase:g.nh.CRITICAL,signals:i,timeout:3e4}),n.appPhases},WP=({criticalSignals:e})=>{e.push(Me.G.GUARDIANS_APP_RENDERED)};var HP=i(947542),GP=i(935098),JP=i(579664),qP=i(395463),zP=i(30350),QP=i(423502),YP=i(883101),KP=i(286672);const XP=(0,zn.s)({guardiansApprovalRequestDialogSurface:{Bbmb7ep:["f1erghxr","f1ehz9de"],Beyfa6y:["f1ehz9de","f1erghxr"],B7oj6ja:["f1spoy8","fmb70yw"],Btl43ni:["fmb70yw","f1spoy8"],a9b677:"f177j64f"},showDialogBody:{Bqenvij:"f1j8dsdc"},showGuardiansApprovalRequestFormLabel:{jrapky:"f1jlhsmd",Be2twd7:"fses1vf"},showGuardiansApprovalRequestFormInput:{B6of3ja:"fvjh0tl"},showAddNewParentButton:{sj55zd:"f16muhyy",uwmqm3:["f1asdtw4","fifp7yv"],B6of3ja:"f1xdg43u",Dyrjrp:"f1cqwcg4"},rightActionButton:{B6of3ja:"f1xdg43u"},showGuardiansAvatarAndArrowIcon:{uwmqm3:["f1asdtw4","fifp7yv"],z189sj:["fifp7yv","f1asdtw4"],B6of3ja:"f1xdg43u",jrapky:"f1jlhsmd"},isParentAvatar:{Bf4jedk:"ff9fk16",Frg6f3:["f9yszdx","fibjyge"]},showArrowIcon:{z189sj:["fifp7yv","f1asdtw4"]},showParentDisplayName:{Bf4jedk:"ff9fk16",sj55zd:"fkfq4zb",Be2twd7:"fses1vf",B80ckks:"fmd4ok8",Bhrd7zp:"f71fsbu",Bg96gwp:"f1n95isl"},alignAvatarAndArrowIcon:{a9b677:"fly5x3f"},showDialogDivider:{B6of3ja:"f2zxqi",jrapky:"febqm8h"},parentInputFieldError:{B4j52fo:"f118ihkj",Bekrc4i:["fb4i99f","fgvdrvz"],Bn0qgzm:"f3bv7ky",ibv6hh:["fgvdrvz","fb4i99f"],icvyot:"fzkkow9",vrafjx:["fcdblym","fjik90z"],oivjwe:"fg706s2",wvpqe5:["fjik90z","fcdblym"],g2u3we:"f8scegn",h3c5rm:["f14c50la","f909gkl"],B9xav0g:"f171s0d9",zhjwy3:["f909gkl","f14c50la"]},showErrorMsg:{B6of3ja:"f4gg0ds",sj55zd:"f1hcrxcs"},showFormView:{B6of3ja:"f18og1rn"},spinner:{B6of3ja:"f1uinfot"},disableGridItem:{sj55zd:"f1s2aq7o",Bkecrkj:"f1aehjj5"},showDialogSubHeader:{B6of3ja:"f2zxqi",jrapky:"febqm8h",Bhrd7zp:"f71fsbu",Be2twd7:"fses1vf"}},{d:[".f1erghxr{border-bottom-right-radius:8px;}",".f1ehz9de{border-bottom-left-radius:8px;}",".f1spoy8{border-top-right-radius:8px;}",".fmb70yw{border-top-left-radius:8px;}",".f177j64f{width:600px;}",".f1j8dsdc{height:403px;}",".f1jlhsmd{margin-bottom:12px;}",".fses1vf{font-size:14px;}",".fvjh0tl{margin-top:4px;}",".f16muhyy{color:var(--colorBrandForeground1);}",".f1asdtw4{padding-left:0px;}",".fifp7yv{padding-right:0px;}",".f1xdg43u{margin-top:12px;}",".f1cqwcg4:disabled{color:var(--colorNeutralForegroundDisabled);}",".ff9fk16{min-width:3.2rem;}",".f9yszdx{margin-left:0px;}",".fibjyge{margin-right:0px;}",".fkfq4zb{color:var(--colorNeutralForeground2);}",".fmd4ok8{font-style:normal;}",".f71fsbu{font-weight:400;}",".f1n95isl{line-height:20px;}",".fly5x3f{width:100%;}",".f2zxqi{margin-top:8px;}",".febqm8h{margin-bottom:8px;}",".f118ihkj{border-top-width:0.1rem;}",".fb4i99f{border-right-width:0.1rem;}",".fgvdrvz{border-left-width:0.1rem;}",".f3bv7ky{border-bottom-width:0.1rem;}",".fzkkow9{border-top-style:solid;}",".fcdblym{border-right-style:solid;}",".fjik90z{border-left-style:solid;}",".fg706s2{border-bottom-style:solid;}",".f8scegn{border-top-color:var(--colorPaletteRedForeground1);}",".f14c50la{border-right-color:var(--colorPaletteRedForeground1);}",".f909gkl{border-left-color:var(--colorPaletteRedForeground1);}",".f171s0d9{border-bottom-color:var(--colorPaletteRedForeground1);}",".f4gg0ds{margin-top:3px;}",".f1hcrxcs{color:var(--colorPaletteRedForeground1);}",".f18og1rn{margin-top:15px;}",".f1uinfot{margin-top:16px;}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f1aehjj5{pointer-events:none;}"]});var ZP=i(44105);const eR=({relatedContacts:e,onClickSaveButtonHandler:n,onClickBackButtonHandler:i,isSaveButtonEnabled:t})=>{const a=(0,wl.Cq)();return(0,Ie.t)(Ae.Fragment,{children:[e.length>0&&(0,Ie.t)(Gn.k,Object.assign({position:"start"},{children:(0,Ie.t)(HP.h,{children:(0,Ie.t)(Sl.z,Object.assign({appearance:"subtle",icon:(0,Ie.t)(ll.s$$,{filled:!0,fontSize:KP.l.large}),onClick:i,"data-tid":"guardians-approval-request-dialog-back-button"},{children:a.stringTranslate("guardians","guardians_approval_request_dialog_back_button")}))})})),(0,Ie.t)(Gn.k,Object.assign({position:"end"},{children:(0,Ie.t)(HP.h,{children:(0,Ie.t)(Sl.z,Object.assign({appearance:"primary",size:"medium",onClick:n,disabled:!t,"data-tid":"guardians-approval-request-dialog-save-button"},{children:a.stringTranslate("guardians","guardians_approval_request_dialog_save_button")}))})}))]})};var nR=i(512318),iR=i(835193);const tR=/[@#$%^&*()_:"=<>[\]{};?\/|~\\]/,aR=(e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var a,o,d,l;const{displayNameErr:r}=((e,n)=>{let i;return Boolean(""!==(null==e?void 0:e.trim()))?e.length>256?i=n.stringTranslate("guardians","guardians_name_max_length_field_error"):tR.test(e)&&(i=n.stringTranslate("guardians","guardians_name_special_characters_error")):i=n.stringTranslate("guardians","guardians_name_required_field_error"),{displayNameErr:i}})(n.displayName,i),s=(null===(a=e.emailAddress)||void 0===a?void 0:a.trim())===(null===(o=n.emailAddress)||void 0===o?void 0:o.trim()),{emailAddressErr:m}=((e,n,i)=>{let t;const a=Boolean(""!==(null==e?void 0:e.trim()));if(a||(t=i.stringTranslate("guardians","guardians_email_required_field_error")),!n){const n=(0,iR.v)(e);a&&!n&&(t=i.stringTranslate("guardians","guardians_email_format_field_error"))}return{emailAddressErr:t}})(n.emailAddress,s,i),c=(null===(d=e.mobilePhone)||void 0===d?void 0:d.trim())===(null===(l=n.mobilePhone)||void 0===l?void 0:l.trim()),{mobilePhoneErr:u}=yield((e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){let t;if(!n){const n=Boolean(""!==(null==e?void 0:e.trim())),a=yield nR.o.tryParse(e),o=a&&e===a.toString();n&&!o&&(t=i.stringTranslate("guardians","guardians_phone_format_field_error"))}return{mobilePhoneErr:t}})))(n.mobilePhone,c,i);return{displayNameErr:r,emailAddressErr:m,mobilePhoneErr:u}})),oR={displayName:"",emailAddress:"",mobilePhone:""},dR=({relatedContacts:e,parentRowSelected:n,setDialogViewMode:i,setRelatedContacts:a})=>{const o=(0,wl.Cq)(),d=XP(),[l,r]=Ae.useState(oR),[s,m]=Ae.useState({displayNameErr:void 0,emailAddressErr:void 0,mobilePhoneErr:void 0}),c=-1!==n?e[n]:oR,u=((e,n)=>Object.keys(n).some((i=>{const t=null==e?void 0:e[i],a=null==n?void 0:n[i];return"string"==typeof t&&"string"==typeof a&&t.trim()!==a.trim()})))(c,l),{handleParentInputChange:p}=((e,n)=>({handleParentInputChange:Ae.useCallback((i=>{const{name:t,value:a}=i.target;e((e=>Object.assign(Object.assign({},e),{[t]:a}))),n((e=>Object.assign(Object.assign({},e),{[`${t}Err`]:void 0})))}),[n,e])}))(r,m),y=Ae.useCallback((()=>{i(ZP.h.List)}),[i]),v=Ae.useCallback((()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{displayNameErr:e,emailAddressErr:t,mobilePhoneErr:d}=yield aR(c,l,o);m((n=>Object.assign(Object.assign({},n),{displayNameErr:e,emailAddressErr:t,mobilePhoneErr:d})));!e&&!t&&!d&&(i(ZP.h.List),a((e=>{const i=[...e||[]];return-1!==n?i[n]=l:i.push(l),i})))}))),[i,a,n,l,c,o]);return Ae.useEffect((()=>{-1!==n&&r(Object.assign({},e[n]))}),[n,e]),(0,Ie.t)(Ae.Fragment,{children:[(0,Ie.t)(Hn.c,{children:[(0,Ie.t)(JP.i,{className:d.showDialogDivider}),(0,Ie.t)(dl.k,Object.assign({column:!0,className:d.showFormView},{children:[(0,Ie.t)(dl.k,Object.assign({column:!0,className:d.showGuardiansApprovalRequestFormLabel},{children:[(0,Ie.t)(qP._,Object.assign({id:"nameLabel",required:!0},{children:o.stringTranslate("guardians","guardians_approval_request_dialog_parent_name_label")})),(0,Ie.t)(zP.I,{type:"text",name:"displayName",value:l.displayName||"",onChange:p,className:d.showGuardiansApprovalRequestFormInput,"aria-labelledby":"nameLabel","aria-required":"true"}),(0,Ie.t)(GP.q,Object.assign({size:"small",className:d.showErrorMsg,"aria-live":"polite","aria-atomic":"true","aria-relevant":"all",error:!0},{children:s.displayNameErr&&(0,Ie.t)(dl.k,Object.assign({vAlign:"center"},{children:[(0,Ie.t)(ll.JeE,{filled:!0,fontSize:KP.l.medium}),s.displayNameErr]}))}))]})),(0,Ie.t)(dl.k,Object.assign({column:!0,className:d.showGuardiansApprovalRequestFormLabel},{children:[(0,Ie.t)(qP._,Object.assign({id:"emailLabel",required:!0},{children:o.stringTranslate("guardians","guardians_approval_request_dialog_parent_email_label")})),(0,Ie.t)(zP.I,{type:"text",name:"emailAddress",value:l.emailAddress||"",onChange:p,className:(0,QP.z)(d.showGuardiansApprovalRequestFormInput,s.emailAddressErr&&d.parentInputFieldError),"aria-labelledby":"emailLabel","aria-required":"true"}),(0,Ie.t)(GP.q,Object.assign({size:"small",className:d.showErrorMsg,"aria-live":"polite","aria-atomic":"true","aria-relevant":"all",error:!0},{children:s.emailAddressErr&&(0,Ie.t)(dl.k,Object.assign({vAlign:"center"},{children:[(0,Ie.t)(ll.JeE,{filled:!0,fontSize:KP.l.medium}),s.emailAddressErr]}))}))]})),(0,Ie.t)(dl.k,Object.assign({column:!0,className:d.showGuardiansApprovalRequestFormLabel},{children:[(0,Ie.t)(dl.k,Object.assign({vAlign:"center"},{children:[(0,Ie.t)(qP._,Object.assign({id:"phoneLabel"},{children:o.stringTranslate("guardians","guardians_approval_request_dialog_parent_phone_label")})),(0,Ie.t)(YP.u,Object.assign({relationship:"label",positioning:"below-start",withArrow:!0,content:{children:o.stringTranslate("guardians","guardians_approval_request_dialog_phone_tooltip")}},{children:(0,Ie.t)(Sl.z,{icon:(0,Ie.t)(ll.kIV,{fontSize:KP.l.medium}),appearance:"transparent","data-tid":"guardians-approval-request-dialog-parent-phone-tooltip",role:"tooltip"})}))]})),(0,Ie.t)(zP.I,{type:"text",name:"mobilePhone",value:l.mobilePhone||"",onChange:p,className:(0,QP.z)(d.showGuardiansApprovalRequestFormInput,s.mobilePhoneErr&&d.parentInputFieldError),"aria-labelledby":"phoneLabel"}),(0,Ie.t)(GP.q,Object.assign({size:"small",className:d.showErrorMsg,"aria-live":"polite","aria-atomic":"true","aria-relevant":"all",error:!0},{children:s.mobilePhoneErr&&(0,Ie.t)(dl.k,Object.assign({vAlign:"center"},{children:[(0,Ie.t)(ll.JeE,{filled:!0,fontSize:KP.l.medium}),s.mobilePhoneErr]}))}))]}))]}))]}),(0,Ie.t)(eR,{relatedContacts:e,onClickBackButtonHandler:y,onClickSaveButtonHandler:v,isSaveButtonEnabled:u})]})};var lR=i(59767),rR=i(866679),sR=i(640516),mR=i(436830),cR=i(110331),uR=i(544825),pR=i(202477),yR=i(271149);const vR=({onClickAddParentButtonHandler:e,isSendApprovalButtonEnabled:n,onClickSendForApprovalButtonHandler:i,isRequestInProgress:t,relatedContacts:a})=>{const o=(0,wl.Cq)(),d=XP(),l=(0,yR.Yx)(),r=Ae.useCallback((()=>{i(a)}),[i,a]),s=o.stringTranslate("guardians","guardians_approval_request_loader_label"),m=o.stringTranslate("guardians","guardians_approval_request_loader_icon_label"),c={"data-track-action-gesture":ei.uS.click,"data-track-module-type":ei.PO.button,"data-track-module-name":ei.rA.sendApprovalButton,"data-track-panel-region":ei.Ai.modal,"data-track-action-outcome":ei.$K.submit,"data-track-panel-type":ei.wh.GuardiansApprovalRequestDialog},u={"data-track-action-gesture":ei.uS.click,"data-track-module-type":ei.PO.button,"data-track-module-name":ei.rA.addNewParentButton,"data-track-panel-region":ei.Ai.modal,"data-track-action-outcome":ei.$K.open,"data-track-panel-type":ei.wh.GuardiansApprovalRequestDialog};return Ae.useEffect((()=>{t&&l.announce(s,!0)}),[t,s,l]),(0,Ie.t)(Ae.Fragment,{children:[(0,Ie.t)(Gn.k,Object.assign({position:"start"},{children:(0,Ie.t)(HP.h,{children:(0,Ie.t)(Sl.z,Object.assign({appearance:"subtle",icon:(0,Ie.t)(ll.mm_,{}),onClick:e,disabled:t,"data-tid":"guardians-approval-request-dialog-add-new-parent-button",className:d.showAddNewParentButton},u,{children:o.stringTranslate("guardians","guardians_approval_request_dialog_add_new_parent_button")}))})})),(0,Ie.t)(Gn.k,Object.assign({position:"end"},{children:t?(0,Ie.t)(pR.$,{size:"extra-small","aria-label":m,label:s,className:d.spinner}):(0,Ie.t)(HP.h,{children:(0,Ie.t)(Sl.z,Object.assign({appearance:"primary","data-tid":"guardians-approval-request-dialog-send-approval-button",disabled:n,className:d.rightActionButton,onClick:r},c,{children:o.stringTranslate("guardians","guardians_approval_request_dialog_send_approval_button")}))})}))]})};var kR=i(415394);const gR=[(0,rR.p)({columnId:"",renderCell:e=>{const n=XP(),{vars:i}=(0,kR.L)(),t=(0,wl.Cq)().stringTranslate("guardians","guardians_approval_request_dialog_arrow_icon");return(0,Ie.t)(lR.K,Object.assign({content:{className:n.alignAvatarAndArrowIcon},className:n.showGuardiansAvatarAndArrowIcon},{children:(0,Ie.t)(dl.k,Object.assign({vAlign:"center",space:"between"},{children:[(0,Ie.t)(dl.k,Object.assign({gap:"gap.medium",vAlign:"center"},{children:[(0,Ie.t)(Tl.mw,{variables:i("guardians",["isParentAvatar"]),v9ClassName:n.isParentAvatar,users:[{displayName:e.displayName,email:e.emailAddress,id:""}],isFocusable:!1,isPresencePrefetched:!1,showPresence:!1,hidePersonaCard:!0,narrateProfilePicture:!1,callerInfo:"guardians-approval-request-dialog-list",isSharedChannel:!1}),(0,Ie.t)(GP.q,Object.assign({className:(0,QP.z)(n.showParentDisplayName,e.disableGridRow&&n.disableGridItem)},{children:e.displayName}))]})),(0,Ie.t)(dl.k,{children:(0,Ie.t)(ll._Qn,{fontSize:KP.l.large,"aria-label":t,"data-tid":"guardians-approval-request-dialog-arrow-icon",className:(0,QP.z)(n.showArrowIcon,e.disableGridRow&&n.disableGridItem)})})]}))}))}})],NR=({relatedContacts:e,setActionType:n,setDialogViewMode:i,setParentRowSelected:t,memberAndRelatedContacts:a,onClickSendForApprovalButtonHandler:o,isRequestInProgress:d})=>{const l=(0,wl.Cq)().stringTranslate("guardians","guardians_grid_info_text",{student:a.displayName||""}),r=XP();e.map((e=>e.disableGridRow=d));const[s,m]=Ae.useState(!1),c=Ae.useCallback((e=>{d||(i(ZP.h.Form),n(ZP.V.Edit),t(e))}),[n,i,t,d]),u=Ae.useCallback((e=>{c(Number(e.currentTarget.id))}),[c]),p=Ae.useCallback((e=>{"Enter"===e.key&&c(Number(e.currentTarget.id))}),[c]),y=Ae.useCallback((()=>{i(ZP.h.Form),n(ZP.V.Add),t(-1)}),[n,i,t]);return Ae.useEffect((()=>{const n=(0,Wi.isEqual)(e,a.guardiansInfo);m(n)}),[a.guardiansInfo,e]),(0,Ie.t)(Ae.Fragment,{children:[(0,Ie.t)(Hn.c,{children:[(0,Ie.t)(JP.i,{className:r.showDialogDivider}),(0,Ie.t)(sR._,Object.assign({items:e,columns:gR,"data-tid":"guardians-approval-request-dialog-list","aria-label":l},{children:(0,Ie.t)(mR.s,{children:({item:e,rowId:n})=>(0,Ie.t)(cR.m,Object.assign({id:n.toString(),onClick:u,onKeyDown:p},{children:({renderCell:n})=>(0,Ie.t)(uR.a,{children:n(e)})}),n)})}))]}),(0,Ie.t)(vR,{onClickAddParentButtonHandler:y,isSendApprovalButtonEnabled:s,onClickSendForApprovalButtonHandler:o,isRequestInProgress:d,relatedContacts:e})]})};var hR=i(851047);const fR=({memberAndRelatedContacts:e,onCloseDialogHandler:n,onClickSendForApprovalButtonHandler:i,isDialogOpen:t,initialAction:a,initialViewMode:o,isRequestInProgress:d})=>{const l=(0,wl.Cq)(),r=XP(),[s,m]=Ae.useState(a),[c,u]=Ae.useState(o),[p,y]=Ae.useState(-1),[v,k]=Ae.useState(e.guardiansInfo),g=Ae.useCallback((e=>{"Escape"!==e.key&&"Esc"!==e.key||n()}),[n]);return(0,Ie.t)(jn.V,Object.assign({open:t,"data-tid":"guardians-approval-request-dialog-renderer"},{children:(0,Ie.t)(Un.c,Object.assign({onKeyDown:g,className:r.guardiansApprovalRequestDialogSurface,"data-tid":"guardians-approval-request-dialog-renderer-surface"},{children:(0,Ie.t)(Vn.a,Object.assign({className:r.showDialogBody},{children:[(0,Ie.t)(Wn.$,Object.assign({action:(0,Ie.t)(HP.h,{children:(0,Ie.t)(Sl.z,{appearance:"subtle",disabled:d,icon:(0,Ie.t)(ll.tEX,{}),onClick:n,"data-tid":"guardians-approval-request-dialog-close-button","aria-label":l.stringTranslate("guardians","guardians_approval_request_dialog_close_button")})})},{children:(0,Ie.t)(dl.k,Object.assign({column:!0},{children:[(0,Ie.t)(ul.W,{children:l.stringTranslate("guardians","guardians_approval_request_dialog_renderer_title",{actionType:s})}),(0,Ie.t)(GP.q,Object.assign({className:r.showDialogSubHeader},{children:l.stringTranslate("guardians","guardians_approval_request_dialog_sub_header")})),(0,Ie.t)(hR.Mx,{member:e,isParentsEndSlot:!1,isGuardiansApprovalRequestDialog:!0})]}))})),c===ZP.h.Form?(0,Ie.t)(dR,{relatedContacts:v,setRelatedContacts:k,parentRowSelected:p,setDialogViewMode:u}):(0,Ie.t)(NR,{relatedContacts:v,setActionType:m,setParentRowSelected:y,memberAndRelatedContacts:e,setDialogViewMode:u,onClickSendForApprovalButtonHandler:i,isRequestInProgress:d})]}))}))}))};var _R=i(16076),SR=i(133698);const TR=({initialAction:e,initialViewMode:n,isDialogOpen:i,setIsDialogOpen:a,memberAndRelatedContacts:o})=>{const d=(0,wl.Cq)(),l=(0,jy.x)(),{loggerFactory:{newLogger:r},scenarioFactory:s}=(0,Cl.SE)(),m=d.stringTranslate("guardians","guardians_approval_request_title",{studentName:o.displayName||""}),u=Ae.useCallback((()=>{a(!1)}),[a]),p=(0,SR.RQ)(),y=(0,SR.WN)(),{createGuardiansApproval:v,loading:k}=(0,_R.CH)(o.groupId||"",o.objectId||"",m,l),g=Ae.useCallback((e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n,i,t,a,d,l;const r=s.newScenario(c.RG.CreateGuardiansApproval);r.appendEventData({studentId:o.objectId||"",groupId:o.groupId||""});try{const t=e.map((e=>({displayName:e.displayName,emailAddress:e.emailAddress,mobilePhone:e.mobilePhone,relationship:"parent"}))),a=yield v(t);u();const o=null===(i=null===(n=a.data)||void 0===n?void 0:n.createGuardiansApproval)||void 0===i?void 0:i.approvalId;o?(r.stop({approvalId:o}),p()):(r.cancel({errorCode:gn.jK.Unknown,errors:"Missing approval id on the create guardians approval request."}),y())}catch(e){const{message:n}=e,{code:i,context:o,reason:s}=null!==(l=null===(d=null===(a=null===(t=null==e?void 0:e.graphQLErrors)||void 0===t?void 0:t[0])||void 0===a?void 0:a.extensions)||void 0===d?void 0:d.prevError)&&void 0!==l?l:{},m=`ErrorMessage: ${n}`;r.fail({context:o,reason:s,errorCode:i,errors:m}),u(),y()}}))),[v,u,p,y,o.objectId,o.groupId,s]);return(0,Ie.t)(Al.q,Object.assign({panelRegion:ei.Ai.modal,panelType:ei.wh.GuardiansApprovalRequestDialog,newLogger:r},{children:(0,Ie.t)(fR,{memberAndRelatedContacts:o,onCloseDialogHandler:u,onClickSendForApprovalButtonHandler:g,initialAction:e,initialViewMode:n,isDialogOpen:i,isRequestInProgress:k})}))};TR.displayName="GuardiansApprovalRequestDialogContainer";const bR=()=>{const[e,n]=Ae.useState(!0),i=(0,wl.Cq)(),t=XP(),a=Ae.useCallback((()=>{n(!1)}),[n]),o=Ae.useCallback((e=>{"Escape"!==e.key&&"Esc"!==e.key||a()}),[a]);return(0,Ie.t)(jn.V,Object.assign({open:e,"data-tid":"guardians-send-approval-success-dialog-renderer"},{children:(0,Ie.t)(Un.c,Object.assign({onKeyDown:o,className:t.guardiansApprovalRequestDialogSurface,"data-tid":"guardians-send-approval-success-dialog-renderer-surface"},{children:(0,Ie.t)(Vn.a,{children:[(0,Ie.t)(Wn.$,{children:i.stringTranslate("guardians","guardians_approval_request_success_dialog_title")}),(0,Ie.t)(Hn.c,{children:(0,Ie.t)(GP.q,{children:i.stringTranslate("guardians","guardians_approval_request_success_dialog_content")})}),(0,Ie.t)(Gn.k,Object.assign({position:"end"},{children:(0,Ie.t)(HP.h,{children:(0,Ie.t)(Sl.z,Object.assign({appearance:"outline","data-tid":"guardians-approval-request-success-dialog-close-button",className:t.rightActionButton,onClick:a},{children:i.stringTranslate("guardians","guardians_approval_request_dialog_close_button")}))})}))]})}))}))},CR=()=>{const[e,n]=Ae.useState(!0),i=(0,wl.Cq)(),t=XP(),a=Ae.useCallback((()=>{n(!1)}),[n]),o=Ae.useCallback((e=>{"Escape"!==e.key&&"Esc"!==e.key||a()}),[a]);return(0,Ie.t)(jn.V,Object.assign({open:e,"data-tid":"guardians-send-approval-error-dialog-renderer"},{children:(0,Ie.t)(Un.c,Object.assign({onKeyDown:o,className:t.guardiansApprovalRequestDialogSurface,"data-tid":"guardians-send-approval-error-dialog-renderer-surface"},{children:(0,Ie.t)(Vn.a,{children:[(0,Ie.t)(Wn.$,{children:i.stringTranslate("guardians","guardians_approval_request_error_dialog_title")}),(0,Ie.t)(Hn.c,{children:(0,Ie.t)(GP.q,{children:i.stringTranslate("guardians","guardians_approval_request_error_dialog_content")})}),(0,Ie.t)(Gn.k,Object.assign({position:"end"},{children:(0,Ie.t)(HP.h,{children:(0,Ie.t)(Sl.z,Object.assign({appearance:"outline","data-tid":"guardians-approval-request-error-dialog-close-button",className:t.rightActionButton,onClick:a},{children:i.stringTranslate("guardians","guardians_approval_request_dialog_close_button")}))})}))]})}))}))},wR=()=>null,IR=()=>Promise.all([i.e(917388),i.e(590393),i.e(892924),i.e(779478),i.e(250273),i.e(320794),i.e(72517),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(26466),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(403936),i.e(450605),i.e(329712),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(39183),i.e(829861)]).then(i.bind(i,491557)),AR=()=>Promise.all([i.e(917388),i.e(590393),i.e(892924),i.e(779478),i.e(250273),i.e(320794),i.e(72517),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(26466),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(403936),i.e(450605),i.e(329712),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(39183),i.e(829861)]).then(i.bind(i,228183)),FR=()=>null;function DR(){return{eventHandlers:UP,getAppPhases:VP,getAppViewEntities:PP,getCommandScenarioName:()=>c.RG.GuardiansAppLoad,manifest:MP,render:({appRenderMode:e,coreSettings:n,onRenderEvent:i,entity:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(e===Fe.S.Modal)return(e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const n=()=>{const{getEntityOptions:e}=(0,al.sV)(),{memberAndRelatedContacts:n,initialAction:i,initialViewMode:t}=e(De.py.guardiansapprovalrequest,De.uk.create),[a,o]=Ae.useState(!0);return(0,Ie.t)(TR,{initialAction:i,initialViewMode:t,memberAndRelatedContacts:n,isDialogOpen:a,setIsDialogOpen:o})};switch(e.type){case De.py.guardiansapprovalrequest:return(0,Ie.t)(n,{});case De.py.guardianssendapprovalsuccess:return(0,Ie.t)(bR,{});case De.py.guardianssendapprovalerror:return(0,Ie.t)(CR,{});default:return(0,Ie.t)(wR,{})}})))(a);if(e===Fe.S.Main){const t="guardians-app";i("ChunkLoadStarted",{chunkName:t});const{enableEntityMoreInfo:a}=n.get(s.J.Core),o=({children:e})=>(0,Ie.t)(Ae.Fragment,{children:e}),{GuardiansAppViews:d}=yield(0,Pn.mT)(IR,t),{LPC:l}=a?{LPC:o}:yield(0,Pn.mT)(AR,t),r=a?o:Na.p3;return i("ChunkLoadSucceeded",{chunkName:t}),(0,Ie.t)(l,{children:(0,Ie.t)(r,{children:(0,Ie.t)(d,{appRenderMode:e})})})}return(0,Ie.t)(FR,{})}))}}const ER=screen.availHeight-250-10,MR=screen.availWidth-400-10,PR={id:"com.microsoft.teams.notifications",name:"NotificationsApp",supportedEntities:[De.py.externalnavigation,De.py.toasts],supportedRenderModes:[Fe.S.Main,Fe.S.PartialOverlay],windowFeatures:{top:ER,left:MR,width:0,height:0,minWidth:0,minHeight:0,offset:0,toolbar:"no",titlebar:"no",menubar:"no",location:"no",scrollbars:"no",resizable:"no",status:"no"}},RR={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsNotificationsMeQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"me"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"email"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"tenantName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"User"}},arguments:[]}]}}]},OR="ModuleLoaded",$R="createCollection not available on module.",LR="removeCollection not available on module.",xR="HostComms is unable to load toast collection module. Bailing out.";class BR{constructor(e,n){this.hostCommunicationService=n,this.logger=e.newLogger("ToastCollectionService","services-io-toast-collection")}createCollection(e){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("toasts");if(n){if(n.createCollection)return this.logger.log(OR),n.createCollection(e);this.logger.error($R)}else this.logger.error(xR)}))}removeCollection(e){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.hostCommunicationService.loadModule("toasts");if(n){if(n.removeCollection)return this.logger.log(OR),n.removeCollection(e);this.logger.error(LR)}else this.logger.error(xR)}))}}function jR(e,n){const i=`${e} - ${n}`;if(i.length<=36)return i;const t=18-n.length,a=t>0?18+t:18;if(e.length<=a)return i;return`${e.slice(0,a-3)}... - ${n}`}function UR(e,n,i,a,o){const{enableToastCollections:d}=o.get(s.J.Notifications);return{id:"create-toast-collection",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const o=i.newLogger("ToastCollectionCreation","apps-notifications");if(!d)return void o.log("not enabled by feature flag");if(!e||!e.loginUserName)return void o.error("AuthenticationUserContext is not found");const l=yield n.query({query:RR});if(!l.data.me||!l.data.me.tenantName)return void o.error("User data not available");const r=new BR(i,a),s=(0,oo.b4)(e);return r.createCollection({collectionId:s,name:jR(e.loginUserName,l.data.me.tenantName)}),e=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if("signout"===e)yield r.removeCollection(s)}))}))}}const VR={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsNotificationsMePresenceQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"me"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mri"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"presence"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activity"},__type:{kind:"NamedType",name:{kind:"Name",value:"Activity"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"availability"},__type:{kind:"NamedType",name:{kind:"Name",value:"Availability"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Presence"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"User"}},arguments:[]}]}}]},WR={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsNotificationsPresenceUpdateEventSubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PresenceSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"presenceUpdateEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PresenceSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activity"},__type:{kind:"NamedType",name:{kind:"Name",value:"Activity"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"availability"},__type:{kind:"NamedType",name:{kind:"Name",value:"Availability"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"Presence"}}}]}}]};var HR,GR;!function(e){e.Presenting="Presenting",e.DoNotDisturb="DoNotDisturb",e.OSdoNotDisturb="OSdoNotDisturb"}(HR||(HR={})),function(e){e.Default="default",e.Presence="presence",e.MeetingOrCall="meetingOrCall"}(GR||(GR={}));class JR{constructor(){this.notificationsBlockingCaches={}}blockUserNotifications(e,n,i){let t=this.notificationsBlockingCaches[e];t||(t={}),t=Object.assign(Object.assign({},t),n),i.log(`NotificationsBlockingCache: set new blocking cache for userId ${e}`),this.notificationsBlockingCaches[e]=t}unblockUserNotifications(e,n,i){var t;i.log(`NotificationsBlockingCache unblockUserNotifications ${e}`);const a=this.notificationsBlockingCaches[e];a?(Object.keys(n).forEach((e=>{Reflect.deleteProperty(a,e)})),Object.keys(a).length||(i.log(`NotificationsBlockingCache, unblockUserNotifications: blocking cache is empty, deleting the entry for the user ${e}`),Reflect.deleteProperty(this.notificationsBlockingCaches,e))):null===(t=null==i?void 0:i.warnToTelemetry)||void 0===t||t.call(i,"No blocking cache found for the user id","notifications-blocking-cache",void 0,!0)}getBlockedState(e){e.log("NotificationsBlockingCache, getBlockedState: reading blocked state");const n=Object.keys(this.notificationsBlockingCaches),i=[];for(const t of n)e.log(`NotificationsBlockingCache, getBlockedState: reading cache for userId ${t}`),i.push({userId:t,blockingReasons:this.notificationsBlockingCaches[t]});if(i.length)return e.log("NotificationsBlockingCache, getBlockedState: returning blocked state"),{state:"blocked",blocks:i};e.log("NotificationsBlockingCache, getBlockedState: blocks not found")}getUserBlockedState(e,n){var i;e.log(`NotificationsBlockingCache, getUserBlockedState: getting blocked state for userId ${n}`);const t=Object.keys(this.notificationsBlockingCaches).find((e=>-1!==e.replace(/-/g,"").indexOf(n.replace(/-/g,""))));if(t)return{userId:t,blockingReasons:this.notificationsBlockingCaches[t]};null===(i=null==e?void 0:e.warnToTelemetry)||void 0===i||i.call(e,"No blocking cache for the user id","notifications-blocking-cache",void 0,!0)}}function qR(e,n,i,a,o){return{id:"presence-blocking-signal-subscription",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var t,d,l;const r=i.newLogger("PresenceBlockingSignalSubscription","apps-notifications"),{enableNotificationsFiltering:m}=o.get(s.J.Notifications);if(!m)return void r.log(io.f.NotEnabled);const c=yield n.query({query:VR});if(!c.data.me||!(null===(t=c.data.me.presence)||void 0===t?void 0:t.availability))return void r.log("user presence missing");const u=null==e?void 0:e.id;if(!u)return void r.log("user id missing");zR(u,a,null===(d=c.data.me.presence)||void 0===d?void 0:d.availability,r,null===(l=c.data.me.presence)||void 0===l?void 0:l.activity);const p=n.subscribe({query:WR,fetchPolicy:"no-cache",variables:{userId:c.data.me.mri,source:"ups"}}).subscribe((e=>{var n,i,t,o;const d=null===(i=null===(n=e.data)||void 0===n?void 0:n.presenceUpdateEvent)||void 0===i?void 0:i.availability,l=null===(o=null===(t=e.data)||void 0===t?void 0:t.presenceUpdateEvent)||void 0===o?void 0:o.activity;d&&zR(u,a,d,r,l)}));return()=>{null==p||p.unsubscribe()}}))}}function zR(e,n,i,t,a){n.unblockUserNotifications(e,{[Fd.cS.DoNotDisturb]:GR.Presence,[Fd.cS.Presenting]:GR.Presence},t),i===Fd.a8.DoNotDisturb&&n.blockUserNotifications(e,{[a]:GR.Presence},t)}const QR={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsNotificationsGraphItemToastEventSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"graphItemToastEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"correlationId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"content"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"customIconUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"senderDisplayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"senderMri"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"startTimestamp"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamsAppId"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"title"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"type"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"GraphItemToastEvent"}}},arguments:[]}]}}]},YR={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsNotificationsGraphItemToastImageAsDataUriQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"credentials"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"toastImageAsDataUri"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"credentials"},value:{kind:"Variable",name:{kind:"Name",value:"credentials"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]}}]},KR={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsNotificationsGraphItemMsaUserProfilePictureQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}]}}]};var XR;!function(e){e.MsGraph="MsGraph"}(XR||(XR={}));const ZR="msgraph_toast_event_subscription_job";function eO(e,n,i,a,o,d){var l,r;return(0,t.__awaiter)(this,void 0,void 0,(function*(){try{const r=d===mn.x4.taco?yield function(e,n,i){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const{data:t}=yield e.query({query:KR,variables:{userId:n,displayName:i,profilePictureSize:Sp.$D.Small}});return t.msaUserProfilePicture}))}(e,i,a):o;if(!r)return void(null===(l=n.errorToTelemetry)||void 0===l||l.call(n,`${io.f.ImageFetchFailed}`,ZR,void 0,!0));const s=yield e.query({query:YR,variables:{url:r,credentials:"omit"}});return(null==s?void 0:s.data.toastImageAsDataUri)||void 0}catch(e){return void(null===(r=n.errorToTelemetry)||void 0===r||r.call(n,`${io.f.ImageFetchFailed} ${e}`,ZR,void 0,!0))}}))}function nO(e,n,i,a,o,d,l){const{enableToastCollections:r}=n.get(s.J.Notifications);return n=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var s,m,u,p,y;if(n.errors){const e=(0,wo.u4)(n.errors.map((e=>e.message)).join());return void(null===(s=i.errorToTelemetry)||void 0===s||s.call(i,`${io.f.SubscriptionFailed} ${e}`,ZR,void 0,!0))}const v=null===(m=null==n?void 0:n.data)||void 0===m?void 0:m.graphItemToastEvent;if(!v)return void(null===(u=i.errorToTelemetry)||void 0===u||u.call(i,`${io.f.EmptyEvent}`,ZR,void 0,!0));const k=a.newScenario(c.RG.CrossClientToastView,{startTime:+v.startTimestamp});k.clientId=v.correlationId,k.appendEventData({mainEntityType:De.py.channels});const g=yield function(e,n,i){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const{teamsAppId:t,content:a,senderMri:o,senderDisplayName:d,startTimestamp:l,title:r,customIconUrl:s}=e,m=yield eO(n,i,o,d||"",s,t);return{conversationId:"",quickReply:!1,time:new Date(+l),title:r,text:a,mainImage:m?{alt:"",src:m}:void 0}}))}(v,d,i);return"MsGraph"===v.type&&(null==g?void 0:g.title)?(r&&(g.collectionId=lo(e,l,i)),null===(y=a.hoistScenarioToCore)||void 0===y||y.call(a,k),o.toasts.showGraphItemNotification(v.correlationId,g)):(null===(p=i.errorToTelemetry)||void 0===p||p.call(i,`${io.f.GraphItemToastUnhandledType} ${v.type}`,ZR,void 0,!0),void k.stop({reason:io.f.GraphItemToastUnhandledType}))}))}function iO(e,n,i,a,o,d,l){const{enableCommandToHostCommService:r}=n.get(s.J.Core),{enableGraphItemToastNotifications:m,enableBrowserToasts:c,enableInAppNotifications:u,enableInAppNotificationsForChatsAndChannels:p}=n.get(s.J.Notifications,["enableGraphItemToastNotifications","enableBrowserToasts","enableInAppNotifications","enableInAppNotificationsForChatsAndChannels"]);return{id:"graph-item-toast-event-subscription",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=a.newLogger("graphItemToastEventSubscription","apps-notifications");if(!(r||c||u&&p))return void t.log(io.f.NotEnabled);if(!m)return void t.log(`The enableGraphItemToastNotifications flag is not enabled ${io.f.NotEnabled}`);const s=i.subscribe({query:QR,fetchPolicy:"no-cache"}).subscribe(nO(e,n,t,o,d,i,l));return()=>{null==s||s.unsubscribe()}}))}}const tO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsNotificationsConnectedCallsSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectedCallsChangedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"state"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ConnectedCallsChanged"}},arguments:[]}]}}]},aO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsNotificationsMuteNotificationsDuringMeetingEventSubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"muteNotificationsDuringMeetingEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"teamsCallId"},value:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isNotificationMuted"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamsCallId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"MuteNotificationsResponse"}}}]}}]},oO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsNotificationsMuteNotificationsDuringMeetingsGlobalQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"muteNotificationsDuringMeetings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"teamsCallId"},value:{kind:"Variable",name:{kind:"Name",value:"teamsCallId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isNotificationMuted"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"teamsCallId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MuteNotificationsResponse"}}}}]}}]};var dO;function lO(e,n,i,a,o){return{id:"meetings-blocking-signal-subscription",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const d=i.newLogger("MeetingsBlockingSignalSubscription","apps-notifications"),{enableNotificationsFilteringInMeetingsAndCalls:l}=o.get(s.J.Notifications);if(!l)return void d.log(io.f.NotEnabled);const r=new rO(n),m=null==e?void 0:e.id;if(!m)return void d.error("User data not available");const c=e=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var n;const{isNotificationMuted:i,teamsCallId:t}=(null===(n=e.data)||void 0===n?void 0:n.muteNotificationsDuringMeetingEvent)||{};i?a.blockUserNotifications(m,{[t]:GR.MeetingOrCall},d):a.unblockUserNotifications(m,{[t]:GR.MeetingOrCall},d)})),u=n.subscribe({query:tO,fetchPolicy:"no-cache"}).subscribe((e=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var i;const t=null===(i=e.data)||void 0===i?void 0:i.connectedCallsChangedEvent;if((null==t?void 0:t.state)===dO.Connected){r.register(null==t?void 0:t.id,c);(yield n.query({query:oO,variables:{teamsCallId:null==t?void 0:t.id}})).data.muteNotificationsDuringMeetings.isNotificationMuted&&a.blockUserNotifications(m,{[null==t?void 0:t.id]:GR.MeetingOrCall},d)}else(null==t?void 0:t.id)&&r.unregister(t.id),a.unblockUserNotifications(m,{[null==t?void 0:t.id]:GR.MeetingOrCall},d)}))));return()=>{null==u||u.unsubscribe()}}))}}!function(e){e[e.Connected=3]="Connected",e[e.Disconnected=7]="Disconnected"}(dO||(dO={}));class rO{constructor(e){this.dataClient=e,this.subscriptions=new Map}register(e,n){const i=this.dataClient.subscribe({query:aO,variables:{teamsCallId:e},fetchPolicy:"no-cache"}).subscribe(n);this.subscriptions.set(e,(()=>{i.unsubscribe(),this.subscriptions.delete(e)}))}unregister(e){const n=this.subscriptions.get(e);null==n||n()}}const sO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsNotificationsNotificationsEngineEventSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"notificationsEngineUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"data"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NotificationXDaysOfInactiveStatus"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"paramType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AllowedNotificationsEngineParams"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"lastUserActivityTimestamp"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"timesToBeShown"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NotificationTflMeetingLinks"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"paramType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AllowedNotificationsEngineParams"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"lastUserActivityTimestamp"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"timesToBeShown"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"meetingLinkPrejoinData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deeplinkUrl"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"conversationId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deepLinkId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MeetingLinkPrejoinData"}}},arguments:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NotificationConversationsReminder"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"paramType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AllowedNotificationsEngineParams"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"threadId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"lastMessageId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"lastMessageComposeTime"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"lastMessageAuthor"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"missedThreadsCount"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"userNames"},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"timestamp"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"NotificationsEngineData"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"correlationId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"NotificationsEngineUpdatedEvent"}}},arguments:[]}]}}]};function mO(e){return e.stringTranslate("toastNotifications","toast_messaging_sent_a_remind_message")}function cO(e){return e.stringTranslate("toastNotifications","toast_messaging_sent_a_meet_now_links_reminder_message")}var uO,pO,yO;!function(e){e.NotificationXDaysOfInactiveStatus="NotificationXDaysOfInactiveStatus",e.NotificationTflMeetingLinks="NotificationTflMeetingLinks",e.NotificationConversationsReminder="NotificationConversationsReminder"}(uO||(uO={})),function(e){e.notifications_x_days_of_inactive_status="notifications_x_days_of_inactive_status",e.notifications_tfl_meeting_links="notifications_tfl_meeting_links",e.notifications_conversations_reminder="notifications_conversations_reminder"}(pO||(pO={})),function(e){e.asc="asc",e.desc="desc"}(yO||(yO={}));var vO=i(885909);const kO={MAX_BANNER_VIEW_COUNT:3,BANNER_VIEW_COUNT_LOCAL_STORAGE_KEY:"NotificationBannerViewCount",BANNER_ID_WINDOWS_NOTIFICATION:"WindowsNotificationBanner",BANNER_ID_BROWSER_NOTIFICATION:"BrowserNotificationBanner",BANNER_ID_TEAMS_NOTIFICATION:"TeamsNotificationBanner",BANNER_ID_WINDOWS_DND:"WindowsDoNotDisturbBanner"},gO={topic:"topic",text:"text",buttonText:"buttonText"},NO=1,hO="CN:",fO=Object.freeze({FIVE_SECONDS:5e3,TWENTY_SECONDS:2e4,THIRTY_SECONDS:3e4,SIXTY_TWO_SECONDS:62e3}),_O=e=>({id:(0,et.v4)(),source:sn.D.NotificationsActivation,scenarioName:c.RG.ToastActivation,startTimestamp:null!=e?e:Date.now()}),SO=(e,n)=>({correlation:n,stateTransition:e?v.su.flush:v.su.new,visibilityState:v.fe.show}),TO=e=>({correlation:e,stateTransition:v.su.flush,visibilityState:v.fe.show}),bO=e=>({id:e.id,action:e.action,type:e.type}),CO=e=>{var n;return e.isIncomingCall?"AcceptIncomingCallThroughPrejoin"===e.targetEntity.dataOptions.actionType?vO.pC.MeetingNudge:vO.pC.Calling:"calls"===(null===(n=e.targetEntity)||void 0===n?void 0:n.type)?vO.pC.MSN:vO.pC.Standard},wO=(e,n)=>{const{targetEntity:i,isOnWeb:t,startTimestamp:a}=e,o=i.dataOptions;n||(n=_O(a));return{command:SO(t,n),entity:bO(i),entityOptions:{messageId:o.messageId,focusOnLoad:void 0,userContextId:o.userContextId},dataOptions:Object.assign({},o)}};function IO(e,n){const{i18n:i,missedConversationsNumber:t,sender:a,otherSenders:o}=n;switch(e){case gO.topic:return o>=NO?i.stringTranslate("toastNotifications","toast_messaging_conversations_reminder_group_topic",{sender:a,otherSenders:o}):i.stringTranslate("toastNotifications","toast_messaging_conversations_reminder_topic",{sender:a});case gO.buttonText:return i.stringTranslate("toastNotifications","toast_messaging_conversations_reminder_button_text");case gO.text:default:return i.stringTranslate("toastNotifications","toast_messaging_conversations_reminder_text",{number:t})}}function AO(e,n,i,a,o){return{id:"notifications-engine-event-subscription",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const d=e.watchQuery({query:sO,fetchPolicy:"no-cache"}).subscribe(function(e,n,i,a){const o=i.newLogger("notificationsEngineUpdatedEvent","apps-notifications");return d=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var t;const l=null===(t=d.data)||void 0===t?void 0:t.notificationsEngineUpdatedEvent,{data:r,correlationId:s=""}=l||{},{__typename:m}=r||{},u=a.newScenario(c.RG.NotificationsEngineEventSubscriptionJob);if(u.appendEventData({correlationId:s}),!m||!r){const e=`Received a NE event with missed event type or data. Type "${m}"`;return(null==o?void 0:o.errorToTelemetry)&&o.errorToTelemetry(e,"life_web_and_desktop_growth_notification_engine_error",void 0,!0),u.fail({reason:e}),Promise.resolve()}const p=`Received a NE event of type "${m}"`;switch((null==o?void 0:o.infoToTelemetry)&&o.infoToTelemetry(p,"life_web_and_desktop_growth_notification_engine_info",void 0,!0),u.appendEventData({notificationEngineEventType:m}),u.stop({reason:p}),m){case uO.NotificationXDaysOfInactiveStatus:return e.toasts.showReEngageNudge(s,{conversationId:Er.Rx,title:mO(n),time:new Date,quickReply:!1,messageId:void 0,type:uO.NotificationXDaysOfInactiveStatus});case uO.NotificationTflMeetingLinks:const{meetingLinkPrejoinData:t}=r;FO(s,t,e,n,i,m);break;case uO.NotificationConversationsReminder:const a=function(e,{threadId:n,lastMessageAuthor:i,lastMessageId:t,lastMessageComposeTime:a,userNames:o,missedThreadsCount:d,type:l}){const r={i18n:e,missedConversationsNumber:d,sender:i,otherSenders:o.length-1};return{text:IO(gO.text,r),title:IO(gO.topic,r),buttonText:IO(gO.buttonText,r),mainImage:{alt:i,src:fs.dA},conversationId:n,messageId:t,time:new Date(a),quickReply:!1,type:l}}(n,Object.assign(Object.assign({},r),{type:uO.NotificationConversationsReminder}));return e.toasts.showReminder(s,a);default:return Promise.resolve()}}))}(n,i,a,o));return()=>{d.unsubscribe()}}))}}const FO=(e,n,i,t,a,o)=>{const d=a.newLogger("notificationsEngineUpdatedEvent","apps-activity");if(!n)return(null==d?void 0:d.infoToTelemetry)&&d.infoToTelemetry(`Received empty data in "notificationsEngineUpdatedEvent". "meetingLinkPrejoinData" of type "${o}" is not defined correctly: ${n}. CorrelationId: ${e}.`,"life_web_and_desktop_growth_notification_engine_info",void 0,!0),Promise.resolve();const{deeplinkUrl:l,conversationId:r,deepLinkId:s}=n||{};return l&&r&&s?i.toasts.showMeetNowNudge(e,{conversationId:r,title:cO(t),time:new Date,quickReply:!1,messageId:void 0,deeplinkUrl:l,deepLinkId:s,type:uO.NotificationTflMeetingLinks}):((null==d?void 0:d.infoToTelemetry)&&d.infoToTelemetry(`Some data is missing in ${n} of type "${o}". CorrelationId: ${e}.`,"life_web_and_desktop_growth_notification_engine_info",void 0,!0),Promise.resolve())},DO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsNotificationsTaskbarBadgeUpdatedEventSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"taskbarBadgeUpdatedEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"badgeCount"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TaskbarBadgeUpdatedEvent"}}},arguments:[]}]}}]};var EO=i(342097),MO=i(257558);const PO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsNotificationsTaskbarBadgeUpdatedMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"accountId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"badgeCount"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateTaskbarMTMABadgeCount"},arguments:[{kind:"Argument",name:{kind:"Name",value:"accountId"},value:{kind:"Variable",name:{kind:"Name",value:"accountId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"badgeCount"},value:{kind:"Variable",name:{kind:"Name",value:"badgeCount"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}}],__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]}}]},RO=2;function OO(e,n,i,a,o,d){return{id:"taskbar-badge-event-subscription",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const r=n.newLogger("TaskbarBadgeEventSubscription","apps-notifications");if(a.config.clientType!==l.Bh.Maglev)return void r.log(EO.vc.NotEnabled);const m=e.subscribe({query:DO,fetchPolicy:"no-cache"}).subscribe(function(e,n,i,a,o){let d=0;const{enableIconFlashingTaskbar:l}=a.get(s.J.Notifications);return a=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var r,s;if(a.errors){const n=a.errors.map((e=>e.message)).join();return void e.error(`${EO.vc.SubscriptionFailed} ${(0,wo.u4)(n)}`)}if(!(null===(r=a.data)||void 0===r?void 0:r.taskbarBadgeUpdatedEvent))return void e.log(EO.vc.EmptyEvent);const{taskbarBadgeUpdatedEvent:m}=a.data,{badgeCount:c}=m;e.log(`${EO.Bd.UpdatedEvent} badgeCount: ${c}`);try{const{data:a}=yield i.mutate({mutation:PO,variables:{accountId:o,badgeCount:c}}),r=null==a?void 0:a.updateTaskbarMTMABadgeCount;if(e.log(`New badge count: ${c} last badgeCount: ${d} update result: ${r}`),l&&c>d&&r){const a=yield null==n?void 0:n.loadModule("windowcontrols"),o=yield null===(s=null==a?void 0:a.getWindowByTag)||void 0===s?void 0:s.call(a,MO.px.Main);yield function(e,n,i,a){var o,d,l;return(0,t.__awaiter)(this,void 0,void 0,(function*(){n.log("Flash Frame event");const t=yield i.query({query:VR,fetchPolicy:"no-cache"});if(!t.data.me||!(null===(o=t.data.me.presence)||void 0===o?void 0:o.availability))return void n.log("User presence missing");const r=null===(d=t.data.me.presence)||void 0===d?void 0:d.availability;if(a&&r!==Fd.a8.DoNotDisturb){const n=yield null==e?void 0:e.loadModule("windowcontrols");yield null===(l=null==n?void 0:n.flashFrame)||void 0===l?void 0:l.call(n,a,RO)}else n.log(`User state is ${r}`)}))}(n,e,i,o)}d=c}catch(n){e.log(`Error on setting badge ${n}`)}}))}(r,i,e,o,null==d?void 0:d.id));return n=>(0,t.__awaiter)(this,void 0,void 0,(function*(){switch(m.unsubscribe(),n){case"quit":case"signout":case"switch_user":try{yield e.mutate({mutation:PO,variables:{accountId:null==d?void 0:d.id,badgeCount:0}})}catch(e){r.log(`Error on badge update mutation ${e}`)}}}))}))}}const $O={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsNotificationsActivitySettingsSubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subCategoryPageId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activitySettingsChangedEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"subCategoryPageId"},value:{kind:"Variable",name:{kind:"Name",value:"subCategoryPageId"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"settings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"error"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"settingsList"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"value"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"NotificationSettingsOptions"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"UserActivitySetting"}}}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ActivitySettings"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ActivitySettingsEvent"}}}]}}]},LO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsNotificationsActivitySettingsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subCategoryPageId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activitySettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"subCategoryPageId"},value:{kind:"Variable",name:{kind:"Name",value:"subCategoryPageId"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"error"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"settingsList"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"value"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"NotificationSettingsOptions"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"UserActivitySetting"}}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ActivitySettings"}}}}]}}]};function xO(e,n,i,a,o,d){return{id:"user-settings-signal-subscription",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var t;const l=o.newLogger("UserSettingsSignalSubscription","apps-notifications"),{showGenericNotificationsSoundSetting:r,showNotificationsCallsSoundSetting:m,enableOSDnDSupportForCustomToasts:c}=d.get(s.J.Notifications);if(!r||!m)return void l.log(io.f.NotEnabled);const u=null==e?void 0:e.id;if(!u)return void l.error("user id missing");const p=yield n.query({query:LO,variables:{appId:"notifications"},fetchPolicy:"no-cache"}).catch((()=>(l.error("Failed to fetch initial user settings"),{data:void 0})));i.updateUserActivitySettingsCache(u,null===(t=p.data)||void 0===t?void 0:t.activitySettings.settingsList,!!c,a,l);const y=n.subscribe({query:$O,variables:{appId:"notifications"},fetchPolicy:"no-cache"}).subscribe((e=>{var n,t,o;i.updateUserActivitySettingsCache(u,null===(o=null===(t=null===(n=e.data)||void 0===n?void 0:n.activitySettingsChangedEvent)||void 0===t?void 0:t.settings)||void 0===o?void 0:o.settingsList,!!c,a,l)}));return()=>{null==y||y.unsubscribe()}}))}}var BO=i(91074);const jO=2;function UO(e,n,i,a,o){return{id:"taskbar-legacy-badge-event-subscription",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const d=n.newLogger("TaskbarLegacyBadgeEventSubscription","apps-notifications");if(a.config.clientType!==l.Bh.Maglev)return void d.log(EO.vc.NotEnabled);const r=new BO.a(n,o,i),m=e.subscribe({query:DO,fetchPolicy:"no-cache"}).subscribe(function(e,n,i,a,o){let d=0;const{enableIconFlashingTaskbar:l}=o.get(s.J.Notifications);return o=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var r,s;if(o.errors){const n=o.errors.map((e=>e.message)).join();return void e.log(`${EO.vc.SubscriptionFailed} ${(0,wo.u4)(n)}`)}if(!(null===(r=o.data)||void 0===r?void 0:r.taskbarBadgeUpdatedEvent))return void e.log(EO.vc.EmptyEvent);const{taskbarBadgeUpdatedEvent:m}=o.data,{badgeCount:c}=m;if(e.log(`${EO.Bd.UpdatedEvent} badgeCount: ${c}`),l&&c>d){const n=yield null==i?void 0:i.loadModule("windowcontrols"),o=yield null===(s=null==n?void 0:n.getWindowByTag)||void 0===s?void 0:s.call(n,MO.px.Main);yield function(e,n,i,a){var o,d,l;return(0,t.__awaiter)(this,void 0,void 0,(function*(){n.log("Flash Frame event");const t=yield i.query({query:VR,fetchPolicy:"no-cache"});if(!t.data.me||!(null===(o=t.data.me.presence)||void 0===o?void 0:o.availability))return void n.log("User presence missing");const r=null===(d=t.data.me.presence)||void 0===d?void 0:d.availability;if(a&&r!==Fd.a8.DoNotDisturb){const n=yield null==e?void 0:e.loadModule("windowcontrols");yield null===(l=null==n?void 0:n.flashFrame)||void 0===l?void 0:l.call(n,a,jO)}else n.log(`User state is ${r}`)}))}(i,e,a,o)}return d=c,n.showBadgeCount(c)}))}(d,r,i,e,o));return e=>(0,t.__awaiter)(this,void 0,void 0,(function*(){switch(m.unsubscribe(),e){case"quit":case"signout":yield r.resetBadge()}}))}))}}var VO=i(706798);function WO(){return Notification.permission}var HO=i(750682);function GO(e,n,i,a,o,d,l){var r;return(0,t.__awaiter)(this,void 0,void 0,(function*(){const m=n.newLogger("WarnUserNoticeJob","apps-notifications"),{disableWarnUserNotificationBanner:c,enableWarnUserNotificationDialog:u,enableBrowserWarnUserBanner:p}=d.get(s.J.Notifications),{enableCustomNotificationsForCalls:y,enableCustomNotificationsOnDesktop:v}=d.get(s.J.Core);if(!o)return void(null===(r=m.errorToTelemetry)||void 0===r||r.call(m,"AuthenticationUserContext is not found for warn user notice job","app_notifications_warn_user_notice"));const k=Number(function(e,n){const i=null==n?void 0:n.get(e);return i||void 0}(kO.BANNER_VIEW_COUNT_LOCAL_STORAGE_KEY,l));if(k&&k>=kO.MAX_BANNER_VIEW_COUNT)return void m.log("Warn user banner was not displayed due to the maximum view count reached");const g=new VO.b(n,a),N=yield function(e){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const n=yield e.getGlobalNotificationSettingsAsync();if(n)return n.global===HO.mG.Enabled}))}(g);let h=0;if(!1===N){if(u&&(y&&v?e.esp.displaySurface("customNotificationsWarning"):e.esp.displaySurface("notificationsWarning")),!c){!function(e,n,i){e.shell.showBanner({id:kO.BANNER_ID_WINDOWS_NOTIFICATION,source:sn.D.NotificationSettings,bannerScenario:i,intentLevel:"Neutral",cause:"SettingsWarnUser",text:n.stringTranslate("toastNotifications",i),action:{text:n.stringTranslate("toastNotifications","toast_warn_user_button"),command:{entity:{type:De.py.externalnavigation,action:De.uk.empty,id:za.Y.Notifications}},dismissOnAction:!0},dismissable:!0,duration:0})}(e,i,y&&v?"toast_global_windows_custom_notifications_banner":"toast_global_windows_notifications_banner"),h=k?k+1:1}h&&function(e,n,i,t){null==t||t.trySet(e,n,"Desktop"),i.log(`Notification banner view count ${n} saved to local storage.`)}(kO.BANNER_VIEW_COUNT_LOCAL_STORAGE_KEY,h.toString(),m,l)}p&&"granted"!==WO()&&"denied"!==WO()&&function(e,n){e.shell.showBanner({id:kO.BANNER_ID_BROWSER_NOTIFICATION,source:sn.D.NotificationSettings,bannerScenario:"toast_browser_user_notice_banner",intentLevel:"Neutral",cause:"SettingsWarnUser",text:n.stringTranslate("toastNotifications","toast_browser_user_notice_banner"),action:{text:n.stringTranslate("toastNotifications","toast_browser_notification_button"),command:{entity:{type:De.py.externalnavigation,action:De.uk.manage,id:za.Y.Notifications}},dismissOnAction:!0},dismissable:!0,duration:0})}(e,i)}))}function JO(e,n,i,a){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const o=a.newLogger("subscribeAndCacheDnDData","apps-notifications"),d=function(e,n,i){return t=>{e.setOsDoNotDistubState(t,n,i)}}(n,i,o);yield function(e,n,i){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=yield qO(e,n,1);if(n.log(`${io.f.UpdateBlockingCacheWithOSDnD} Fetched the initial OS 'Do not disturb' state: ${t}`),t){const e=function(e,n){switch(e){case HO.lX.AlarmsOnly:return HO.ZD.AlarmsOnly;case HO.lX.PriorityOnly:return HO.ZD.PriorityOnly;case HO.lX.Off:return HO.ZD.Unrestricted;default:return n.warn(`${io.f.UpdateBlockingCacheWithOSDnD} Focus assist state '${e}' was not recognised. Converting to '${HO.ZD.Unrestricted}'`),HO.ZD.Unrestricted}}(t,n);i(e)}}))}(e,o,d),e.registerForNotificationModeChanged(d)}))}function qO(e,n,i){return(0,t.__awaiter)(this,void 0,void 0,(function*(){if(i>2)return void n.error(`${io.f.UpdateBlockingCacheWithOSDnD} Could not fetch the initial state of OS Do not Disturb on the second attempt, skipping`);let t;try{t=yield e.getFocusAssistStateAsync()}catch(t){return n.warn(`${io.f.UpdateBlockingCacheWithOSDnD} Could not fetch the initial state of OS Do not Disturb, trying again`),void qO(e,n,i+1)}return t}))}function zO(e,n){e.shell.showBanner({id:kO.BANNER_ID_WINDOWS_DND,source:sn.D.NotificationSettings,bannerScenario:"toast_focus_assist_banner",intentLevel:"Neutral",cause:"SettingsWarnUser",text:n.stringTranslate("toastNotifications","toast_focus_assist_banner"),action:{text:n.stringTranslate("toastNotifications","toast_focus_assist_button"),command:{entity:{type:De.py.settingsstore,action:De.uk.view,id:za.Y.Notifications},command:{stateTransition:v.su.flush,visibilityState:v.fe.show,correlation:{source:sn.D.BannerNotification}}},dismissOnAction:!0},dismissable:!0,duration:0})}function QO(e,n,i,a,o,d,l,r,m){const{enableWarnUserNotificationSettings:c,enableOSDnDSupportForCustomToasts:u}=a.get(s.J.Notifications);return{id:"warn-notifications-settings-banner-job",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){c&&GO(e,n,i,o,d,a,m),u&&(yield function(e,n,i,a,o,d){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const l=n.newLogger("setupHonorDnDEvents","apps-notifications"),r=null==d?void 0:d.id;r?(!function(e,n,i,a,o){(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=e.newLogger("warn-notifications-settings-banner-job","apps-notifications");o?(a.registerOnCacheUpdatedCallback(o,(function(e){e?zO(n,i):n.shell.dismissBanner(kO.BANNER_ID_WINDOWS_DND,sn.D.NotificationSettings)})),a.shouldDropToastBasedOnDnD(o,t)&&zO(n,i)):t.log(`${io.f.OSDnDBannerJobUserFetchFailed} User ID is empty, skipping OS DND banner job`)}))}(n,e,i,a,r),JO(o,a,r,n)):l.error(`${io.f.OSDnDBannerJobUserFetchFailed} Failed to fetch user id`)}))}(e,n,i,l,r,d))}))}}function YO(e,n,i,t){return({context:{authenticationUser:a,client:o,coreSettings:d,entityCommanding:l,hostCommunicationService:r,i18n:m,scenarioFactory:c,userTrackingService:u,localStorage:p,loggerFactory:y,platformService:v,notificationsHandler:k}})=>{var g;t.initialize(k,m);const N=new VO.b(y,r),h=o,{enableCoherenceBadgeForWindows:f,enableCoherenceBadgeForMac:_}=d.get(s.J.Notifications),S=[xO(a,h,i,n,y,d),qR(a,h,y,e,d),lO(a,h,y,e,d),UR(a,h,y,r,d),iO(a,d,h,y,c,l,u),QO(l,y,m,d,r,a,n,N,p)];return(null===(g=d.get(s.J.CdlWorker))||void 0===g?void 0:g.enableNotificationsEngine)&&S.push(AO(h,l,m,y,c)),f||_?S.push(OO(h,y,r,v,d,a)):S.push(UO(h,y,r,v,d)),S}}const KO={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsNotificationsResetTaskbarBadgeOnAccountSwitchMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"accountId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resetTaskbarBadgeOnAccountSwitch"},arguments:[{kind:"Argument",name:{kind:"Name",value:"accountId"},value:{kind:"Variable",name:{kind:"Name",value:"accountId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]}}]};function XO(){return({context:{client:e,authenticationUser:n,hostCommunicationService:i,loggerFactory:a,platformService:o,isMainWindow:d,coreSettings:r}})=>{const{enableCoherenceBadgeForWindows:m,enableRequestNotificationAuthorizationJob:c}=r.get(s.J.Notifications),u=[];if(m){const i=e;u.push(function(e,n,i,a,o){return{id:"reset-taskbar-badge-on-account-switch",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=n.newLogger("ResetTaskbarBadgeOnAccountSwitch","apps-notifications");i.config.clientType===l.Bh.Maglev?o&&(yield e.mutate({mutation:KO,variables:{accountId:null==a?void 0:a.id}})):t.log(EO.vc.NotEnabled)}))}}(i,a,o,n,d))}return c&&u.push(function(e,n){return{id:"request-notification-authorization",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const i=e.newLogger("RequestNotificationAuthorizationJob","apps-notifications"),t=yield n.loadModule("toasts");(null==t?void 0:t.requestNotificationAuthorization)?(t.requestNotificationAuthorization(),i.log("Notification authorization requested.")):i.warn("API not available.")}))}}(a,i)),u}}var ZO,e$=i(455572);!function(e){e.alertSound="alertSound",e.incomingCallsAndMeetingStartSound="IncomingCallsAndMeetingStartSound",e.respectOsDnDForCustomToasts="respectOsDnDForCustomToasts",e.notificationStyleList="notificationStyleList"}(ZO||(ZO={}));var n$=i(345830);const i$={[ja.dt.activity]:ei.wh.activityToast,[ja.dt.calls]:ei.wh.callingToast,[ja.dt.campaignnotifications]:ei.wh.campaignnotificationsToast,[ja.dt.channels]:ei.wh.channelsToast,[ja.dt.chats]:ei.wh.chatToast,[ja.dt.extensions]:ei.wh.extensionsToast,[ja.dt.reminders]:ei.wh.remindersToast,[ja.dt.communities]:ei.wh.communitiesToast,[ja.dt.communitiesevents]:ei.wh.communitiesEventsToast,[ja.dt.callingdeeplink]:ei.wh.callingToast,[ja.dt.settingsstore]:ei.wh.activityToast,[ja.dt.communitiesjoinrequest]:ei.wh.communitiesToast,[ja.dt.communitiesmembers]:ei.wh.communitiesToast},t$=e=>{var n;const{targetEntity:i}=e.entityOptions;switch(i.type){case ja.dt.communities:case ja.dt.communitiesjoinrequest:case ja.dt.communitiesmembers:return null===(n=null==i?void 0:i.dataOptions)||void 0===n?void 0:n.teamId;default:return}},a$=(e,n,i)=>{var t,a;if(!n.createDatabag)return;const o=n.createDatabag(),{targetEntity:d}=e.entityOptions;switch(d.type){case ja.dt.calls:o.callingToastType=(null==d?void 0:d.dataOptions).toastType;break;case ja.dt.communities:case ja.dt.communitiesjoinrequest:o.communitiesToastType=null===(t=null==d?void 0:d.dataOptions)||void 0===t?void 0:t.toastType;break;case ja.dt.reminders:case ja.dt.chats:case ja.dt.callingdeeplink:o.chatToastType=null===(a=null==d?void 0:d.dataOptions)||void 0===a?void 0:a.toastType}return i&&(o.isCustomNotification=i),o};const o$=e=>{var n;return e.collectionId||(null===(n=e.targetEntity.dataOptions)||void 0===n?void 0:n.userContextId)},d$={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsNotificationsTriggerCallingToastActionMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"notificationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"actionType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"triggerCallingToastAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"notificationId"},value:{kind:"Variable",name:{kind:"Name",value:"notificationId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"Argument",name:{kind:"Name",value:"actionType"},value:{kind:"Variable",name:{kind:"Name",value:"actionType"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]};var l$,r$;!function(e){e.DND="DND",e.Presenting="Presenting",e.MeetingOrCall="MeetingOrCall",e.OSDnD="OSDnd",e.SuppressedDueToSilentLaunch="SuppressedDueToSilentLaunch"}(l$||(l$={})),function(e){e.UrgentToast="UrgentToast",e.IncomingCall="IncomingCall",e.SingleAccount="SingleAccount",e.AllowedByPresence="AllowedByPresence",e.AllowedInMeetingOrCall="AllowedInMeetingOrCall"}(r$||(r$={}));const s$=(e,n,i,t,a,o,d,l,r)=>{const{enableNotificationsFiltering:m}=e.get(s.J.Notifications),{enableHonoringPresenceForNotification:u}=e.get(s.J.Calling);if(!m)return n.log(io.f.NotEnabled),i;const p=i.entityOptions,{dropNotification:y,reason:v}=c$(o,d,p,e,n,r);return n.log(`Is toast dropped: ${y} because "reason: ${v}"`),!y&&(null==p?void 0:p.isUrgent)&&a.recordPanelAction({panelRegion:ei.Ai.notificationsApp,actionScenario:ei.Tk.priorityToastIssued}),y?(function(e,n,i,t){const a=e.entityOptions,o=[{scenarioName:c.RG.CrossClientToastView,scenarioId:e.command.correlation.id},{scenarioName:a.crossClientScenarioName,scenarioId:a.callId||e.command.correlation.id},{scenarioName:c.RG.WebToastShow,scenarioId:e.command.correlation.id}];o.forEach((({scenarioName:e,scenarioId:a})=>{var o;if(e&&a){const d=i.findScenarioByNameAndId(e,a);d?d.incomplete({reason:n}):null===(o=t.errorToTelemetry)||void 0===o||o.call(t,`AppsNotifications: Could not find scenario with name: ${e} and id: ${a}`,"app_notifications_scenario_not_found",void 0,!0)}}))}(i,v,t,n),void m$(a,v)):(u&&p.isIncomingCall&&function(e,n,i){var t,a;null===(t=i.infoToTelemetry)||void 0===t||t.call(i,"[sendDroppedCallStatus] Notification was not dropped by Presenting/DND; Sending canNotifyForCallingNotification action","app_notifications");try{e.mutate({mutation:d$,variables:{notificationId:n.entity.id,actionType:"canNotifyForCallingNotification"}})}catch(e){null===(a=i.errorToTelemetry)||void 0===a||a.call(i,"[sendDroppedCallStatus] Could not send call dropped state mutation","app_notifications",{errors:`${e.message}`},!0)}}(l,i,n),i)},m$=(e,n)=>{const i={[l$.DND]:ei.Yu.toastDiscardedByDND,[l$.MeetingOrCall]:ei.Yu.toastDiscardedByMeetingOrCall,[l$.Presenting]:ei.Yu.toastDiscardedByPresenting,[l$.OSDnD]:ei.Yu.toastDiscardedByOSDND,[l$.SuppressedDueToSilentLaunch]:ei.Yu.toastDiscardedBySilentLaunch};e.recordPanelAction({panelRegion:ei.Ai.notificationsApp,actionScenario:ei.Tk.toastDiscarded,actionScenarioType:i[n]})},c$=(e,n,i,t,a,o)=>{var d,l;const{disableNotificationsForSilentLaunch:r}=t.get(s.J.Notifications),{launchIntent:m}=t.get(s.J.HostCapabilities);if(r&&"LaunchCoreNoSystemTray"===m)return{dropNotification:!0,reason:l$.SuppressedDueToSilentLaunch};if(null==i?void 0:i.isUrgent)return{dropNotification:!1,reason:r$.UrgentToast};const c=function(e,n){var i;const t=e.getBlockedState(n),a=null===(i=null==t?void 0:t.blocks)||void 0===i?void 0:i.find((e=>e.blockingReasons.Presenting));return n.log(`isNotificationBlockedByPresenting: presentingBlockedState: ${a}, any blocks present: ${!!(null==t?void 0:t.blocks)}`),!!a}(e,a);if(c)return{dropNotification:!0,reason:l$.Presenting};if(i.isIncomingCall&&!(null===(d=t.get(s.J.Notifications))||void 0===d?void 0:d.onlyPriorityCallsInDnD))return{dropNotification:!1,reason:r$.IncomingCall};if(function(e,n,i){var t;const a=CO(n);if(a!==vO.pC.Standard)return!1;const o=e.getBlockedState(i),d=null===(t=null==o?void 0:o.blocks)||void 0===t?void 0:t.find((({blockingReasons:e})=>Object.keys(e).find((n=>e[n]===GR.MeetingOrCall))));return!!d}(e,i,a))return{dropNotification:!0,reason:l$.MeetingOrCall};const u=function(e,n,i){const t=o$(n);if(!t)return!1;const a=e.getUserBlockedState(i,t);return!!(null==a?void 0:a.blockingReasons.DoNotDisturb)}(e,i,a);return u?{dropNotification:!0,reason:l$.DND}:(null===(l=t.get(s.J.Notifications))||void 0===l?void 0:l.enableOSDnDSupportForCustomToasts)&&function(e,n,i,t){var a;if(!t)return void i.log("User id is missing, isNotificationBlockedByOsDnD returns false");const o=e.shouldDropToastBasedOnDnD(t,i),d=(null===(a=null==n?void 0:n.targetEntity)||void 0===a?void 0:a.dataOptions).toastType||"";return!d&&o}(n,i,a,o)?{dropNotification:!0,reason:l$.OSDnD}:{dropNotification:!1,reason:r$.AllowedByPresence}};class u${constructor(e,n,i){this.setTimeout=e,this.clearTimeout=n,this.timer=0,this.remainingTimeOnScreen=0,this.startTimeInMS=0,this.toast=i.toast,this.callback=i.callback,this.remainingTimeOnScreen=this.toast.displayDuration||fO.FIVE_SECONDS}cancelTimer(){this.clearTimeout(this.timer)}resetTimer(){this.remainingTimeOnScreen=this.toast.displayDuration||fO.FIVE_SECONDS,this.cancelTimer(),this.startTimer()}pauseTimer(){const e=Date.now()-this.startTimeInMS;this.remainingTimeOnScreen-=e,this.cancelTimer()}startTimer(e){this.startTimeInMS=Date.now(),e&&(this.remainingTimeOnScreen=e),this.timer=this.setTimeout((()=>{this.callback()}),this.remainingTimeOnScreen)}}class p${constructor(){this.registeredCallbacks=[],this.dismissCallbacks=[],this.priorityMap={[vO.gP.Call]:new Map,[vO.gP.High]:new Map,[vO.gP.Normal]:new Map},this.timers=new Map,this.prevActiveToasts=[],this.defaultTimerForStandardNotifications=fO.FIVE_SECONDS,this.window=(0,Bi.J)()}overrideDefaultTimerForStandardNotifications(e){this.defaultTimerForStandardNotifications=e||fO.FIVE_SECONDS}registerTelemetryServices(e,n){this.logger=e,this.scenarioFactory=n}registerOnStateChangedCallback(e){this.registeredCallbacks.push(e),this.generateUpdatedActiveState()}registerOnDismissCallback(e){this.dismissCallbacks.push(e)}pinToast(e){var n;const i=this.prevActiveToasts.find((({id:n})=>n===e));i&&(i.pinned=!0,null===(n=this.timers.get(e))||void 0===n||n.pauseTimer())}unpinToast(e){var n;const i=this.prevActiveToasts.find((({id:n})=>n===e));i&&(i.pinned=!1,null===(n=this.timers.get(e))||void 0===n||n.startTimer(),this.generateUpdatedActiveState())}addIncomingToast(e){const n=this.getPriority(e);e.displayDuration=this.getDisplayDuration(e);const i=this.priorityMap[n].get(e.id);if(null==i?void 0:i.pinned)return this.findAssociatedScenarios(e,(e=>e.incomplete({reason:"updateToPinnedToast"}))),void this.log(`Discarding ${e.id} toastType: ${e.type} as it is an update to a pinned toast`);const t=e.type===vO.pC.Calling?void 0:fO.THIRTY_SECONDS;this.resetTimer(e,t),this.priorityMap[n].set(e.id,e),this.generateUpdatedActiveState(e),this.log(`Adding ${e.id} toastType: ${e.type} to Notification queue`)}dismissToast(e,n=!0,i=!1){const t=this.getPriority(e);this.priorityMap[t].delete(e.id);const a=this.prevActiveToasts.findIndex((({id:n})=>n===e.id));this.prevActiveToasts.splice(a,1),this.cancelTimer(e),this.dismissCallbacks.forEach((n=>{n(e,i?"timeout":"unknown")})),n&&(this.generateUpdatedActiveState(),i&&!e.shown&&this.findAssociatedScenarios(e,(e=>{e.incomplete({reason:"noSlotAvailable"})})),this.log(`${e.id}: Dismiss ${i?"by timer":""}`))}log(e){if(!this.logger)return;let n=0;for(const e of Object.keys(this.priorityMap)){n+=this.priorityMap[e].size}this.logger.log(`CN:${e} activeToasts: ${this.prevActiveToasts.length} totalToasts: ${n}`)}generateUpdatedActiveState(e){let n=[];for(const e of Object.keys(this.priorityMap)){const i=this.priorityMap[e];n=n.concat(Array.from(i.values()))}let i=-1;for(let e=this.prevActiveToasts.length-1;e>=0;e--)if(this.prevActiveToasts[e].pinned){i=e;break}const t=-1===i?[]:this.prevActiveToasts.slice(0,i+1),a={};t.map((e=>a[e.id]=e)),n=n.filter((e=>!a[e.id])),n=n.slice(0,3-t.length);const o=t.concat(n);this.replaceActiveToasts(o,e),o.forEach((e=>e.shown=!0));for(const e of this.registeredCallbacks)e({activeToasts:[...o].reverse()})}replaceActiveToasts(e,n){const i={};e.map((e=>i[e.id]=e));const t={};this.prevActiveToasts.map((e=>t[e.id]=e));for(const e of Object.keys(t)){const n=t[e];i[e]||(this.dismissToast(n,!1),delete t[e])}for(const e of Object.keys(i)){const n=i[e];n.type===vO.pC.Calling||t[e]||this.resetTimer(n)}n&&i[n.id]&&n.type!==vO.pC.Calling&&this.resetTimer(n),this.prevActiveToasts=e}resetTimer(e,n){const i=this.timers.get(e.id);if(i)return void i.resetTimer();const t=new u$(this.window.setTimeout,this.window.clearTimeout,{toast:e,callback:()=>{this.dismissToast(e,!0,!0)}});this.timers.set(e.id,t),t.startTimer(n)}cancelTimer(e){var n;null===(n=this.timers.get(e.id))||void 0===n||n.cancelTimer(),this.timers.delete(e.id)}getPriority(e){switch(e.type){case vO.pC.Calling:case vO.pC.MeetingNudge:return vO.gP.Call;case vO.pC.MSN:return vO.gP.High;default:return vO.gP.Normal}}getDisplayDuration(e){if(e.displayDuration)return e.displayDuration;switch(e.type){case vO.pC.Calling:case vO.pC.MeetingNudge:return fO.SIXTY_TWO_SECONDS;case vO.pC.MSN:return fO.TWENTY_SECONDS;default:return this.defaultTimerForStandardNotifications}}findAssociatedScenarios(e,n){const i=[c.RG.CrossClientToastView,c.RG.WebToastShow];e.type===vO.pC.Calling&&e.telemetry.callingScenarioName&&i.push(e.telemetry.callingScenarioName),i.forEach((i=>{var t;const a=null===(t=this.scenarioFactory)||void 0===t?void 0:t.findScenarioByNameAndId(i,e.telemetry.toastScenarioClientId);a&&n(a)}))}}const y$=(e,n)=>{var i,t,a;const o=CO(n);return{id:n.targetEntity.id||e,mainImageSrc:(null===(i=n.mainImage)||void 0===i?void 0:i.src)||"",title:n.title,text:n.text,type:o,isIncomingCall:Boolean(n.isIncomingCall),isUrgent:Boolean(n.isUrgent),actions:null===(t=n.buttons)||void 0===t?void 0:t.map((e=>{var n;return{text:e.text,style:e.style,img:null===(n=e.image)||void 0===n?void 0:n.src,targetEntity:e.targetEntity}})),headerTitle:n.headerTitle,headerSubTitle:n.headerSubtitle,headerImageSrc:(null===(a=n.headerImage)||void 0===a?void 0:a.src)||"",ringtone:n.ringtone,deviceLabel:n.deviceLabel,deviceLabelSecondary:n.deviceLabelSecondary,targetEntity:n.targetEntity,isSilent:n.isSilent,textInput:n.textInput,telemetry:{callingScenarioName:n.crossClientScenarioName,callId:n.callId,toastType:n.targetEntity.dataOptions.toastType,toastScenarioClientId:e},mtmaHeader:n.mtmaHeader,displayDuration:n.displayDuration,externalAppIconType:n.externalAppIconType}},v$=(e,n,i,a)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,o,d;if(!e)return null===(t=a.errorToTelemetry)||void 0===t||t.call(a,"Toast activated with notificationsHandler unset","app_notifications_activation_handler_not_found"),i;const l=i.entityOptions,r=null===(o=null==l?void 0:l.targetEntity)||void 0===o?void 0:o.id;if(!r||!l)return null===(d=a.errorToTelemetry)||void 0===d||d.call(a,"Toast activated with toast id unset","app_notifications"),i;const s=y$(r,l);e&&l.targetEntity.id&&(null==n||n.dismissToast(s,"ActivatedByUser"));const m=((e,n)=>{switch(e.type){case ja.dt.chats:case ja.dt.channels:return wO({isOnWeb:!0,targetEntity:e,startTimestamp:n.startTimestamp?+n.startTimestamp:Date.now()},n);case ja.dt.calls:default:return}})(l.targetEntity,i.command.correlation);m&&(yield e.activateNotification(m))}));class k${constructor(e,n,i){this.entityCommand=e,this.isRtl=n,this.scenario=i,this.shown=!1}getWebToastOptions(){return this.entityCommand.entityOptions}getNotificationOptionsPayload(){var e;const n=this.entityCommand.entityOptions;return{notificationTitle:n.title,notificationOptions:{body:n.text,icon:null===(e=n.mainImage)||void 0===e?void 0:e.src,timestamp:new Date(n.time).getTime(),tag:void 0,requireInteraction:!0,dir:this.isRtl?vO.uP.Rtl:vO.uP.Auto}}}registerGetNotificationCallback(e){this.getNotificationCallback=e}getNotification(){var e;return null===(e=this.getNotificationCallback)||void 0===e?void 0:e.call(this)}addCloseNotificationListener(e){var n;this.closeNotificationCallback=e,null===(n=this.getNotification())||void 0===n||n.addEventListener("close",e)}closeNotification(){const e=this.getNotification();this.closeNotificationCallback&&(null==e||e.removeEventListener("close",this.closeNotificationCallback),this.closeNotificationCallback=void 0),null==e||e.close()}}const g$=(e,n)=>{n.registerOnDismissCallback((n=>{null==e||e.dismissToast(n,"DismissedWithInAppToast")}))},N$=e=>{e.registerOnDismissCallback(((n,i)=>{if("timeout"===i){const i=e.getNotification(n.id);i&&(i.closeNotification(),i.scenario.stop({reason:"Timeout"}),e.deleteNotification(n.id))}}))},h$=e=>{e.registerOnStateChangedCallback((({activeToasts:n})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){f$(n,e),_$(n,e),yield S$(n,e)}))))},f$=(e,n)=>{var i;for(const t of n.getToastIds()){const a=n.getNotification(t);!e.find((e=>e.id===t))&&a&&(null===(i=a.closeNotification)||void 0===i||i.call(a),a.scenario.stop(),n.deleteNotification(t))}},_$=(e,n)=>{e.length&&e.forEach((i=>{const t=i.id,a=n.getNotification(t);a&&a.shown&&i.id!==e[e.length-1].id&&(a.closeNotification(),a.scenario.stop({reason:"DismissedByHigherPriorityNotification"}),n.deleteNotification(t))}))},S$=(e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){if(e.length){const i=e[e.length-1];if(n.isExistingToast(i.id)){const e=n.getNotification(i.id);if(e&&!e.shown&&n.notificationsHandler){e.shown=!0;switch(yield n.notificationsHandler.tryShowBrowserNotification(e)){case"queued":e.scenario.mark(c.ck.BrowserToastStepRequested),e.addCloseNotificationListener((()=>{n.dismissToast(i,"DismissedByUser")}));break;case"skippedNoPermissions":n.dismissToast(i,"SkippedNoPermissions");break;case"skippedAppInFocus":n.dismissToast(i,"SkippedAppInFocus");break;default:n.dismissToast(i,"SkippedReasonUnknown")}}}}})),T$=!0;function b$(e,n,i,t,a){if(!function(e,n){const{showGenericNotificationsSoundSetting:i,showNotificationsCallsSoundSetting:t}=n.get(s.J.Notifications);if(e&&t)return!0;if(!e&&i)return!0;return!1}(e,t))return i.log("Allowing to play toast sounds as the sound check feature is disabled"),T$;if(!n)return i.warn("Returning default value. SettingsCache is undefined"),T$;if(e){const e=C$(n[ZO.incomingCallsAndMeetingStartSound],i);return void 0!==a&&!1!==e?!a:e}return C$(n[ZO.alertSound],i)}function C$(e,n){const i=function(e,n){switch(e){case"On":return!0;case"Off":return!1;default:return n.warn(`Fall back to play toast sounds as the setting is ${e}`),T$}}(e,n);return n.log(`Allowed to play sound: ${i}`),i}const w$={Default:"msteams-asset://teams_notification.mp3",MeetingStarted:"msteams-asset://teams_meet_up_reminder.mp3"};var I$;function A$(e,n,i){var t;if(function(e,n,i){var t;if(!e.entityOptions)return i.error("Invalid command, no entity options. Skip adding ringtone"),!0;const{allowCustomToastRingtone:a}=n.get(s.J.Notifications);if(!a)return i.warn("Custom Ringtone feature is not enabled"),!0;if(null===(t=e.entityOptions)||void 0===t?void 0:t.ringtone)return i.log("Ringtone already exists on the command"),!0;return!1}(e,n,i))return e;const a=e.entityOptions,o=(null===(t=null==a?void 0:a.targetEntity)||void 0===t?void 0:t.dataOptions).toastType||"";if(!a.isIncomingCall){const n=(d=o)===I$.MeetingStarted||d===I$.HuddleMeetingStart||d===I$.MeetingStartFromLobby?w$.MeetingStarted:w$.Default;return i.log(`Added ringtone "${n.split("//")[1]}" to toast`),function(e,n){return(null==e?void 0:e.entityOptions).ringtone=n,e}(e,n)}var d;return e}!function(e){e.HuddleMeetingStart="HuddleMeetingStart",e.MeetingStarted="MeetingStart",e.MeetingStartFromLobby="MeetingStartFromLobby"}(I$||(I$={}));const F$=36;function D$(e,n,i,a,o,d){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const l=function(e,n,i,t){const a=e.entityOptions;if(!a)return i.error("Trying to apply ringtone data to toast command: entity options are missing"),e;const o=o$(a);if(!o)return i.error("Trying to apply ringtone data to toast command: userId not found"),e;const d=t.getUserActivitySettings(o),l=b$(a.callId,d,i,n,a.isSilent);return a.isSilent=!l,i.log(`Notification toast isSilent: ${a.isSilent}`),e.entityOptions=a,A$(e,n,i)}(e,n,i,a);return l.entityOptions?(l.entityOptions.mtmaHeader=yield function(e,n,i,a){var o;return(0,t.__awaiter)(this,void 0,void 0,(function*(){if(a||i.warn("User tracking service is undefined, the system cannot determine MTMA context but the header will be created"),a&&a.getAccountMode()!==ao.b.MultipleAccounts)return void i.log("User is logged in to one account, skipping MTMA header");const{enableMtmaHeaderForCustomToasts:d}=n.get(s.J.Notifications);if(!d)return void i.log("MTMA Header feature is disabled");const{email:l,tenantName:r}=yield function(e,n){var i;return(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=yield e.query({query:RR});return t.data.me&&t.data.me.email&&t.data.me.tenantName?{email:t.data.me.email,tenantName:t.data.me.tenantName}:(null===(i=n.errorToTelemetry)||void 0===i||i.call(n,"User data not available","app_notifications_enrich_command",void 0,!0),{email:void 0,tenantName:void 0})}))}(e,i);if(!l||!r)return void(null===(o=i.warnToTelemetry)||void 0===o||o.call(i,"Email or tenant name is undefined, skipping creation of MTMA header","app_notifications_enrich_command",void 0,!0));const m=function(e,n,i){const t=3,a=.6,o=1,d=2,l=Math.floor(i*a)-o;let r=e.length<l?e.length:l;const s=i-r-d-o;n.length<s&&(r=i-n.length-d-o);e.length>l&&(e=`${e.slice(0,r-t).trim()}...`);n.length>s&&(n=`${n.slice(0,s-t).trim()}...`);return`${e} - ${n}`}(l,r,F$);return i.log(`Created formatted header. Length: ${m.length}, args intial length: {email: ${l.length}, tenant name length: ${r.length}}`),m}))}(o,n,i,d),l):l}))}const E$=(e,n,i,a,o)=>{((e,n)=>{g$(e,n),N$(e),h$(e)})(o,a);return d=>{const{entityCommand:l,entityCommand:{entityOptions:r,entity:{type:m,action:c}},notificationsHandler:u,requestContext:{scenarioFactory:p,loggerFactory:y,coreSettings:k,userBiService:g,client:N,userTrackingService:h},windowProvider:f}=d,_=y.newLogger("NotificationsOnBeforeCommandHandled","apps-notifications");if(m===De.py.externalnavigation&&c===De.uk.empty)return M$(k,_,l,f);if(m===De.py.externalnavigation&&c===De.uk.manage)return((e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){return Notification.requestPermission().then((i=>{e.log(`Permision notification ${i}`),"granted"===i&&(null==n||n.showPermissionConfirmationBrowserNotification())})),Promise.resolve(void 0)})))(_,u);const{enableCustomNotificationsForCalls:S}=k.get(s.J.Core,["enableCustomNotificationsForCalls"]),{enableInAppNotificationsForCalls:T}=k.get(s.J.Notifications,["enableInAppNotificationsForCalls"]),{enableBrowserToasts:b}=k.get(s.J.Notifications),C=S||T||b;return m===De.py.toasts?l.entity.action===De.uk.confirm?v$(u,o,l,_):l.command.visibilityState===v.fe.hide?C?O$(a,o,l,!!T,k,u):Promise.resolve(l):l.command.visibilityState===v.fe.show?P$(k,_,l,p,g,e,n,i,o,N,u,h,r):(_.warn(`Unsupported combination of action ${l.entity.action} and visibilityState ${l.command.visibilityState} for EntityType.toasts`),Promise.resolve(l)):(_.warn(`Entity type is not of EntityType.toasts or EntityType.externalnavigation, received one is: ${l.entity.type}`),Promise.resolve(l))}},M$=(e,n,i,a)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{enableWarnUserNotificationSettings:t}=e.get(s.J.Notifications);return t?(null==a||a.open("ms-settings:notifications","_blank"),n.log("Go to OS settings event command triggered"),Promise.resolve(void 0)):(n.log("Warn user before command disabled by flag"),Promise.resolve(i))})),P$=(e,n,i,a,o,d,l,r,m,u,p,y,v)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){let t;$$(a,i,p);const{enableBrowserToasts:k}=e.get(s.J.Notifications,["enableBrowserToasts"]);k&&(t={browserToastScenario:L$(a,i)});const g=a.findScenarioByNameAndId(c.RG.CrossClientToastView,i.command.correlation.id),N=null==p?void 0:p.isCustomNotificationsEnabled(i.entityOptions);g&&g.appendEventData({isCustomNotification:N});const h=(null==v?void 0:v.targetEntity.dataOptions.userContextId)||"";let f=s$(e,n,i,a,o,d,l,u,h);return f?(f=yield D$(f,e,n,r,u,y),((e,n,i)=>{const{entityOptions:t}=e,a=null==t?void 0:t.targetEntity.type;if(a){const t=a$(e,n,i);n.recordPanelView({panelLaunchMethod:e$.$g.notification,panelRegion:ei.Ai.toast,dataBag:t,appName:"apps-notifications",panelType:i$[a],teamId:t$(e)}),null==t||t.dispose()}})(f,o,N),function(e,n,i,t,a,o){if(!e)return void a.warn("Entity options are not found, skipping creating OS DnD coachmark");const d=i.getSettingStateForUser(o,ZO.notificationStyleList)===n$.H.Native,l=e.targetEntity.type,r=i$[l];r!==ei.wh.callingToast&&!n.isHonoringDnDEnabled(o,a)&&n.isOSDnDEnabled(a)&&d&&t.recordPanelAction({panelRegion:ei.Ai.toast,panelType:r,actionScenario:ei.Tk.toastIssuedDuringOsDndOn,actionScenarioType:ei.Yu.issueToastDuringDnDOnForExNativeToastsUsers})}(f.entityOptions,l,r,o,n,h),t&&R$(p,m,i,t.browserToastScenario),Promise.resolve(f)):(null==t||t.browserToastScenario.stop({reason:"SkippedByFilters"}),Promise.resolve(f))})),R$=(e,n,i,t)=>{var a;if(!e)return void t.stop({reason:"ErrorMissingNotificationsHandler"});const o=i.entityOptions,d=o.targetEntity.id;if(!d)return void t.stop({reason:"ErrorMissingToastId"});const l=new k$(i,n.isRtl,t),r=y$(d,o);if(n.isExistingToast(d)){const e=n.getNotification(d);null==e||e.scenario.stop({reason:"DismissedToUpdateContent"}),null===(a=null==e?void 0:e.getNotification())||void 0===a||a.close()}t.mark(c.ck.BrowserToastStepAddedToStateContainer),n.addIncomingToast(r,l)},O$=(e,n,i,a,o,d)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{enableBrowserToasts:t}=o.get(s.J.Notifications),l=i.entity.id,r=i.entityOptions;if(!l||!r)return Promise.resolve(void 0);const m=y$(l,r);return t&&d&&r.targetEntity.id&&(null==n||n.dismissToast(m,"DismissedByApplication")),e.dismissToast(m),Promise.resolve(a?i:void 0)})),$$=(e,n,i)=>{var t,a;const o=e.newScenario(c.RG.WebToastShow);o.clientId=n.command.correlation.id;const d=n.entityOptions;return o.appendEventData({mainEntityType:null===(t=null==d?void 0:d.targetEntity)||void 0===t?void 0:t.type,isCustomNotification:(null==i?void 0:i.isCustomNotificationsEnabled(d))||(null==i?void 0:i.isInAppNotificationsEnabled(d))}),null===(a=e.hoistScenarioToCore)||void 0===a||a.call(e,o),o},L$=(e,n)=>{var i,t,a;const o=e.newScenario(c.RG.BrowserToast);return o.appendEventData({mainEntityType:null===(t=null===(i=n.entityOptions)||void 0===i?void 0:i.targetEntity)||void 0===t?void 0:t.type}),null===(a=e.hoistScenarioToCore)||void 0===a||a.call(e,o),o};var x$=i(344282);const B$={eventHandlers:{onEventReceived:e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n,i,a,o,d,l,r,m,c,u,p,y;const{eventInput:k,notificationsHandler:g,requestContext:{coreSettings:N,loggerFactory:h,hostCommunicationService:f}}=e,_=k.event;let S;const T=h.newLogger("NotificationsEventHandlers","apps-notifications"),{enableInAppNotifications:b}=N.get(s.J.Notifications,["enableInAppNotifications"]);if(_.originator!==x$.kn)return null===(n=T.errorToTelemetry)||void 0===n||n.call(T,`Unhandled event ${k.event.type} is not a notification event`,"app_notifications_unhandled_event"),Promise.resolve(void 0);let C;switch(_.type){case x$.uS.activateChatToast:C=null===(i=_.data)||void 0===i?void 0:i.call(_),S=wO(Object.assign(Object.assign({},C),{isOnWeb:!!b}));break;case x$.uS.activateCallToast:C=null===(a=_.data)||void 0===a?void 0:a.call(_),S=(e=>{const{targetEntity:n,isOnWeb:i,startTimestamp:t}=e,a=n.dataOptions,o=_O(t);return{command:SO(i,o),entity:bO(n),dataOptions:Object.assign({},a),entityOptions:Object.assign({},a)}})(Object.assign(Object.assign({},C),{isOnWeb:!!b}));break;case x$.uS.activateGraphItemToast:C=null===(o=_.data)||void 0===o?void 0:o.call(_),S=(e=>{const{targetEntity:n,startTimestamp:i}=e,t=n.dataOptions,a=_O(i);return{command:TO(a),entity:bO(n),dataOptions:Object.assign({},t)}})(Object.assign(Object.assign({},C),{isOnWeb:!!b}));break;case x$.uS.activateCommunitiesToast:C=null===(d=_.data)||void 0===d?void 0:d.call(_),S=(e=>{const{targetEntity:n,startTimestamp:i}=e,t=n.dataOptions;return{command:{correlation:_O(i),stateTransition:v.su.flush,visibilityState:v.fe.show},entity:bO(n),entityOptions:Object.assign({},t),dataOptions:t}})(Object.assign(Object.assign({},C),{isOnWeb:!!b}));break;case x$.uS.activateRemindersToast:C=null===(l=_.data)||void 0===l?void 0:l.call(_),S=(e=>{const{targetEntity:n,startTimestamp:i}=e,t=n.dataOptions,a=_O(i);return{command:SO(!0,a),entity:Object.assign(Object.assign({},bO(n)),{type:De.py.chats}),entityOptions:Object.assign({messageId:t.messageId,focusOnLoad:void 0},t),dataOptions:Object.assign({},t)}})(Object.assign(Object.assign({},C),{isOnWeb:!!b}));break;case x$.uS.files:((e,n)=>{(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var i;try{const n=yield e.loadModule("files");if(!(null==n?void 0:n.openLocalRecordingFolder))throw Error("filesModule is not available.");yield n.openLocalRecordingFolder()}catch(e){null===(i=n.errorToTelemetry)||void 0===i||i.call(n,"Open local recording folder failed.","cmd_recordings_open_local_recording_folder_failed")}}))})(f,T);break;case x$.uS.resizeWindow:C=null===(r=_.data)||void 0===r?void 0:r.call(_),g.resizeNotificationsWindow(C);break;case x$.uS.focusWindow:g.focusNotificationsWindow();break;case x$.uS.sendTelemetry:C=null===(m=_.data)||void 0===m?void 0:m.call(_),g.sendTelemetry(C);break;case x$.uS.sendDismissToastTelemetry:C=null===(c=_.data)||void 0===c?void 0:c.call(_),g.sendDismissToastTelemetry(C);break;case x$.uS.settingsstore:C=null===(u=_.data)||void 0===u?void 0:u.call(_),S=function(e){const{targetEntity:n,startTimestamp:i}=e,t=n.dataOptions,a=null==t?void 0:t.subMenu;return{entity:Object.assign({type:De.py.settingsstore,action:De.uk.default},a?{id:a}:{}),command:{stateTransition:v.su.flush,visibilityState:v.fe.show,correlation:_O(i)},dataOptions:Object.assign({},t)}}(Object.assign(Object.assign({},C),{isOnWeb:!!b}));break;case x$.uS.offsetNotificationsWindow:C=null===(p=_.data)||void 0===p?void 0:p.call(_),g.offsetNotificationsWindow(C.offset);break;default:null===(y=T.errorToTelemetry)||void 0===y||y.call(T,`Unhandled event ${k.event.type}`,"app_notifications_unhandled_event")}return S&&g.activateNotification(S),Promise.resolve(void 0)}))}};var j$=i(363592);const U$=({coreSettings:e,stateContainer:n,NotificationsRenderer:i,loggerFactory:t,scenarioFactory:a,host:o})=>{var d;const{entity:{id:l},getEntityOptions:r}=(0,al.sV)(),m=(0,j$.JQ)(),u=Ae.useRef(!1),p=Ae.useMemo((()=>{const e=t.newLogger("NotificationsApp","apps-notifications");return n.registerTelemetryServices(e,a),e}),[t,a,n]);p.log(`${hO}Parsing notification details`);const y=r(De.py.toasts,De.uk.view);let v;if(l){u.current||(!function(e,n){const{delayCustomNotificationsWindowCreation:i,enableCustomNotificationWindowOffset:t,customNotificationWindowOffset:a}=e.get(s.J.Notifications,["delayCustomNotificationsWindowCreation","enableCustomNotificationWindowOffset","customNotificationWindowOffset"]);i&&t&&n.generateEvent({event:x$.U3.offsetNotificationsWindow({offset:a})})}(e,m),u.current=!0),v=y$(y.telemetryClientId||"",y);const{id:n,telemetry:{callingScenarioName:i,callId:t,toastType:a,toastScenarioClientId:o}}=v;m.generateEvent({event:x$.U3.sendTelemetry({toastScenarioClientId:o,stepName:c.ck.RootNotificationRenderBegin,callId:t,callingScenarioName:i,toastType:a})}),p.log(`${hO}${n}:Beginning to render notification. correlationId=${o} callId=${t} type=${v.type} toastType=${a} scenario=${i}`)}else null===(d=p.errorToTelemetry)||void 0===d||d.call(p,`${hO}: Missing entityId in Toast Command of type ${y.targetEntity.type}`,"app_notifications",void 0,!0);return(0,Ie.t)(i,{host:o,logger:p,scenarioFactory:a,stateContainer:n,uiToast:v})};const V$=e=>{if(W$(e))return{subNavEntity:null,headerEntity:null,startEntity:null,mainEntity:H$(e),endEntity:null}},W$=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=e===v.lO.minimal,o=t===De.py.toasts,d=[De.uk.delete,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},H$=({entity:e})=>e,G$=()=>({mainEntity:{[Fe.S.Main]:{disableNotificationsBanners:!0,forceDisableTitleBar:!0,isBackgroundTransparent:!0}}}),J$={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsNotificationsNewWindowMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createNotificationsWindow"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]}]}}]};function q$(e,n){return{id:"create-notifications-window-on-experience-warm-job",runOncePerId:!0,job:()=>(n.newLogger("NotificationsWindowCreation","apps-notifications").log("CN:Issuing mutation to create notifications window."),e.mutate({mutation:J$,fetchPolicy:"no-cache"}),()=>{})}}const z$=({context:{hostCommunicationService:e,coreSettings:n,client:i,loggerFactory:a}})=>{const o=a.newLogger("NotificationsOnExperienceJob","apps-notifications"),d=i,{enableCustomNotificationsForCalls:l,enableCustomNotificationsForChats:r,enableCustomNotificationsOnDesktop:m}=n.get(s.J.Core),{allowPrivateCallingPolicy:c}=n.get(s.J.Calling);if(!m||!l&&!r)return o.debug(`${hO}CreateNotificationsWindowOnExperienceWarmDisabled`),[];if(!c)return o.debug(`${hO}CreateNotificationsWindowSkippedAsCallingNotEnabledByPolicy`),[];const{delayCustomNotificationsWindowCreation:u,enableCustomNotificationWindowOffset:p,customNotificationWindowOffset:y}=n.get(s.J.Notifications,["delayCustomNotificationsWindowCreation","enableCustomNotificationWindowOffset","customNotificationWindowOffset"]);if(u)return o.log(`${hO}Creation of notifications window is delayed until 1st notification arrives.`),[];o.log(`${hO}Attempting to create notifications window on experience warm.`);const v=[q$(d,a)];return p&&v.push(function(e,n,i){return{id:"reposition-notifications-window-on-experience-warm-job",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=n.newLogger("NotificationsWindowReposition","apps-notifications");t.log("Calling pie api to reposition notification window at the bottom");const a=yield e.loadModule("toasts");if(a){if(a.offsetNotificationsPanel)return a.offsetNotificationsPanel(i||0);t.error("toasts.offsetNotificationsPanel method not available")}else t.error("cannot load toasts module")}))}}(e,a,y)),v};class Q${constructor(){this.notificationSettingsCache={}}updateUserActivitySettingsCache(e,n,i,t,a){if(!n)return void a.error("Empty activity settings, update failed");const o=function(e,n){const i={[ZO.alertSound]:"On",[ZO.incomingCallsAndMeetingStartSound]:"On",[ZO.respectOsDnDForCustomToasts]:"Off",[ZO.notificationStyleList]:"Purple"},t=new Map;for(const n of e)n&&t.set(n.key.toLowerCase(),n.value);for(const[e,a]of Object.entries(i)){const o=t.get(e.toLowerCase());o?(i[e]=o,n.debug(`Assigned ${e} setting value ${a}`)):n.debug(`Setting ${e} not found in user settings, fallback to ${a}`)}return i}(n,a);if(a.log(`Settings successfully updated for id ${e}. Generic toasts sound value: ${o[ZO.alertSound]}, calling toasts: ${o[ZO.incomingCallsAndMeetingStartSound]}`),this.notificationSettingsCache[e]=o,i){const n=this.getSettingStateForUser(e,ZO.respectOsDnDForCustomToasts);t.setHonorDnDSettingState(n,a,e)}}getUserActivitySettings(e){const n=Object.entries(this.notificationSettingsCache),[i,t]=n.find((([n])=>-1!==n.replace(/-/g,"").indexOf(null==e?void 0:e.replace(/-/g,""))))||[];return t}getSettingStateForUser(e,n){var i;return null===(i=this.notificationSettingsCache[e])||void 0===i?void 0:i[n]}}class Y${constructor(){this.browserNotificationStateContainer=new p$,this.toastIdToNotification=new Map}initialize(e,n){this.notificationsHandler=e,this.i18n=n}get isRtl(){var e;return!!(null===(e=this.i18n)||void 0===e?void 0:e.isRtl)}isExistingToast(e){return!!this.toastIdToNotification.has(e)}getToastIds(){return this.toastIdToNotification.keys()}getNotification(e){return this.toastIdToNotification.get(e)}setNotification(e,n){this.toastIdToNotification.set(e,n)}deleteNotification(e){this.toastIdToNotification.delete(e)}registerOnStateChangedCallback(e){this.browserNotificationStateContainer.registerOnStateChangedCallback(e)}registerOnDismissCallback(e){this.browserNotificationStateContainer.registerOnDismissCallback(e)}addIncomingToast(e,n){this.setNotification(e.id,n),this.browserNotificationStateContainer.addIncomingToast(e)}dismissToast(e,n){var i;n&&(null===(i=this.toastIdToNotification.get(e.id))||void 0===i||i.scenario.appendEventData({reason:n})),this.browserNotificationStateContainer.dismissToast(e)}}class K${constructor(){this.doNotDisturbState=HO.ZD.Unrestricted,this.honorOsDoNotDisturbSetting={},this.cacheUpdatedCallbacks={}}registerOnCacheUpdatedCallback(e,n){this.cacheUpdatedCallbacks[e]?this.cacheUpdatedCallbacks[e].push(n):this.cacheUpdatedCallbacks[e]=[n]}setOsDoNotDistubState(e,n,i){i.log(`New OS 'Do not Disturb' state set to ${e}`),this.doNotDisturbState=e,this.cacheUpdatedCallbacks[n]&&this.cacheUpdatedCallbacks[n].forEach((e=>e(this.shouldDropToastBasedOnDnD(n,i))))}setHonorDnDSettingState(e,n,i){n.log(`Setting new state of OS DnD ${e}`),this.honorOsDoNotDisturbSetting[i]=e,this.cacheUpdatedCallbacks[i]&&this.cacheUpdatedCallbacks[i].forEach((e=>e(this.shouldDropToastBasedOnDnD(i,n))))}isHonoringDnDEnabled(e,n){const i=this.honorOsDoNotDisturbSetting[e];switch(n.log(`Current 'Honor DnD' setting state: ${i}`),i){case n$.H.On:return!0;case n$.H.Off:return!1;default:return n.log("Current setting state is undefined, returning isHonoringDnDEnabled: false"),!1}}isOSDnDEnabled(e){switch(this.doNotDisturbState){case HO.ZD.AlarmsOnly:case HO.ZD.PriorityOnly:return e.log("isOSDnDEnabled: true"),!0;case HO.ZD.Unrestricted:return!1;default:return e.log("Current OS DnD state is unrecognised, returning isOSDnDEnabled: false"),!1}}shouldDropToastBasedOnDnD(e,n){return n.log(`[shouldDropToastBasedOnDnD] Honor OS DnD: ${this.honorOsDoNotDisturbSetting[e]}, OS DnD state: ${this.doNotDisturbState}. Checking for userId ${e}`),this.isHonoringDnDEnabled(e,n)&&this.isOSDnDEnabled(n)}}const X$=()=>Promise.all([i.e(256045),i.e(296056),i.e(400010),i.e(346239),i.e(127919),i.e(853863)]).then(i.bind(i,66506));function Z$(){const e=new JR,n=new K$,i=new Q$,a=new p$,o=new Y$,d=()=>null;return Object.assign(Object.assign({},B$),{getAppViewEntities:V$,getAppViewEntitiesProps:G$,getAppWindowFeatures:()=>PR.windowFeatures||{},onUserWindowPreWarm:XO(),onBeforeCommandHandled:E$(e,n,i,a,o),onPreWarm:YO(e,n,i,o),manifest:PR,render:({loggerFactory:e,scenarioFactory:n,host:i,coreSettings:o})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){var t,l;try{const{NotificationsRenderer:t}=yield(0,Pn.mT)(X$,"notifications-app",n),{standardNotificationDuration:d}=o.get(s.J.Notifications);return d&&!isNaN(d)&&Number(d)>0&&a.overrideDefaultTimerForStandardNotifications(Number(d)),(0,Ie.t)(U$,{coreSettings:o,loggerFactory:e,stateContainer:a,NotificationsRenderer:t,scenarioFactory:n,host:i})}catch(n){return null===(l=(t=e.newLogger("NotificationsApp","apps-notifications")).errorToTelemetry)||void 0===l||l.call(t,`CN:Error in notification app render method: ${n.message}`,"app_notifications",void 0,!0),(0,Ie.t)(d,{})}})),onExperienceWarm:z$})}const eL={id:ND.x8,name:"TeamsGalleryApp",supportedEntities:[De.py.teamsgallery,De.py.teams],supportedRenderModes:[Fe.S.Main,Fe.S.Rail],getDefaultCommand:()=>({action:De.uk.view,type:De.py.teamsgallery})},nL=e=>{if(iL(e))return tL(e)?{subNavEntity:aL(e),headerEntity:oL(e),startEntity:dL(e),mainEntity:lL(e),endEntity:rL(e)}:null},iL=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.teamsgallery,De.py.teams].includes(t),d=[De.uk.create,De.uk.default,De.uk.list,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},tL=()=>!0,aL=({entity:e})=>e,oL=()=>null,dL=()=>null,lL=({entity:e})=>e,rL=()=>null,sL=({areEmptySlotsTransparent:e,coreSettings:n})=>({subNavEntity:{[Fe.S.Rail]:{areSlotShadowsDisabled:e,isBackgroundTransparent:!!(null==n?void 0:n.get(s.J.Core).enableTransparentLeftRail)||e,isColorSchemeDefaultBackground3:!e}}}),mL=()=>Promise.all([i.e(711880),i.e(122417),i.e(715369)]).then(i.bind(i,585805));function cL(){return{getAppViewEntities:nL,getAppViewEntitiesProps:sL,manifest:eL,render:({appRenderMode:e,onRenderEvent:n,scenarioFactory:i})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t="teams-gallery-app";n("ChunkLoadStarted",{chunkName:t});const{TeamsGalleryEntry:a}=yield(0,Pn.mT)(mL,t,i);return n("ChunkLoadSucceeded",{chunkName:t}),(0,Ie.t)(a,{appRenderMode:e})}))}}const uL={id:"com.microsoft.teams.entitymoreinfo",actors:["entitymoreinfo"],name:"EntityMoreInfoApp",supportedRenderModes:[Fe.S.Configurations]},pL={gqlTypeName:"EntityMoreInfoAppViewState",queryFieldName:"entityMoreInfoAppViewState",navigationalFieldDefaultValues:{},nonNavigationalFieldDefaultValues:{readyToBootstrapLPC:!1},computedValues:void 0},yL={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsEntityMoreInfoUsersForConversationQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mriArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isShortProfileRequested"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"peoplePickerFilters"}},type:{kind:"NamedType",name:{kind:"Name",value:"PeoplePickerFiltersInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isSharedChannel"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hostTenantId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getUsersForConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mriArray"},value:{kind:"Variable",name:{kind:"Name",value:"mriArray"}},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"Argument",name:{kind:"Name",value:"isShortProfileRequested"},value:{kind:"Variable",name:{kind:"Name",value:"isShortProfileRequested"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"Argument",name:{kind:"Name",value:"peoplePickerFilters"},value:{kind:"Variable",name:{kind:"Name",value:"peoplePickerFilters"}},__type:{kind:"NamedType",name:{kind:"Name",value:"PeoplePickerFiltersInput"}}},{kind:"Argument",name:{kind:"Name",value:"isSharedChannel"},value:{kind:"Variable",name:{kind:"Name",value:"isSharedChannel"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"Argument",name:{kind:"Name",value:"hostTenantId"},value:{kind:"Variable",name:{kind:"Name",value:"hostTenantId"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"objectId"},__type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"companyName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"tenantName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"type"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"userType"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isFederated"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"xtapUser"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"User"}}}}}]}}]},vL={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsEntityMoreInfoLpcStateQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lpcState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLivePersonaCardInitialized"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LpcState"}}},arguments:[]}]}}]},kL={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsEntityMoreInfoAuthenticationUsersQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserFilter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}},__type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserFilter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"tenantId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserProfile"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUser"}}}}}}]}}]};var gL=i(288573),NL=i(350205);const hL=e=>{switch(e){case"Card":return"Card";case"Expanded":return"ExpandedView";default:return}},fL=e=>{const{ariaLabel:n,coreSettings:i,eventType:t,externalAppSessionCorrelationId:a,host:o,hostConversationId:d,hostTenantId:l,isSharedChannel:r,locationToOpen:m,logger:c,personNodeId:u,tabIndex:p,userBiService:y,smtp:v,upn:k,aadObjectId:g,displayName:N,personaType:h,userId:f}=e;let _,S="Card";switch(t){case"mouseout":case"mousedown":default:_=gL.M.MouseHover;break;case"click":case"dblclick":_=gL.M.MouseClick,S=null!=m?m:"ExpandedView";break;case"keydown":_=gL.M.KeyboardPress,S=null!=m?m:"ExpandedView";break;case"app-request":_=gL.M.AppRequest,S=null!=m?m:"ExpandedView"}const T=()=>{null==o||o.document.dispatchEvent(new MouseEvent("mousemove"))},b=!!i.get(s.J.People).isInIframe;return{cardParameters:{personaInfo:{identifiers:{PersonaType:h||"NotResolved",HostAppPersonaId:(0,NL.Bg)({userId:f,isSharedChannel:!!r,hostTenantId:l,hostConversationId:d,personNodeId:u}),TeamsMri:f,Smtp:v,Upn:k,AadObjectId:g},displayName:N},behavior:{cardPlacementMode:"AnchorSide",locationToOpen:S,onCardOpen:()=>{null==o||o.document.addEventListener("mouseleave",T);const e={panelRegion:ei.Ai.popover,panelType:ei.wh.LivePersonaCard};null==y||y.recordPanelView(e,c)},onCardClose:()=>{null==o||o.document.removeEventListener("mouseleave",T);const e={actionGesture:ei.uS.mouseleave,actionOutcome:ei.$K.closePanel,actionScenarioType:ei.Yu.people,actionScenario:ei.Tk.closePanel,moduleName:ei.rA.lpcClose,panelRegion:ei.Ai.popover,panelType:ei.wh.LivePersonaCard};null==y||y.recordPanelAction(e,c)},shouldDeferCardOpenToParentWindow:b},externalAppSessionCorrelationId:a,ariaLabel:n,clientScenario:"MicrosoftTeams_MultiWindow",openCardTriggerType:_,cardOpenTime:Date.now()},tabIndex:p}},_L=({commandData:{isSharedChannel:e,conversationId:n,smtp:i,upn:a,aadObjectId:o,userId:d,personNodeId:l},tenantId:r,coreSettings:m,client:c,logger:u,host:p})=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const y=yield((e,n,i,a,o,d,l,r)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const{enableTflSms:t}=d.get(s.J.Messaging),{showPersonCardForSMSUser:m,showPersonCardForXTapUser:c}=d.get(s.J.People),{isCallingScreenInteractive:u,disablePstnPersonaCard:p}=d.get(s.J.Calling),{enableFlyoutInlineChat:y,enableSimplifiedFeaturesInFlyoutChat:v}=d.get(s.J.Flyout);if(!u||y&&v)return!1;if(a)return!0;if(e&&ms.eo.isTFLSmsMri(e))return!!t&&!!m;if(e&&ms.eo.isTFLOffNetworkUser(e))return!1;if(p&&(0,Uo.EG)(e))return!1;if(n&&!c){const n=(0,NL.we)(e,i,o,"lpc-persona-container",r);if(!n)return r.warn("xTap profile Query variables are not defined for a shared channel"),!1;const{data:t}=yield l.query({query:yL,variables:n});if(!t||!t.getUsersForConversation)return r.warn("xTap profile Query returned null data"),!1;const a=t.getUsersForConversation,d=!!(a.length>0&&a[0]&&ms.eo.isFederatedUser(a[0])&&a[0].xtapUser);return!d||!!c&&d}return!0})))(d,!!e,n,l,r,m,c,u),{data:{lpcState:v}}=yield c.query({query:vL}),k=!!(d||l||o||i||a);return!!(k&&y&&(null==v?void 0:v.isLivePersonaCardInitialized)&&(null==p?void 0:p.LPC))||(u.warn(`Lpc is not ready, \n          isIdentifierProvided: ${k},\n          isLpcAllowed: ${!y},\n          isLivePersonaCardInitialized: ${null==v?void 0:v.isLivePersonaCardInitialized}, \n          host.LPC:${!(null==p?void 0:p.LPC)}\n        `),!1)})),SL=e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n,i;const{data:{authenticationUsers:t}}=yield e.query({query:kL,variables:{filter:{isAuthenticated:!0}}});return null===(i=null===(n=t[0])||void 0===n?void 0:n.profile)||void 0===i?void 0:i.tenantId})),TL=(e,n,i)=>null==i?void 0:i.LPC.openCard(new i.DOMRect(e.left,e.top,e.width,e.height),n);var bL=i(989280),CL=i(331748);const wL={onCommandReceived:e=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n,i,a;const{appViewState:o,commandInput:d,host:l,requestContext:{client:r,coreSettings:m,loggerFactory:c},userBiService:u}=e,{command:{action:p,actor:y,data:v}}=d,k=c.newLogger("EntityMoreInfo onCommandReceived","apps-entity-more-info"),{enableEntityMoreInfo:g}=m.get(s.J.Core);if(k.log(`Command {action:${d.command.action}} received.`),!(null===(n=uL.actors)||void 0===n?void 0:n.includes(y)))return void k.error(`Command {action:${d.command.action}, actor:${d.command.actor}} is sent to the wrong App.`);const N=o;if(g&&!(null===(i=N.readyToBootstrapLPC)||void 0===i?void 0:i.read()))return k.error(`Command failed, LPC is not bootstrapped for command: {action:${d.command.action}}}.`),void(null===(a=N.readyToBootstrapLPC)||void 0===a||a.update(!0));const h=(e,n)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){return!!(yield _L({client:r,commandData:e,coreSettings:m,host:l,logger:k,tenantId:n}))||(k.error(`Command failed, LPC is not ready for command: {action:${d.command.action}}}.`),!1)}));switch(p){case nn:{const e=v,n=e.tenantId||(yield SL(r));if(!(yield h(e,n)))return;const i=fL(Object.assign(Object.assign(Object.assign(Object.assign({},e),{locationToOpen:hL(e.modality)}),n&&{tenantId:n}),{coreSettings:m,externalAppSessionCorrelationId:(0,et.v4)(),host:l,logger:k,userBiService:u}));return void(e.useNewEventObserver&&(e=>!!(null==e?void 0:e.LPC.eventObserver))(l)?((e,n,i)=>{var t;if(!i)return;const{eventType:a,top:o,left:d,width:l,height:r}=e;let s;switch(a){case"click":s="HoverTargetClick";break;case"mouseenter":s="HoverTargetEnter";break;case"keydown":s="HoverTargetKeyPress";break;case"mouseleave":s="HoverTargetLeave";break;default:return}const m={kind:s,params:{personaInfo:{identifiers:{personaType:n.personaInfo.identifiers.PersonaType,hostAppPersonaId:n.personaInfo.identifiers.HostAppPersonaId,teamsMri:n.personaInfo.identifiers.TeamsMri},displayName:n.personaInfo.displayName},behavior:{cardPlacementMode:["bottom","top","overlap"],onCardOpen:n.behavior.onCardOpen,onCardClose:n.behavior.onCardClose},clientScenario:"MicrosoftTeams_MultiWindow",cardOpenTime:n.cardOpenTime,externalAppSessionCorrelationId:n.externalAppSessionCorrelationId},targetLocation:new i.DOMRect(d,o,l,r)};null===(t=i.LPC.eventObserver)||void 0===t||t.next(m)})(e,i.cardParameters,l):TL(e,i.cardParameters,l))}case tn:{const e=v,n=e.tenantId||(yield SL(r));if(!(yield h(e,n)))return;const i=fL(Object.assign(Object.assign(Object.assign({},e),n&&{tenantId:n}),{locationToOpen:"ExpandedViewOrganizationSection",coreSettings:m,externalAppSessionCorrelationId:(0,et.v4)(),host:l,logger:k,userBiService:u}));return void TL(e,i.cardParameters,l)}case an:{const e=v,n=e.tenantId||(yield SL(r));if(!(yield h(e,n)))return;const i=(({ariaLabel:e,contextId:n,conversationId:i,coreSettings:t,eventType:a,externalAppSessionCorrelationId:o,highlightedText:d,host:l,isSharedChannel:r,logger:s,tenantId:m,topicId:c,userBiService:u,userId:p,clientRequestId:y})=>{const v=fL({ariaLabel:e,coreSettings:t,eventType:a,externalAppSessionCorrelationId:o,host:l,hostConversationId:i,hostTenantId:m,isSharedChannel:r,logger:s,userBiService:u,userId:p}),k={contextId:n,highlightedText:d,hideEntityAndContextQuestion:!0,clientRequestId:y};return Object.assign(Object.assign({},v),{cardParameters:Object.assign(Object.assign({},v.cardParameters),{personaInfo:Object.assign(Object.assign({},v.cardParameters.personaInfo),{identifiers:Object.assign(Object.assign({},v.cardParameters.personaInfo.identifiers),{PersonaType:"Topic",TeamsMri:void 0,TopicId:c}),topicMetadata:k}),behavior:Object.assign(Object.assign({},v.cardParameters.behavior),{onCardOpen:()=>{var e,n;if(null===(n=(e=v.cardParameters.behavior).onCardOpen)||void 0===n||n.call(e),c){const e=(0,bL.I6)({userAadObjectId:p,tenantAadObjectId:m});null==e||e.logEvent(CL.z.TopicCardOpen,{topicId:c})}}})})})})(Object.assign(Object.assign(Object.assign({},e),n&&{tenantId:n}),{coreSettings:m,externalAppSessionCorrelationId:(0,et.v4)(),host:l,logger:k,userBiService:u}));return void TL(e,i.cardParameters,l)}default:k.error(`Command action ${p} is not supported at EntityMoreInfoApp.`)}})),viewStateRegistration:pL};var IL=i(221272),AL=i(196897);const{useRef:FL,useEffect:DL}=Ae,EL=()=>Promise.all([i.e(917388),i.e(892924),i.e(779478),i.e(320794),i.e(475063),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(26466),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(403936),i.e(450605),i.e(329712),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(285883)]).then(i.bind(i,228183)),ML=({logger:e,onRenderEvent:n,scenarioFactory:a})=>{const o=(0,IL.I)("readyToBootstrapLPC");e.log(`LpcLazyLoader: shouldBootstrapLPC=${o}`);const[d,l]=(0,Ae.useState)(null);return(e=>{const n=FL(),a=FL(),o=(0,AL.WD)(g.nh.COMPLETE),{host:d,scenarioFactory:l}=(0,Cl.SE)();DL((()=>{e&&o&&(0,t.__awaiter)(void 0,void 0,void 0,(function*(){const e=()=>i.e(739823).then(i.t.bind(i,450054,23));try{const{freeBootstrapperMemory:i}=yield(0,Pn.mT)(e,"lpc-teams-bootstrapper",l);n.current=i,a.current=d.__lpcWindowProxy}catch(e){}}))}),[d,o,l,e]),DL((()=>()=>n.current&&a.current&&n.current(a.current)),[])})(!!o),(0,Ae.useEffect)((()=>{if(o){const e="entity-more-info-app";n("ChunkLoadStarted",{chunkName:e}),(0,Pn.mT)(EL,e,a).then((e=>l((()=>e.LPC)))),n("ChunkLoadSucceeded",{chunkName:e})}}),[n,a,o]),d&&(0,Ie.t)(d,{})};function PL(){return Object.assign(Object.assign({},wL),{manifest:uL,render:({coreSettings:e,loggerFactory:n,onRenderEvent:i,scenarioFactory:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=n.newLogger("EntityMoreInfoApp","apps-entity-more-info"),{enableEntityMoreInfo:o}=e.get(s.J.Core);return t.log(`render: loading EntityMoreInfoApp with enableEntityMoreInfo=${o}`),o?(0,Ie.t)(ML,{logger:t,onRenderEvent:i,scenarioFactory:a}):(0,Ie.t)(Ae.Fragment,{})}))})}const RL={getDefaultCommand:()=>({type:De.py.meetings,action:De.uk.view}),id:"com.microsoft.teams.meeting-options",name:"MeetingOptionsApp",supportedRenderModes:[Fe.S.Main,Fe.S.Modal],supportedEntities:[De.py.meetings,De.py.meetingsettings,De.py.licenses,De.py.meetingoptionscreatedialog],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}},OL=e=>{if($L(e))return LL(e)?{subNavEntity:xL(e),headerEntity:BL(e),startEntity:jL(e),mainEntity:UL(e),endEntity:VL(e)}:null},$L=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.meetings,De.py.meetingsettings,De.py.licenses,De.py.meetingoptionscreatedialog].includes(t),d=[De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},LL=()=>!0,xL=()=>null,BL=()=>null,jL=()=>null,UL=({entity:e})=>e,VL=()=>null,WL=()=>({mainEntity:{[Fe.S.Main]:{isBackgroundTransparent:!0}}}),HL=()=>Promise.all([i.e(790026),i.e(256045),i.e(371935),i.e(296056),i.e(958708),i.e(69286),i.e(401371),i.e(555748),i.e(409201),i.e(615942),i.e(277075),i.e(755491),i.e(375558)]).then(i.bind(i,259540));function GL(){return{getAppViewEntities:OL,getAppViewEntitiesProps:WL,manifest:RL,onRegister:e=>{e.registerTask(new Si.K)},render:({appRenderMode:e,onRenderEvent:n,scenarioFactory:i})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t="meeting-options-app";n("ChunkLoadStarted",{chunkName:t});const{MeetingOptions:a}=yield(0,Pn.mT)(HL,t,i);return n("ChunkLoadSucceeded",{chunkName:t}),(0,Ie.t)(JL,Object.assign({scenarioFactory:i},{children:(0,Ie.t)(a,{appRenderMode:e})}))}))}}const JL=({scenarioFactory:e,children:n})=>(qL(e),(0,Ie.t)(Ae.Fragment,{children:n})),qL=e=>{const n=Ae.useRef(e.findScenario(c.RG.MeetingOptionsStart));Ae.useEffect((()=>{n.current||(n.current=e.cancelExistingAndCreateScenario(c.RG.MeetingOptionsStart,"remount"))}),[e])},zL={id:"com.microsoft.teams.unified-consent",name:"UnifiedConsentApp",supportedEntities:[De.py.unifiedconsentdialog],supportedRenderModes:[Fe.S.Modal]},QL={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsUnifiedConsentDialogGetConsentStateQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"consentSurface"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"consentState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"consentSurface"},value:{kind:"Variable",name:{kind:"Name",value:"consentSurface"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"modelType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"platform"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"osVersion"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"deviceId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UnifiedConsentState"}}}}]}}]};function YL(e,n){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const{coreSettings:i,entityCommanding:t,client:a,loggerFactory:o}=n,{enableUnifiedConsent:d}=i.get(s.J.WindowsSignatureExperiences);if(!d||"main_window_rendered"!==e.type)return;const l=o.newLogger("UCWindowRenderTrigger","apps-unified-consent"),{data:r,error:m}=yield a.query({query:QL,fetchPolicy:"no-cache",variables:{consentSurface:"AppStart"}});m&&l.error(`Failed to query unified consent state: ${m.message}`);const c=null==r?void 0:r.consentState;c&&c.modelType&&t.unifiedConsent.launchUnifiedConsent(c)}))}const KL=()=>Promise.all([i.e(917388),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(976609),i.e(133950),i.e(779478),i.e(315215),i.e(680254),i.e(984256),i.e(555551),i.e(844369),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(215133),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(26466),i.e(745659),i.e(462317),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(485984),i.e(12921),i.e(756029),i.e(613692),i.e(403936),i.e(207856),i.e(450605),i.e(586146),i.e(329712),i.e(673758),i.e(524307),i.e(964619),i.e(418133),i.e(158087),i.e(788842),i.e(427163),i.e(749021),i.e(542511),i.e(232044),i.e(660340),i.e(988150),i.e(258171),i.e(658803),i.e(966573),i.e(868123)]).then(i.bind(i,389201));function XL(){const e=()=>null;return{manifest:zL,render:({appRenderMode:n,onRenderEvent:i,scenarioFactory:a,loggerFactory:o})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=o.newLogger("UnifiedConsentApp","apps-unified-consent");if(n===Fe.S.Modal){const e="unified-consent-app";t.debug("chunk load start"),i("ChunkLoadStarted",{chunkName:e}),t.debug("experimental import start");const{UnifiedConsentDialog:n}=yield(0,Pn.mT)(KL,e,a);return t.debug("report chunk load success"),i("ChunkLoadSucceeded",{chunkName:e}),t.debug("Rendering unified consent dialog"),(0,Ie.t)(n,{isFRE:!1})}return(0,Ie.t)(e,{})})),UNSAFE_onSignal:YL}}const ZL=e=>ex(e)?{subNavEntity:nx(e),headerEntity:ix(e),startEntity:tx(e),mainEntity:ax(e),endEntity:ox(e)}:null,ex=({entity:e})=>{const{type:n}=Object.assign({},e);return n!==De.py.platformstageinactivemeeting},nx=()=>null,ix=({entity:e})=>{try{const n=JSON.parse(e.options||"{}");if(e.type===De.py.platformstagewithoutchat&&n.isFullScreenApp)return null}catch(n){return e}return e},tx=()=>null,ax=({entity:e})=>e,ox=({entity:e,contextEntity:n})=>{const i=e.linkedEntity,t=e.options;return i?e.type===De.py.platformStage&&i.type===De.py.chats?Object.assign(Object.assign({},i),{action:De.uk.view,options:t}):e.type===De.py.platformStage&&(null==n?void 0:n.type)===De.py.chats?Object.assign(Object.assign({},n),{action:De.uk.view,options:t}):null:null},dx={id:"com.microsoft.teams.collab-stage-view",name:"CollabStageViewApp",supportedEntities:[De.py.platformStage,De.py.platformstageinactivemeeting,De.py.platformstagewithoutchat],supportedRenderModes:[Fe.S.Main,Fe.S.HorizontalBar],windowFeatures:{minWidth:800,width:800,minHeight:670,height:600,offset:20}},lx={shouldAddEntitiesToWindowHistory:e=>{var n;return(null===(n=e.mainEntity)||void 0===n?void 0:n.type)!==De.py.platformStage},shouldRestoreClientToEntities:e=>{var n;return(null===(n=e.mainEntity)||void 0===n?void 0:n.type)!==De.py.platformStage}},rx=({appRenderMode:e,coreSettings:n})=>{const i=new Ee.H,{platformAppCriticalPhaseTimeout:t}=n.get(s.J.Extensibility);if(e===Fe.S.Main)i.registerAppPhase({phase:g.nh.CRITICAL,signals:[Me.G.PLATFORM_APP_FRAME_CONTENT_RENDERED],timeout:t||35e3});return i.appPhases},sx=()=>Promise.all([i.e(917388),i.e(790026),i.e(590393),i.e(65477),i.e(70378),i.e(981345),i.e(347761),i.e(409201),i.e(399094),i.e(671682),i.e(967393),i.e(68688),i.e(912597),i.e(127919),i.e(314621),i.e(272519),i.e(547199),i.e(842529),i.e(485984),i.e(722198),i.e(271428),i.e(394413),i.e(477708),i.e(628109),i.e(677395),i.e(74043),i.e(358329),i.e(56767),i.e(802830),i.e(982110)]).then(i.bind(i,285099)),mx=({coreServices:e,host:n,prevEntityType:i,entityType:t,screenState:a,isResize:o})=>{if((i===De.py.platformStage||i===De.py.calls)&&t===De.py.platformStage)return null;const{minHeight:d,minWidth:l,offset:r=1}=dx.windowFeatures||{},m=null==n?void 0:n.screen;if(o&&!m)return dx.windowFeatures||null;if(!m)return null;let{height:c=1,width:u=1}=((e,n)=>{const{minHeight:i=0,minWidth:t=0}=dx.windowFeatures||{};let{width:a,height:o}=dx.windowFeatures||{};if(!n)return{height:o,width:a,minHeight:i,minWidth:t};const{orientation:{type:d}}=e,{landscapeScreenRatio:l,portraitScreenRatio:r,widthHeightRatio:m}=n.coreSettings.get(s.J.Calling);if(l&&r&&m)switch(d){case"landscape-primary":case"landscape-secondary":const n=l*e.availHeight;o=n>i?n:i,a=m*o;break;case"portrait-primary":case"portrait-secondary":const d=r*e.availWidth;a=d>t?d:t,o=1/m*a}return{height:o,width:a}})(m,e);const p=m.availHeight-r,y=u>=m.availWidth||c>=p;y&&(c=m.availHeight,u=m.availWidth);const{left:v,top:k}=((e,n,i,t,a)=>{if(t)return{left:0,top:0};const o="availLeft"in e?e.availLeft:0,d="availTop"in e?e.availTop:0,l=o+e.availWidth/2-n/2;let r;switch(e.orientation.type){case"landscape-primary":case"landscape-secondary":r=d+a;break;default:r=d+e.availHeight/2-i/2}return{left:l,top:r}})(m,u,c,y,r),g=y?0:((null==a?void 0:a.numOpenWindows)||1)*r;return{additionalFeatures:{minHeight:`${d}`,minWidth:`${l}`},height:c,left:v+g,minHeight:d,minWidth:l,top:k+g,width:u}};function cx(){return{getCommandScenarioName:ux,getAppViewEntities:ZL,getAppPhases:rx,getAppWindowFeatures:mx,manifest:dx,render:({appRenderMode:e,scenarioFactory:n,onRenderEvent:i,entity:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t="collab-stage-view-app";i("ChunkLoadStarted",{chunkName:t});const{StageViewEntry:o,StageViewWithoutChatEntry:d}=yield(0,Pn.mT)(sx,t,n);return a.type===De.py.platformstagewithoutchat?(0,Ie.t)(ri.f,Object.assign({namespace:"extensibility",loaderRenderer:null},{children:(0,Ie.t)(d,{appRenderMode:e})})):(0,Ie.t)(ri.f,Object.assign({namespace:"extensibility",loaderRenderer:null},{children:(0,Ie.t)(o,{appRenderMode:e})}))})),onBeforeAddToNavigation:lx}}const ux=e=>{const{entity:{type:n,action:i}}=e;return n===De.py.platformStage&&i===De.uk.create?c.RG.PlatformTabCollabStageFrameLoading:n===De.py.platformstagewithoutchat&&i===De.uk.view?c.RG.PlatformTabStageWithoutChatFrameLoading:void 0},px={id:"com.microsoft.teams.mtma",name:"MtmaApp",supportedEntities:[],supportedRenderModes:[]},yx={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsMtmaUserActivityUpdateEventSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mtmaUserActivityUpdateEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userAccountId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"count"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"lastUpdatedTimestamp"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"notificationSignalsInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"notificationSignalsWithCount"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activityType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"count"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"NotificationSignal"}}}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mostRecentNotificationSignal"},__type:{kind:"NamedType",name:{kind:"Name",value:"MissedMtmaNotificationSignals"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"mostRecentNotificationTimestamp"},__type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"NotificationSignalDetails"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},__type:{kind:"NamedType",name:{kind:"Name",value:"Float"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MTMAUserActivityData"}}},arguments:[]}]}}]},vx={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsMtmaSetUserNotificationsMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mtmaUserNotificationsParam"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MTMAUserNotificationsDataInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setMTMAUserNotificationsData"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mtmaUserNotificationsParam"},value:{kind:"Variable",name:{kind:"Name",value:"mtmaUserNotificationsParam"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MTMAUserNotificationsDataInput"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]};function kx(e){const{authenticationUser:n,client:i,loggerFactory:a}=e,o=i,d=a.newLogger("MTMAUserActivityUpdateEventSubscriptionJob","apps-mtma");return{id:"mtma-user-activity-update-event-subscription",runOncePerId:!0,job:()=>{const e=o.subscribe({query:yx,fetchPolicy:"no-cache"}).subscribe((e=>(0,t.__awaiter)(this,void 0,void 0,(function*(){!function(e,n,i,a){var o,d;(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=null==n?void 0:n.id;if(e.errors){const n=(0,wo.u4)(e.errors.map((e=>e.message)).join());return void(null===(o=a.errorToTelemetry)||void 0===o||o.call(a,`encountered error for user: ${t}, ${n}`,"mtma_user_activity_update_event_subscription_job",{context:"error_event",reason:n,userId:t},!0))}if(!(null===(d=e.data)||void 0===d?void 0:d.mtmaUserActivityUpdateEvent))return void a.warn(`received empty event for user: ${t}`);const{mtmaUserActivityUpdateEvent:l}=e.data,{userAccountId:r,count:s,lastUpdatedTimestamp:m,notificationSignalsInfo:c,consumptionHorizon:u}=l;a.log(`activity updated for user: ${t}, count: ${s}, signals: ${JSON.stringify(c.notificationSignalsWithCount)}`);const p=[];c.notificationSignalsWithCount.forEach((e=>{p.push({activityType:e.activityType,count:e.count})})),i.mutate({mutation:vx,variables:{mtmaUserNotificationsParam:{userAccountId:r,notifications:{count:s,lastUpdatedTimestamp:m,notificationSignalsInfo:{notificationSignalsWithCount:p,mostRecentNotificationSignal:c.mostRecentNotificationSignal,mostRecentNotificationTimestamp:c.mostRecentNotificationTimestamp},consumptionHorizon:u}}},fetchPolicy:"no-cache"})}))}(e,n,o,d)}))));return()=>{e.unsubscribe()}}}}const gx={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsMtmaUserPresenceUpdateEventSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mtmaUserPresenceUpdateEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userAccountId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"presence"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userPresenceData"}}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Presence"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MTMAUserPresenceData"}}},arguments:[]}]}},...i(232312).OY.definitions]},Nx={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsMtmaSetUserPresenceMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mtmaUserPresenceParam"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MTMAUserPresenceDataInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setMTMAUserPresenceData"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mtmaUserPresenceParam"},value:{kind:"Variable",name:{kind:"Name",value:"mtmaUserPresenceParam"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MTMAUserPresenceDataInput"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]};function hx(e){const{authenticationUser:n,client:i,loggerFactory:a}=e,o=i,d=a.newLogger("MTMAUserPresenceUpdateEventSubscriptionJob","apps-mtma");return{id:"mtma-user-presence-update-event-subscription",runOncePerId:!0,job:()=>{const e=o.subscribe({query:gx,fetchPolicy:"no-cache"}).subscribe((e=>(0,t.__awaiter)(this,void 0,void 0,(function*(){!function(e,n,i,a){var o,d;(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=null==n?void 0:n.id;if(e.errors){const n=(0,wo.u4)(e.errors.map((e=>e.message)).join());return void(null===(o=a.errorToTelemetry)||void 0===o||o.call(a,`encountered error for user: ${t}, ${n}`,"mtma_user_presence_update_event_subscription_job",{context:"error_event",reason:n,userId:t},!0))}if(!(null===(d=e.data)||void 0===d?void 0:d.mtmaUserPresenceUpdateEvent))return void a.warn(`received empty event for user: ${t}`);const{mtmaUserPresenceUpdateEvent:l}=e.data,{userAccountId:r,presence:s}=l,m=s.availability;a.log(`presence updated for user: ${t}, presence: ${s.availability}`),i.mutate({mutation:Nx,variables:{mtmaUserPresenceParam:{userAccountId:r,presence:{availability:m}}},fetchPolicy:"no-cache"})}))}(e,n,o,d)}))));return()=>{e.unsubscribe()}}}}const fx={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsMtmaUserProfileUpdateEventSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mtmaUserProfileUpdateEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userAccountId"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"User"}}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MTMAUserProfileData"}}},arguments:[]}]}},...i(995873).f.definitions]},_x={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsMtmaSetUserProfileMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mtmaUserProfileParam"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MTMAUserProfileDataInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setMTMAUserProfileData"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mtmaUserProfileParam"},value:{kind:"Variable",name:{kind:"Name",value:"mtmaUserProfileParam"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MTMAUserProfileDataInput"}}}}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}]}}]};function Sx(e){const{authenticationUser:n,client:i,loggerFactory:a}=e,o=i,d=a.newLogger("MTMAUserProfileUpdateEventSubscriptionJob","apps-mtma");return{id:"mtma-user-profile-update-event-subscription",runOncePerId:!0,job:()=>{const e=o.subscribe({query:fx,fetchPolicy:"no-cache"}).subscribe((e=>(0,t.__awaiter)(this,void 0,void 0,(function*(){!function(e,n,i,a){var o,d;(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=null==n?void 0:n.id;if(e.errors){const n=(0,wo.u4)(e.errors.map((e=>e.message)).join());return void(null===(o=a.errorToTelemetry)||void 0===o||o.call(a,`encountered error for user: ${t}, ${n}`,"mtma_user_profile_update_event_subscription_job",{context:"error_event",reason:n,userId:t},!0))}if(!(null===(d=e.data)||void 0===d?void 0:d.mtmaUserProfileUpdateEvent))return void a.warn(`received empty event for user: ${t}`);const{mtmaUserProfileUpdateEvent:l}=e.data,{userAccountId:r,profile:s}=l;a.log(`profile updated for user: ${t}`),i.mutate({mutation:_x,variables:{mtmaUserProfileParam:{userAccountId:r,profile:{avatarBlob:"",displayName:s.displayName||"",email:s.email||"",tenantName:s.tenantName||"",userPrincipalName:s.userPrincipalName||""}}},fetchPolicy:"no-cache"})}))}(e,n,o,d)}))));return()=>{e.unsubscribe()}}}}var Tx=i(588470),bx=i(136613);const Cx={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AppsMtmaGetHostMachineUsersQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hostMachineUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"accountType"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"HostMachineUser"}}}}},arguments:[]}]}}]};var wx=i(766237);const Ix={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsMtmaEspSurfaceShownSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"espSurfaceShownEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"surfaceIds"},value:{kind:"ListValue",values:[{kind:"StringValue",value:"AddAccountsSuggestionCoachmark",block:!1}]},__type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}]}}]};function Ax(){return({context:e})=>{var n,i;const a=[];if(e.coreSettings.get(s.J.CdlWorker).enableMTMAUserDataInMaglevStorage){const n=Fx(e);a.push(...n)}const{enableAddAccountSuggestionCoachmark:o,addAccountSuggestionCoachmarkDays:d}=e.coreSettings.get(s.J.Auth);return(null===(n=e.authenticationUser)||void 0===n?void 0:n.id)===(null===(i=e.authenticationUser)||void 0===i?void 0:i.homeAccountId)&&o&&d&&a.push(function(e,n){const i=e.client,a=new Date(-1),o=i.subscribe({query:Ix,fetchPolicy:"no-cache"}).subscribe((()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){Tx.Jt.put(bx.Jl.addAccountsSuggestionCoachMarkTimeStamp,a.toString())}))));return{id:"mtma-add-accounts-suggestion",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t={id:(0,Kg.pW)(),scenarioName:c.RG.AuthAddAccountsSuggestion,source:"apps-mtma:app-pre-warm"},[d,l]=(0,Xg.OU)({scenarioName:c.RG.AuthAddAccountsSuggestion,subContext:"appPrewarm",source:"mtma-add-accounts-suggestion:createMTMAAddAccountsSuggestionJob",options:{correlation:t}});try{const{entityCommanding:o}=e,l=Tx.Jt.getValue(bx.Jl.addAccountsSuggestionCoachMarkTimeStamp)||"",r=new Date(l);if(r.getTime()<0)return void d.addScenarioMark(c.ck.AuthAddAccountsSuggestionNotTriggered);const s=(yield i.query({query:Cx,fetchPolicy:"no-cache",context:{correlation:t}})).data.hostMachineUsers,m=s.filter((e=>!e.isAuthenticated)),u=s.filter((e=>e.isAuthenticated));if(u.length>1)return d.addScenarioMark(c.ck.AuthAddAccountsSuggestionNotTriggered),void Tx.Jt.put(bx.Jl.addAccountsSuggestionCoachMarkTimeStamp,a.toString());if(!l&&u.length>0)return d.addScenarioMark(c.ck.AuthAddAccountsSuggestionNotTriggered),void Tx.Jt.put(bx.Jl.addAccountsSuggestionCoachMarkTimeStamp,(new Date).toString());if((0,wx.RR)(new Date,(0,wx.Xz)(r,n)))return void d.addScenarioMark(c.ck.AuthAddAccountsSuggestionNotTriggered);m.length>0&&o.esp.displaySurface("AddAccountsSuggestionCoachmark")}catch(e){d.addScenarioMark(c.ck.AuthAddAccountsSuggestionFailed)}return l(),()=>{null==o||o.unsubscribe()}}))}}(e,d||0)),a}}const Fx=e=>[kx(e),hx(e),Sx(e)],Dx={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AppsMtmaCleanupStaleUserDataMutation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cleanupStaleMTMAUserData"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]}}]};function Ex(){return({context:e})=>{const n=[],{coreSettings:i}=e;return i.get(s.J.CdlWorker).disableMTMACleanupStaleUserDataJob||n.push(function(e){const{client:n}=e,i=n;return{id:"mtma-cleanup-stale-user-data-job",runOncePerId:!0,job:()=>(i.mutate({mutation:Dx,fetchPolicy:"no-cache"}),()=>{})}}(e)),n}}function Mx(){const e=()=>null;return{onPreWarm:Ax(),onExperienceWarm:Ex(),manifest:px,render:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){return(0,Ie.t)(e,{})}))}}const Px={id:"com.microsoft.teams.biometric-enrollment",name:"BiometricEnrollmentApp",supportedRenderModes:[Fe.S.Main],supportedEntities:[De.py.voiceenrollment,De.py.faceenrollment],windowFeatures:{minWidth:900,width:900,minHeight:950,height:950}},Rx=e=>{if(Ox(e))return $x(e)?{subNavEntity:Lx(e),headerEntity:xx(e),startEntity:Bx(e),mainEntity:jx(e),endEntity:Ux(e)}:null},Ox=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.faceenrollment,De.py.voiceenrollment].includes(t),d=[De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},$x=()=>!0,Lx=()=>null,xx=()=>null,Bx=()=>null,jx=({entity:e})=>e,Ux=()=>null,Vx=()=>Promise.all([i.e(790026),i.e(325894),i.e(755162),i.e(880414)]).then(i.bind(i,767200)),Wx=()=>Px.windowFeatures||{};function Hx(){const e=()=>null;return{getAppViewEntities:Rx,getAppWindowFeatures:Wx,manifest:Px,render:({appRenderMode:n,scenarioFactory:i})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main){const e="biometric-enrollment-entry",{BiometricEnrollmentEntry:n}=yield(0,Pn.mT)(Vx,e,i);return(0,Ie.t)(n,{})}return(0,Ie.t)(e,{})}))}}const Gx=e=>{if(Jx(e))return qx(e)?{subNavEntity:zx(e),headerEntity:Qx(e),startEntity:Yx(e),mainEntity:Kx(e),endEntity:Xx(e)}:null},Jx=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.coachreport].includes(t),d=[De.uk.default,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},qx=()=>!0,zx=()=>null,Qx=()=>null,Yx=()=>null,Kx=({entity:e})=>e,Xx=()=>null,Zx={id:"com.microsoft.teams.coachreport",name:"CoachReport",supportedEntities:[De.py.coachreport],supportedRenderModes:[Fe.S.Main],getDefaultCommand:()=>({type:De.py.coachreport,action:De.uk.view}),windowFeatures:{minWidth:1600,width:1600,minHeight:1e3,height:1e3,offset:20}},eB=({appRenderMode:e,coreSettings:n})=>{const i=new Ee.H,{speakerCoachCriticalPhaseTimeout:t,speakerCoachPostCriticalPhaseTimeout:a}=n.get(s.J.Coach),o=[];if(e===Fe.S.Main)o.push(Me.G.COACH_REPORT_VIEW_RENDERED);return i.registerAppPhase({phase:g.nh.CRITICAL,signals:o,timeout:t||3e4}),i.registerAppPhase({phase:g.nh.POST_CRITICAL,signals:[],timeout:a||1e4}),i.appPhases},nB=()=>Promise.all([i.e(790026),i.e(394902),i.e(764551),i.e(471154)]).then(i.bind(i,330701)),iB=()=>Zx.windowFeatures||{};function tB(){const e=()=>null;return{getAppViewEntities:Gx,getAppWindowFeatures:iB,getAppPhases:eB,manifest:Zx,render:({appRenderMode:n,onRenderEvent:i,scenarioFactory:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main){const e="coach-report-app";i("ChunkLoadStarted",{chunkName:e});const{CoachReportRenderer:n}=yield(0,Pn.mT)(nB,e,a);return i("ChunkLoadSucceeded",{chunkName:e}),(0,Ie.t)(ri.f,Object.assign({namespaces:["calling","messaging","meetingAnalytics","coachReport"],loaderRenderer:null},{children:(0,Ie.t)(n,{})}))}return(0,Ie.t)(e,{})}))}}const aB={id:"com.microsoft.teams.peoplecore",name:"PeopleCore",supportedEntities:[],supportedRenderModes:[]},oB={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"AppsPeopleCoreProfilesUpdateEventSubscription"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"profilesUpdateEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"User"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"avatarUrl"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]},__type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"User"}}}}},arguments:[]}]}}]};function dB(){return({context:{client:e,loggerFactory:n,coreSettings:i}})=>{const a=[],{enableProfilesUpdateToApolloCache:o}=i.get(s.J.People);return o&&a.push(function(e,n,i){return{id:"profiles-update-event-subscription-job",runOncePerId:!0,job:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const{enableProfilesUpdateToApolloCache:t}=i.get(s.J.People);if(!t)return;const a=n.newLogger("ProfilesUpdateSubscriptionJob","apps-people-core"),o=e.subscribe({query:oB}).subscribe((e=>{var n,i;a.log(`profilesUpdateEvent received ${null===(i=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.profilesUpdateEvent)||void 0===i?void 0:i.length} profiles`)}));return()=>{null==o||o.unsubscribe()}}))}}(e,n,i)),a}}function lB(){const e=()=>null;return{onUserWindowPreWarm:dB(),manifest:aB,render:()=>(0,t.__awaiter)(this,void 0,void 0,(function*(){return(0,Ie.t)(e,{})}))}}var rB=i(21242);const sB=e=>{if(mB(e))return cB(e)?{subNavEntity:uB(e),headerEntity:pB(e),startEntity:yB(e),mainEntity:vB(e),endEntity:kB(e)}:null},mB=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.attendeeview].includes(t),d=[De.uk.default,De.uk.create,De.uk.view],l=i&&d.includes(i);return!!(a&&o&&l)},cB=()=>!0,uB=()=>null,pB=({entity:e})=>e,yB=()=>null,vB=({entity:e})=>e,kB=()=>null,gB=({coreSettings:e,themeOptions:n})=>{var i;const{enableLightThemeSupport:t=!1}=null!==(i=null==e?void 0:e.get(s.J.Calling))&&void 0!==i?i:{};return{mainEntity:{[Fe.S.Main]:{disableNotificationsBanners:!0,forceDisableTitleBar:!0,isBackgroundTransparent:!0,isThemePinnedToDarkOrHighContrast:!t||(null==n?void 0:n.isCallingWindowDarkTheme)}},headerEntity:{[Fe.S.HorizontalBar]:{doesHeaderOverlapMain:!1,isBackgroundTransparent:!0}}}},NB={id:"com.microsoft.teams.attendee-view",name:"AteendeeViewApp",supportedEntities:[De.py.attendeeview],supportedRenderModes:[Fe.S.Main,Fe.S.HorizontalBar],windowFeatures:{height:360,width:640,minHeight:360,minWidth:640,offset:20}},hB=()=>Promise.all([i.e(315215),i.e(958708),i.e(416511),i.e(726400),i.e(127919),i.e(816906),i.e(297312),i.e(165665),i.e(442766),i.e(328135),i.e(104683),i.e(707014),i.e(112665),i.e(512052),i.e(667135),i.e(117530)]).then(i.bind(i,52610)),fB=()=>Promise.all([i.e(315215),i.e(958708),i.e(416511),i.e(726400),i.e(127919),i.e(816906),i.e(297312),i.e(165665),i.e(442766),i.e(328135),i.e(104683),i.e(707014),i.e(112665),i.e(512052),i.e(667135),i.e(117530)]).then(i.bind(i,114261)),_B="attendee-view-app",SB=(e,n,i,t)=>{const a=(e=>{const n=null==e?void 0:e.coreSettings.get(s.J.Host).disableOldDesktopCallMonitor;return(null==e?void 0:e.coreSettings.get(s.J.Calling).enableModernCallMonitor)||n?{width:304,height:247,cornerMargin:100}:{width:280,height:160,cornerMargin:16}})(t),o=a.cornerMargin,d=a.height+a.cornerMargin+16,l="availLeft"in e?e.availLeft:0,r=("availTop"in e?e.availTop:0)+e.availHeight-i-d,m=l+e.availWidth-n-o,c=r<0||m<0;return{top:c?0:r,left:c?0:m}},TB=({coreServices:e,host:n})=>{var i;const t=null==n?void 0:n.screen;if(!t)return null;const a=(!(null==e?void 0:e.coreSettings.get(s.J.Calling).disableContentprotection)).toString(),o=!!(null==e?void 0:e.coreSettings.get(s.J.Calling).enableCallMonitorGallery),d=(null===(i=NB.windowFeatures)||void 0===i?void 0:i.width)||640,l=(e=>e?360+(0,rB.fh)(e.windowProvider,6)+(0,rB.fh)(e.windowProvider,2.4):360)(e),{top:r,left:m}=SB(t,d,l,e);return{additionalFeatures:{alwaysOnTop:"true",closable:o.toString(),minimizable:(!o).toString(),excludeWindowFromScreenSharing:a,contentprotection:a,fullscreenable:"false",maximizable:"false",resizable:"false"},top:r,left:m,width:d,height:l,minWidth:d,minHeight:l}};function bB(){const e=()=>null;return{getAppViewEntities:sB,getAppViewEntitiesProps:gB,getAppWindowFeatures:TB,manifest:NB,render:({appRenderMode:n,scenarioFactory:i})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main){const{AttendeeView:e}=yield(0,Pn.mT)(hB,_B,i);return(0,Ie.t)(CB,{children:(0,Ie.t)(e,{})})}if(n===Fe.S.HorizontalBar){const{AttendeeToolbar:e}=yield(0,Pn.mT)(fB,_B,i);return(0,Ie.t)(CB,{children:(0,Ie.t)(e,{})})}return(0,Ie.t)(e,{})}))}}const CB=({children:e})=>(0,Ie.t)(ri.f,Object.assign({namespace:"calling",loaderRenderer:null},{children:e})),wB={getDefaultCommand:()=>({type:De.py.messages,action:De.uk.create}),id:"com.microsoft.teams.share",name:"ShareApp",supportedEntities:[De.py.messages,De.py.shareformdialog],supportedRenderModes:[Fe.S.Main,Fe.S.Modal],windowFeatures:{top:0,left:0,width:800,height:600,minWidth:800,minHeight:600,offset:20}};var IB=i(510793),AB=i(329948);const FB=({children:e})=>{const n=IB.YM,{unblockOutlookDesktopIE11:i,unblockSafari:t}=(0,yl.NC)(s.J.Outlook);if(i&&(n.ie=`>=${IB.Zz}`),t&&(n.safari=`>=${IB.hh}`),!((0,AB.H$)(n)||(0,AB.L5)()&&t))throw(0,yn.Tr)("UnsupportedBrowserCheck",gn.jK.FeatureNotSupported,"render",void 0,"Unsupported Browser");if(!t&&(0,AB.Qh)())throw(0,yn.Tr)("UnsupportedBrowserCheck",gn.jK.FeatureNotSupported,"render",{itpError:!0},"Unsupported Browser (ITP Enabled)");return(0,Ie.t)(Ae.Fragment,{children:e})},DB=e=>{if(EB(e))return MB(e)?{subNavEntity:PB(e),headerEntity:RB(e),startEntity:OB(e),mainEntity:$B(e),endEntity:LB(e)}:null},EB=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.messages,De.py.shareformdialog].includes(t),d=[De.uk.default,De.uk.view,De.uk.create],l=i&&d.includes(i);return!!(a&&o&&l)},MB=()=>!0,PB=()=>null,RB=()=>null,OB=()=>null,$B=({entity:e})=>e,LB=()=>null,xB=({appRenderMode:e})=>{const n=new Ee.H,i=[];return e===Fe.S.Main&&i.push(Me.G.SHARE_PAGE_RENDERED),n.registerAppPhase({phase:g.nh.CRITICAL,signals:i,timeout:2e4}),n.appPhases},BB=()=>Promise.all([i.e(917388),i.e(790026),i.e(122297),i.e(140641),i.e(590393),i.e(141603),i.e(892924),i.e(256045),i.e(65477),i.e(241602),i.e(976609),i.e(1053),i.e(779478),i.e(365718),i.e(890210),i.e(347761),i.e(9081),i.e(409201),i.e(475063),i.e(949673),i.e(868724),i.e(919433),i.e(195258),i.e(86195),i.e(810162),i.e(150486),i.e(794535),i.e(309953),i.e(757343),i.e(37943),i.e(212947),i.e(422118),i.e(68688),i.e(912597),i.e(314621),i.e(272519),i.e(547199),i.e(953275),i.e(718194),i.e(68792),i.e(481020),i.e(842529),i.e(485984),i.e(12921),i.e(495500),i.e(722198),i.e(271428),i.e(394413),i.e(477708),i.e(329712),i.e(494306),i.e(762318),i.e(591822),i.e(839074),i.e(55587),i.e(827265),i.e(693257),i.e(108951),i.e(989430),i.e(828729)]).then(i.bind(i,944712)),jB=()=>null;function UB(){return{getAppPhases:xB,getAppViewEntities:DB,manifest:wB,onRegister:e=>{e.registerTask(new Si.K)},render:({appRenderMode:e,scenarioFactory:n})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(e===Fe.S.Modal||e===Fe.S.Main){const e=yield(0,Pn.mT)(BB,"share-form",n),{ShareForm:i}=e;return(0,Ie.t)(FB,{children:(0,Ie.t)(i,{})})}return(0,Ie.t)(jB,{})}))}}const VB={id:"com.microsoft.teams.minimode-meeting-scheduler",name:"MinimodeMeetingschedulerApp",supportedEntities:[De.py.minimodeMeetingScheduler],supportedRenderModes:[Fe.S.Main],windowFeatures:{additionalFeatures:{closable:"true",hideWindowControl:"true",maximizable:"false"},top:50,left:50,minHeight:470,height:470,minWidth:400,width:400,offset:20}},WB=e=>{if(HB(e))return{subNavEntity:null,headerEntity:null,startEntity:null,mainEntity:GB(e),endEntity:JB(e)}},HB=({entity:e})=>{const{action:n=null,type:i}=Object.assign({},e),t=i===De.py.minimodeMeetingScheduler,a=n===De.uk.view;return Boolean(t&&a)},GB=({entity:e})=>e,JB=()=>null,qB=()=>({mainEntity:{[Fe.S.Main]:{disableNotificationsBanners:!0}}}),zB=()=>Promise.all([i.e(141603),i.e(371935),i.e(976609),i.e(1053),i.e(191673),i.e(22654),i.e(18830),i.e(409201),i.e(84215),i.e(880261),i.e(68688),i.e(386201),i.e(769716),i.e(788842),i.e(575317)]).then(i.bind(i,646256)),QB=()=>VB.windowFeatures||{};function YB(){const e=()=>null;return{getAppViewEntities:WB,getAppViewEntitiesProps:qB,getAppWindowFeatures:QB,manifest:VB,render:({appRenderMode:n,entity:{type:i},scenarioFactory:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main&&i===De.py.minimodeMeetingScheduler){const{MinimodeCreateMeetingForm:e}=yield(0,Pn.mT)(zB,"minimode-meeting-scheduler",a);return(0,Ie.t)(e,{})}return(0,Ie.t)(e,{})}))}}const KB={id:"com.microsoft.teams.exploratory-license",name:"ExploratoryLicenseApp",supportedEntities:[De.py.exploratorylicense],supportedRenderModes:[Fe.S.Main]},XB=e=>{if(ZB(e))return ej(e)?{subNavEntity:nj(e),headerEntity:ij(e),startEntity:tj(e),mainEntity:aj(e),endEntity:oj(e)}:null},ZB=({layoutMode:e,entity:n})=>{const{action:i=null,type:t}=Object.assign({},n),a=[v.lO.focus,v.lO.standard].includes(e),o=[De.py.exploratorylicense].includes(t),d=[De.uk.create],l=i&&d.includes(i);return!!(a&&o&&l)},ej=()=>!0,nj=()=>null,ij=()=>null,tj=()=>null,aj=({entity:e})=>e,oj=()=>null,dj=()=>i.e(449406).then(i.bind(i,316468));function lj(){return{manifest:KB,render:({appRenderMode:e,onRenderEvent:n,scenarioFactory:i})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){const t="exploratory-license-app";n("ChunkLoadStarted",{chunkName:t});const{ExploratoryLicenseViewsRenderer:a}=yield(0,Pn.mT)(dj,t,i);return n("ChunkLoadSucceeded",{chunkName:t}),(0,Ie.t)(a,{appRenderMode:e})})),getAppViewEntities:XB}}const rj={id:"com.microsoft.teams.presenter-chat",name:"PresenterChatApp",supportedEntities:[De.py.presenterchat],supportedRenderModes:[Fe.S.Main],windowFeatures:{height:631,width:304,offset:70}},sj=e=>{if(mj(e))return{subNavEntity:null,headerEntity:null,startEntity:null,mainEntity:cj(e),endEntity:null}},mj=({entity:e})=>{const{action:n=null,type:i}=Object.assign({},e),t=i===De.py.presenterchat,a=n===De.uk.view;return Boolean(t&&a)},cj=({entity:e})=>e,uj=()=>({mainEntity:{[Fe.S.Main]:{disableNotificationsBanners:!0,isBackgroundTransparent:!0,forceDisableTitleBar:!0}}}),pj=()=>Promise.all([i.e(882718),i.e(816906),i.e(47437),i.e(796745)]).then(i.bind(i,786393)),yj=({host:e,coreServices:n,windowOptions:i})=>{var t,a,o;const d=null==e?void 0:e.screen;if(!d)return null;const l=(null===(t=rj.windowFeatures)||void 0===t?void 0:t.width)||304,r=(null===(a=rj.windowFeatures)||void 0===a?void 0:a.height)||631,m=16+((null==i?void 0:i.top)||(null===(o=rj.windowFeatures)||void 0===o?void 0:o.offset)||70),c=(null==i?void 0:i.left)||d.availWidth/2,u=(!(null==n?void 0:n.coreSettings.get(s.J.Calling).disableContentprotection)).toString();return{additionalFeatures:{alwaysOnTop:"true",closable:"false",excludeWindowFromScreenSharing:u,fullscreenable:"false",maximizable:"false",minimizable:"false",resizable:"true",movable:"true",hideWindowControl:"true",contentprotection:u,transparent:"false"},top:m,left:c,width:l,height:r}};function vj(){const e=()=>null;return{getAppViewEntities:sj,getAppViewEntitiesProps:uj,getAppWindowFeatures:yj,manifest:rj,render:({appRenderMode:n,entity:{type:i},scenarioFactory:a})=>(0,t.__awaiter)(this,void 0,void 0,(function*(){if(n===Fe.S.Main&&i===De.py.presenterchat){const{PresenterChatContainer:e}=yield(0,Pn.mT)(pj,"presenter-chat-app",a);return(0,Ie.t)(e,{})}return(0,Ie.t)(e,{})}))}}const kj=e=>{const n=e===r.s.life?[tg(),XM(),ey(),vC(),Hp(),XL(),YB(),hP()]:[EM(),sE(),at(),{getAppPhases:bf,manifest:of,render:Tf,onCommandReceived:df,eventHandlers:af,getPlatformAppIdForEntity:e=>e.type===De.py.peopleapp?Vu.n.peopleApp:void 0,getAppViewEntities:wf,getAppViewEntitiesProps:Pf,onBeforeNavigationFromHistory:Rf},vP(),EP(),Ea(),mC(),$i(),vT(),Mx(),Hx(),Iv(),tB(),_i(),lB(),UB(),lj()];return[aF({isMainWindow:!0}),_N(),Uy(),tc(),...n,rr(),du(),fu(),ZT(),tD(),li(),qN(),dh(),Bh(),hh(),Xh(),va(),pS(),_S(),vj(),Ub(),ry(),yk(),bv(),Dr(),Ek(),Bk(),yg(),_v(),Cy(),EF(),Sr(),Z$(),cL(),Kf(),DR(),PL(),Pg(),GL(),cx(),hT(),bB()]};performance&&performance.mark&&performance.mark("start-execute-main-bundle"),i(524288);const gj={Application:{onExperienceWarm:["flyout-on-experience-warm-job","lazy-initialize-accounts-job","memory-feedback-service-start","init-diagnostics-idb-job","clear-t2-web-boot-attempts-counter","create-notifications-window-on-experience-warm-job","reposition-notifications-window-on-experience-warm-job","notify-desktop-experience-warm-job","mtma-cleanup-stale-user-data-job","detect-third-party-cookie-support-job","cleanup-t1-desktop-job"],onPreWarm:["active-windows-history-job","auth-state-subscription","cdl-services-state-subscription","auth-notification","bootstrap-floodgate","esp-time-based-trigger-job","esp-synthetic-notification-toast-subscription-job","files-register-resources","flyout-prewarm-job","graph-item-toast-event-subscription","start-esp","esp-signal-handler-job","download-log-subscription","network-state-subscription","presence-prewarm-job","setup-calling-app-events","settings-ecs-fetch","standup-calling","toast-event-subscription","channel-toast-event-subscription","communities-toast-event-subscription","taskbar-badge-event-subscription","taskbar-legacy-badge-event-subscription","worker-start-sync","connected-account-state-subscription","connected-calendar-sync-state-job","unified-calendar-sync-state-job","user-bi-initialize-smb-user-intent","notifications-engine-event-subscription","create-toast-collection","initialize-office-integration-service","start-local-migrated-settings-timer-job","presence-blocking-signal-subscription","user-settings-signal-subscription","warn-notifications-settings-banner-job","meetings-blocking-signal-subscription","connected-account-refresh-srt-job","desktop-minimum-version-check-job","share-to-teams-outlook-install","mtma-add-accounts-suggestion","mtma-user-activity-update-event-subscription","mtma-user-presence-update-event-subscription","mtma-user-profile-update-event-subscription","emergency-location-notification","maglev-provider-host-settings","prewarm-platform-app","exploratory-upgrade-banner-job","notify-desktop-experience-warm-for-user-job"],onUserWindowPreWarm:["m365-links-set-policy-value-job","profiles-update-event-subscription-job","start-esp-app-ready-hander","reset-taskbar-badge-on-account-switch","request-notification-authorization"],onExperienceLongIdle:["high-memory-restart-service","bootstrap-floodgate","files-app-pre-warm-job","public-preview-policy-job","bizchat-app-pre-warm","files-app-pre-warm-cft-job","share-to-teams-clear-teams-list-localstorage"]}},Nj=e=>{let n,i;return(0,m.IA)(e)&&(n=l.Bh.Maglev,i=(0,m.im)(e)),{clientType:n,platformId:i}},hj=()=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var e,n,t,l,m;const y=fj();yield null===(e=y.loader)||void 0===e?void 0:e.flushTelemetry(),null===(n=y.loader)||void 0===n||n.signalCoreInitStarted();const v=Date.now(),k=i(759455),g=(null===(l=null===(t=y.loader)||void 0===t?void 0:t.getProperties())||void 0===l?void 0:l.environment)||r.s.prod,N=new d.Q({config:Object.assign(Object.assign({},k),{startTimeMS:v,lifeCycleJobPermissions:gj}),apps:kj(g),criticalDynamicImports:p,loadConfigs:u.loadConfigs,generateChildWindowTemplate:we,getPlatformConfigurationOverrides:Nj});yield N.init();const h=N.coreServices,{enableMercuryDesign:f}=h.coreSettings.get(s.J.MercuryDesign),_={config:k,getLayoutResponsiveTemplates:he,uiVariables:{isMultiWindow:!0,disableExperienceSlotShadows:!!f}};yield(0,a.o)(N.activeWindows,h,(0,o.c)(_)),null===(m=h.scenarioFactory.findScenario(c.RG.ExperienceReady))||void 0===m||m.stop()})),fj=()=>window;hj().catch((e=>{(e=>{(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var n;return null===(n=fj().loader)||void 0===n?void 0:n.onErrorHandler(e,"CoreInitFailure")}))})(e)}))},973877:(e,n,i)=>{"use strict";i.d(n,{TP:()=>o,ad:()=>d,U:()=>r});var t=i(185535);function a(e){var n,i;const t=e.storeReader;return{selectionSetCache:null===(n=null==t?void 0:t.executeSelectionSet)||void 0===n?void 0:n.__DEBUG_ONLY_optimismCache,selectionSetArrayCache:null===(i=null==t?void 0:t.executeSubSelectedArray)||void 0===i?void 0:i.__DEBUG_ONLY_optimismCache}}function o(e){const{selectionSetCache:n,selectionSetArrayCache:i}=a(e),o=performance.now(),d=[Array.from(n.map),Array.from(i.map)];return{cacheSize:t(d),measuringTime:performance.now()-o}}function d(e){const{selectionSetCache:n,selectionSetArrayCache:i}=a(e);return{objectCount:n.map.size,arrayCount:i.map.size}}function l(e){var n,i,t,a;if(0===e.length)return"[Dirty]";let o="";return e[0]&&e[0].result&&(o=null!==(i=null===(n=e[0].result)||void 0===n?void 0:n.__typename)&&void 0!==i?i:"[Query]"),e[1]&&(o+=` (Error: ${null!==(a=null===(t=e[1])||void 0===t?void 0:t.message)&&void 0!==a?a:""})`),o}function r(e){var n;const{selectionSetCache:i}=a(e),t=new Map;for(const e of i.map.values()){const i=l(e.value.value),a=null!==(n=t.get(i))&&void 0!==n?n:0;t.set(i,a+1)}return Array.from(t).sort(((e,n)=>n[1]-e[1]))}},820061:(e,n,i)=>{"use strict";i.d(n,{K:()=>a});var t=i(530014);class a extends t.G{constructor(e,n){super({type:"UnknownError",code:"NONE",message:e.message,prevError:e}),this.context=n}getExtensions(){return Object.assign(Object.assign({},super.getExtensions()),this.context)}toTelemetryCode(){return`[${this.type}]`}}},541152:(e,n,i)=>{"use strict";i.d(n,{o:()=>d});var t=i(74583),a=i(530014),o=i(820061);function d(e,n){const i={};for(const[o,d]of(0,t.entries)(e))if(a=d,(0,t.entries)(a).some((([e,n])=>l(n)&&!e.startsWith("__"))))for(const[e,a]of(0,t.entries)(d))i[o]||(i[o]={}),i[o][e]=l(a)?r(a,[o,e],n):a;else i[o]=d;var a;return i}function l(e){return"function"==typeof e}function r(e,n,i){const t=e=>{throw e instanceof a.G?e:new o.K(e,{source:i,resolverPath:n})};return(...n)=>{try{const a=e(...n);return"function"==typeof(null==(i=a)?void 0:i.then)?a.catch(t):a}catch(e){t(e)}var i}}},263e3:(e,n,i)=>{"use strict";i.d(n,{HT:()=>t,Lo:()=>a,Oz:()=>o,Fu:()=>d,GO:()=>l});const t={FailedToFetchRelatedContacts:"FailedToFetchRelatedContacts",BadRequest:"BadRequest",InvalidBackendResponse:"InvalidBackendResponse",InvalidCallerOrGroup:"InvalidCallerOrGroup",InvalidUserOrGroup:"InvalidUserOrGroup",Unknown:"Unknown"},a={Active:"Active",Inactive:"Inactive"};var o,d,l;!function(e){e.FailedToFetchRelatedContacts="FailedToFetchRelatedContacts",e.BadRequest="BadRequest",e.InvalidBackendResponse="InvalidBackendResponse",e.CallerIsNotGroupOwner="CallerIsNotGroupOwner",e.Unknown="Unknown"}(o||(o={})),function(e){e.AccessDenied="AccessDenied",e.BadRequest="BadRequest",e.InvalidArgument="InvalidArgument",e.InvalidBackendResponse="InvalidBackendResponse",e.UserProfileNotFound="UserProfileNotFound",e.Unknown="Unknown"}(d||(d={})),function(e){e.Success="Success",e.Pending="Pending",e.IngestionFailed="IngestionFailed"}(l||(l={}))},810602:(e,n,i)=>{"use strict";i.d(n,{I:()=>t});const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activityFeed"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isFirstPage"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filters"}},type:{kind:"NamedType",name:{kind:"Name",value:"ActivityFeedFilterInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"enableAvatarUrlResolutionInActivityFeeds"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activities"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"Argument",name:{kind:"Name",value:"filters"},value:{kind:"Variable",name:{kind:"Name",value:"filters"}},__type:{kind:"NamedType",name:{kind:"Name",value:"ActivityFeedFilterInput"}}},{kind:"Argument",name:{kind:"Name",value:"isFirstPage"},value:{kind:"Variable",name:{kind:"Name",value:"isFirstPage"}},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonActivitiesConnectionFragment"}},{kind:"Field",name:{kind:"Name",value:"activityConsumptionHorizonBookmark"},directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"isFirstPage"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ActivityConsumptionHorizonBookmark"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"activityTimestamp"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"chatTimestamp"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"channelTimestamp"},__type:{kind:"NamedType",name:{kind:"Name",value:"String"}},arguments:[]}]}}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ActivityConsumptionHorizonBookmark"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"upfrontFilter"},directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"isFirstPage"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"unreadOnly"},__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ActivityFeedUpfrontFilter"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"showNotificationSettingsRecommendationCoachmark"},directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"isFirstPage"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]}],__type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"trackingInfo"},directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"isFirstPage"}},__type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalFeedsCountOnBoot"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]},{kind:"Field",name:{kind:"Name",value:"unseenCountOnBell"},__type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ActivityTrackingInfo"}},arguments:[]}]},__type:{kind:"NamedType",name:{kind:"Name",value:"ActivitiesConnection"}}}]}},...i(580779).f.definitions]}},303419:(e,n,i)=>{"use strict";i.d(n,{c:()=>r});const t=(e,n,i)=>{const{scenarioFactory:t}=e;return i?t.findScenarioByNameAndId(n,i):t.findScenario(n)},a=(e,n)=>{try{return JSON.stringify(n)}catch(n){return e.warn("exception occured in getFeedDataBagString"),""}},o=(e,n,i)=>{const{scenarioFactory:t,logger:a}=e,{scenarioId:o,data:d,timeoutMs:l}=i||{},r=t.newScenario(n,{timeoutMs:l});return o&&(r.clientId=o),d&&r.appendEventData(d),a.log(`${n} - scenario started with origin: ${null==d?void 0:d.origin}`),r},d=(e,n,i,a)=>{const{logger:o}=e,d=t(e,n,i.scenarioId);d?d.cancel({message:a}):o.warn(`${n} with Id: ${i.scenarioId} - not found hence not cancelled`)},l=(e,n,i)=>{const t=((e,n,i)=>{let t=i;const o=n.eventData.feedDataBag;if(o){let n={};try{n=JSON.parse(o)}catch(n){e.warn("exception occured in prevFeedDataBagStr to object conversion")}t=Object.assign(Object.assign({},n),t)}return a(e,t)||o})(e,n,i);n.appendEventData({feedDataBag:t})},r={addScenarioDataByNameId:(e,n,i,a)=>{const{logger:o}=e,d=t(e,n,a);d?d.appendEventData(i):o.warn(`No active scenario with ScenarioName: ${n} with Id: ${a}`)},appendFeedDataBag:l,cancelScenarioByNameId:d,cancelExistingAndCreateNewScenario:(e,n,i,t)=>(d(e,n,i,t),o(e,n,i)),findScenario:t,markScenarioStepByNameId:(e,n,i,a,o)=>{const{logger:d}=e,l=t(e,n,i.scenarioId);return l?l.mark(a,i.data,o):d.warn(`${n} with Id: ${i.scenarioId} - not found hence did not mareked step`),l},newScenario:o,startScenario:(e,n,i)=>{var a;const{logger:d}=e;let l=t(e,n,i.scenarioId);return l?d.warn(`${n} - scenario already started with origin: ${null===(a=null==l?void 0:l.eventData)||void 0===a?void 0:a.origin}`):l=o(e,n,i),l},stopScenarioByNameId:(e,n,i,a)=>{const{logger:o}=e,d=t(e,n,i.scenarioId);if(d){const{data:e}=i;d.stop(e,a),o.log(`${n} - scenario stopped with id: ${d.clientId}`)}else o.warn(`No active scenario with ScenarioName: ${n} with Id: ${i.scenarioId}`)},getFeedDataBagString:a,findScenarioAndAppendFeedDataBag:(e,n,i,t)=>{const{logger:a}=e,o=r.findScenario(e,n,t);o?l(a,o,i):a.warn(`${n} with Id: ${t} - not found hence couldn't append feedDataBag`)}}},36593:(e,n,i)=>{"use strict";var t,a;i.d(n,{NN:()=>t,d_:()=>a,GD:()=>o}),function(e){e.Chat="Chat",e.Meetings="Meetings",e.Notifications="notifications",e.GraphApps="GraphApps",e.TeamsAndChannelsCustom="Custom",e.CallGroup="call_group",e.Recommendation="Recommendation"}(t||(t={})),function(e){e.Chat="notification_settings_details_chat_subheader_text",e.Meetings="notification_settings_details_only_meetings_subheader_string",e.TeamsAndChannelsCustom="notification_settings_details_teams_channel_subheader_text"}(a||(a={}));const o="activity-settings"},781015:(e,n,i)=>{"use strict";var t,a,o;i.d(n,{NE:()=>t,iP:()=>a,S_:()=>o,ET:()=>d,B9:()=>l,x4:()=>s,HX:()=>m,oi:()=>c,DO:()=>u,yF:()=>p,ch:()=>y,LI:()=>v,rm:()=>k,rp:()=>g,F4:()=>N}),function(e){e.Any="any",e.Never="never",e.Chat="chat",e.Reply="reply",e.ReplyToReply="replyToReply",e.Like="like",e.Mention="mention",e.TeamMembershipChange="teamMembershipChange",e.AddedToTeam="addedToTeam",e.PromotedToTeamAdmin="promotedToTeamAdmin",e.Download="download",e.Follow="follow",e.CallOrMeetup="callOrMeetup",e.ThirdParty="thirdParty",e.Unread="unread",e.Inferred="inferred",e.MessageSendFailed="messageSendFailed",e.LikeInChat="likeInChat",e.MentionInChat="mentionInChat",e.MentionInCommunity="mentionInCommunity",e.ReactionInCommunity="reactionInCommunity",e.CallTransferFailed="callTransferFailed",e.Call="call",e.MissedCall="missedCall",e.Voicemail="voicemail",e.GroupRenewal="groupRenewal",e.Error="error",e.DesktopNotification="desktopNotification",e.Trending="trending",e.ShareFromChat="shareFromChat",e.PresenceStatus="presenceStatus",e.Priority="priority",e.Reaction="reaction",e.ReactionInChat="reactionInChat",e.TeamsTasks="teamsTasks",e.TeamsEngagementActivity="teamsEngagementActivity",e.DLP="dLP",e.MsGraph="msGraph",e.StaffHub="StaffHub",e.SkypeConsumerCall="SkypeConsumerCall",e.SyntheticNotification="syntheticNotification",e.UserActivity="UserActivity",e.NativeNotificationFre="NativeNotificationFre",e.Recommendation="Recommendation",e.JoinInvite="joinInvite",e.CommunityReply="communityReply",e.CommunityReplyToReply="communityReplyToReply",e.CommunityMention="communityMention",e.CommunityMembership="communityMembership",e.Calendar="calendar",e.ReactionInSubCommunity="reactionInSubCommunity",e.MentionInSubCommunity="mentionInSubCommunity"}(t||(t={})),function(e){e.Everyone="everyone",e.Team="team",e.Person="person",e.AddedToTeam="addedToTeam",e.PromotedToTeamAdmin="promotedToTeamAdmin",e.DownloadStarted="downloadStarted",e.Downloaded="downloaded",e.DownloadFailed="downloadFailed",e.ChannelReplyMessage="channelReplyMessage",e.ChannelNewMessage="channelNewMessage",e.Call="call",e.Meetup="meetup",e.Bot="bot",e.Channel="channel",e.Campaign="campaign",e.MissedCall="missedCall",e.Voicemail="voicemail",e.ThirtyDayNotification="thirtyDayNotification",e.RifteenDayNotification="rifteenDayNotification",e.RenewedNotification="renewedNotification",e.OneOnOneChat="oneOnOneChat",e.GroupChat="groupChat",e.ShareFromChat="shareFromChat",e.Like="like",e.Angry="angry",e.Sad="sad",e.Laugh="laugh",e.Heart="heart",e.Surprised="surprised",e.NotifySender="notifySender",e.PendingSelfJoinRequest="pendingSelfJoinRequest",e.PendingOnBehalfOfJoinRequest="pendingOnBehalfOfJoinRequest",e.NativeNotificationFre="nativeNotificationFre",e.PendingOnBehalfOfJoinRequestMultiple="pendingOnBehalfOfJoinRequestMultiple",e.TaskAssignedToYou="taskAssignedToYou",e.UrgentTaskAssignedToYou="urgentTaskAssignedToYou",e.YourTaskWasUpdated="yourTaskWasUpdated",e.YourTaskChangedToNotStarted="yourTaskChangedToNotStarted",e.YourTaskChangedToInProgress="yourTaskChangedToInProgress",e.YourTaskChangedToCompleted="yourTaskChangedToCompleted",e.YourTaskChangedToBlocked="yourTaskChangedToBlocked",e.YourTaskChangedToRemoved="yourTaskChangedToRemoved",e.YourTaskChangedToNotApplicable="yourTaskChangedToNotApplicable",e.YourTaskWasReassigned="yourTaskWasReassigned",e.YourTaskWasDeleted="yourTaskWasDeleted",e.TaskListPublishedToYourTeam="taskListPublishedToYourTeam",e.TaskListRecalledFromYourTeam="taskListRecalledFromYourTeam",e.YourTaskWasMarkedUrgent="yourTaskWasMarkedUrgent",e.YourTaskWasMarkedNotUrgent="yourTaskWasMarkedNotUrgent",e.UrgentTaskPublishedToYourTeam="urgentTaskPublishedToYourTeam",e.SmsChat="smsChat",e.NewShift="newShift",e.SchedulePublished="schedulePublished",e.NewShiftRequest="newShiftRequest",e.ShiftRequestUpdated="shiftRequestUpdated",e.ShiftUpdated="shiftUpdated",e.MissedMeetingNudge="missedMeetingNudge",e.Tag="tag",e.InviteeJoined="inviteeJoined",e.AddedToSharedChannel="addedToSharedChannel",e.TeamShareTeamOwnerNotify="teamShareTeamOwnerNotify",e.PromotedToSharedChannelOwner="promotedToSharedChannelOwner",e.ChannelOwnerUnshareTeamOwnerNotify="channelOwnerUnshareTeamOwnerNotify",e.TeamOwnerUnshareChannelOwnerNotify="teamOwnerUnshareChannelOwnerNotify",e.HostOwnerUnshareChannelOwnerNotify="hostOwnerUnshareChannelOwnerNotify",e.HostOwnerUnshareTeamOwnerNotify="hostOwnerUnshareTeamOwnerNotify",e.Community="community",e.CommunityJoinInviteCreated="communityJoinInviteCreated",e.CommunityJoinInviteAccepted="communityJoinInviteAccepted",e.CommunityMembershipJoinRequestAccepted="communityMembershipJoinRequestAccepted",e.CommunityMembershipJoinRequestCreated="communityMembershipJoinRequestCreated",e.CommunityMembershipPromotedToAdmin="communityMembershipPromotedToAdmin",e.NewCalendarEvent="newCalendarEvent",e.CalendarEventCanceled="calendarEventCanceled",e.CalendarEventUpdated="calendarEventUpdated",e.InviteeJoinedOne2One="inviteeJoinedOne2One",e.InviteeJoinedGroupChat="inviteeJoinedGroupChat",e.InviteeJoinedCommunity="inviteeJoinedCommunity"}(a||(a={})),function(e){e.Call="call",e.Chat="chat"}(o||(o={}));const d=[t.Reaction,t.TeamMembershipChange,t.Mention,t.Follow,t.Reply,t.ReplyToReply],l=[t.MentionInChat,t.ReactionInChat,t.Priority];var r,s,m,c,u,p;!function(e){e.MobileOnly="mobile",e.DesktopWebOnly="desktopWeb",e.All="all"}(r||(r={})),function(e){e.taco="2a84919f-59d8-4441-a975-2a8c2643b741",e.calendar="ef56c0de-36fc-4ef8-b417-3d82ba9d073c"}(s||(s={})),function(e){e.toggleActivityRead="toggleActivityRead",e.deleteActivityFeedItem="deleteActivityFeedItem",e.removeActivityFeedItem="removeActivityFeedItem",e.channelNotificationSettings="channelNotificationSettings",e.missedCallFeedCallBackAction="missedCallFeedCallBackAction",e.missedCallFeedChatAction="missedCallFeedChatAction",e.notificationSettings="notificationSettings",e.turnOffLikesAndReactions="turnOffLikesAndReactions",e.muteApp="muteApp",e.turnOffChannel="turnOffChannel",e.turnOffAllTeamAndChannelMentions="turnOffAllTeamAndChannelMentions",e.turnOffRepliesFromChannel="turnOffRepliesFromChannel",e.turnOffPostsFromChannel="turnOffPostsFromChannel"}(m||(m={})),function(e){e.notificationSettings="notificationSettings",e.markAllAsRead="markAllAsRead"}(c||(c={})),function(e){e.mentionIcon="iconsMention",e.likeIcon="iconsReactionsLike",e.sadIcon="iconsReactionsSad",e.wowIcon="iconsReactionsWow",e.angryIcon="iconsReactionsAngry",e.heartIcon="iconsReactionsHeart",e.laughIcon="iconsReactionsLaugh",e.missedCallIcon="missedCallIcon",e.voicemailIcon="voicemailIcon",e.urgentIcon="iconsUrgent",e.defaultIcon="iconDefault",e.addedToTeamIcon="addedToTeamIcon",e.promotedToAdminIcon="promotedToAdminIcon",e.communityMentionIcon="communityMentionIcon",e.channelMentionIcon="channelMentionIcon",e.teamMentionIcon="teamMentionIcon",e.followChannelIcon="followChannelIcon",e.replyIcon="replyIcon",e.customIcon="customIcon",e.channelShareIcon="channelShareIcon",e.channelDismissIcon="channelDismissIcon",e.everyoneMentionIcon="everyoneMentionIcon",e.calendar="calendar",e.appIcon="iconsApp"}(u||(u={})),function(e){e.hasText="hasText",e.sentAFile="sentAFile",e.sentAnImage="sentAnImage",e.sentACard="sentACard",e.previewUnavailable="previewUnavailable",e.DLPMessagePreview="dlpMessagePreview"}(p||(p={}));const y=30,v=1e3;var k,g,N;!function(e){e.unread="unread",e.mention="mention",e.reactions="reactions",e.missedcall="missedcall",e.reply="reply",e.apps="apps",e.voicemail="voicemail"}(k||(k={})),function(e){e.states="states",e.types="types"}(g||(g={})),function(e){e.navWithoutEarlyFetch="navWithoutEarlyFetch",e.navOnEarlyFetch="navOnEarlyFetch",e.navOnDifferentMainEntity="navOnDifferentMainEntity",e.noNavOnSameMainEntity="noNavOnSameMainEntity"}(N||(N={}))},653266:(e,n,i)=>{"use strict";var t,a,o;i.d(n,{Nt:()=>t,mL:()=>a,m$:()=>o,FH:()=>d}),function(e){e.DEFAULT="DEFAULT",e.CHANNEL="CHANNEL",e.COMMUNITIES="COMMUNITIES"}(t||(t={})),function(e){e.chat="chatCampaign",e.meeting="meetingCampaign",e.files="filesCampaign",e.contactSyncConfirmation="contactSyncConfirmation",e.communityInvite="communityInviteCampaign"}(a||(a={})),function(e){e.channel="channel",e.chat="chat",e.communities="communities",e.communitiesJoinInviteView="communitiesJoinInviteView",e.communitiesJoinRequestsView="communitiesJoinRequestsView",e.communitiesMembersView="communitiesMembersView",e.communitiesCalendarEvent="communitiesCalendarEvent",e.syntheticNotificationCampaign="syntheticNotificationCampaign",e.joinInviteActivity="joinInviteActivity",e.teamPendingJoinRequest="teamPendingJoinRequest",e.manageTeamChannels="manageTeamChannels",e.manageChannelMembers="manageChannelMembers",e.msGraph="msGraph",e.calls="calls",e.communitiesL1View="communitiesL1View",e.onboardedToTeam="onboardedToTeam",e.generic="generic"}(o||(o={}));const d={teamAvatar:"teamAvatar",staticImage:"staticImage",imageUrl:"imageUrl",default:"default"}},665388:(e,n,i)=>{"use strict";var t;i.d(n,{N:()=>t}),function(e){e.UNIFIED_CALENDAR_SYNCING="UNIFIED_CALENDAR_SYNCING",e.UNIFIED_CALENDAR_SYNC_FAILED="UNIFIED_CALENDAR_SYNC_FAILED",e.UNIFIED_CALENDAR_UPTO_DATE="UNIFIED_CALENDAR_UPTO_DATE",e.EMPTY="EMPTY"}(t||(t={}))},345830:(e,n,i)=>{"use strict";i.d(n,{H:()=>t});const t={On:"On",Off:"Off",BannerAndFeed:"BannerAndFeed",OnlyFeed:"OnlyFeed",OnlyBanner:"OnlyBanner",All:"All",CallMentionChats:"CallMentionChats",Immediately:"Immediately",Every10Mins:"Every10Mins",Hourly:"Hourly",EveryEightHours:"EveryEightHours",Daily:"Daily",Never:"Never",AllActivity:"AllActivity",MyAtMentions:"MyAtMentions",Custom:"Custom",Feed:"Feed",Ring:"Ring",Banner:"Banner",Mute:"Mute",MuteChat:"MuteChat",Unmute:"Unmute",MuteUntilJoin:"MuteUntilJoin",Purple:"Purple",Native:"Native"}},410770:(e,n,i)=>{"use strict";i.d(n,{f5:()=>t,PJ:()=>a,QD:()=>o});const t="most-recent",a="first",o="last"},660378:(e,n,i)=>{"use strict";var t,a,o,d,l,r,s,m,c,u;i.d(n,{tq:()=>t,dt:()=>a,S1:()=>o,A$:()=>d,p6:()=>l,G5:()=>r,oY:()=>m}),function(e){e.toastFromWeb="toastFromWeb",e.toastFromHost="toastFromHost"}(t||(t={})),function(e){e.calls="calls",e.chats="chats",e.toasts="toasts",e.signout="signout",e.extensions="extensions",e.reminders="reminders",e.channels="channels",e.activity="activity",e.campaignnotifications="campaignnotifications",e.communities="communities",e.callingdeeplink="callingdeeplink",e.communitiesevents="communitiesevents",e.settingsstore="settingsstore",e.communitiesjoinrequest="communitiesjoinrequest",e.communitiesmembers="communitiesmembers"}(a||(a={})),function(e){e.hide="hide",e.show="show"}(o||(o={})),function(e){e.mutate="mutate",e.view="view",e.list="list",e.join="join"}(d||(d={})),function(e){e.success="success",e.critical="critical"}(l||(l={})),function(e){e.start="start",e.quit="quit",e.restart="restart"}(r||(r={})),function(e){e.airgap08="airgap08",e.prod="prod",e.life="life",e.dod="dod",e.gcch="gcch",e.gallatin="gallatin",e.airgap09="airgap09"}(s||(s={})),function(e){e.available="available",e.busy="busy",e.doNotDisturb="doNotDisturb",e.beRightBack="beRightBack",e.away="away",e.offLine="offLine",e.resetAvailability="resetAvailability"}(m||(m={})),function(e){e.Accepted="Accepted",e.Tentative="Tentative",e.Declined="Declined",e.NotResponded="NotResponded"}(c||(c={})),function(e){e.inProc="inProc",e.outOfProc="outOfProc"}(u||(u={}))},750682:(e,n,i)=>{"use strict";var t,a,o,d,l;i.d(n,{mG:()=>t,lX:()=>a,ZD:()=>o}),function(e){e.DisabledByGroupPolicy="DisabledByGroupPolicy",e.DisabledByManifest="DisabledByManifest",e.DisabledForApplication="DisabledForApplication",e.DisabledForUser="DisabledForUser",e.Enabled="Enabled"}(t||(t={})),function(e){e.AlarmsOnly="AlarmsOnly",e.Off="Off",e.PriorityOnly="PriorityOnly"}(a||(a={})),function(e){e.Unrestricted="Unrestricted",e.PriorityOnly="PriorityOnly",e.AlarmsOnly="AlarmsOnly"}(o||(o={})),function(e){e.UserCancelled="UserCancelled",e.ApplicationHidden="ApplicationHidden",e.TimedOut="TimedOut",e.FocusAssist="FocusAssist"}(d||(d={})),function(e){e.Unknown="Unknown",e.NotificationDisabled="NotificationDisabled",e.NotificationTypeDisabled="NotificationTypeDisabled"}(l||(l={}))},897564:(e,n,i)=>{"use strict";var t,a;i.d(n,{a:()=>t,D:()=>a}),function(e){e.PresenceUnknown="PresenceUnknown",e.Available="Available",e.AvailableIdle="AvailableIdle",e.Away="Away",e.Busy="Busy",e.BusyIdle="BusyIdle",e.DoNotDisturb="DoNotDisturb",e.BeRightBack="BeRightBack",e.Offline="Offline"}(t||(t={})),function(e){e.call="call",e.mention="mention",e.chat="chat",e.channel="channel",e.other="other"}(a||(a={}))},898293:(e,n,i)=>{"use strict";i.d(n,{L5:()=>d,MO:()=>l,Dj:()=>r});var t=i(740597),a=i(321748),o=i(271721);const d=(e,n,i,d)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,l;try{const o=yield null==n?void 0:n.getUser();if(!(e&&(null===(t=null==o?void 0:o.profile)||void 0===t?void 0:t.tid)&&(null===(l=null==o?void 0:o.profile)||void 0===l?void 0:l.oid)&&i))throw new Error("missing required parameters");const{databaseName:r,versionNumber:m,objectStoreName:c,objectStoreKey:u}=s(e,o.profile.tid,o.profile.oid),p=JSON.stringify(i).length;if(p>12500)throw new Error(`cart size is ${p} bytes, maximum: 12500`);yield(0,a.Zl)(r,m,c,u,[i],d)}catch(e){throw(0,o.HV)(d,"writeMarketplaceCartToLocalDB").fail({error:"failed to write marketplace cart in cache"}),new Error(`failed to write marketplace cart in cache, ${e.message}`)}})),l=(e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,d;try{const o=yield null==n?void 0:n.getUser();if(!e||!(null===(t=null==o?void 0:o.profile)||void 0===t?void 0:t.tid)||!(null===(d=null==o?void 0:o.profile)||void 0===d?void 0:d.oid))throw new Error("missing required parameters");const{databaseName:l,versionNumber:r,objectStoreName:m,objectStoreKey:c}=s(e,o.profile.tid,o.profile.oid);return yield(0,a.q8)(l,r,m,c,i,!0)}catch(e){throw(0,o.HV)(i,"readMarketplaceCartFromLocalDB").fail({error:"failed to read marketplace cart in cache"}),new Error(`failed to read marketplace cart in cache, ${e.message}`)}})),r=(e,n,i)=>(0,t.__awaiter)(void 0,void 0,void 0,(function*(){var t,d;try{const o=yield null==n?void 0:n.getUser();if(!e||!(null===(t=null==o?void 0:o.profile)||void 0===t?void 0:t.tid)||!(null===(d=null==o?void 0:o.profile)||void 0===d?void 0:d.oid))throw new Error("missing required parameters");const{databaseName:l,versionNumber:r,objectStoreName:m,objectStoreKey:c}=s(e,o.profile.tid,o.profile.oid);return void(yield(0,a.dR)(l,r,m,c,i))}catch(e){throw(0,o.HV)(i,"clearMarketplaceCartInLocalDB").fail({error:"failed to clear marketplace cart in cache"}),new Error(`failed to clear marketplace cart in cache, ${e.message}`)}})),s=(e,n,i)=>({databaseName:`marketplace-cart:${n}:${i}`,versionNumber:1,objectStoreName:`app:${e}`,objectStoreKey:"cartInfo.market"})},708702:(e,n,i)=>{"use strict";i.d(n,{o:()=>o,O:()=>l});var t=i(50805);const a="MicrosoftTeams",o=e=>{var n,i;const t=null===(i=(n=e.event).data)||void 0===i?void 0:i.call(n);if(t){const n=d(e),i=t.telemetryItem;return Object.assign(Object.assign({},i),{data:Object.assign(Object.assign({},i.data),n)})}return null},d=({coreSettings:e,sessionStartGesture:n,client:i})=>{var o,d,l,r,s;const{clientVersion:m}=e.get(t.J.Platform),{ring:c,environment:u}=e.get(t.J.Metadata),{clientType:p}=e.get(t.J.People),y=p||a,v=null===(d=null===(o=null==i?void 0:i.ctx)||void 0===o?void 0:o.authenticationUser)||void 0===d?void 0:d.profile;return{hostApp:p||a,hostAppRing:(null==c?void 0:c.id)||"",hostAppVersion:null!=m?m:"",complianceEnvironment:null!=u?u:"",sessionStartGesture:n,clientType:y,userId:null!==(l=null==v?void 0:v.objectId)&&void 0!==l?l:"",tenantId:null!==(r=null==v?void 0:v.tenantId)&&void 0!==r?r:"",puid:null!==(s=null==v?void 0:v.puid)&&void 0!==s?s:""}},l=e=>{const{environment:n}=e.get(t.J.Metadata);switch(null==n?void 0:n.toLowerCase()){case"life":case"prod":return"Prod";case"gcc":return"GccModerate";case"gcchigh":return"GccHigh";case"dod":return"DoD";case"gallatin":return"Gallatin";case"ag08":return"AG08";case"ag09":return"AG09";default:return null}}},800611:(e,n,i)=>{"use strict";i.d(n,{W:()=>o});var t=i(781662),a=i(708702);class o{static associateIngestionKeyWithAppName(e,n,i){o.ingestionKeys.set(n,e),i&&o.middlewaresMap.set(n,i),(0,t.G)().initializeSecondPartyLogger(n,e)}static associateIngestionKeyWithAppNameIfNecessary(e,n,i){o.isAssociated(n)||o.associateIngestionKeyWithAppName(e,n,i)}static isAssociated(e){return o.ingestionKeys.has(e)}static logEvent(e){var n,i;const d=null===(i=(n=e.event).data)||void 0===i?void 0:i.call(n).appName,l=(0,a.o)(e);if(d&&l){const e=o.executeMiddleware(d,l);(0,t.G)().logSecondPartyEvent(d,e)}}static executeMiddleware(e,n){const i=o.middlewaresMap.get(e);return i?i.reduce(((e,n)=>n(e)),n):n}}o.ingestionKeys=new Map,o.middlewaresMap=new Map},91074:(e,n,i)=>{"use strict";i.d(n,{a:()=>d});var t=i(740597),a=i(50805),o=i(342097);class d{constructor(e,n,i){this.coreSettings=n,this.hostCommunicationService=i,this.getBadge=e=>({icon:{countBadge:{value:e}}}),this.logger=e.newLogger(o.d5,"services-io-taskbar")}showBadge(e){var n,i;return(0,t.__awaiter)(this,void 0,void 0,(function*(){if(!this.enableTaskbarBadgeMaglev)return void this.logger.log(o.vc.NotEnabled);const t=yield this.hostCommunicationService.loadModule("taskbar");if(t){if(t.showBadge)return this.logger.log(`${o.Bd.ModuleLoaded} with count badge: ${null===(i=null===(n=e.icon)||void 0===n?void 0:n.countBadge)||void 0===i?void 0:i.value}`),t.showBadge(e);this.logger.log(o.vc.MethodNotAvailable)}else this.logger.error(o.vc.ModuleUnableToLoad)}))}showBadgeCount(e){return(0,t.__awaiter)(this,void 0,void 0,(function*(){return this.showBadge(this.getBadge(e))}))}resetBadge(){return(0,t.__awaiter)(this,void 0,void 0,(function*(){return this.showBadgeCount(0)}))}get enableTaskbarBadgeMaglev(){return!!this.coreSettings.get(a.J.Core).enableTaskbarBadgeMaglev}}},706798:(e,n,i)=>{"use strict";i.d(n,{b:()=>l});var t=i(740597);const a="ModuleLoaded",o="Focus Assist not available on module.",d="HostComms is unable to load toast toasts module. Bailing out.";class l{constructor(e,n){this.hostCommunicationService=n,this.logger=e.newLogger("ToastSettingsService","services-io-toast-settings")}getFocusAssistStateAsync(){var e,n,i,l;return(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("toasts");if(t){if(t.getFocusAssistStateAsync)return this.logger.log(a),t.getFocusAssistStateAsync();null===(l=(i=this.logger).errorToTelemetry)||void 0===l||l.call(i,o,"toast_service_settings_warn_user_notice")}else null===(n=(e=this.logger).errorToTelemetry)||void 0===n||n.call(e,d,"toast_service_settings_warn_user_notice")}))}getGlobalNotificationSettingsAsync(e){var n,i,l,r;return(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("toasts");if(t){if(t.getGlobalNotificationSettingsAsync)return this.logger.log(a),e?t.getGlobalNotificationSettingsAsync(e):t.getGlobalNotificationSettingsAsync();null===(r=(l=this.logger).errorToTelemetry)||void 0===r||r.call(l,o,"toast_service_settings_warn_user_notice")}else null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,d,"toast_service_settings_warn_user_notice")}))}registerForToastDismissed(e){var n,i,a,l;return(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("toasts");t?t.registerForToastDismissed?t.registerForToastDismissed(e):null===(l=(a=this.logger).errorToTelemetry)||void 0===l||l.call(a,o,"toast_service_settings_warn_user_notice"):null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,d,"toast_service_settings_warn_user_notice")}))}registerForNotificationModeChanged(e){var n,i,a,l;return(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("toasts");t?t.registerForNotificationModeChanged?t.registerForNotificationModeChanged(e):null===(l=(a=this.logger).errorToTelemetry)||void 0===l||l.call(a,o,"toast_service_settings_warn_user_notice"):null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,d,"toast_service_settings_warn_user_notice")}))}registerForFocusSessionChanged(e){var n,i,a,l;return(0,t.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.hostCommunicationService.loadModule("toasts");t?t.registerForFocusSessionChanged?t.registerForFocusSessionChanged(e):null===(l=(a=this.logger).errorToTelemetry)||void 0===l||l.call(a,o,"toast_service_settings_warn_user_notice"):null===(i=(n=this.logger).errorToTelemetry)||void 0===i||i.call(n,d,"toast_service_settings_warn_user_notice")}))}}},734625:(e,n,i)=>{"use strict";i.d(n,{hA:()=>_,w2:()=>S,KD:()=>T,a:()=>b,$O:()=>C,jo:()=>w,Pg:()=>I,Q3:()=>A,fY:()=>M,DP:()=>P,Ky:()=>R,yf:()=>O});var t=i(740597),a=i(558632);const o="asm.skype.com",d="api.ams.gcc.teams.microsoft.com",l="urlp.ams.gcc.teams.microsoft.com",r="api.ams.gov.teams.microsoft.us",s="api.ams.dod.teams.microsoft.us",m="api.asyncgw.teams.microsoft.scloud",c="api.asyncgw.teams.microsoftonline.cn",u="api.asyncgw.teams.eaglex.ic.gov",p="asyncgw.teams.microsoft.com",y="/v1/objects",v="/views/video",k="/ams",g="teams.microsoft.com",N=/^\/asm\/[a-z]+/i,h=/^\/asm\/[a-z]+\/v1\/objects/i,f=/v1\/objects\/([^/]{1,300})/i;var _,S;function T(e){if(e&&C(e)){const n=e.match(f);return n&&n[1]||""}return""}function b(e){const n=(0,a.Lp)(e).toLowerCase(),i=(0,a.DW)(e);return n.endsWith(o)||n===d||n===r||n===s||n===m||n===c||n===u||n===l||n.endsWith(p)||n===g&&N.test(i)}function C(e){if(P(e))return!0;const n=(0,a.DW)(e);return b(e)&&(n.startsWith(y)||h.test(n))}function w(e){if(!e)return!1;const n=(0,a.DW)(e);return!(!P(e)||!n.endsWith(v))||b(e)&&n.endsWith(v)}function I(e){return w(e)?S.Video:C(e)?S.Image:S.None}function A(e){var n;return(0,t.__awaiter)(this,void 0,void 0,(function*(){const i=e instanceof Blob?new Uint8Array(yield null===(n=e.arrayBuffer)||void 0===n?void 0:n.call(e)):e;if(!i||i.length<6)return!1;if(71!==i[0]||73!==i[1]||70!==i[2])return function(e){if(!e)return!1;let n=-1,i=-1;for(let t=0;t<e.length-4;t++)if(97===e[t]&&99===e[t+1]&&84===e[t+2]&&76===e[t+3]&&(i=t),73===e[t]&&68===e[t+1]&&65===e[t+2]&&84===e[t+3]){n=t;break}return i>=0&&n>i}(i);let t=0;for(let e=0;e<i.length-9&&!(F(i,e)&&(D(i,e+8)||E(i,e+8))&&(t++,t>1));e++);return t>1}))}function F(e,n){return 33===e[n]&&249===e[n+1]&&4===e[n+2]}function D(e,n){return 44===e[n]}function E(e,n){return 33===e[n]&&255===e[n+1]&&11===e[n+2]}function M(e,n){if(!e||!C(e)||!n||e.startsWith(n))return e;return[n,new URL(e).pathname.substring(1)].join("")}function P(e){return(0,a.DW)(e).toLowerCase().startsWith(k+y)}function R(e){return e>20971520}function O(e){if(!e||"image/*"===e)return"";const n=e.match(/^image\/([^*]+)$/);return n?n[1]:e}!function(e){e[e.IMAGE_SIZE_TOO_LARGE=10001]="IMAGE_SIZE_TOO_LARGE",e[e.UNSUPPORTED_IMAGE_FORMAT=10002]="UNSUPPORTED_IMAGE_FORMAT"}(_||(_={})),function(e){e.None="None",e.Image="Image",e.Video="Video"}(S||(S={}))},403084:(e,n,i)=>{"use strict";i.d(n,{u:()=>s,F9:()=>m,OU:()=>c,ld:()=>p,cv:()=>y,Tu:()=>v});var t=i(740597),a=i(186921),o=i(928665),d=i(210158),l=i(176843);class r{constructor(e,n,i){this._scenarioProvider=e,this._asyncAuthCache=n,this._telemetryService=i,this.create=e=>this._createScenario(e,!0),this.createNew=e=>{var n;const i=new d.q(this._scenarioProvider,e.correlation,this._asyncAuthCache,e.subContext,!0,null!==(n=e.isBatch)&&void 0!==n&&n,e.timeoutMs,this._telemetryService);return e.scenarioEventData&&i.appendScenarioEventData(e.scenarioEventData),i},this.createWithoutScenario=e=>this._createScenario(e,!1),this.getCorrelation=e=>l.n.getCorrelation(e)||[],this._createScenario=(e,n)=>{var i,t;const{correlation:a,subContext:o,scenarioEventData:r,timeoutMs:s,scenario:m,isBatch:c}=e;let u=l.n.getAuthTelemetry(a.id);if(u)u.addEventData([`fn:${o}`]);else{const r=null===(i=this._telemetryService)||void 0===i?void 0:i.getTelemetryServicesCache().get(null===(t=e.scenarioEventData)||void 0===t?void 0:t.accountId);u=new d.q((null==r?void 0:r.coreScenarioFactory)||this._scenarioProvider,a,this._asyncAuthCache,o,n,null!=c&&c,s,(null==r?void 0:r.telemetryService)||this._telemetryService,m),l.n.setAuthTelemetry(a.id,u)}return r&&u.appendScenarioEventData(r),l.n.setCorrelation(a),u}}}const s=(e,n)=>{l.n.setUserBiService(e||"GLOBAL",n)},m=e=>u(Object.assign(Object.assign({},e),{startWithoutScenario:!1})),c=e=>{var n,i,a,d,l,r;e.options.correlation={id:null!==(i=null===(n=e.options.correlation)||void 0===n?void 0:n.id)&&void 0!==i?i:(0,o.pW)(),scenarioName:null!==(d=null===(a=e.options.correlation)||void 0===a?void 0:a.scenarioName)&&void 0!==d?d:e.scenarioName,source:null!==(r=null===(l=e.options.correlation)||void 0===l?void 0:l.source)&&void 0!==r?r:e.source};const{options:{correlation:s}}=e,m=(0,t.__rest)(e,["options"]);return u(Object.assign({correlation:s},m))},u=e=>{const{correlation:n,subContext:i,scenarioEventData:t,eventData:a,timeoutMs:o,scenario:d,isBatch:r}=e,s=l.n.getAuthTelemetry(n.id),m=(e.startWithoutScenario||!n.scenarioName?y.createWithoutScenario:y.create)({correlation:n,subContext:i,scenarioEventData:t,timeoutMs:o,scenario:d,isBatch:r});a&&m.addEventData(a);return[m,(e,n,i)=>m.closeScenario(e,n,!!s,i)]},p=e=>y.getCorrelation(e);let y;const v=(e,n,i)=>{y||(y=new r(e,n,i),a.q.log("authTelemetryProvider initialized"))}},100329:(e,n,i)=>{"use strict";i.d(n,{N2:()=>o,$l:()=>d,Ej:()=>l});var t=i(466094),a=i(50805);function o(e,n,i){return d(e)&&((null==e?void 0:e.role)===t.w4.Anonymous||!l(n,i))}function d(e){return!!(null==e?void 0:e.isAuthenticated)}function l(e,n){const{enableTflFreProfileConsentDialog:i}=e.get(a.J.Fre);return!(!i||n&&"true"===n.get("TflFreProfileCardDisplayed"))}},671168:(e,n,i)=>{"use strict";i.d(n,{Hk:()=>d,Rd:()=>l,By:()=>r});var t=i(740597);const a=200;function o(e,n){if(!e.startsWith("blob"))return Promise.reject("invalid blob url");const i=new XMLHttpRequest;return i.open("GET",e,!0),i.responseType=n,new Promise(((e,n)=>{i.onload=()=>{i.status===a&&i.response?e(i.response):n(i.status!==a?{status:i.status,statusText:i.statusText}:{status:404,statusText:"no response data"})},i.onerror=()=>{n({status:i.status,statusText:i.statusText})},i.send()}))}function d(e){return(0,t.__awaiter)(this,void 0,void 0,(function*(){return yield o(e,"blob")}))}function l(e){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const n=yield o(e,"arraybuffer");return new Uint8Array(n)}))}function r(e){return(0,t.__awaiter)(this,void 0,void 0,(function*(){return e.then((e=>URL.createObjectURL(e)))}))}},917556:(e,n,i)=>{"use strict";i.d(n,{E:()=>a,Y:()=>o});const t=({osName:e,osVersion:n})=>{var i;if((null===(i=null==e?void 0:e.toLowerCase())||void 0===i?void 0:i.includes("windows"))&&n)try{const e=n.match(/^(\d+)\.(\d+)\.(\d+)$/),i=4,t=1,a=2,o=3;if(e&&e.length===i){const n=parseInt(e[t],10),i=parseInt(e[a],10);return{majorVersion:n,minorVersion:i,revision:parseInt(e[o],10)}}}catch(e){}},a=({osName:e,osVersion:n})=>{const i=t({osName:e,osVersion:n});return void 0!==i&&(i.majorVersion>=10&&i.minorVersion>=0&&i.revision>=22e3)},o=({osName:e,osVersion:n})=>{const i=t({osName:e,osVersion:n});return void 0!==i&&(10===i.majorVersion&&0===i.minorVersion&&i.revision<22e3&&i.revision>=10240)}},271721:(e,n,i)=>{"use strict";i.d(n,{HV:()=>o,jC:()=>d});var t=i(663945),a=i(738646);const o=(e,n,i=!1)=>{let t=null;return i||(t=e.findScenario(a.RG.MarketplaceDeviceStoreCartControl)),t||(t=e.newScenario(a.RG.MarketplaceDeviceStoreCartControl,{startTime:(new Date).getTime()}),t.appendEventData({startScope:n}),i||t.appendEventData({scenarioNotFound:!0})),t},d=(e,n,i)=>{const a=i(),{totalPrice:o,totalQuantity:d}=(e=>{let n=0,i=0;return null==e||e.cartItems.forEach((e=>{(null==e?void 0:e.price)&&(null==e?void 0:e.quantity)&&(n+=e.price*e.quantity,i+=e.quantity)})),{totalPrice:n,totalQuantity:i}})(e);a.orderTotalPrice=o,a.orderTotalQuantity=d;n({actionScenario:t.Tk.storeCheckoutClick,actionScenarioType:t.Yu.store,moduleName:t.rA.storeCheckoutButton,moduleType:t.PO.button,actionGesture:t.uS.click,actionOutcome:t.$K.completeCheckout,panelRegion:t.Ai.modal,panelType:t.wh.DeviceStoreCart,extensibilityData:void 0,dataBag:a}),a.dispose()}},375823:(e,n,i)=>{"use strict";i.d(n,{tC:()=>o,Mv:()=>d,RQ:()=>l,kl:()=>r,ev:()=>s});var t=i(74583);const a=1024;function o(e){const n={},i=[...e];return y(n,"TelemetryWorker",h(i,"TelemetryWorker")),y(n,"CDLWorker",h(i,"CDLWorker")),y(n,"ServiceWorker",h(i,"ServiceWorker")),n.Perf_Total_NumberOfCDLWorkers=N(e,"CDLWorker"),n.Perf_Total_NumberOfServiceWorkers=N(e,"ServiceWorker"),n.Perf_Total_NumberOfTelemetryWorkers=N(e,"TelemetryWorker"),n.Perf_Total_NumberOfWorkers=e.length,n}function d(e,n,i){const t={},a=[...e];v(t,"GPU",g(a,["gpu-process","Gpu"]),n),v(t,"NativeShell",g(a,["nativeShell","NativeShell"]),n),v(t,"CrashpadHandler",g(a,"crashpad-handler"),n),v(t,"Browser",g(a,["browser","Browser"]),n);const o=g(a,["renderer","Renderer"]);t.Perf_Renderer_Count_Processes=o.length,v(t,"Renderer",o,n),v(t,"SlimCore",g(a,["NativeModuleProcess_SlimCore"]),n);const d=g(a,["utility","Utility"]);if(v(t,"Utility",d,n),t.Perf_Utility_Process=[...d],v(t,"Total",e),t.Perf_Total_NumberOfProcesses=e.length,t.Perf_Unknown_Process=a,t.Perf_Unknown_NumberOfProcesses=a.length,t.Perf_Unknown_WorkingSet=c(a),t.Perf_Unknown_PrivateWorkingSet=u(a),t.Perf_Unknown_CommitSize=p(a),i){const a=e.find((e=>e.processId===i));a&&(t.Perf_MainRenderer_WorkingSet=c([a]),t.Perf_MainRenderer_PrivateWorkingSet=u([a]),t.Perf_MainRenderer_CommitSize=p([a]),t.Perf_MainRenderer_PeakWorkingSet=null==n?void 0:n.get(i))}return t}function l(e,n){const i={},{totalJSHeapSize:t,jsHeapSizeLimit:a,usedJSHeapSize:o}=e;return t&&(i.Perf_JSHeap_TotalSize=t),a&&(i.Perf_JSHeap_LimitSize=a),o&&(i.Perf_JSHeap_UsedSize=o),n&&(i.Perf_Peak_UsedJSHeapSize=n),i}function r(e){return"number"!=typeof e||isNaN(e)?void 0:Math.round(e/a)}const s=r;function m(e,n){const i=(0,t.sumBy)(e,(e=>{var i;return null!==(i=e[n])&&void 0!==i?i:NaN}));return 0===e.length||isNaN(i)?void 0:i}function c(e){return m(e,"workingSetSizeKB")}function u(e){return m(e,"privateWorkingSetSizeKB")}function p(e){return m(e,"commitSizeKB")}function y(e,n,i){e[`Perf_${n}_UsedSize`]=function(e){return m(e,"usedSizeKB")}(i),e[`Perf_${n}_TotalSize`]=function(e){return m(e,"totalSizeKB")}(i)}function v(e,n,i,t){if(e[`Perf_${n}_WorkingSet`]=c(i),e[`Perf_${n}_PrivateWorkingSet`]=u(i),e[`Perf_${n}_CommitSize`]=p(i),"Total"===n)e.Perf_Total_NumberOfProcesses=i.length;else{if(e[`Perf_${n}_Count_Processes`]=i.length,!t||!i.length)return;const a=Math.max(...i.map((e=>t.get(e.processId)||0)));a&&(e[`Perf_${n}_PeakWorkingSet`]=a)}}function k(e,n){let i;const t=[];for(;i=e.findIndex(n),-1!==i;)t.push(e.splice(i,1)[0]);return t}function g(e,n){const i="string"==typeof n?[n]:n;return k(e,(e=>i.includes(e.type)))}const N=(e,n)=>e.filter((e=>e.subType===n)).length;function h(e,n){return k(e,(e=>e.subType.includes(n)))}},381721:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjUiIGN5PSIyNSIgcj0iMjUiIGZpbGw9IiNENkQ2RDYiLz4KPHBhdGggZD0iTTI1Ljk5OTMgMzBDMjUuOTk5MyAyOS40NDg0IDI1LjU1MjIgMjkuMDAxMyAyNS4wMDA2IDI5LjAwMTNDMjQuNDQ5MSAyOS4wMDEzIDI0LjAwMiAyOS40NDg0IDI0LjAwMiAzMEMyNC4wMDIgMzAuNTUxNSAyNC40NDkxIDMwLjk5ODYgMjUuMDAwNiAzMC45OTg2QzI1LjU1MjIgMzAuOTk4NiAyNS45OTkzIDMwLjU1MTUgMjUuOTk5MyAzMFpNMjUuNzQwMSAyMi4xNDY3QzI1LjY5MDEgMjEuNzgwNyAyNS4zNzYxIDIxLjQ5ODggMjQuOTk2NCAyMS40OTkxQzI0LjU4MjIgMjEuNDk5NCAyNC4yNDY3IDIxLjgzNTQgMjQuMjQ3IDIyLjI0OTdMMjQuMjUwNiAyNi43NTEzTDI0LjI1NzUgMjYuODUzQzI0LjMwNzUgMjcuMjE5MSAyNC42MjE1IDI3LjUwMSAyNS4wMDEyIDI3LjUwMDdDMjUuNDE1NCAyNy41MDAzIDI1Ljc1MDkgMjcuMTY0MyAyNS43NTA2IDI2Ljc1MDFMMjUuNzQ3IDIyLjI0ODVMMjUuNzQwMSAyMi4xNDY3Wk0yNi45NjkzIDE2LjY1ODlDMjYuMTEzIDE1LjExMTEgMjMuODg3OCAxNS4xMTExIDIzLjAzMTYgMTYuNjU4OUwxNS4yODYzIDMwLjY2MDRDMTQuNDU2OCAzMi4xNiAxNS41NDE0IDMzLjk5OTUgMTcuMjU1MiAzMy45OTk1SDMyLjc0NjJDMzQuNDYgMzMuOTk5NSAzNS41NDQ2IDMyLjE2IDM0LjcxNSAzMC42NjAzTDI2Ljk2OTMgMTYuNjU4OVpNMjQuMzQ0MiAxNy4zODVDMjQuNjI5NiAxNi44NjkxIDI1LjM3MTMgMTYuODY5MSAyNS42NTY3IDE3LjM4NUwzMy40MDI1IDMxLjM4NjVDMzMuNjc5IDMxLjg4NjMgMzMuMzE3NSAzMi40OTk1IDMyLjc0NjIgMzIuNDk5NUgxNy4yNTUyQzE2LjY4MzkgMzIuNDk5NSAxNi4zMjI0IDMxLjg4NjMgMTYuNTk4OSAzMS4zODY1TDI0LjM0NDIgMTcuMzg1WiIgZmlsbD0iIzMzMzMzMyIvPgo8L3N2Zz4K"},383657:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjUiIGN5PSIyNSIgcj0iMjUiIGZpbGw9IiNENkQ2RDYiLz4KPHBhdGggZD0iTTIxLjIwNjkgMTdDMjEuNjY3NSAxNyAyMi4xMTUzIDE3LjE0MTMgMjIuNDkwOSAxNy40MDIzTDIyLjY0NzMgMTcuNTIxNUwyNS4wMjIgMTkuNUgzMi43NUMzMy44ODY3IDE5LjUgMzQuODI2NiAyMC4zNDMgMzQuOTc4NSAyMS40Mzc5TDM0Ljk5NDggMjEuNTk2TDM1IDIxLjc1VjMwLjc1QzM1IDMxLjk0MDkgMzQuMDc0OCAzMi45MTU2IDMyLjkwNCAzMi45OTQ4TDMyLjc1IDMzSDE3LjI1QzE2LjA1OTEgMzMgMTUuMDg0NCAzMi4wNzQ4IDE1LjAwNTIgMzAuOTA0TDE1IDMwLjc1VjE5LjI1QzE1IDE4LjA1OTEgMTUuOTI1MiAxNy4wODQ0IDE3LjA5NiAxNy4wMDUyTDE3LjI1IDE3SDIxLjIwNjlaTTIyLjY0NzMgMjIuOTc4NUMyMi4yOTM1IDIzLjI3MzMgMjEuODU5MSAyMy40NTE1IDIxLjQwMzQgMjMuNDkxNEwyMS4yMDY5IDIzLjVMMTYuNSAyMy40OTlWMzAuNzVDMTYuNSAzMS4xMjk3IDE2Ljc4MjIgMzEuNDQzNSAxNy4xNDgyIDMxLjQ5MzJMMTcuMjUgMzEuNUgzMi43NUMzMy4xMjk3IDMxLjUgMzMuNDQzNSAzMS4yMTc4IDMzLjQ5MzIgMzAuODUxOEwzMy41IDMwLjc1VjIxLjc1QzMzLjUgMjEuMzcwMyAzMy4yMTc4IDIxLjA1NjUgMzIuODUxOCAyMS4wMDY4TDMyLjc1IDIxSDI1LjAyMUwyMi42NDczIDIyLjk3ODVaTTIxLjIwNjkgMTguNUgxNy4yNUMxNi44NzAzIDE4LjUgMTYuNTU2NSAxOC43ODIyIDE2LjUwNjggMTkuMTQ4MkwxNi41IDE5LjI1VjIxLjk5OUwyMS4yMDY5IDIyQzIxLjM0NzMgMjIgMjEuNDg0MSAyMS45NjA2IDIxLjYwMjIgMjEuODg3NEwyMS42ODcxIDIxLjgyNjJMMjMuNTc4IDIwLjI0OUwyMS42ODcxIDE4LjY3MzhDMjEuNTc5MiAxOC41ODQgMjEuNDQ4OSAxOC41MjY2IDIxLjMxMTMgMTguNTA3M0wyMS4yMDY5IDE4LjVaIiBmaWxsPSIjMzMzMzMzIi8+Cjwvc3ZnPgo="},285474:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjUiIGN5PSIyNSIgcj0iMjUiIGZpbGw9IiNENkQ2RDYiLz4KPHBhdGggZD0iTTMxLjc0OTggMzMuNDk1MUMzMi4xNjQgMzMuNDk0OSAzMi41IDMzLjgzMDYgMzIuNSAzNC4yNDQ4QzMyLjUgMzQuNjU5IDMyLjE2NDQgMzQuOTk0OSAzMS43NTAyIDM0Ljk5NTFMMTguNzUwMiAzNC45OTg4QzE4LjMzNiAzNC45OTg5IDE4IDM0LjY2MzIgMTggMzQuMjQ5QzE4IDMzLjgzNDggMTguMzM1NiAzMy40OTg5IDE4Ljc0OTggMzMuNDk4OEwzMS43NDk4IDMzLjQ5NTFaTTI1LjE0ODIgMTUuMDA2OEwyNS4yNSAxNUMyNS42Mjk3IDE1IDI1Ljk0MzUgMTUuMjgyMiAyNS45OTMyIDE1LjY0ODJMMjYgMTUuNzVMMjUuOTk5IDI5LjQzNUwyOS43MjA4IDI1LjcxNDdDMjkuOTg3MSAyNS40NDg0IDMwLjQwMzggMjUuNDI0MyAzMC42OTc0IDI1LjY0MjJMMzAuNzgxNSAyNS43MTQ4QzMxLjA0NzcgMjUuOTgxMSAzMS4wNzE5IDI2LjM5NzcgMzAuODU0IDI2LjY5MTNMMzAuNzgxNCAyNi43NzU0TDI1Ljc4MzcgMzEuNzcyMUMyNS41MTc2IDMyLjAzODEgMjUuMTAxMiAzMi4wNjI0IDI0LjgwNzYgMzEuODQ0OUwyNC43MjM1IDMxLjc3MjRMMTkuNzIgMjYuNzc1N0MxOS40MjY5IDI2LjQ4MzEgMTkuNDI2NiAyNi4wMDgyIDE5LjcxOTMgMjUuNzE1MUMxOS45ODU0IDI1LjQ0ODYgMjAuNDAyIDI1LjQyNDEgMjAuNjk1OCAyNS42NDE4TDIwLjc4IDI1LjcxNDRMMjQuNDk5IDI5LjQyOEwyNC41IDE1Ljc1QzI0LjUgMTUuMzcwMyAyNC43ODIyIDE1LjA1NjUgMjUuMTQ4MiAxNS4wMDY4TDI1LjI1IDE1TDI1LjE0ODIgMTUuMDA2OFoiIGZpbGw9IiMzMzMzMzMiLz4KPC9zdmc+Cg=="}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/async-entry-55618a1e63cf5002.js.map