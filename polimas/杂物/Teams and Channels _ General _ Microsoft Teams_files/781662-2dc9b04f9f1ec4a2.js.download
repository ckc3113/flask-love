"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[781662],{870017:(e,t,i)=>{i.d(t,{Y:()=>n});let s=[];function n(e){s.push(e)}},642601:(e,t,i)=>{i.d(t,{A:()=>s});class s{constructor(e,t){this.router=e,this.coreSettings=t,this.categorySubscriptions=new Map}init(){this.channel=new MessageChannel,this.router.postMessage("initCoreSettingsWorker",void 0,[this.channel.port2]),this.registerListeners()}registerListeners(){this.channel&&(this.channel.port1.onmessage=e=>{const{data:t}=e;"settingsRequest"===t.type&&this.handleSettings(t.payload),"subscribeCategory"===t.type&&this.handleSubscription(t.payload),"unsubscribeCategory"===t.type&&this.handleUnsubscription(t.payload)})}handleSubscription({category:e}){if(this.categorySubscriptions.has(e))return;const t=this.coreSettings.getObservable(e).subscribe((t=>{var i;null===(i=this.channel)||void 0===i||i.port1.postMessage({type:"categorySubscriptionResponse",payload:{values:t,category:e}})}));this.categorySubscriptions.set(e,t)}handleUnsubscription({category:e}){const t=this.categorySubscriptions.get(e);t&&(t.unsubscribe(),this.categorySubscriptions.delete(e))}handleSettings({category:e,settings:t,id:i}){var s;const n=this.coreSettings.get(e),r={};null==t||t.forEach((e=>{r[e]=n[e]})),null===(s=this.channel)||void 0===s||s.port1.postMessage({type:"settingsResponse",payload:{values:r,id:i}})}}},685118:(e,t,i)=>{i.d(t,{t:()=>a});var s=i(50805),n=i(168731);const r="default",o=5e3;class a{constructor(e,t,i){this.windowProvider=e,this.coreSettings=t,this._eventsPerInterval=0,this._captureEvents=!1,this._captureContext=!1,this._capturedEvents={},this._capturedContext={},i&&(this._capturedContext=i.context,this._capturedEvents=i.events),this.start()}get capturingEvents(){return this._captureEvents}setCaptureEvents(e){this._captureEvents=e,this.createWindowIntervalOnce()}get capturingContext(){return this._captureContext}setCaptureContext(e){this._captureContext=e,this.createWindowIntervalOnce()}get events(){return this._capturedEvents}get context(){return this._capturedContext}get eventsPerSecond(){return this._eventsPerInterval}get eventSubscription(){return a._eventSubscription}captureEvent(e,t){const i=t||r;this._captureEvents&&(this._capturedEvents[i]||(this._capturedEvents[i]=[]),this._capturedEvents[i].unshift(e),this._capturedEvents[i].length>=o&&(this._capturedEvents[i].length=o-Math.floor(500)),a._dirty=!0)}captureContext(e,t,i){if(!this._captureContext||!e)return;const s=i||r;s in this._capturedContext||(this._capturedContext[s]={}),this._capturedContext[s][e]=t}clear(){this._capturedEvents={[r]:[]}}start(){var e,t,i;const n=null===(e=this.coreSettings)||void 0===e?void 0:e.get(s.J.Telemetry);this._captureEvents=null!==(t=null==n?void 0:n.debugMenuCaptureEvents)&&void 0!==t&&t,this._captureContext=null!==(i=null==n?void 0:n.debugMenuCaptureContext)&&void 0!==i&&i,this.createWindowIntervalOnce(),a._eventSubscription.next()}stop(){this.windowProvider&&a._intervalId&&(this.windowProvider.clearInterval(a._intervalId),a._intervalId=void 0),a._eventSubscription.next()}getTotalEventCount(){return Object.keys(this._capturedEvents).reduce(((e,t)=>[...e,...this._capturedEvents[t]]),[]).length}createWindowIntervalOnce(){if((this._captureEvents||this._captureContext)&&this.windowProvider&&void 0===a._intervalId){let e=0;a._intervalId=this.windowProvider.setInterval((()=>{e+=1,this._eventsPerInterval=this.getTotalEventCount()/e,a._dirty&&(a._eventSubscription.next(),a._dirty=!1)}),1e3)}}}a._dirty=!1,a._eventSubscription=new n.xQ},300426:(e,t,i)=>{i.d(t,{k:()=>a,H:()=>l});var s=i(50805),n=i(549571),r=i(738646),o=i(74583);const a=-1;class l{constructor(){this.FractionalBuckets=1e3,this.ExpandedFractionalBuckets=1e6,this.ConvertToWholeFactor=.01,this.WholeNumberBuckets=100,this.DefaultCohort=0,this.DefaultSampleRate=100,this.rulesLookup={},this.cohortBoundary=this.DefaultCohort,this.telemetrySettings={},this.deviceId=null,this.userId=null,this.blockZeroSampleRate=!1,this.preAuthUserSamplingId=null,this.updateSamplingSettings=e=>{var t;if(e){this.telemetrySettings=e;let i={},s={};e.samplingRules&&(i=e.samplingRules,e.enableToolingSamplingRules?(s=null!==(t=e.toolingSamplingRules)&&void 0!==t?t:{},this.rulesLookup=(0,o.merge)(s,i)):this.rulesLookup=i),this.setCohortBoundry(),this.blockZeroSampleRate=e.enableBlockZeroSampleRate}}}initialize(e){e.getObservable(s.J.Telemetry).subscribe(this.updateSamplingSettings),this.telemetrySettings=e.get(s.J.Telemetry),this.updateSamplingSettings(this.telemetrySettings)}static getInstance(){return this.eventSuppressionService||(this.eventSuppressionService=new l),this.eventSuppressionService}setSamplingByUser(e){this.userId||(this.userId=e,this.setCohortBoundry())}setSamplingByPreAuthId(e){this.preAuthUserSamplingId=e,this.setCohortBoundry()}setSamplingByDevice(e){this.deviceId=e,this.setCohortBoundry()}getCurrentCohort(){return this.cohortBoundary}shouldSuppressEvent(e,t="*"){return this.getSampleRate(e,t,"*")===a}getCrossClientScenarioSampleRate(e){if(this.telemetrySettings.enableExpandedCrossClientScenarioDefaultSampling&&e===r.t7.Expanded)return this.DefaultSampleRate}getSampleRate(e,t="*",i="*"){const s=this.rulesLookup[e];if(void 0!==s){const e=void 0!==s[`${t}|${i}`]?s[`${t}|${i}`]:void 0!==s[t]?s[t]:void 0!==s[`*|${i}`]?s[`*|${i}`]:void 0!==s["*"]?s["*"]:this.DefaultSampleRate;if(0===e&&this.blockZeroSampleRate)return a;if(this.cohortBoundary!==this.DefaultCohort)return this.cohortBoundary>e?a:e}return this.DefaultSampleRate}setCohortBoundaryByIdType(e,t){return t&&t>a&&t<=this.DefaultSampleRate?void(this.cohortBoundary=t):e}getBuckets(){return this.telemetrySettings.enableExpandedFractionalBuckets?this.telemetrySettings.ecsProvidedBuckets&&this.telemetrySettings.ecsProvidedBuckets>0?this.telemetrySettings.ecsProvidedBuckets:this.ExpandedFractionalBuckets:this.FractionalBuckets}setCohortBoundry(){if(this.cohortBoundary!==this.DefaultCohort)return;let e=null;const t=this.telemetrySettings,i=this.getBuckets(),s=i*this.ConvertToWholeFactor;!this.userId&&t.enablePreAuthIdSampling?e=this.preAuthUserSamplingId:t.enableDeviceIdSampling?e=this.setCohortBoundaryByIdType(this.deviceId,this.telemetrySettings.deviceIdSampleCohort):t.enableUserIdSamplingV2&&(e=this.setCohortBoundaryByIdType(this.userId,this.telemetrySettings.userIdSampleCohort)),t.enablePreAuthIdSampling||t.enableDeviceIdSampling||t.enableUserIdSamplingV2?e&&(this.cohortBoundary=((0,n.E)(e)%i+1)/s):this.userId&&(this.cohortBoundary=(0,n.E)(this.userId)%this.WholeNumberBuckets+1)}}},781662:(e,t,i)=>{i.d(t,{G:()=>A});var s,n=i(740597),r=i(870017),o=i(738646);!function(e){e.Desktop="Desktop",e.Messaging="Messaging",e.Files="Files",e.Apps="Apps",e.Activity="Activity",e.Feeds="Feeds",e.Teams="Teams",e.CMD="CMD",e.Notifications="Notifications",e.Foundation="Foundation"}(s||(s={}));const a=new Map;a.set(o.RG.WindowLaunchTime,{featureArea:s.Foundation,customDimensions:["App"]});var l=i(50805),d=i(642601),c=i(969939),h=i(853063),u=i(185870),p=i(100836),_=i(507829),g=i(575644),S=i(89062),E=i(685118),I=i(300426);class v{constructor(){this.propagators={}}addCallback(e,t){const i=this.propagators[e];this.propagators[e]=i?Object.assign(Object.assign({},i),{callbacks:[...i.callbacks,t]}):{filters:void 0,usingCache:!1,cache:{},callbacks:[t]};const s=this.propagators[e];if(s){const{cache:e,usingCache:i}=s;i&&Object.keys(e).forEach((i=>{const s=e[i];s&&t(i,s[0],s[1])}))}}updateFilter(e,t,i=!1){const s=this.propagators[e];s?(s.filters=t,s.usingCache=i):this.propagators[e]={filters:t,usingCache:i,cache:{},callbacks:[]}}send(e,t,i){Object.keys(this.propagators).forEach((s=>{var n,r;const o=this.propagators[s];if(o){const a=o.filters;a?a.has(e)&&(o.usingCache&&(o.cache[e]=[t,i]),null===(n=this.propagators[s])||void 0===n||n.callbacks.forEach((s=>s(e,t,i)))):null===(r=this.propagators[s])||void 0===r||r.callbacks.forEach((s=>s(e,t,i)))}}))}}const m=c.h.default;class C{constructor(){this._eventCapture=new E.t,this._contextPropagator=new v,this._sessionId="",this._silent=!1,this._sharedWorkerOptions={delayLoadingWorker:!1,isSharedWorkerEnabled:!1,isWorkerEnabled:!1},this._cachedOperation=[],this._workerInited=!1,this._primaryUserId="",this._primaryTenantId="",this._users=new Set,(0,r.Y)((()=>{this._cachedOperation=[],this._sharedWorkerOptions.sharedWorkerUrl=void 0}))}getUsers(){return this._users}getPrimaryUserId(){return this._primaryUserId}getPrimaryTenantId(){return this._primaryTenantId}get eventCapture(){return this._eventCapture}set eventCapture(e){this._eventCapture&&this._eventCapture.stop(),this._eventCapture=e}get sessionId(){return this._sessionId}setCdlContextCallback(e){this._contextPropagator.addCallback("cdl",((t,i,s)=>{var n;e(t,null!==(n=null==i?void 0:i.toString())&&void 0!==n?n:"",s)}))}setMultiContextCallback(e){this._contextPropagator.addCallback("maglev",((t,i,s)=>{var n;e(t,null!==(n=null==i?void 0:i.toString())&&void 0!==n?n:"",s)}))}setCollectorContextCallback(e){this._collectorContextCallback=e}setEndpointHealth(e){this._getEndpointHealth=e}getEndpointHealth(e,t){var i;return this._getEndpointHealth?null===(i=this._getEndpointHealth(e,t))||void 0===i?void 0:i.isHealthy:void 0}setupReinitSubscriptions(e){var t;if(!this._initializeParams||!e.enableTelemetryRegionReinit)return;let i=!1;e.oneDsCollectorUrl&&this._initializeParams.oneDsCollectorUrl!==e.oneDsCollectorUrl&&(this._initializeParams.oneDsCollectorUrl=e.oneDsCollectorUrl,i=!0),e.telemetryServer&&this._initializeParams.config.collectorUrl!==e.telemetryServer&&(this._initializeParams.config.collectorUrl=e.telemetryServer,i=!0),void 0!==e.enableOneDsSdkNs&&this._initializeParams.enableOneDsSdkNs.toString()!==(null===(t=e.enableOneDsSdkNs)||void 0===t?void 0:t.toString())&&(this._initializeParams.enableOneDsSdkNs=e.enableOneDsSdkNs||!1,i=!0),e.defaultToken&&this._initializeParams.appTokens.default!==e.defaultToken&&(this._initializeParams.appTokens.default=e.defaultToken,i=!0),i&&(this._sendOrCacheOperation("flushForReinit",this._initializeParams),this.logReinitEvent()),void 0!==e.telemetryRegionFetchComplete&&null!==e.telemetryRegionFetchComplete&&this.setContext("telemetryRegionFetchComplete",e.telemetryRegionFetchComplete),e.telemetryRegion&&this.setContext("UserInfo.TelemetryRegion",e.telemetryRegion),void 0!==this._collectorContextCallback&&i&&e.telemetryRegionFetchComplete&&e.telemetryRegion&&this._collectorContextCallback(e.enableTelemetryRegionReinit,e.telemetryRegion,e.telemetryRegionFetchComplete)}initialize(e,t){var i,s,r,a,c,u,p;const{workerOptions:S,services:v}=e,C=(0,n.__rest)(e,["workerOptions","services"]),{coreSettings:A,columnSuppressionService:y}=v,O=A.get(l.J.Telemetry);C.enableMergedExpIds=null!==(i=O.enableMergedExpIds)&&void 0!==i&&i;const{workerType:f,workerSetup:T}=S;if(this._initializeParams=C,this._initializeParams&&(null!==(s=(p=this._initializeParams).defaultLoggerName)&&void 0!==s||(p.defaultLoggerName=m)),this._silent=C.isSilent,this._sharedWorkerOptions.delayLoadingWorker=null!==(r=C.delayLoadingWorker)&&void 0!==r&&r,this._sharedWorkerOptions.isSharedWorkerEnabled=null!==(a=C.enableSharedWorker)&&void 0!==a&&a,t&&(this._consoleLogger=t,C.config.log=void 0,C.enableDebugTrace=!0),this.initScenario=e.services.scenarioFactory.newScenario(o.RG.TelemetryWorkerInitialization),this.columnSuppressionService=y,this._initializeDefer=(0,_.P)(),(0,g.E)(this._initializeDefer.promise,3e4).catch((e=>{var t;this.setContext("Session.TelemetryWorkerType","embed"),null===(t=this.initScenario)||void 0===t||t.mark(o.ck.WorkerTimeout),this._router=new h.v,this._setupWorker(this._router,C)})),this._router=T(),this._setupWorker(this._router,C),Array.isArray(O.multiContextColumns)){const e=new Set(O.multiContextColumns);this._contextPropagator.updateFilter("maglev",e)}else null===(c=t.warnNoPii)||void 0===c||c.call(t,"Failed to update maglev multi context filter, setting in unexpected format "+typeof O.multiContextColumns);if(Array.isArray(O.cdlMultiContextColumns)){const e=new Set(O.cdlMultiContextColumns);this._contextPropagator.updateFilter("cdl",e,!0)}else null===(u=t.warnNoPii)||void 0===u||u.call(t,"Failed to update maglev multi context filter, setting in unexpected format "+typeof O.cdlMultiContextColumns);C.documentInfo.deviceId&&I.H.getInstance().setSamplingByDevice(C.documentInfo.deviceId);if(A.getObservable(l.J.Telemetry).subscribe((e=>{this._updateSDKwithPrivacyGuard(e),this._updateSecondPartyTelemetryFlag(e),this.setupReinitSubscriptions(e)})),this.setContext("Session.TelemetryWorkerType",f),this.eventCapture=new E.t(void 0,v.coreSettings,this.eventCapture),("shared"===f||"dedicated"===f)&&void 0!==this._router){new d.A(this._router,A).init()}}createEvent(e,t,i,s,n,r){var o;const a=new u.kc;return a.name=e,a.eventType=t,a.timestamp=Date.now(),a.setProperty("EventInfo.BaseType",t),i&&(this._copyEventProperties(a,i,s),null===(o=this.columnSuppressionService)||void 0===o||o.applyColumnBlockingRules(e,null!=r?r:t,a,n),n&&a.setProperty(n.columnName,(0,S.XC)(n.packedData))),r&&a.setProperty("EventInfo.Identifier",r),a}flush(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return this._silent?new Promise(((e,t)=>{t()})):new Promise(((t,i)=>{this._router?(this._router.registerMessageHandler("flushed",(()=>{this._router&&this._router.unregisterMessageHandler("flushed"),t()})),this._router.postMessage("flush",{isAsync:e})):i()}))}))}logEvent(e,t,i=""){this._silent||(this._sendOrCacheOperation("logEvent",{key:e,value:t,userContextId:i}),this._eventCapture.captureEvent(t,i))}initializeSecondPartyLogger(e,t,i=!1){this.enableSecondPartyTelemetry&&this._sendOrCacheOperation("newSecondPartyOneDsLogger",{key:e,value:{ingestionToken:t,useTeamsContext:i}})}logSecondPartyEvent(e,t){this.enableSecondPartyTelemetry&&!this._silent&&this._sendOrCacheOperation("logSecondPartyEvent",{key:e,value:t})}initializeLogger(e,t){this._sendOrCacheOperation("newLogger",{key:e,value:t})}logOutUser(e){e&&(this._sendOrCacheOperation("logOutUser",{userContextId:e}),this._users.delete(e))}setPrimaryUser(e,t){e&&(this._primaryUserId=e,this._primaryTenantId=t,this._users.has(e)||this._users.add(e),this._sendOrCacheOperation("setPrimaryUser",{userContextId:e,userTenantId:t}))}setContext(e,t,i,s){var n,r,o;if("UserInfo.Id"===e&&"string"==typeof t&&(I.H.getInstance().setSamplingByUser(t),t&&!this._users.has(t)&&this._users.add(t)),!(null===(n=this.columnSuppressionService)||void 0===n?void 0:n.isContextColumnOk(e)))return;const a=(0,S.XC)(null!=t?t:""),l={key:e,value:a,pii:i,userContextId:s};(null===(r=this._initializeParams)||void 0===r?void 0:r.defaultLoggerName)&&(null===(o=this._initializeParams)||void 0===o?void 0:o.defaultLoggerName)!==c.h.default&&(l.logger=this._initializeParams.defaultLoggerName),this._sendOrCacheOperation("setContext",l),this._eventCapture.captureContext(e,a,s),this._contextPropagator.send(e,t,s)}setPrivacyGuardUserInfo(e,t){this._sendOrCacheOperation("setPrivacyGuardUserInfo",{userNames:e,upns:t})}setDeviceAuthToken(e){this._sendOrCacheOperation("setDeviceAuthToken",e)}start(){this._silent||this._sendOrCacheOperation("start")}stop(){this._silent||this._sendOrCacheOperation("stop")}sendPulsarSignal(e){this._sendOrCacheOperation("pulsarSignal",e)}registerPulsarBackchannelListener(e){var t;null===(t=this._router)||void 0===t||t.registerMessageHandler("pulsarSignal",e)}Verbose(e){this._consoleLogger&&this._consoleLogger.debug(e)}Error(e){this._consoleLogger&&this._consoleLogger.error(e)}Info(e){this._consoleLogger&&this._consoleLogger.debug(e)}_setupWorker(e,t){var i,s,n,r;return e.registerMessageHandler("sessionId",(e=>{this._sessionId=null==e?void 0:e.value})),e.registerMessageHandler("batchDone",(()=>{var e;this._workerInited=!0,null===(e=this.initScenario)||void 0===e||e.stop()})),e.registerMessageHandler("workerInitialized",(()=>{var e,t;null===(e=this._initializeDefer)||void 0===e||e.resolve(),null===(t=this.initScenario)||void 0===t||t.mark(o.ck.WorkerInitialized),this._cachedOperation.length>0&&this._router&&(this._router.postMessage("batch",this._cachedOperation),this._cachedOperation=[])})),e.registerMessageHandler("error",(e=>{this.Error(e)})),e.registerMessageHandler("info",(e=>{this.Info(e)})),e.registerMessageHandler("verbose",(e=>{this.Verbose(e)})),this._sendOrCacheOperation("newLogger",{key:null!==(s=null===(i=this._initializeParams)||void 0===i?void 0:i.defaultLoggerName)&&void 0!==s?s:m,value:t.appTokens.default}),this._sendOrCacheOperation("logSession",{name:null!==(r=null===(n=this._initializeParams)||void 0===n?void 0:n.defaultLoggerName)&&void 0!==r?r:m,state:u.sM.STARTED,sessionId:t.sessionId,sessionStartTime:t.sessionStartTime}),this._sendOrCacheOperation("sessionId",t.sessionId),e.postMessage("initialize",t),e}logReinitEvent(){const e="loggingns",t="instrumentation_reinit",i="info",s=I.H.getInstance().getSampleRate(e,t,i);if(s===I.k)return;const n=this.createEvent(e,t,{message:"Triggering logger reinit",sampleRate:s,"EventInfo.Identifier":t,logLevel:i});this.logEvent(c.h.default,n)}static getInstance(){return this.telemetryProviderInstance||(this.telemetryProviderInstance=new C),this.telemetryProviderInstance}_sendOrCacheOperation(e,t){this._workerInited&&this._router?(this._cachedOperation.length>0&&(this._router.postMessage("batch",this._cachedOperation),this._cachedOperation=[]),this._router.postMessage(e,t)):this._cachedOperation.push({name:e,params:t})}_copyEventProperties(e,t,i){let s=null;for(const i in t)t.hasOwnProperty(i)&&(s=t[i],null!=s&&""!==s&&("object"==typeof s&&Object.prototype.hasOwnProperty.call(s,"piiKind")&&Object.prototype.hasOwnProperty.call(s,"value")&&s.piiKind in p.A4?e.setProperty(i,(0,S.XC)(s.value),s.piiKind):e.setProperty(i,(0,S.XC)(s))));if(i){const t=a.get(e.eventType);t&&this._copyMonitoringData(e,t,i)}}_copyMonitoringData(e,t,i){const s=[void 0,void 0,void 0],n=t.customDimensions.length;e.setProperty("Scenario.Priority",i.scenarioPriority),i.scenarioErrorCode&&e.setProperty("Scenario.ErrorCode",i.scenarioErrorCode),i.data.forEach((i=>{i.value&&e.setProperty(this._createMonitoringKey(t.featureArea,i.key),i.value);const n=t.customDimensions.findIndex((e=>e===i.key));n>0&&n<3&&(s[n]=i.value)}));let r="";for(let e=0;e<n;e++){const t=void 0===s[e]?"":s[e];r=e===n-1?`${r}${t}`:`${r}${t},`}e.setProperty("CombinedMonitoringDimensions",r)}_createMonitoringKey(e,t){return`QoS.${e}_${t}`}_updateSecondPartyTelemetryFlag(e){this.enableSecondPartyTelemetry=Boolean(e.enableSecondPartyTelemetry)}_updateSDKwithPrivacyGuard(e){var t,i;if(e&&(null===(t=this._initializeParams)||void 0===t?void 0:t.enableOneDsSdkNs)){const t=!!e.enablePrivacyGuard;t!==(null===(i=this._initializeParams)||void 0===i?void 0:i.enablePrivacyGuard)&&(this._initializeParams.enablePrivacyGuard=t,this._sendOrCacheOperation("updateSDKWithPrivacyGuard",t))}}}const A=()=>C.getInstance()},853063:(e,t,i)=>{i.d(t,{v:()=>r});var s=i(561890),n=i(83398);class r extends s.t{constructor(){super(),this.telemetryWorker=new n.N,this.telemetryWorker.initialize(this)}postMessage(e,t){const i=this.messageHandlers[e];i&&i(t)}}},185870:(e,t,i)=>{i.d(t,{cS:()=>c,kc:()=>u,sM:()=>n,hD:()=>S,Yd:()=>E});var s,n,r=i(589008),o=i(100836),a=i(447918),l=i(119830),d=null;function c(e){d=e}class h{constructor(){this.key=null,this.value=null,this.pii=null}static _isPii(e){if(e==o.A4.NotSet)return!1;var t=!1;for(var i in o.A4)isNaN(i)||i==e&&(t=!0);return t}}class u{constructor(){this.name=null,this.timestamp=null,this.properties=[],this.eventType=null}setProperty(e,t,i){if(!e||!this.properties[e]&&!u._propertyNameRegex.test(e))throw new p(s.INVALID_PROPERTY_NAME);this.properties[e]={key:e,value:t,pii:i!=o.A4.NotSet?i:null}}unsetProperty(e){if(!e)throw new p(s.INVALID_PROPERTY_NAME);void 0!==this.properties[e]&&(this.properties[e]=void 0,delete this.properties[e])}}u._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$/,function(e){e[e.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN",e[e.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME",e[e.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME",e[e.INVALID_COLLECTOR_URL=4]="INVALID_COLLECTOR_URL",e[e.MISSING_FAILURE_SIGNATURE=5]="MISSING_FAILURE_SIGNATURE",e[e.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL",e[e.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID",e[e.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME",e[e.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE"}(s||(s={}));class p{constructor(e){this.errorCode=null,this.errorCode=e}ErrorCode(){return this.errorCode}toString(){switch(this.errorCode){case s.INVALID_TENANT_TOKEN:return"Invalid tenant token";case s.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty";case s.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$";case s.INVALID_COLLECTOR_URL:return"Collector url can't be null or empty.";case s.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty.";case s.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty.";case s.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty.";case s.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty.";case s.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum.";default:return"Unknown error"}}}class _{constructor(e){this.contextMap=new a.D,this.piiKind=o.A4.NotSet,this._allowDeviceInfoFields=!1,this._allowDeviceInfoFields=e}setAppId(e){e&&this.contextMap.Add("AppInfo.Id",e)}setAppVersion(e){e&&this.contextMap.Add("AppInfo.Version",e)}setAppClientType(e){e&&this.contextMap.Add("AppInfo.ClientType",e)}setAppLanguage(e){e&&this.contextMap.Add("AppInfo.Language",e)}setDeviceId(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.Id",e)}setDeviceOsName(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsName",e)}setDeviceOsVersion(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsVersion",e)}setDeviceBrowserName(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserName",e)}setDeviceBrowserVersion(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserVersion",e)}setUserId(e,t){e&&this.contextMap.Add("UserInfo.Id",e),h._isPii(t)&&(this.piiKind=t)}setUserMsaId(e){e&&this.contextMap.Add("UserInfo.MsaId",e)}setUserANID(e){e&&this.contextMap.Add("UserInfo.ANID",e)}setUserAdvertisingId(e){e&&this.contextMap.Add("UserInfo.AdvertisingId",e)}setUserTimeZone(e){e&&this.contextMap.Add("UserInfo.TimeZone",e)}setUserLanguage(e){e&&this.contextMap.Add("UserInfo.Language",e)}setUserRing(e){e&&this.contextMap.Add("UserInfo.Ring",e)}setUserTenantId(e){e&&this.contextMap.Add("UserInfo.TenantId",e)}}class g{static initialize(e){g.documentInfo=e;var t=e.appLanguage;t&&g.semanticContext.setAppLanguage(t);var i=e.userLanguage;i&&g.semanticContext.setUserLanguage(i);var s=(new Date).getTimezoneOffset(),n=s%60,r=(s-n)/60,o="+";r>0&&(o="-"),n=Math.abs(n);var a=o+((r=Math.abs(r))<10?"0"+r:r.toString())+":"+(n<10?"0"+n:n.toString());g.semanticContext.setUserTimeZone(a),g.semanticContext.setDeviceBrowserName(g._getBrowserName()),g.semanticContext.setDeviceBrowserVersion(g._getBrowserVersion()),g.semanticContext.setDeviceOsName(g._getOsName()),g.semanticContext.setDeviceOsVersion(g._getOsVersion()),g.semanticContext.setDeviceId(e.deviceId),g.firstLaunchTime=e.firstLaunchTime,g.semanticContext.setAppVersion(e.appVersion)}static _getUserAgent(){return g.documentInfo.userAgent}static _userAgentContainsString(e){return g._getUserAgent().indexOf(e)>-1}static _isIe(){return g._userAgentContainsString("Trident")}static _isEdge(){return g._userAgentContainsString(g.BROWSERS.EDGE)}static _isEdgeAnaheim(){return g._userAgentContainsString("Edg/")}static _isOpera(){return g._userAgentContainsString("OPR/")}static _getBrowserName(){return g._isOpera()?g.BROWSERS.UNKNOWN:g._userAgentContainsString(g.BROWSERS.PHANTOMJS)?g.BROWSERS.PHANTOMJS:g._isEdge()?g.BROWSERS.EDGE:g._isEdgeAnaheim()?g.BROWSERS.EDGEANAHEIM:g._userAgentContainsString(g.BROWSERS.ELECTRON)?g.BROWSERS.ELECTRON:g._userAgentContainsString(g.BROWSERS.CHROME)?g.BROWSERS.CHROME:g._userAgentContainsString(g.BROWSERS.FIREFOX)?g.BROWSERS.FIREFOX:g._userAgentContainsString(g.BROWSERS.SAFARI)?g.BROWSERS.SAFARI:g._userAgentContainsString(g.BROWSERS.SKYPE_SHELL)?g.BROWSERS.SKYPE_SHELL:g._isIe()?g.BROWSERS.MSIE:g.BROWSERS.UNKNOWN}static _getBrowserVersion(){return g._isIe()?function(){var e,t=g._getUserAgent(),i=t.match(new RegExp(g.BROWSERS.MSIE+" "+g.REGEX_VERSION));if(i)return i[1];if(e=t.match(new RegExp("rv:"+g.REGEX_VERSION)))return e[1]}():function(e){var t;e===g.BROWSERS.SAFARI?e="Version":e===g.BROWSERS.EDGEANAHEIM&&(e="Edg");if(t=g._getUserAgent().match(new RegExp(e+"/"+g.REGEX_VERSION)))return t[1];return g.UNKNOWN_VERSION}(g._getBrowserName())}static _getOsName(){return g._getUserAgent().match(/windows\sphone\s\d+\.\d+/i)?g.OPERATING_SYSTEMS.WINDOWS_PHONE:g._getUserAgent().match(/ arm;/i)?g.OPERATING_SYSTEMS.WINDOWS_RT:g._getUserAgent().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?g.OPERATING_SYSTEMS.IOS:g._getUserAgent().match(/android/i)?g.OPERATING_SYSTEMS.ANDROID:g._getUserAgent().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i)?g.OPERATING_SYSTEMS.LINUX:g._getUserAgent().match(/(macintosh|mac os x)/i)?g.OPERATING_SYSTEMS.MACOSX:g._getUserAgent().match(/(windows|win32)/i)?g.OPERATING_SYSTEMS.WINDOWS:g.OPERATING_SYSTEMS.UNKNOWN}static _getOsVersion(){return g._getOsName()===g.OPERATING_SYSTEMS.WINDOWS?function(){var e=g._getUserAgent().match(new RegExp("Windows NT "+g.REGEX_VERSION));if(e&&g.VERSION_MAPPINGS[e[1]])return g.VERSION_MAPPINGS[e[1]];return g.UNKNOWN_VERSION}():g._getOsName()===g.OPERATING_SYSTEMS.MACOSX?function(){var e=g._getUserAgent().match(new RegExp(g.OPERATING_SYSTEMS.MACOSX+" "+g.REGEX_VERSION_MAC));if(e){var t=e[1].replace(/_/g,".");if(t){var i=function(e){if(e.indexOf(".")>-1)return".";if(e.indexOf("_")>-1)return"_";return null}(t);return i?t.split(i)[0]:t}}return g.UNKNOWN_VERSION}():g.UNKNOWN_VERSION}}g.semanticContext=new _(!0),g.firstLaunchTime=-1,g.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",EDGEANAHEIM:"EdgeAnaheim",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"},g.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},g.VERSION_MAPPINGS={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},g.REGEX_VERSION="([\\d,.]+)",g.REGEX_VERSION_MAC="([\\d,_,.]+)",g.UNKNOWN_VERSION="Unknown",g.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId",g.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime",function(e){e[e.STARTED=0]="STARTED",e[e.ENDED=1]="ENDED"}(n||(n={}));class S{static initialize(e,t){if(!S._initialized){if(!t)throw new p(s.INVALID_TENANT_TOKEN);S._defaultToken=t,S._config.collectorUrl||(S._config.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/"),d||(d=r.sE.CreateTelemetryManager()).Initialize(S._config),d.Start(),g.initialize(e),S._initialized=!0}}static initializeWithConfiguration(e,t,i){if(!i.collectorUrl)throw new p(s.INVALID_COLLECTOR_URL);S._config.collectorUrl=i.collectorUrl,S.initialize(e,t)}static flush(e){d.Flush(e)}static addCallbackListener(e){S._initialized&&d.AddListener(e)}static setContext(e,t,i){""!==t&&"null"!==t&&"undefined"!==t?S._contextProperties.setProperty(e,t,i):S._contextProperties.unsetProperty(e)}static isInitialized(){return S._initialized}static getDefaultToken(){return S._defaultToken}static getSemanticContext(){return S._semanticContext}static __addTestHookListener(e){S._initialized&&d.__AddTestHookListener(e)}static __clearTestHookListener(){S._initialized&&d.__ClearTestHookListener()}static __backToUninitialized(){S._config=new r.Mk,S._semanticContext=new _(!0),S._contextProperties=new u,d=r.sE.CreateTelemetryManager(),S._initialized=!1}}S._initialized=!1,S._defaultToken=null,S._config=new r.Mk,S._contextProperties=new u,S._semanticContext=new _(!0);class E{constructor(e){this._initId=o.P6.GetGuid(),this._sequence=0,this._tenantToken=null,this._contextProperties=new u,this._semanticContext=new _(!1),this._sessionStartTime=0,this._sessionId=null,this._tenantToken=e||S.getDefaultToken()}logEvent(e){if(!e.name)throw new p(s.MISSING_EVENT_PROPERTIES_NAME);var t=this._createEventRecord(e.name,e.eventType);this._addCustomPropertiesToEvent(t,e),this._sendRecord(t)}logFailure(e,t,i,n,r){if(!e)throw new p(s.MISSING_FAILURE_SIGNATURE);if(!t)throw new p(s.MISSING_FAILURE_DETAIL);var o=this._createEventRecord("failure","failure");o.Extension.Add("Failure.Signature",e),o.Extension.Add("Failure.Detail",t),i&&o.Extension.Add("Failure.Category",i),n&&o.Extension.Add("Failure.Id",n),this._addCustomPropertiesToEvent(o,r),this._sendRecord(o)}logPageView(e,t,i,n,r,o){if(!e)throw new p(s.MISSING_PAGEVIEW_ID);if(!t)throw new p(s.MISSING_PAGEVIEW_NAME);var a=this._createEventRecord("pageview","pageview");a.Extension.Add("PageView.Id",e),a.Extension.Add("PageView.Name",t),i&&a.Extension.Add("PageView.Category",i),n&&a.Extension.Add("PageView.Uri",n),r&&a.Extension.Add("PageView.ReferrerUri",r),this._addCustomPropertiesToEvent(a,o),this._sendRecord(a)}logSession(e,t,i,r){if(e!==n.STARTED&&e!==n.ENDED)throw new p(s.INVALID_SESSION_STATE);var a=this._createEventRecord("session","session");if(e===n.STARTED){if(this._sessionStartTime>0)return;this._sessionStartTime=r||(new Date).getTime(),this._sessionId=i||o.P6.GetGuid(),a.Extension.Add("Session.Id",this._sessionId),a.Extension.Add("Session.State","Started")}else if(e===n.ENDED){if(0==this._sessionStartTime)return;var l=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);a.Extension.Add("Session.Duration",l.toString()),a.Extension.Add("Session.DurationBucket",this._getSessionDurationFromTime(l)),a.Extension.Add("Session.Id",this._sessionId),a.Extension.Add("Session.State","Ended"),this._sessionId=null,this._sessionStartTime=0}a.Extension.Add("Session.FirstLaunchTime",new Date(g.firstLaunchTime).toISOString()),this._addCustomPropertiesToEvent(a,t),this._sendRecord(a)}getSessionId(){return this._sessionId}setContext(e,t,i){this._contextProperties.setProperty(e,t,i)}getSemanticContext(){return this._semanticContext}_getSessionDurationFromTime(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"}_createEventRecord(e,t){var i=new o.WV;t||(t="custom"),i.EventType=e.toLowerCase(),i.Type=t.toLowerCase(),i.Extension.Add("EventInfo.Source","JS_default_source"),i.Extension.Add("EventInfo.InitId",this._initId),this._sequence++,i.Extension.Add("EventInfo.Sequence",this._sequence.toString()),i.Extension.Add("EventInfo.Name",e.toLowerCase());var s=new Date;return i.Timestamp=o.P6.GetTimeStampWithValue(s.getTime()),i.Extension.Add("EventInfo.Time",s.toISOString()),i.Extension.Add("EventInfo.SdkVersion","ACT-Web-JS-"+l.w.version),i}_addCustomPropertiesToEvent(e,t){this._addSemanticContext(e,g.semanticContext),this._addSemanticContext(e,S._semanticContext),this._addSemanticContext(e,this._semanticContext),this._sessionId&&e.Extension.Add("Session.Id",this._sessionId),this._addEventPropertiesToEvent(e,S._contextProperties),this._addEventPropertiesToEvent(e,this._contextProperties),this._addEventPropertiesToEvent(e,t)}_addSemanticContext(e,t){if(t&&t.contextMap.Count()>0)for(var i=t.contextMap.GetBuffer(),s=0;s<i.length;s++)"UserInfo.Id"==i[s].Key&&t.piiKind!=o.A4.NotSet?e.AddOrReplacePII(i[s].Key,i[s].Value,t.piiKind):e.Extension.AddOrReplace(i[s].Key,i[s].Value)}_addEventPropertiesToEvent(e,t){if(t){t.timestamp&&t.timestamp>=new Date("1/1/2000").getTime()&&(e.Timestamp=o.P6.GetTimeStampWithValue(t.timestamp),e.Extension.AddOrReplace("EventInfo.Time",new Date(t.timestamp).toISOString())),t.name&&(e.EventType=t.name.toLowerCase(),e.Extension.AddOrReplace("EventInfo.Name",t.name.toLowerCase()));var i=t.properties;if(i)for(var s in i)i[s].key&&"string"==typeof i[s].key&&(i[s].value||0==i[s].value||0==i[s].value||""==i[s].value)&&(h._isPii(i[s].pii)?(e.AddOrReplacePII(i[s].key,i[s].value.toString(),i[s].pii),e.Extension.Remove(i[s].key)):(e.Extension.AddOrReplace(i[s].key,i[s].value.toString()),e.PIIExtensions.Remove(i[s].key)))}}_sendRecord(e){S.isInitialized()&&d.SendAsync(this._tenantToken,[e])}}},507829:(e,t,i)=>{function s(){const e={};return e.promise=new Promise(((t,i)=>{e.resolve=t,e.reject=i})),e}i.d(t,{P:()=>s})},549571:(e,t,i)=>{function s(e){let t=5381;for(let i=0;i<e.length;i++)t=(t<<5)+t+e.charCodeAt(i);return t>>>0}i.d(t,{E:()=>s})}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/781662-2dc9b04f9f1ec4a2.js.map